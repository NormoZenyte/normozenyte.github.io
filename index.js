(()=>{"use strict";var t,i,s,e,h={8793:(t,i,s)=>{s.d(i,{K:()=>P});var e=s(1120),h=s(4583),n=s(1069),r=s(4702);class o{static tt=t=>{let i=0;t=t.toUpperCase();for(let s=0;s<t.length;s++)i=61*i+t.charCodeAt(s)-32|0;return i};buffer;it;st;et;ht;nt;rt;ot=[];constructor(t){t instanceof Uint8Array&&(t=new Int8Array(t));let i=new n.A(new Uint8Array(t));const s=i.lt,e=i.lt;s===e?(this.buffer=t,this.it=!1):(this.buffer=r.A.read(s,t,e,6),i=new n.A(new Uint8Array(this.buffer)),this.it=!0),this.st=i.ct,this.et=[],this.ht=[],this.nt=[],this.rt=[];let h=i.ft+10*this.st;for(let t=0;t<this.st;t++)this.et.push(i.ut),this.ht.push(i.lt),this.nt.push(i.lt),this.rt.push(h),h+=this.nt[t]}read(t){const i=o.tt(t),s=this.et.indexOf(i);return-1===s?null:this.dt(s)}dt(t){if(t<0||t>=this.st)return null;if(this.ot[t])return this.ot[t];const i=this.rt[t],s=i+this.nt[t];if(this.it){const e=Uint8Array.from(this.buffer.subarray(i,i+s));return this.ot[t]=e,e}{const i=Uint8Array.from(r.A.read(this.ht[t],this.buffer,this.nt[t],this.rt[t]));return this.ot[t]=i,i}}}var a=s(8370),l=(s(8902),s(6666)),c=s(198),f=s(818),u=s(670),d=s(8268),y=s(3867),p=s(7854),w=s(8950),A=s(1302),x=s(9298),g=s(8665),C=s(1312),S=s(3819),m=s(8317),v=s(9234),B=s(123),b=s(5637),I=s(6948),E=s(2164),_=s(8738),T=s(3764),O=s(8534),L=s(6730);function R(t,i){var s;(s=document.createElement('a')).href=t,s.download=i,document.body.appendChild(s),s.style='display: none',s.click(),s.remove()}class D{yt=new Map;wt;At=self.isSecureContext?self.crypto.randomUUID():'0';constructor(t){this.wt=t}async xt(){const t=new RTCPeerConnection({iceServers:[{urls:'stun:stun.l.google.com:19302'}]}),i=t.createDataChannel('channel'),s=crypto.randomUUID();this.yt.set(s,i),await t.setLocalDescription(await t.createOffer()),t.onicegatheringstatechange=async()=>{if('complete'===t.iceGatheringState){let i;self.isSecureContext?await navigator.clipboard.writeText(JSON.stringify(t.localDescription)):console.log(JSON.stringify(t.localDescription));try{for(;null===(i=prompt('Offer copied to clipboard, paste answer here')););t.setRemoteDescription(new RTCSessionDescription(JSON.parse(i)))}catch(t){console.error(t)}}},i.onopen=()=>{i.send(JSON.stringify({type:'id',id:s})),console.log('Connected to peer!')},i.onerror=t=>{console.error(t)},i.onmessage=t=>{const i=JSON.parse(t.data);i.data&&(i.data=Object.values(i.data)),this.wt&&this.wt.postMessage(i)}}postMessage(t){const i=this.yt.get(t.data.id),s=t.data;s.data&&(s.data=Array.from(t.data.data)),i&&'open'===i.readyState&&i.send(JSON.stringify(s))}}class k{pc;gt=void 0;At;constructor(t){this.pc=new RTCPeerConnection({iceServers:[{urls:'stun:stun.l.google.com:19302'}]}),this.pc.ondatachannel=i=>{this.gt=i.channel,this.gt.onopen=()=>{console.log('Connected to host!')},this.gt.onerror=t=>{console.error(t)},this.gt.onmessage=i=>{if(!this.At){const t=JSON.parse(i.data);if('id'===t.type)return void(this.At=t.id)}t.onmessage&&t.onmessage(i)}},this.pc.onicegatheringstatechange=async()=>{'complete'===this.pc.iceGatheringState&&(self.isSecureContext?await navigator.clipboard.writeText(JSON.stringify(this.pc.localDescription)):console.log(JSON.stringify(this.pc.localDescription)))}}async Ct(t){await this.pc.setRemoteDescription(new RTCSessionDescription(JSON.parse(t))),await this.pc.setLocalDescription(await this.pc.createAnswer())}}var M=s(643),U=s(5868);class P extends a.A{static St=225;static vt=10;static portOffset=0;static members=!0;static Bt=!1;static bt='';static It='';static Et=2;static _t=!1;static Tt='https://raw.githubusercontent.com/2004scape/Server/main';static exponent=58778699976184461502525193738213253649000149147835990136706041084440742975821n;static Ot=7162900525229798032761816791230527296329313291232324290237849263501208207972894053929065636522363163621000728841182238772712427862772219676577293600221789n;static Lt=0;static Rt=0;static Dt=0;static kt=0;static Mt=0;static Ut=0;static Pt=0;static Nt=0;static Ft=0;static Vt=0;static Gt=0;static Wt=0;static Yt=0;static Ht=0;static zt=0;Xt=async()=>{};Kt=async()=>{};Zt=async()=>{};jt=()=>{};qt=async()=>{};static $t=()=>{c.A.Bt=!1,h.A.Bt=!1,P.Bt=!1,f.A.Bt=!1};static Jt=()=>{c.A.Bt=!0,h.A.Bt=!0,P.Bt=!0,f.A.Bt=!0};Qt=2048;ti=2047;ii=!1;si=!1;ei=!1;hi=!1;db=null;ni=0;ri=[];stream=null;in=n.A.oi(1);ai=n.A.oi(1);li=n.A.oi(1);ci=0n;fi=0;ui=0;di=0;yi=null;pi=0;packetSize=0;wi=0;Ai=0;xi=0;gi=null;Ci=!0;Si=0;mi=0;vi=null;Bi=null;bi=null;Ii=null;Ei=null;_i=null;Ti=null;Oi=null;Li=null;Ri=null;Di=null;ki='';Mi='';username='';password='';Ui=null;Pi=null;Ni=null;Fi=null;Vi=[];Gi=!1;Wi=null;Yi=null;Hi=null;zi=null;Xi=null;Ki=null;Zi=null;ji=null;qi=null;$i=null;Ji=new Int32Array(256);Qi=0;ts=0;ss=0;es=null;hs=null;ns=null;rs=null;os=null;ls=null;cs=null;fs=null;us=null;ds=null;ys=null;ps=null;ws=null;As=null;xs=null;gs=null;Cs=null;Ss=null;vs=null;Bs=null;bs=null;Is=new Int32Array(33);Es=new Int32Array(33);_s=new Int32Array(151);Ts=new Int32Array(151);Os=null;Ls=null;Rs=null;Ds=null;ks=null;Ms=null;Us=new y.Ps(13,null);Ns=null;Fs=null;Vs=new y.Ps(50,null);Gs=new y.Ps(50,null);Ws=new y.Ps(20,null);Ys=new y.Ps(20,null);Hs=null;zs=new y.Ps(8,null);Xs=null;Ks=null;Zs=null;js=null;qs=null;$s=null;Js=null;Qs=null;te=null;ie=null;se=null;ee=null;he=null;ne=null;re=null;oe=null;ae=null;le=null;ce=new y.Ps(1e3,null);fe=!1;ue=!1;de=!1;ye=!1;pe=-1;we=0;Ae=0;xe=0;ge=0;Ce=0;Se=0;me=!1;ve=0;Be=0;be=0;Ie=0;Ee=0;_e=0;Te=[];Oe=-1;Le=-1;Re=new e.A;De=78;ke=0;Me=0;Ue=[];Pe=0;Ne=0;Fe=0;Ve=0;Ge=0;We=0;Ye=0;He=0;ze=[];Xe=[];Ke=[];Ze=[];je=null;qe=-1;$e=3;Je=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];Qe=0;th=0;ih=0;sh=!1;eh=0;hh=!1;nh='';rh='';oh=0;ah='';lh=!1;fh=-1;uh=new y.Ps(100,null);dh=new y.Ps(100,null);messageType=new Int32Array(100);yh=new Int32Array(100);ph=0;wh=0;Ah=0;xh='';gh=0;Ch=0;Sh=0;mh=0;Bh=0;bh=0;Ih=0;Eh=0;_h=0;Th=!1;Oh=0;Lh=0;Rh=0;Dh=0;kh=null;Mh=0;Uh=0;Ph=0;Nh=0;Fh=!1;Vh=[];Gh=[];Wh=0;Yh=0;Hh=0;zh=null;Xh=0;Kh=new Int32Array(500);Zh=new Int32Array(500);jh=new Int32Array(500);qh=new Int32Array(500);$h=0;Jh=0;Qh=0;tn='';sn=!1;en=-1;hn=0;nn=0;rn=0;an=0;ln=0;cn=new Int32Array(1e3);fn=new Int32Array(1e3);un=null;dn=0;yn=0;pn=0;wn=0;An=0;xn=!1;gn=0;Cn=0;Sn=0;mn=0;vn=2;Bn=2;bn=1;In=new Int32Array(5);En=new y.Ps(5,!1);_n=new Int32Array(5);Tn=new Int32Array(5);On=new Int32Array(5);Ln=0;Rn=0;Dn=0;kn=0;Mn=0;Un=0;Pn=0;Nn=0;Fn=0;Vn=1;Gn=2;Wn=-1;Yn=0;Hn=0;zn=0;Xn=0;Kn=0;Zn=0;jn=null;qn=null;$n=null;Jn=0;Qn=0;tr=new Int8Array(16384);ir=new y.Ps(u.A.sr,null);er=0;hr=0;nr=128;rr=0;ar=0;lr=0;cr=0;ur=0;dr=null;yr=null;pr=new y.wr(u.A.Ar,u.A.Ar);gr=0;Cr=0;Sr=0;mr=0;vr=0;Br=0;br=0;Ir=0;Er=0;_r=0;Tr=0;Or=0;Lr=new y.Ps(this.Qt,null);Rr=0;Dr=new Int32Array(this.Qt);kr=0;Mr=0;Ur=new Int32Array(this.Qt);Pr=new Int32Array(1e3);Nr=new y.Ps(this.Qt,null);Fr=new y.Ps(8192,null);Vr=0;Gr=new Int32Array(8192);Wr=new l.A;Yr=new l.A;Hr=new l.A;zr=new l.A;Xr=new y.Kr(u.A.sr,u.A.Ar,u.A.Ar,null);Zr=new l.A;jr=new Int32Array(4e3);qr=new Int32Array(4e3);$r=new Int32Array(u.A.Ar*u.A.Ar);Jr=new Int32Array(u.A.Ar*u.A.Ar);Qr=0;io=null;so=0;eo=0;ho=-1;no=0;ro=0;oo=0;ao=0;lo=!1;co=!0;fo=!1;uo=new Int32Array(7);do=new Int32Array(5);yo=0;po=0;static wo=50;Ao=new Int32Array(P.wo);xo=new Int32Array(P.wo);Co=new Int32Array(P.wo);So=new Int32Array(P.wo);mo=new Int32Array(P.wo);vo=new Int32Array(P.wo);Bo=new Int32Array(P.wo);bo=new y.Ps(P.wo,null);Io=new y.Ps(100,null);Eo=new BigInt64Array(100);_o=new Int32Array(100);To=null;Oo=0;Lo=!0;Ro=new Int32Array(50);Do=new Int32Array(50);ko=new Int32Array(50);Mo=192;Uo=-1;Po=-1;No=0;Fo=0;Vo=0;Go=!0;Wo=null;Yo=0;Ho=0;zo=192;wt=void 0;Xo=!1;host=null;Ko=null;Zo=new y.Ps(16,null);jo=0;qo=!1;$o=()=>{try{this.stream&&this.stream.close()}catch(t){}this.Ko&&'998'===P.getParameter('world')&&this.Ko.gt?.send(JSON.stringify({type:'close',id:this.Ko.At})),this.stream=null,(0,B.Jo)(!1),this.ai=null,this.li=null,this.in=null,this.$n=null,this.jn=null,this.qn=null,this.dr=null,this.yr=null,this.un=null,this.ir=null,this.$r=null,this.Jr=null,this.jr=null,this.qr=null,this.tr=null,this.hs=null,this.ns=null,this.rs=null,this.os=null,this.ls=null,this.cs=null,this.fs=null,this.us=null,this.ds=null,this.ys=null,this.ps=null,this.ws=null,this.As=null,this.xs=null,this.gs=null,this.Cs=null,this.Ss=null,this.Os=null,this.Rs=null,this.Ls=null,this.Ds=null,this.ks=null,this.Ms=null,this.Us=null,this.Js=null,this.Qs=null,this.te=null,this.ie=null,this.se=null,this.ee=null,this.he=null,this.ne=null,this.re=null,this.oe=null,this.Fs=null,this.Ws=null,this.Ys=null,this.zs=null,this.Xs=null,this.Ks=null,this.Zs=null,this.js=null,this.Vs=null,this.Gs=null,this.pr=null,this.Lr=null,this.Dr=null,this.Ur=null,this.Nr=null,this.Pr=null,this.Fr=null,this.Gr=null,this.Xr=null,this.Zr=null,this.zr=null,this.Wr=null,this.Yr=null,this.Hr=null,this.jh=null,this.qh=null,this.Kh=null,this.Zh=null,this.Te=null,this.Vh=null,this.cn=null,this.fn=null,this.ce=null,this.Ns=null,this.Io=null,this.Eo=null,this._o=null,this.Ii=null,this.Ei=null,this.vi=null,this.Bi=null,this.bi=null,this._i=null,this.Ti=null,this.Oi=null,this.Li=null,this.Qo(),b.A.$o(),I.A.$o(),A.A.$o(),E.A.ta=null,m.A.ta=null,e.A.ta=null,C.A.ta=null,_.A.ta=null,_.A.ia=null,T.A.ta=null,this.sa=null,d.A.ia=null,h.A.$o(),c.A.$o(),g.A.$o(),O.A.ta=[],L.A.ta=[]};ea(){return this.Si}ha(){return this.lh}na(){return this.hh}ra(){return this.Le}oa(){return this.pe}Qo=()=>{this.Gi=!1,this.es&&(clearInterval(this.es),this.es=null),this.Ri=null,this.Di=null,this.Vi=[],this.Zi=null,this.ji=null,this.qi=null,this.$i=null,this.zi=null,this.Hi=null,this.Xi=null,this.Ki=null,this.Wi=null,this.Yi=null};aa=()=>{'999'===P.getParameter('world')?(this.wt=new Worker('worker.js',{type:'module'}),this.wt.onmessage=this.onmessage,this.host=new D(this.wt)):'998'===P.getParameter('world')&&(this.wt={onmessage:t=>{this.stream.la.onmessage(t)},postMessage:t=>{this.Ko&&this.Ko.gt&&'open'===this.Ko.gt.readyState&&this.Ko.gt.send(JSON.stringify(t))},onerror:null,onmessageerror:null,terminate:()=>{throw new Error},addEventListener:()=>{throw new Error},removeEventListener:()=>{throw new Error},dispatchEvent:()=>{throw new Error}},this.Ko=new k(this.wt))};onmessage=t=>{switch(t.data.type){case'ready':return void(this.Xo=!0);case'save':return R(t.data.value,t.data.path.split('/').pop().split('\\').pop()),void URL.revokeObjectURL(t.data.value);case'close':return void this.wt?.postMessage({type:'close',id:t.data.id})}this.host?.At===t.data.id?this.stream.la.onmessage(t.data):this.host?.postMessage(t)};ca=async()=>{if(999==+P.getParameter('world'))this.host&&await this.host.xt();else if(998==+P.getParameter('world')&&this.Ko){if(this.Ko.gt)return void console.log('You are already connected.');const t=prompt('Paste offer here, answer will be copied to clipboard');if(t)try{await this.Ko.Ct(t)}catch(t){console.error(t)}}};fa=async(t,i,s,e)=>{let h=5,r=await(this.db?.ua(t));if(r&&n.A.da(r)!==s&&(r=void 0),r)return new o(r);for(;!r;){await this.ya(e,`Requesting ${i}`);try{r=+P.getParameter('world')<998?await(0,v.pa)(`${P.It}/${t}${s}`):await(0,v.pa)(`${P.It}/${t}`)}catch(t){r=void 0;for(let t=h;t>0;t--)await this.ya(e,`Error loading - Will retry in ${t} secs.`),await(0,v.wa)(1e3);h*=2,h>60&&(h=60)}}return await(this.db?.Aa(t,r)),new o(r)};xa=async(t,i,s,e)=>{let h=await(this.db?.ua(t+'.mid'));if(h&&12345678!==i&&n.A.da(h)!==i&&(h=void 0),!h)try{h=+P.getParameter('world')<998?await(0,v.pa)(`${P.It}/${t}_${i}.mid`):await(0,v.pa)(`${P.It}/songs/${t}.mid`),s!==h.length&&(h=h.slice(0,s))}catch(t){}if(!h)return;await(this.db?.Aa(t+'.mid',h));const o=new n.A(Uint8Array.from(h)).ut,a=r.A.read(o,h,s,4);(0,B.ga)(a,this.zo,e)};Ca=()=>{if(M.A.Sa(),p.ma.fillStyle='black',p.ma.fillRect(0,0,this.width,this.height),this.va(1),this.ei){this.Gi=!1,p.ma.font='bold 16px helvetica, sans-serif',p.ma.textAlign='left',p.ma.fillStyle='yellow';let t=35;p.ma.fillText('Sorry, an error has occured whilst loading RuneScape',30,t),t+=50,p.ma.fillStyle='white',p.ma.fillText('To fix this try the following (in order):',30,t),t+=50,p.ma.font='bold 12px helvetica, sans-serif',p.ma.fillText('1: Try closing ALL open web-browser windows, and reloading',30,t),t+=30,p.ma.fillText('2: Try clearing your web-browsers cache from tools->internet options',30,t),t+=30,p.ma.fillText('3: Try using a different game-world',30,t),t+=30,p.ma.fillText('4: Try rebooting your computer',30,t),t+=30,p.ma.fillText('5: Try selecting a different version of Java from the play-game menu',30,t)}if(this.hi&&(this.Gi=!1,p.ma.font='bold 20px helvetica, sans-serif',p.ma.textAlign='left',p.ma.fillStyle='white',p.ma.fillText('Error - unable to load game!',50,50),p.ma.fillText('To play RuneScape make sure you play from',50,100),p.ma.fillText('https://2004scape.org',50,150)),this.si){this.Gi=!1,p.ma.font='bold 13px helvetica, sans-serif',p.ma.textAlign='left',p.ma.fillStyle='yellow';let t=35;p.ma.fillText('Error a copy of RuneScape already appears to be loaded',30,t),t+=50,p.ma.fillStyle='white',p.ma.fillText('To fix this try the following (in order):',30,t),t+=50,p.ma.font='bold 12px helvetica, sans-serif',p.ma.fillText('1: Try closing ALL open web-browser windows, and reloading',30,t),t+=30,p.ma.fillText('2: Try rebooting your computer, and reloading',30,t)}};Ba=t=>{if(!t.ba)return!1;for(let i=0;i<t.ba.length;i++){const s=this.Ia(t,i);if(!t.Ea)return!1;const e=t.Ea[i];if(2===t.ba[i]){if(s>=e)return!1}else if(3===t.ba[i]){if(s<=e)return!1}else if(4===t.ba[i]){if(s===e)return!1}else if(s!==e)return!1}return!0};_a=(t,i,s,e,h)=>{this.qs?.draw(t,i),this.$s?.draw(t,i+h-16),w.A.fillRect(t,i+16,16,h-32,x.A.Ta);let n=(h-32)*h/e|0;n<8&&(n=8);const r=(h-n-32)*s/(e-h)|0;w.A.fillRect(t,i+r+16,16,n,x.A.Oa),w.A.La(t,i+r+16,x.A.Ra,n),w.A.La(t+1,i+r+16,x.A.Ra,n),w.A.Da(t,i+r+16,x.A.Ra,16),w.A.Da(t,i+r+17,x.A.Ra,16),w.A.La(t+15,i+r+16,x.A.ka,n),w.A.La(t+14,i+r+17,x.A.ka,n-1),w.A.Da(t,i+r+n+15,x.A.ka,16),w.A.Da(t+1,i+r+n+14,x.A.ka,15)};Ma=(t,i)=>{let s=!1;const h=e.A.ta[t];if(!h.Ua)return!1;for(let t=0;t<h.Ua.length&&-1!==h.Ua[t];t++){const n=e.A.ta[h.Ua[t]];if(1===n.type&&(s||=this.Ma(n.id,i)),6===n.type&&(-1!==n.Pa||-1!==n.Na)){let t;if(t=this.Ba(n)?n.Na:n.Pa,-1!==t){const e=C.A.ta[t];if(n.Fa+=i,e.delay)for(;n.Fa>e.delay[n.Va];)n.Fa-=e.delay[n.Va]+1,n.Va++,n.Va>=e.Ga&&(n.Va-=e.Wa,(n.Va<0||n.Va>=e.Ga)&&(n.Va=0)),s=!0}}}return s};Ya=(t,i,s,n,r=!1)=>{if(0!==t.type||!t.Ua||t.hide&&this.gh!==t.id&&this.Ch!==t.id&&this.Sh!==t.id)return;const o=w.A.left,a=w.A.top,l=w.A.right,c=w.A.bottom;w.A.Ha(i,s,i+t.width,s+t.height);const f=t.Ua.length;for(let o=0;o<f;o++){if(!t.za||!t.Xa)continue;let a=t.za[o]+i,l=t.Xa[o]+s-n;const c=e.A.ta[t.Ua[o]];if(a+=c.x,l+=c.y,r&&w.A.Ka(a,l,c.width,c.height,x.A.Za),c.ja>0&&this.qa(c),c.type===e.A.$a)c.Ja>c.scroll-c.height&&(c.Ja=c.scroll-c.height),c.Ja<0&&(c.Ja=0),this.Ya(c,a,l,c.Ja,r),c.scroll>c.height&&this._a(a+c.width,l,c.Ja,c.scroll,c.height);else if(c.type===e.A.Qa){let t=0;for(let i=0;i<c.height;i++)for(let s=0;s<c.width;s++){if(!(c.tl&&c.il&&c.sl&&c.el))continue;let e=a+s*(c.hl+32),h=l+i*(c.nl+32);if(t<20&&(e+=c.tl[t],h+=c.il[t]),c.sl[t]>0){let i=0,s=0;const n=c.sl[t]-1;if(e>=-32&&e<=512&&h>=-32&&h<=334||0!==this.bh&&this.Bh===t){const r=A.A.rl(n,c.el[t]);if(0!==this.bh&&this.Bh===t&&this.mh===c.id?(i=this.ol-this.Ih,s=this.al-this.Eh,i<5&&i>-5&&(i=0),s<5&&s>-5&&(s=0),this._h<5&&(i=0,s=0),r.ll(128,e+i,h+s)):0!==this.Mh&&this.Uh===t&&this.Ph===c.id?r.ll(128,e,h):r.draw(e,h),33===r.cl||1!==c.el[t]){const n=c.el[t];this.Ui?.fl(e+i+1,h+10+s,this.ul(n),x.A.dl),this.Ui?.fl(e+i,h+9+s,this.ul(n),x.A.yl)}}}else if(c.pl&&t<20){const i=c.pl[t];i?.draw(e,h)}t++}}else if(c.type===e.A.wl)c.fill?w.A.fillRect(a,l,c.width,c.height,c.Al):w.A.Ka(a,l,c.width,c.height,c.Al);else if(c.type===e.A.xl){const t=c.font;let i=c.Al,s=c.text;if(this.Sh!==c.id&&this.Ch!==c.id&&this.gh!==c.id||0===c.gl||(i=c.gl),this.Ba(c)&&(i=c.Cl,c.Sl&&c.Sl.length>0&&(s=c.Sl)),c.ml===e.A.vl&&this.Fh&&(s='Please wait...',i=c.Al),!t||!s)continue;for(let e=l+t.height;s.length>0;e+=t.height){if(-1!==s.indexOf('%')){for(;;){const t=s.indexOf('%1');if(-1===t)break;s=s.substring(0,t)+this.Bl(this.Ia(c,0))+s.substring(t+2)}for(;;){const t=s.indexOf('%2');if(-1===t)break;s=s.substring(0,t)+this.Bl(this.Ia(c,1))+s.substring(t+2)}for(;;){const t=s.indexOf('%3');if(-1===t)break;s=s.substring(0,t)+this.Bl(this.Ia(c,2))+s.substring(t+2)}for(;;){const t=s.indexOf('%4');if(-1===t)break;s=s.substring(0,t)+this.Bl(this.Ia(c,3))+s.substring(t+2)}for(;;){const t=s.indexOf('%5');if(-1===t)break;s=s.substring(0,t)+this.Bl(this.Ia(c,4))+s.substring(t+2)}}const h=s.indexOf('\\n');let n;-1!==h?(n=s.substring(0,h),s=s.substring(h+2)):(n=s,s=''),c.bl?t.Il(a+(c.width/2|0),e,n,i,c.El):t._l(a,e,n,i,c.El)}}else if(c.type===e.A.Tl){let t;t=this.Ba(c)?c.Ol:c.Ll,t?.draw(a,l)}else if(c.type===e.A.Rl){const t=h.A.Dl,i=h.A.kl;h.A.Dl=a+(c.width/2|0),h.A.kl=l+(c.height/2|0);const s=h.A.sin[c.Ml]*c.zoom>>16,e=h.A.cos[c.Ml]*c.zoom>>16,n=this.Ba(c);let r;r=n?c.Na:c.Pa;let o=null;if(-1===r)o=c.Ul(-1,-1,n);else{const t=C.A.ta[r];t.frames&&t.Pl&&(o=c.Ul(t.frames[c.Va],t.Pl[c.Va],n))}o&&o.Nl(0,c.Fl,0,c.Ml,0,s,e),h.A.Dl=t,h.A.kl=i}else if(c.type===e.A.Vl){const t=c.font;if(!t||!c.sl||!c.el)continue;let i=0;for(let s=0;s<c.height;s++)for(let e=0;e<c.width;e++){if(c.sl[i]>0){const h=A.A.get(c.sl[i]-1);let n=h.name;if((h.Gl||1!==c.el[i])&&(n=n+' x'+this.Wl(c.el[i])),!n)continue;const r=a+e*(c.hl+115),o=l+s*(c.nl+12);c.bl?t.Il(r+(c.width/2|0),o,n,c.Al,c.El):t._l(r,o,n,c.Al,c.El)}i++}}}w.A.Ha(o,a,l,c)};qa=t=>{let i=t.ja;if(i>=e.A.Yl&&i<=e.A.Hl)i--,i>=this.yo?(t.text='',t.ml=0):(t.text=this.Io[i],t.ml=1);else if(i>=e.A.zl&&i<=e.A.Xl)i-=e.A.zl,i>=this.yo?(t.text='',t.ml=0):(0===this._o[i]?t.text='@red@Offline':this._o[i]===P.vt?t.text='@gre@World-'+(this._o[i]-9):t.text='@yel@World-'+(this._o[i]-9),t.ml=1);else if(i===e.A.Kl)t.scroll=15*this.yo+20,t.scroll<=t.height&&(t.scroll=t.height+1);else if(i>=e.A.Zl&&i<=e.A.jl)i-=e.A.Zl,i>=this.Me?(t.text='',t.ml=0):(t.text=S.A.ql(S.A.$l(this.Ue[i])),t.ml=1);else if(i===e.A.Jl)t.scroll=15*this.Me+20,t.scroll<=t.height&&(t.scroll=t.height+1);else if(i===e.A.Ql){if(t.Ml=150,t.Fl=256*Math.sin(this.ni/40)&2047,this.fo){this.fo=!1;const i=new y.Ps(7,null);let s=0;for(let t=0;t<7;t++){const e=this.uo[t];e>=0&&(i[s++]=m.A.ta[e].Ul())}const e=g.A.tc(i,s);for(let t=0;t<5;t++)0!==this.do[t]&&(e.ic(d.A.sc[t][0],d.A.sc[t][this.do[t]]),1===t&&e.ic(d.A.ec[0],d.A.ec[this.do[t]]));if(this.io){const i=C.A.ta[this.io.hc].frames;i&&(e.nc(),e.rc(i[0]),e.oc(64,850,-30,-50,-30,!0),t.model=e)}}}else if(i===e.A.ac)this.ae||(this.ae=t.Ll,this.le=t.Ol),this.co?t.Ll=this.le:t.Ll=this.ae;else if(i===e.A.lc)this.ae||(this.ae=t.Ll,this.le=t.Ol),this.co?t.Ll=this.ae:t.Ll=this.le;else if(i===e.A.cc)t.text=this.tn,this.ni%20<10?t.text=t.text+'|':t.text=t.text+' ';else if(i===e.A.fc)this.lo?this.sn?(t.Al=x.A.RED,t.text='Moderator option: Mute player for 48 hours: <ON>'):(t.Al=x.A.Za,t.text='Moderator option: Mute player for 48 hours: <OFF>'):t.text='';else if(i===e.A.uc||i===e.A.dc)if(0===this.hn)t.text='';else{let i;i=0===this.nn?'earlier today':1===this.nn?'yesterday':this.nn+' days ago',t.text='You last logged in '+i+' from: '+(U.A.yc?'':S.A.wc(this.hn))}else if(i===e.A.Ac)0===this.an&&(t.text='0 unread messages',t.Al=x.A.yl),1===this.an&&(t.text='1 unread message',t.Al=x.A.GREEN),this.an>1&&(t.text=this.an+' unread messages',t.Al=x.A.GREEN);else if(i===e.A.xc)if(201===this.rn)t.text='';else if(200===this.rn)t.text='You have not yet set any password recovery questions.';else{let i;i=0===this.rn?'Earlier today':1===this.rn?'Yesterday':this.rn+' days ago',t.text=i+' you changed your recovery questions'}else i===e.A.gc?201===this.rn?t.text='':200===this.rn?t.text='We strongly recommend you do so now to secure your account.':t.text='If you do not remember making this change then cancel it immediately':i===e.A.Cc&&(201===this.rn?t.text='':(this.rn,t.text="Do this from the 'account management' area on our front webpage"))};Ia=(t,i)=>{if(!t.scripts||i>=t.scripts.length)return-2;try{const s=t.scripts[i];if(!s)return-1;let h=0,n=0;for(;;){const t=s[n++];if(0===t)return h;if(1===t)h+=this.Xe[s[n++]];else if(2===t)h+=this.Ke[s[n++]];else if(3===t)h+=this.ze[s[n++]];else if(4===t){const t=e.A.ta[s[n++]],i=s[n++]+1;if(t.sl&&t.el)for(let s=0;s<t.sl.length;s++)t.sl[s]===i&&(h+=t.el[s]);else h+=0}else if(5===t)h+=this.Vh[s[n++]];else if(6===t)h+=this.Ze[this.Ke[s[n++]]-1];else if(7===t)h+=100*this.Vh[s[n++]]/46875|0;else if(8===t)h+=this.io?.Sc||0;else if(9===t)for(let t=0;t<19;t++)18===t&&(t=20),h+=this.Ke[t];else if(10===t){const t=e.A.ta[s[n++]],i=s[n++]+1;for(let s=0;s<t.sl.length;s++)if(t.sl[s]===i){h+=999999999;break}}else if(11===t)h+=this.so;else if(12===t)h+=this.no;else if(13===t){const t=this.Vh[s[n++]];h+=t&1<<s[n++]?1:0}}}catch(t){return-1}};Bl=t=>t<999999999?String(t):'*';Wl=t=>{let i=String(t);for(let t=i.length-3;t>0;t-=3)i=i.substring(0,t)+','+i.substring(t);return i.length>8?i='@gre@'+i.substring(0,i.length-8)+' million @whi@('+i+')':i.length>4&&(i='@cya@'+i.substring(0,i.length-4)+'K @whi@('+i+')'),' '+i};ul=t=>t<1e5?String(t):t<1e7?(t/1e3|0)+'K':(t/1e6|0)+'M'}},7604:(t,i,s)=>{s.d(i,{w:()=>n});var e=s(8370),h=s(8793);async function n(){await async function(){0===e.A.getParameter('world').length&&e.A.setParameter('world','1');['0','998','999'].includes(e.A.getParameter('world'))?function(){if(+e.A.getParameter('world')>=998)return void(h.K.It='data/pack/client');h.K.bt='http://localhost',h.K.It='http://localhost',h.K.portOffset=0}():await async function(t){const i={id:parseInt(e.A.getParameter('world'),10)??1,region:'United Kingdom',address:"http://pegscape.zapto.org/",portOffset:0,Lr:0,members:!0},s=new URL(i.address);h.K.vt=10+i.id-1,h.K.bt=`${s.protocol}//${s.hostname}`,h.K.It=`${s.protocol}//${s.hostname}:${s.port}`,t||(h.K.bt=h.K.bt.replace('https:','http:'));h.K.portOffset=i.portOffset,h.K.members=!0===i?.members,e.A.setParameter('world',i.id.toString(10))}(window.location.protocol.startsWith('https'))}(),function(){0===e.A.getParameter('detail').length&&e.A.setParameter('detail','high');'low'===e.A.getParameter('detail')?h.K.Jt():h.K.$t()}(),0===e.A.getParameter('method').length&&e.A.setParameter('method','0')}},8328:(t,i,s)=>{s.d(i,{Z:()=>St});var e=s(1312),h=s(5637),n=s(1302),r=s(6948),o=s(8317),a=s(8738),l=s(3764),c=s(1120),f=s(1183),u=s(8950),d=s(4583),y=s(1673),p=s(1122),w=s(1069),A=s(4474);class x{seed;constructor(t){this.seed=(0x5deece66dn^t)&(1n<<48n)-1n}mc(t){this.seed=(0x5deece66dn^t)&(1n<<48n)-1n}vc(){return this.next(32)}next(t){return this.seed=0x5deece66dn*this.seed+0xbn&(1n<<48n)-1n,Number(this.seed)>>>48-t}}var g=s(9298),C=s(643);class S extends A.A{static Bc='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!"£$%^&*()-_=+[{]};:\'@#~,<.>/?\\| ';static bc=[];static{const t=navigator.userAgent.includes('Capacitor');for(let i=0;i<256;i++){let s=S.Bc.indexOf(String.fromCharCode(i));t&&s>=63&&s--,-1===s&&(s=74),S.bc[i]=s}}Ic=[];Ec=new Int32Array(94);_c=new Int32Array(94);Tc=new Int32Array(94);Oc=new Int32Array(94);Lc=new Int32Array(95);Rc=new Int32Array(256);random=new x(BigInt(Date.now()));height=0;static Dc=(t,i)=>{const s=new w.A(t.read(i+'.dat')),e=new w.A(t.read('index.dat'));e.ft=s.ct+4;const h=e.kc;h>0&&(e.ft+=3*(h-1));const n=new S;for(let t=0;t<94;t++){n.Tc[t]=e.kc,n.Oc[t]=e.kc;const i=n.Ec[t]=e.ct,h=n._c[t]=e.ct,r=e.kc,o=i*h;if(n.Ic[t]=new Int8Array(o),0===r)for(let e=0;e<i*h;e++)n.Ic[t][e]=s.Mc;else if(1===r)for(let e=0;e<i;e++)for(let r=0;r<h;r++)n.Ic[t][e+r*i]=s.Mc;h>n.height&&(n.height=h),n.Tc[t]=1,n.Lc[t]=i+2;{let s=0;for(let e=h/7|0;e<h;e++)s+=n.Ic[t][e*i];s<=(h/7|0)&&(n.Lc[t]--,n.Tc[t]=0)}{let s=0;for(let e=h/7|0;e<h;e++)s+=n.Ic[t][i+e*i-1];s<=(h/7|0)&&n.Lc[t]--}}n.Lc[94]=n.Lc[8];for(let t=0;t<256;t++)n.Rc[t]=n.Lc[S.bc[t]];return n};fl(t,i,s,e){if(!s)return;t|=0,i|=0;const h=s.length;i-=this.height;for(let n=0;n<h;n++){const h=S.bc[s.charCodeAt(n)];94!==h&&this.Uc(this.Ic[h],t+this.Tc[h],i+this.Oc[h],this.Ec[h],this._c[h],e),t+=this.Lc[h]}}_l(t,i,s,e,h){t|=0,i|=0;const n=s.length;i-=this.height;for(let r=0;r<n;r++)if('@'===s.charAt(r)&&r+4<n&&'@'===s.charAt(r+4))e=this.Pc(s.substring(r+1,r+4)),r+=4;else{const n=S.bc[s.charCodeAt(r)];94!==n&&(h&&this.Uc(this.Ic[n],t+this.Tc[n]+1,i+this.Oc[n]+1,this.Ec[n],this._c[n],g.A.dl),this.Uc(this.Ic[n],t+this.Tc[n],i+this.Oc[n],this.Ec[n],this._c[n],e)),t+=this.Lc[n]}}Nc(t){if(!t)return 0;const i=t.length;let s=0;for(let e=0;e<i;e++)'@'===t.charAt(e)&&e+4<i&&'@'===t.charAt(e+4)?e+=4:s+=this.Rc[t.charCodeAt(e)];return s}Il(t,i,s,e,h){t|=0,i|=0,this._l(t-(this.Nc(s)/2|0),i,s,e,h)}Fc(t,i,s,e){s&&(t|=0,i|=0,this.fl(t-(this.Nc(s)/2|0),i,s,e))}Vc(t,i,s,e,h,n){t|=0,i|=0,this.random.mc(BigInt(n));const r=192+(31&this.random.vc()),o=i-this.height;for(let i=0;i<s.length;i++)if('@'===s.charAt(i)&&i+4<s.length&&'@'===s.charAt(i+4))e=this.Pc(s.substring(i+1,i+4)),i+=4;else{const n=S.bc[s.charCodeAt(i)];94!==n&&(C.A.Gc?(h&&this.Uc(this.Ic[n],t+this.Tc[n]+1,o+this.Oc[n]+1,this.Ec[n],this._c[n],g.A.dl),this.Uc(this.Ic[n],t+this.Tc[n],o+this.Oc[n],this.Ec[n],this._c[n],e)):(h&&this.Wc(t+this.Tc[n]+1,o+this.Oc[n]+1,this.Ec[n],this._c[n],g.A.dl,192,this.Ic[n]),this.Wc(t+this.Tc[n],o+this.Oc[n],this.Ec[n],this._c[n],e,r,this.Ic[n]))),t+=this.Lc[n],3&this.random.vc()||t++}}Yc(t,i,s,e,h=!0){t|=0,i|=0,h&&this.fl(t-this.Nc(s)+1,i+1,s,g.A.dl),this.fl(t-this.Nc(s),i,s,e)}Hc(t,i,s,e,h){if(!s)return;t|=0,i|=0,t-=this.Nc(s)/2|0;const n=i-this.height;for(let i=0;i<s.length;i++){const r=S.bc[s.charCodeAt(i)];94!=r&&this.Uc(this.Ic[r],t+this.Tc[r],n+this.Oc[r]+(5*Math.sin(i/2+h/5)|0),this.Ec[r],this._c[r],e),t+=this.Lc[r]}}Uc(t,i,s,e,h,n){e|=0,h|=0;let r=(i|=0)+(s|=0)*u.A.zc,o=u.A.zc-e,a=0,l=0;if(s<u.A.top){const t=u.A.top-s;h-=t,s=u.A.top,l+=t*e,r+=t*u.A.zc}if(s+h>=u.A.bottom&&(h-=s+h+1-u.A.bottom),i<u.A.left){const t=u.A.left-i;e-=t,i=u.A.left,l+=t,r+=t,a+=t,o+=t}if(i+e>=u.A.right){const t=i+e+1-u.A.right;e-=t,a+=t,o+=t}e>0&&h>0&&this.Xc(e,h,t,l,a,u.A.Kc,r,o,n)}Wc(t,i,s,e,h,n,r){s|=0,e|=0;let o=(t|=0)+(i|=0)*u.A.zc,a=u.A.zc-s,l=0,c=0;if(i<u.A.top){const t=u.A.top-i;e-=t,i=u.A.top,c+=t*s,o+=t*u.A.zc}if(i+e>=u.A.bottom&&(e-=i+e+1-u.A.bottom),t<u.A.left){const i=u.A.left-t;s-=i,t=u.A.left,c+=i,o+=i,l+=i,a+=i}if(t+s>=u.A.right){const i=t+s+1-u.A.right;s-=i,l+=i,a+=i}s>0&&e>0&&this.Zc(s,e,u.A.Kc,o,a,r,c,l,h,n)}Xc(t,i,s,e,h,n,r,o,a){const l=-((t|=0)>>2);t=-(3&t);for(let c=-(i|=0);c<0;c++){for(let t=l;t<0;t++)0===s[e++]?r++:n[r++]=a,0===s[e++]?r++:n[r++]=a,0===s[e++]?r++:n[r++]=a,0===s[e++]?r++:n[r++]=a;for(let i=t;i<0;i++)0===s[e++]?r++:n[r++]=a;r+=o,e+=h}}Zc(t,i,s,e,h,n,r,o,a,l){t|=0;const c=((16711935&a)*l&4278255360)+((65280&a)*l&16711680)>>8,f=256-l;for(let a=-(i|=0);a<0;a++){for(let i=-t;i<0;i++)if(0===n[r++])e++;else{const t=s[e];s[e++]=(((16711935&t)*f&4278255360)+((65280&t)*f&16711680)>>8)+c}e+=h,r+=o}}Pc(t){return'red'===t?g.A.RED:'gre'===t?g.A.GREEN:'blu'===t?g.A.BLUE:'yel'===t?g.A.yl:'cya'===t?g.A.jc:'mag'===t?g.A.qc:'whi'===t?g.A.Za:'bla'===t?g.A.dl:'lre'===t?g.A.$c:'dre'===t?g.A.Jc:'dbl'===t?g.A.Qc:'or1'===t?g.A.tf:'or2'===t?g.A.if:'or3'===t?g.A.sf:'gr1'===t?g.A.ef:'gr2'===t?g.A.hf:'gr3'===t?g.A.nf:g.A.dl}split(t,i){if(0===t.length)return[t];const s=[];for(;t.length>0;){if(this.Nc(t)<=i&&-1===t.indexOf('|')){s.push(t);break}let e=t.length;for(let s=0;s<t.length;s++)if(' '===t[s]){if(this.Nc(t.substring(0,s))>i)break;e=s}else if('|'===t[s]){e=s;break}s.push(t.substring(0,e)),t=t.substring(e+1)}return s}}var m=s(8665),v=s(6666),B=s(1982),b=s(9234);class I{rf;af;lf;closed=!1;cf=!1;static ff=async t=>await new Promise(((i,s)=>{const e=t.startsWith('https')?'wss':'ws',h=t.substring(t.indexOf('//')+2),n=new WebSocket(`${e}://${h}`,'binary');n.addEventListener('open',(()=>{console.log('connection open!'),i(n)})),n.addEventListener('error',(()=>{console.log('connection error!'),s(n)}))}));constructor(t){t.onclose=this.onclose,t.onerror=this.onerror,this.af=new T(t,5e3),this.lf=new E(t,5e3),this.rf=t}get host(){return this.rf.url.split('/')[2]}get port(){return parseInt(this.rf.url.split(':')[2],10)}get available(){return this.closed?0:this.af.available}write(t,i){this.lf.write(t,i)}async read(){return this.closed?0:this.af.uf()??await this.af.df()}async yf(t,i,s){if(!this.closed)for(;s>0;){const e=this.af.pf(t,i,s)??await this.af.wf(t,i,s);if(e.length<=0)throw new Error('EOF');i+=e.length,s-=e.length}}close(){this.closed=!0,this.rf.close(),this.af.close(),this.lf.close(),console.log('connection close!'),this.cf&&console.log('connection error!')}onclose=t=>{this.closed||this.close()};onerror=t=>{this.closed||(this.cf=!0,this.close())}}class E{rf;Af;closed=!1;cf=!1;constructor(t,i){this.rf=t,this.Af=i}write(t,i){if(!this.closed){if(this.cf)throw this.cf=!1,new Error('Error in writer thread');if(i>this.Af||t.length>this.Af)throw new Error('buffer overflow');try{this.rf.send(t.subarray(0,i))}catch(t){this.cf=!0}}}close(){this.closed=!0}}class _ extends B.A{xf;position;constructor(t){super(),this.xf=t,this.position=0}get available(){return this.xf.length-this.position}get read(){return this.xf[this.position++]}get gf(){return this.xf.length}}class T{Af;queue=new v.A;event=null;Cf=null;total=0;closed=!1;constructor(t,i){this.Af=i,t.binaryType='arraybuffer',t.onmessage=this.onmessage}get available(){return this.total}onmessage=t=>{if(this.closed)throw new Error('WebSocketReader is closed!');const i=new _(new Uint8Array(t.data));if(this.event?this.queue.Sf(i):this.event=i,this.total+=i.gf,this.Cf&&(this.Cf(this.event),this.Cf=null,this.total>this.Af))throw new Error('buffer overflow')};mf(){return this.event&&this.event.available>0?this.event.read:null}async vf(t){for(this.event=this.queue.Bf();this.total<t;)await Promise.race([new Promise((t=>this.Cf=t)),(0,b.wa)(2e3).then((()=>{if(this.closed)throw new Error('WebSocketReader closed while reading.')}))]);return this.event?this.event.read:this.vf(t)}pf(t,i,s){if(this.closed)throw new Error('WebSocketReader is closed!');if(!(this.event&&this.event.available>=s))return null;for(;s>0;){const e=this.mf();if(null===e)throw new Error('EOF - tried to read a fast byte when there was not enough immediate bytes.');t[i++]=e,this.total--,s--}return t}async wf(t,i,s){if(this.closed)throw new Error('WebSocketReader is closed!');for(;s>0;)t[i++]=this.mf()??await this.vf(s),this.total--,s--;return t}uf(){if(this.closed)throw new Error('WebSocketReader is closed!');const t=this.mf();return null===t?null:(this.total--,t)}async df(){if(this.closed)throw new Error('WebSocketReader is closed!');const t=await this.vf(1);return this.total--,t}close(){this.closed=!0,this.Cf=null,this.total=0,this.event=null,this.queue.clear()}}class O{static bf=[95,218,67,50,253,222,194,60,101,128,8,251,92,111,24,33,223,66,232,59,227,113,153,105,126,98,167,102,177,238,62,190,147,23,150,151,156,144,193,155,81,0,198,22,137,210,179,16,168,170,32,181,248,141,58,87,208,106,180,191,221,241,40,176,196,154,65,145,230,78,30,161,188,41,14,129,18,199,47,247,225,34,51,10,159,75,12,56,61,31,39,91,46,242,134,5,122,123,209,228,104,195,21,3,11,44,107,172,6,186,110,215,205,103,27,185,124,77,252,117,86,115,127,207,52,79,43,97,219,116,169,7,118,162,108,36,20,233,88,135,80,19,42,237,57,152,71,9,250,17,4,119,234,130,26,200,189,163,254,245,197,171,220,235,140,244,184,94,211,231,99,246,121,212,112,204,63,148,83,178,1,255,131,13,183,142,236,45,55,35,243,136,37,85,100,160,38,224,146,174,82,48,109,132,125,90,143,138,240,173,165,164,192,175,29,74,28,114,213,73,64,206,76,139,96,2,229,15,93,25,239,202,49,70,214,201,72,203,68,89,69,157,216,217,249,120,226,84,149,187,54,53,158,166,182,133,0];static If=[0,-2,4,6,-1,0,0,2,0,0,0,0,5,4,2,2,0,0,0,0,2,-2,2,14,0,6,3,0,4,0,0,0,3,0,0,0,0,0,0,0,0,-1,4,2,6,0,6,0,0,3,7,0,0,0,-1,0,0,0,0,4,0,0,0,0,0,0,0,0,1,15,0,0,0,0,6,0,2,0,0,0,2,0,0,0,1,0,0,4,0,0,0,0,0,0,0,0,0,0,-2,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,-2,0,0,2,0,0,0,2,9,0,0,0,0,0,4,0,0,0,3,7,9,0,0,0,0,0,0,0,0,0,-2,0,0,0,0,3,2,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,-2,2,0,0,0,0,0,6,0,0,0,2,0,2,0,0,0,-2,0,0,4,0,0,0,0,6,0,0,-2,-2,0,0,0,0,0,0,-2,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,-2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0]}class L{count=0;Ef=new Int32Array(256);_f=new Int32Array(256);a=0;b=0;c=0;constructor(t){for(let i=0;i<t.length;i++)this.Ef[i]=t[i];this.init()}get vc(){return 0==this.count--&&(this.Tf(),this.count=255),this.Ef[this.count]}init(){let t=2654435769,i=2654435769,s=2654435769,e=2654435769,h=2654435769,n=2654435769,r=2654435769,o=2654435769;for(let a=0;a<4;a++)t^=i<<11,e+=t,i+=s,i^=s>>>2,h+=i,s+=e,s^=e<<8,n+=s,e+=h,e^=h>>>16,r+=e,h+=n,h^=n<<10,o+=h,n+=r,n^=r>>>4,t+=n,r+=o,r^=o<<8,i+=r,o+=t,o^=t>>>9,s+=o,t+=i;for(let a=0;a<256;a+=8)t+=this.Ef[a],i+=this.Ef[a+1],s+=this.Ef[a+2],e+=this.Ef[a+3],h+=this.Ef[a+4],n+=this.Ef[a+5],r+=this.Ef[a+6],o+=this.Ef[a+7],t^=i<<11,e+=t,i+=s,i^=s>>>2,h+=i,s+=e,s^=e<<8,n+=s,e+=h,e^=h>>>16,r+=e,h+=n,h^=n<<10,o+=h,n+=r,n^=r>>>4,t+=n,r+=o,r^=o<<8,i+=r,o+=t,o^=t>>>9,s+=o,t+=i,this._f[a]=t,this._f[a+1]=i,this._f[a+2]=s,this._f[a+3]=e,this._f[a+4]=h,this._f[a+5]=n,this._f[a+6]=r,this._f[a+7]=o;for(let a=0;a<256;a+=8)t+=this._f[a],i+=this._f[a+1],s+=this._f[a+2],e+=this._f[a+3],h+=this._f[a+4],n+=this._f[a+5],r+=this._f[a+6],o+=this._f[a+7],t^=i<<11,e+=t,i+=s,i^=s>>>2,h+=i,s+=e,s^=e<<8,n+=s,e+=h,e^=h>>>16,r+=e,h+=n,h^=n<<10,o+=h,n+=r,n^=r>>>4,t+=n,r+=o,r^=o<<8,i+=r,o+=t,o^=t>>>9,s+=o,t+=i,this._f[a]=t,this._f[a+1]=i,this._f[a+2]=s,this._f[a+3]=e,this._f[a+4]=h,this._f[a+5]=n,this._f[a+6]=r,this._f[a+7]=o;this.Tf(),this.count=256}Tf(){this.c++,this.b+=this.c;for(let t=0;t<256;t++){const i=this._f[t],s=3&t;let e;0===s?this.a^=this.a<<13:1===s?this.a^=this.a>>>6:2===s?this.a^=this.a<<2:3===s&&(this.a^=this.a>>>16),this.a+=this._f[t+128&255],this._f[t]=e=this._f[i>>>2&255]+this.a+this.b,this.Ef[t]=this.b=this._f[e>>>8>>>2&255]+i}}}class R{db;constructor(t){t.onerror=this.onerror,t.onclose=this.onclose,this.db=t}static openDatabase=async()=>await new Promise(((t,i)=>{const s=indexedDB.open('lostcity',1);s.onsuccess=i=>{const s=i.target;console.log('database success!'),t(s.result)},s.onupgradeneeded=t=>{t.target.result.createObjectStore('cache')},s.onerror=t=>{const s=t.target;console.error('database error!: ',s.error),i(s.result)}}));ua=async t=>await new Promise((i=>{const s=this.db.transaction('cache','readonly').objectStore('cache').get(t);s.onsuccess=()=>{i(s.result)},s.onerror=t=>{i(void 0)}}));Aa=async(t,i)=>await new Promise(((s,e)=>{const h=this.db.transaction('cache','readwrite').objectStore('cache').put(i,t);h.onsuccess=()=>{s()},h.onerror=t=>{e()}}));onclose=t=>{console.log('database close!')};onerror=t=>{console.log('database error!')};tt=t=>{const i=t.trim();let s=0;for(let t=0;t<i.length&&t<12;t++){const e=i.charAt(t);s*=37,e>='A'&&e<='Z'?s+=e.charCodeAt(0)+1-65:e>='a'&&e<='z'?s+=e.charCodeAt(0)+1-97:e>='0'&&e<='9'&&(s+=e.charCodeAt(0)+27-48)}return s}}class D{static Of=14;static Lf=28;static Rf=129;static Df=167;static kf=168;static Mf=195;static Uf=2;static Pf=26;static Nf=46;static Ff=84;static Vf=87;static Gf=103;static Wf=146;static Yf=197;static Hf=201;static zf=204;static Xf=209;static Kf=126;static Zf=185;static jf=15;static qf=98;static $f=213;static Jf=74;static Qf=13;static tu=3;static iu=239;static su=1;static eu=184;static hu=133;static nu=226;static ru=4;static ou=21;static au=32;static lu=41;static cu=152;static fu=19;static uu=22;static du=25;static yu=43;static pu=44;static wu=68;static Au=136;static xu=139;static gu=140;static Cu=142;static Su=243;static mu=254;static vu=20;static Bu=80;static bu=132;static Iu=220;static Eu=237;static _u=150;static Tu=175;static Ou=193;static Lu=12;static Ru=54;static Du=212;static ku=7;static Mu=135;static Uu=162;static Pu=23;static Nu=42;static Fu=49;static Vu=50;static Gu=59;static Wu=69;static Yu=76;static Hu=151;static zu=191;static Xu=223}class k{static Ku=150;static Zu=108;static ju=70;static qu=81;static $u=189;static Ju=7;static Qu=88;static td=30;static sd=176;static ed=220;static hd=66;static nd=17;static rd=2;static od=238;static ad=233;static ld=146;static fd=215;static ud=236;static dd=85;static yd=219;static pd=140;static wd=40;static Ad=200;static xd=178;static gd=247;static Cd=138;static Sd=239;static md=194;static vd=8;static Bd=27;static bd=113;static Id=100;static Ed=134;static _d=202;static Td=245;static Od=172;static Ld=96;static Rd=97;static Dd=116;static kd=9;static Md=75;static Ud=164;static Pd=53;static Nd=185;static Fd=206;static Vd=177;static Gd=248;static Wd=195;static Yd=71;static Hd=133;static zd=157;static Xd=211;static Kd=48;static Zd=130;static jd=31;static qd=59;static $d=212;static Jd=38;static Qd=6;static ty=155;static iy=235;static sy=231;static ey=237;static hy=175;static ny=93;static oy=190;static ly=165;static uy=159;static yy=171;static py=79;static wy=52;static Ay=244;static lu=148;static xy=11;static gy=118;static Cy=4;static Sy=158;static my=181}class M{static vy=new Uint16Array(['d','o','t'].join('').split('').map((t=>t.charCodeAt(0))));static By=new Uint16Array(['(','a',')'].join('').split('').map((t=>t.charCodeAt(0))));static by=new Uint16Array(['s','l','a','s','h'].join('').split('').map((t=>t.charCodeAt(0))));static Iy=['cook',"cook's",'cooks','seeks','sheet'];static Ey=[];static _y=[];static Ty=[];static Oy=[];static Ly=[];static Ry=[];static Dy=t=>{const i=new w.A(t.read('fragmentsenc.txt')),s=new w.A(t.read('badenc.txt')),e=new w.A(t.read('domainenc.txt')),h=new w.A(t.read('tldlist.txt'));this.read(s,e,i,h)};static filter=t=>{const i=[...t];this.format(i);const s=i.join('').trim(),e=s.toLowerCase(),h=[...e];this.ky(h),this.My(h),this.Uy(h),this.Py(h);for(let t=0;t<this.Iy.length;t++){let i=-1;for(;-1!==(i=e.indexOf(this.Iy[t],i+1));){const s=[...this.Iy[t]];for(let t=0;t<s.length;t++)h[t+i]=s[t]}}return this.Ny(h,[...s]),this.Fy(h),h.join('').trim()};static read=(t,i,s,e)=>{this.Vy(t),this.Gy(i),this.Wy(s),this.Yy(e)};static Yy=t=>{const i=t.ut;for(let s=0;s<i;s++)this._y[s]=t.kc,this.Ey[s]=new Uint16Array(t.kc).map((()=>t.kc))};static Vy=t=>{const i=t.ut;for(let s=0;s<i;s++){this.Ty[s]=new Uint16Array(t.kc).map((()=>t.kc));const i=new Array(t.kc).fill([]).map((()=>[t.Mc,t.Mc]));i.length>0&&(this.Oy[s]=i)}};static Gy=t=>{const i=t.ut;for(let s=0;s<i;s++)this.Ly[s]=new Uint16Array(t.kc).map((()=>t.kc))};static Wy=t=>{const i=t.ut;for(let s=0;s<i;s++)this.Ry[s]=t.ct};static ky=t=>{const i=[...t],s=[...t];this.Hy(null,i,this.vy),this.Hy(null,s,this.by);for(let e=0;e<this.Ey.length;e++)this.zy(s,this._y[e],t,this.Ey[e],i)};static My=t=>{for(let i=0;i<2;i++)for(let i=this.Ty.length-1;i>=0;i--)this.Hy(this.Oy[i],t,this.Ty[i])};static Uy=t=>{const i=[...t],s=[...t];this.Hy(null,i,this.By),this.Hy(null,s,this.vy);for(let e=this.Ly.length-1;e>=0;e--)this.Xy(s,i,this.Ly[e],t)};static Py=t=>{for(let i=0;i<t.length;){const s=this.Ky(t,i);if(-1===s)return;let e=!1;for(let h=i;h>=0&&h<s&&!e;h++)this.Zy(t[h])||this.jy(t[h])||(e=!0);let h=0;e&&(h=0),0===h&&(h=1,i=s);let n=0;for(let e=s;e<t.length&&e<i;e++)n=10*n+t[e].charCodeAt(0)-48;n<=255&&i-s<=8?h++:h=0,4===h&&(this.qy(s,i,t),h=0),i=this.$y(i,t)}};static Jy=t=>{if(this.Qy(t))return!0;const i=this.tp(t),s=this.Ry,e=s.length;if(i===s[0]||i===s[e-1])return!0;let h=0,n=e-1;for(;h<=n;){const t=(h+n)/2|0;if(i===s[t])return!0;i<s[t]?n=t-1:h=t+1}return!1};static tp=t=>{if(t.length>6)return 0;let i=0;for(let s=0;s<t.length;s++){const e=t[t.length-s-1];if(this.ip(e))i=38*i+e.charCodeAt(0)+1-'a'.charCodeAt(0);else if("'"===e)i=38*i+27;else if(this.sp(e))i=38*i+e.charCodeAt(0)+28-'0'.charCodeAt(0);else if('\0'!==e)return 0}return i};static Ky=(t,i)=>{for(let s=i;s<t.length&&s>=0;s++)if(this.sp(t[s]))return s;return-1};static $y=(t,i)=>{for(let s=t;s<i.length&&s>=0;s++)if(!this.sp(i[s]))return s;return i.length};static ep=(t,i,s)=>i===s||'o'===i&&'0'===s?1:'o'===i&&'('===s&&')'===t?2:'c'!==i||'('!==s&&'<'!==s&&'['!==s?'e'===i&&'€'===s||'s'===i&&'$'===s||'l'===i&&'i'===s?1:0:1;static Xy=(t,i,s,e)=>{const h=s.length,n=e.length;for(let r=0;r<=n-h;r++){const{hp:h,np:n}=this.rp(r,s,e);if(!h)continue;const o=this.op(r,e,3,i,['@']),a=this.ap(n-1,e,3,t,['.',',']);(o>2||a>2)&&this.qy(r,n,e)}};static rp=(t,i,s)=>{const e=i.length;let h=t,n=0;for(;h<s.length&&n<e;){const r=s[h],o=h+1<s.length?s[h+1]:'\0',a=this.ep(o,String.fromCharCode(i[n]),r);if(a>0)h+=a,n++;else{if(0===n)break;const s=this.ep(o,String.fromCharCode(i[n-1]),r);if(s>0)h+=s,1===n&&t++;else{if(n>=e||!this.Zy(r))break;h++}}}return{hp:n>=e,np:h}};static Hy=(t,i,s)=>{if(!(s.length>i.length))for(let e=0;e<=i.length-s.length;e++){let h=e;const{np:n,lp:r,cp:o,fp:a,up:l}=this.dp(i,s,h);h=n;let c=i[h],f=h+1<i.length?i[h+1]:'\0';if(!(r>=s.length)||a&&l)continue;let u,d=!0;if(o){let t=!1,s=!1;if((e-1<0||this.Zy(i[e-1])&&"'"!==i[e-1])&&(t=!0),(h>=i.length||this.Zy(i[h])&&"'"!==i[h])&&(s=!0),!t||!s){let s=!1;for(u=e-2,t&&(u=e);!s&&u<h;){if(u>=0&&(!this.Zy(i[u])||"'"===i[u])){const t=[];let e;for(e=0;e<3&&u+e<i.length&&(!this.Zy(i[u+e])||"'"===i[u+e]);e++)t[e]=i[u+e];let h=!0;0===e&&(h=!1),e<3&&u-1>=0&&(!this.Zy(i[u-1])||"'"===i[u-1])&&(h=!1),h&&!this.Jy(t)&&(s=!0)}u++}s||(d=!1)}}else{c=' ',e-1>=0&&(c=i[e-1]),f=' ',h<i.length&&(f=i[h]);const s=this.yp(c),n=this.yp(f);t&&this.pp(s,t,n)&&(d=!1)}if(!d)continue;let y=0,p=0;for(let t=e;t<h;t++)this.sp(i[t])?y++:this.wp(i[t])&&p++;y<=p&&this.qy(e,h,i)}};static dp=(t,i,s)=>{let e=s,h=0,n=0,r=!1,o=!1,a=!1;for(;e<t.length&&(!o||!a)&&!(e>=t.length||o&&a);){const l=t[e],c=e+1<t.length?t[e+1]:'\0';let f;if(h<i.length&&(f=this.Ap(c,String.fromCharCode(i[h]),l))>0)1===f&&this.sp(l)&&(o=!0),2===f&&(this.sp(l)||this.sp(c))&&(o=!0),e+=f,h++;else{if(0===h)break;let t;if((t=this.Ap(c,String.fromCharCode(i[h-1]),l))>0)e+=t;else{if(h>=i.length||!this.jy(l))break;if(this.Zy(l)&&"'"!==l&&(r=!0),this.sp(l)&&(a=!0),e++,n++,(100*n/(e-s)|0)>90)break}}}return{np:e,lp:h,cp:r,fp:o,up:a}};static Ap=(t,i,s)=>{if(i===s)return 1;if(i>='a'&&i<='m'){if('a'===i)return'4'!==s&&'@'!==s&&'^'!==s?'/'===s&&'\\'===t?2:0:1;if('b'===i)return'6'!==s&&'8'!==s?'1'===s&&'3'===t?2:0:1;if('c'===i)return'('!==s&&'<'!==s&&'{'!==s&&'['!==s?0:1;if('d'===i)return'['===s&&')'===t?2:0;if('e'===i)return'3'!==s&&'€'!==s?0:1;if('f'===i)return'p'===s&&'h'===t?2:'£'===s?1:0;if('g'===i)return'9'!==s&&'6'!==s?0:1;if('h'===i)return'#'===s?1:0;if('i'===i)return'y'!==s&&'l'!==s&&'j'!==s&&'1'!==s&&'!'!==s&&':'!==s&&';'!==s&&'|'!==s?0:1;if('j'===i)return 0;if('k'===i)return 0;if('l'===i)return'1'!==s&&'|'!==s&&'i'!==s?0:1;if('m'===i)return 0}if(i>='n'&&i<='z'){if('n'===i)return 0;if('o'===i)return'0'!==s&&'*'!==s?'('===s&&')'===t||'['===s&&']'===t||'{'===s&&'}'===t||'<'===s&&'>'===t?2:0:1;if('p'===i)return 0;if('q'===i)return 0;if('r'===i)return 0;if('s'===i)return'5'!==s&&'z'!==s&&'$'!==s&&'2'!==s?0:1;if('t'===i)return'7'!==s&&'+'!==s?0:1;if('u'===i)return'v'===s?1:'\\'===s&&'/'===t||'\\'===s&&'|'===t||'|'===s&&'/'===t?2:0;if('v'===i)return'\\'===s&&'/'===t||'\\'===s&&'|'===t||'|'===s&&'/'===t?2:0;if('w'===i)return'v'===s&&'v'===t?2:0;if('x'===i)return')'===s&&'('===t||'}'===s&&'{'===t||']'===s&&'['===t||'>'===s&&'<'===t?2:0;if('y'===i)return 0;if('z'===i)return 0}return i>='0'&&i<='9'?'0'===i?'o'===s||'O'===s?1:'('===s&&')'===t||'{'===s&&'}'===t||'['===s&&']'===t?2:0:'1'===i&&'l'===s?1:0:','===i?'.'===s?1:0:'.'===i?','===s?1:0:'!'===i&&'i'===s?1:0};static pp=(t,i,s)=>{let e=0,h=i.length-1;for(;e<=h;){const n=(e+h)/2|0;if(i[n][0]===t&&i[n][1]===s)return!0;t<i[n][0]||t===i[n][0]&&s<i[n][1]?h=n-1:e=n+1}return!1};static yp=t=>this.ip(t)?t.charCodeAt(0)+1-'a'.charCodeAt(0):"'"===t?28:this.sp(t)?t.charCodeAt(0)+29-'0'.charCodeAt(0):27;static zy=(t,i,s,e,h)=>{if(!(e.length>s.length))for(let n=0;n<=s.length-e.length;n++){const{np:r,xp:o}=this.gp(s,e,n);if(o<e.length)continue;let a=!1;const l=this.op(n,s,3,h,[',','.']),c=this.ap(r-1,s,5,t,['\\','/']);if(1===i&&l>0&&c>0&&(a=!0),2===i&&(l>2&&c>0||l>0&&c>2)&&(a=!0),3===i&&l>0&&c>2&&(a=!0),!a)continue;let f,u=n,d=r-1,y=!1;if(l>2){if(4===l)for(y=!1,f=n-1;f>=0;f--)if(y){if('*'!==h[f])break;u=f}else'*'===h[f]&&(u=f,y=!0);for(y=!1,f=u-1;f>=0;f--)if(y){if(this.Zy(s[f]))break;u=f}else this.Zy(s[f])||(y=!0,u=f)}if(c>2){if(4===c)for(y=!1,f=d+1;f<s.length;f++)if(y){if('*'!==t[f])break;d=f}else'*'===t[f]&&(d=f,y=!0);for(y=!1,f=d+1;f<s.length;f++)if(y){if(this.Zy(s[f]))break;d=f}else this.Zy(s[f])||(y=!0,d=f)}this.qy(u,d+1,s)}};static gp=(t,i,s)=>{let e=0;for(;s<t.length&&e<i.length;){const h=t[s],n=s+1<t.length?t[s+1]:'\0';let r;if((r=this.ep(n,String.fromCharCode(i[e]),h))>0)s+=r,e++;else{if(0===e)break;let t;if((t=this.ep(n,String.fromCharCode(i[e-1]),h))>0)s+=t;else{if(!this.Zy(h))break;s++}}}return{np:s,xp:e}};static Zy=t=>!this.wp(t)&&!this.sp(t);static jy=t=>!this.ip(t)||('v'===t||'x'===t||'j'===t||'q'===t||'z'===t);static wp=t=>this.ip(t)||this.Cp(t);static sp=t=>t>='0'&&t<='9';static ip=t=>t>='a'&&t<='z';static Cp=t=>t>='A'&&t<='Z';static Qy=t=>{for(let i=0;i<t.length;i++)if(!this.sp(t[i])&&'\0'!==t[i])return!1;return!0};static qy=(t,i,s)=>{for(let e=t;e<i;e++)s[e]='*'};static Sp=(t,i)=>{let s=0;for(let e=i-1;e>=0&&this.Zy(t[e]);e--)'*'===t[e]&&s++;return s};static mp=(t,i)=>{let s=0;for(let e=i+1;e<t.length&&this.Zy(t[e]);e++)'*'===t[e]&&s++;return s};static vp=(t,i,s,e,h)=>(h?this.Sp(i,s):this.mp(i,s))>=e?4:this.Zy(h?t[s-1]:t[s+1])?1:0;static op=(t,i,s,e,h)=>{if(0===t)return 2;for(let s=t-1;s>=0&&this.Zy(i[s]);s--)if(h.includes(i[s]))return 3;return this.vp(i,e,t,s,!0)};static ap=(t,i,s,e,h)=>{if(t+1===i.length)return 2;for(let s=t+1;s<i.length&&this.Zy(i[s]);s++)if(h.includes(i[s]))return 3;return this.vp(i,e,t,s,!1)};static format=t=>{let i=0;for(let s=0;s<t.length;s++)this.Bp(t[s])?t[i]=t[s]:t[i]=' ',0!==i&&' '===t[i]&&' '===t[i-1]||i++;for(let s=i;s<t.length;s++)t[s]=' '};static Bp=t=>t>=' '&&t<=''||' '===t||'\n'===t||'\t'===t||'£'===t||'€'===t;static Ny=(t,i)=>{for(let s=0;s<i.length;s++)'*'!==t[s]&&this.Cp(i[s])&&(t[s]=i[s])};static Fy=t=>{let i=!0;for(let s=0;s<t.length;s++){const e=t[s];this.wp(e)?i?this.ip(e)&&(i=!1):this.Cp(e)&&(t[s]=String.fromCharCode(e.charCodeAt(0)+'a'.charCodeAt(0)-65)):i=!0}}}class U{static bp=[' ','e','t','a','o','i','h','n','s','r','d','l','u','m','w','c','y','f','g','p','b','v','k','x','j','q','z','0','1','2','3','4','5','6','7','8','9',' ','!','?','.',',',':',';','(',')','-','&','*','\\','\'','@','#','+','=','£','$','%','"','[',']'];static Ip=[];static Dy=(t,i)=>{let s,e=0,h=-1;for(let n=0;n<i&&e<100;n++){const i=t.kc;s=i>>4&15,-1!==h?(this.Ip[e++]=this.bp[(h<<4)+s-195],h=-1):s<13?this.Ip[e++]=this.bp[s]:h=s,s=15&i,-1!==h?(this.Ip[e++]=this.bp[(h<<4)+s-195],h=-1):s<13?this.Ip[e++]=this.bp[s]:h=s}let n=!0;for(let t=0;t<e;t++){const i=this.Ip[t];n&&i>='a'&&i<='z'&&(this.Ip[t]=i.toUpperCase(),n=!1),'.'!==i&&'!'!==i||(n=!0)}return this.Ip.slice(0,e).join('')};static Ep=(t,i)=>{i.length>80&&(i=i.substring(0,80)),i=i.toLowerCase();let s=-1;for(let e=0;e<i.length;e++){const h=i.charAt(e);let n=0;for(let t=0;t<this.bp.length;t++)if(h===this.bp[t]){n=t;break}n>12&&(n+=195),-1===s?n<13?s=n:t.p1(n):n<13?(t.p1((s<<4)+n),s=-1):(t.p1((s<<4)+(n>>4)),s=15&n)}-1!==s&&t.p1(s<<4)}}class P{start=0;end=0;form=0;length=0;_p=null;Tp=null;threshold=0;position=0;delta=0;amplitude=0;Op=0;read(t){this.form=t.kc,this.start=t.ut,this.end=t.ut,this.length=t.kc,this._p=new Int32Array(this.length),this.Tp=new Int32Array(this.length);for(let i=0;i<this.length;i++)this._p[i]=t.ct,this.Tp[i]=t.ct}reset(){this.threshold=0,this.position=0,this.delta=0,this.amplitude=0,this.Op=0}evaluate(t){return this.Op>=this.threshold&&this.Tp&&this._p&&(this.amplitude=this.Tp[this.position++]<<15,this.position>=this.length&&(this.position=this.length-1),this.threshold=this._p[this.position]/65536*t|0,this.threshold>this.Op&&(this.delta=((this.Tp[this.position]<<15)-this.amplitude)/(this.threshold-this.Op)|0)),this.amplitude+=this.delta,this.Op++,this.amplitude-this.delta>>15}}class N{static buffer=null;static Lp=null;static sin=null;static Rp=new Int32Array(5);static Dp=new Int32Array(5);static kp=new Int32Array(5);static Mp=new Int32Array(5);static Up=new Int32Array(5);Pp=null;Np=null;Fp=null;Vp=null;Gp=null;Wp=null;release=null;attack=null;Yp=new Int32Array(5);Hp=new Int32Array(5);zp=new Int32Array(5);start=0;length=500;Xp=100;Kp=0;static init=()=>{this.Lp=new Int32Array(32768);for(let t=0;t<32768;t++)Math.random()>.5?this.Lp[t]=1:this.Lp[t]=-1;this.sin=new Int32Array(32768);for(let t=0;t<32768;t++)this.sin[t]=16384*Math.sin(t/5215.1903)|0;this.buffer=new Int32Array(220500)};Zp(t,i){for(let i=0;i<t;i++)N.buffer[i]=0;if(i<10)return N.buffer;const s=t/i|0;this.Pp?.reset(),this.Np?.reset();let e=0,h=0,n=0;this.Fp&&this.Vp&&(this.Fp.reset(),this.Vp.reset(),e=32.768*(this.Fp.end-this.Fp.start)/s|0,h=32.768*this.Fp.start/s|0);let r=0,o=0,a=0;this.Gp&&this.Wp&&(this.Gp.reset(),this.Wp.reset(),r=32.768*(this.Gp.end-this.Gp.start)/s|0,o=32.768*this.Gp.start/s|0);for(let t=0;t<5;t++)this.Pp&&0!==this.Yp[t]&&(N.Rp[t]=0,N.Dp[t]=this.zp[t]*s,N.kp[t]=(this.Yp[t]<<14)/100|0,N.Mp[t]=32.768*(this.Pp.end-this.Pp.start)*Math.pow(1.0057929410678534,this.Hp[t])/s|0,N.Up[t]=32.768*this.Pp.start/s|0);if(this.Pp&&this.Np)for(let i=0;i<t;i++){let s=this.Pp.evaluate(t),l=this.Np.evaluate(t);if(this.Fp&&this.Vp){const i=this.Fp.evaluate(t),r=this.Vp.evaluate(t);s+=this.jp(r,n,this.Fp.form)>>1,n+=(i*e>>16)+h}if(this.Gp&&this.Wp){const i=this.Gp.evaluate(t),s=this.Wp.evaluate(t);l=l*(32768+(this.jp(s,a,this.Gp.form)>>1))>>15,a+=(i*r>>16)+o}for(let e=0;e<5;e++)if(0!==this.Yp[e]){const h=i+N.Dp[e];h<t&&(N.buffer[h]+=this.jp(l*N.kp[e]>>15,N.Rp[e],this.Pp.form),N.Rp[e]+=(s*N.Mp[e]>>16)+N.Up[e])}}if(this.release&&this.attack){this.release.reset(),this.attack.reset();let i=0,s=!0;for(let e=0;e<t;e++){const h=this.release.evaluate(t),n=this.attack.evaluate(t);let r;r=s?this.release.start+((this.release.end-this.release.start)*h>>8):this.release.start+((this.release.end-this.release.start)*n>>8),i+=256,i>=r&&(i=0,s=!s),s&&(N.buffer[e]=0)}}if(this.Kp>0&&this.Xp>0){const i=this.Kp*s;for(let s=i;s<t;s++)N.buffer[s]+=N.buffer[s-i]*this.Xp/100|0,N.buffer[s]|=0}for(let i=0;i<t;i++)N.buffer[i]<-32768&&(N.buffer[i]=-32768),N.buffer[i]>32767&&(N.buffer[i]=32767);return N.buffer}jp(t,i,s){return 1===s?(32767&i)<16384?t:-t:2===s?N.sin[32767&i]*t>>14:3===s?((32767&i)*t>>14)-t:4===s?N.Lp[i/2607&32767]*t:0}read(t){this.Pp=new P,this.Pp.read(t),this.Np=new P,this.Np.read(t),0!==t.kc&&(t.ft--,this.Fp=new P,this.Fp.read(t),this.Vp=new P,this.Vp.read(t)),0!==t.kc&&(t.ft--,this.Gp=new P,this.Gp.read(t),this.Wp=new P,this.Wp.read(t)),0!==t.kc&&(t.ft--,this.release=new P,this.release.read(t),this.attack=new P,this.attack.read(t));for(let i=0;i<10;i++){const s=t.qp;if(0===s)break;this.Yp[i]=s,this.Hp[i]=t.$p,this.zp[i]=t.qp}this.Kp=t.qp,this.Xp=t.qp,this.length=t.ct,this.start=t.ct}}var F=s(3867);class V{static Jp=new Int32Array(1e3);static Qp=null;static tw=null;static iw=new F.Ps(1e3,null);sw=new F.Ps(10,null);ew=0;loopEnd=0;static Dy=t=>{const i=new w.A(t.read('sounds.dat'));for(this.Qp=new Uint8Array(441e3),this.tw=new w.A(this.Qp),N.init();;){const t=i.ct;if(65535===t)break;const s=new V;s.read(i),this.iw[t]=s,this.Jp[t]=s.trim()}};static Zp=(t,i)=>{if(!this.iw[t])return null;const s=this.iw[t];return s?.hw(i)??null};read(t){for(let i=0;i<10;i++)0!==t.kc&&(t.ft--,this.sw[i]=new N,this.sw[i]?.read(t));this.ew=t.ct,this.loopEnd=t.ct}trim(){let t=9999999;for(let i=0;i<10;i++)this.sw[i]&&(this.sw[i].start/20|0)<t&&(t=this.sw[i].start/20|0);if(this.ew<this.loopEnd&&(this.ew/20|0)<t&&(t=this.ew/20|0),9999999===t||0===t)return 0;for(let i=0;i<10;i++)this.sw[i]&&(this.sw[i].start-=20*t);return this.ew<this.loopEnd&&(this.ew-=20*t,this.loopEnd-=20*t),t}hw(t){const i=this.Zp(t);return V.tw.ft=0,V.tw?.p4(1380533830),V.tw?.nw(i+36),V.tw?.p4(1463899717),V.tw?.p4(1718449184),V.tw?.nw(16),V.tw?.rw(1),V.tw?.rw(1),V.tw?.nw(22050),V.tw?.nw(22050),V.tw?.rw(1),V.tw?.rw(8),V.tw?.p4(1684108385),V.tw?.nw(i),V.tw.ft+=i,V.tw}Zp(t){let i=0;for(let t=0;t<10;t++)this.sw[t]&&this.sw[t].length+this.sw[t].start>i&&(i=this.sw[t].length+this.sw[t].start);if(0===i)return 0;let s=22050*i/1e3|0,e=22050*this.ew/1e3|0,h=22050*this.loopEnd/1e3|0;(e<0||h<0||h>s||e>=h)&&(t=0);let n=s+(h-e)*(t-1);for(let t=44;t<n+44;t++)V.Qp&&(V.Qp[t]=-128);for(let t=0;t<10;t++)if(this.sw[t]){const i=22050*this.sw[t].length/1e3|0,s=22050*this.sw[t].start/1e3|0,e=this.sw[t].Zp(i,this.sw[t].length);for(let t=0;t<i;t++)V.Qp&&(V.Qp[t+s+44]+=e[t]>>8<<24>>24)}if(t>1){e+=44,h+=44,s+=44,n+=44;const i=n-s;for(let t=s-1;t>=h;t--)V.Qp&&(V.Qp[t+i]=V.Qp[t]);for(let i=1;i<t;i++){const t=(h-e)*i;for(let i=e;i<h;i++)V.Qp&&(V.Qp[i+t]=V.Qp[i])}n-=44}return n}}s(8902);var G=s(4702),W=s(3819),Y=s(2595),H=s(198),z=s(818),X=s(5599),K=s(1023),Z=s(6169);class j extends B.A{ow;aw;x;z;lw;angle;shape;cw;fw;uw;constructor(t,i,s,e,h,n,r,o,a,l){super(),this.ow=t,this.aw=i,this.x=s,this.z=e,this.lw=h,this.angle=n,this.shape=r,this.cw=o,this.fw=a,this.uw=l}}class q extends B.A{ow;aw;x;z;lw;angle;shape;dw;constructor(t,i,s,e,h,n,r,o){super(),this.ow=t,this.aw=i,this.x=s,this.z=e,this.lw=h,this.angle=n,this.shape=r,this.dw=o}}var $=s(670),J=s(9456),Q=s(8268),tt=s(9418);class it extends tt.A{static yw=2;static pw=4;static ww=8;static Aw=16;static xw=32;static gw=64;static Cw=128;type=null;draw(t){if(!this.type)return null;if(-1===this.Sw||-1===this.mw)return this.Bw();const i=this.Bw();if(!i)return null;const s=a.A.ta[this.Sw],e=m.A.bw(s.Ul(),!0,!s.Iw,!1);e.translate(-this.Ew,0,0),e.nc(),s._w&&s._w.frames&&e.rc(s._w.frames[this.mw]),e.Tw=null,e.Ow=null,128===s.Lw&&128===s.Rw||e.scale(s.Lw,s.Rw,s.Lw),e.oc(64+s.Dw,850+s.kw,-30,-50,-30,!0);const h=[i,e],n=m.A.Mw(h,2);return 1===this.type.size&&(n.Uw=!0),n}isVisible(){return null!==this.type}Bw(){if(!this.type)return null;if(this.Pw>=0&&0===this.Nw){const t=e.A.ta[this.Pw].frames;if(t){const i=t[this.Fw];let s=-1;if(this.Vw>=0&&this.Vw!==this.hc){const t=e.A.ta[this.Vw].frames;t&&(s=t[this.Gw])}return this.type.Bw(i,s,e.A.ta[this.Pw].Ww)}}let t=-1;if(this.Vw>=0){const i=e.A.ta[this.Vw].frames;i&&(t=i[this.Gw])}const i=this.type.Bw(t,-1,null);return i?(this.height=i.Yw,i):null}}class st extends B.A{index;count;constructor(t,i){super(),this.index=t,this.count=i}}var et=s(4197),ht=s(7121);class nt extends ht.A{Hw;level;zw;Xw;Kw;offsetY;Zw;dw;jw;arc;target;mobile=!1;x=0;z=0;y=0;velocityX=0;qw=0;$w=0;velocityY=0;Jw=0;Qw=0;pitch=0;Va=0;Fa=0;constructor(t,i,s,e,h,n,r,o,l,c,f){super(),this.Hw=a.A.ta[t],this.level=i,this.zw=s,this.Xw=h,this.Kw=e,this.Zw=n,this.dw=r,this.jw=o,this.arc=l,this.target=c,this.offsetY=f}tA(t,i,s,e){if(!this.mobile){const i=t-this.zw,e=s-this.Xw,h=Math.sqrt(i*i+e*e);this.x=this.zw+i*this.arc/h,this.z=this.Xw+e*this.arc/h,this.y=this.Kw}const h=this.dw+1-e;this.velocityX=(t-this.x)/h,this.qw=(s-this.z)/h,this.$w=Math.sqrt(this.velocityX*this.velocityX+this.qw*this.qw),this.mobile||(this.velocityY=-this.$w*Math.tan(.02454369*this.jw)),this.Jw=2*(i-this.y-this.velocityY*h)/(h*h)}update(t){if(this.mobile=!0,this.x+=this.velocityX*t,this.z+=this.qw*t,this.y+=this.velocityY*t+.5*this.Jw*t*t,this.velocityY+=this.Jw*t,this.Qw=325.949*Math.atan2(this.velocityX,this.qw)+1024&2047,this.pitch=325.949*Math.atan2(this.velocityY,this.$w)&2047,this.Hw._w&&this.Hw._w.delay)for(this.Fa+=t;this.Fa>this.Hw._w.delay[this.Va];)this.Fa-=this.Hw._w.delay[this.Va]+1,this.Va++,this.Va>=this.Hw._w.Ga&&(this.Va=0)}draw(){const t=this.Hw.Ul(),i=m.A.bw(t,!0,!this.Hw.Iw,!1);return this.Hw._w&&this.Hw._w.frames&&(i.nc(),i.rc(this.Hw._w.frames[this.Va]),i.Tw=null,i.Ow=null),128===this.Hw.Lw&&128===this.Hw.Rw||i.scale(this.Hw.Lw,this.Hw.Rw,this.Hw.Lw),i.iA(this.pitch),i.oc(64+this.Hw.Dw,850+this.Hw.kw,-30,-50,-30,!0),i}}class rt extends ht.A{type;level;x;z;y;Zw;sA=!1;Va=0;Fa=0;constructor(t,i,s,e,h,n,r){super(),this.type=a.A.ta[t],this.level=i,this.x=s,this.z=e,this.y=h,this.Zw=n+r}update(t){if(this.type._w&&this.type._w.delay)for(this.Fa+=t;this.Fa>this.type._w.delay[this.Va];)this.Fa-=this.type._w.delay[this.Va]+1,this.Va++,this.Va>=this.type._w.Ga&&(this.Va=0,this.sA=!0)}draw(){const t=this.type.Ul(),i=m.A.bw(t,!0,!this.type.Iw,!1);return!this.sA&&this.type._w&&this.type._w.frames&&(i.nc(),i.rc(this.type._w.frames[this.Va]),i.Tw=null,i.Ow=null),128===this.type.Lw&&128===this.type.Rw||i.scale(this.type.Lw,this.type.Rw,this.type.Lw),0!==this.type.orientation&&(90===this.type.orientation?i.eA():180===this.type.orientation?(i.eA(),i.eA()):270===this.type.orientation&&(i.eA(),i.eA(),i.eA())),i.oc(64+this.type.Dw,850+this.type.kw,-30,-50,-30,!0),i}}var ot=s(123),at=s(8793),lt=s(8534),ct=s(6730),ft=s(2164),ut=s(3795),dt=s(4909);class yt{wt;la;hA;closed=!1;cf=!1;constructor(t,i){this.wt=t,this.wt.onerror=this.onerror,this.wt.onmessageerror=this.onmessageerror,this.la=new At(5e3),this.hA=new pt(this.wt,5e3,i),this.wt.postMessage({type:'connection',id:i})}get available(){return this.closed?0:this.la.available}write(t,i){this.hA.write(t,i)}async read(){return this.closed?0:this.la.uf()??await this.la.df()}async yf(t,i,s){if(!this.closed)for(;s>0;){const e=this.la.pf(t,i,s)??await this.la.wf(t,i,s);if(e.length<=0)throw new Error('EOF');i+=e.length,s-=e.length}}close(){this.closed=!0,this.la.close(),this.hA.close(),console.log('connection close!'),this.cf&&console.log('connection error!')}onerror=t=>{this.closed||(this.cf=!0,this.close())};onmessageerror=t=>{this.closed||(this.cf=!0,this.close())}}class pt{wt;Af;At;closed=!1;cf=!1;constructor(t,i,s){this.wt=t,this.Af=i,this.At=s}write(t,i){if(!this.closed){if(this.cf)throw this.cf=!1,new Error('Error in writer thread');if(i>this.Af||t.length>this.Af)throw new Error('buffer overflow');try{this.wt.postMessage({type:'data',data:t.subarray(0,i),id:this.At})}catch(t){this.cf=!0}}}close(){this.closed=!0}}class wt extends B.A{xf;position;constructor(t){super(),this.xf=t,this.position=0}get available(){return this.xf.length-this.position}get read(){return this.xf[this.position++]}get gf(){return this.xf.length}}class At{Af;queue=new v.A;event=null;Cf=null;total=0;closed=!1;constructor(t){this.Af=t}get available(){return this.total}onmessage=t=>{const i='string'==typeof t.data?JSON.parse(t.data):t;if('data'!==i.type)return void console.error('Unexpected message type: ',i.type);if(this.closed)throw new Error('WorkerReader is closed!');const s=new wt(new Uint8Array(i.data));if(this.event?this.queue.Sf(s):this.event=s,this.total+=s.gf,this.Cf&&(this.Cf(this.event),this.Cf=null,this.total>this.Af))throw new Error('buffer overflow')};mf(){return this.event&&this.event.available>0?this.event.read:null}async vf(t){for(this.event=this.queue.Bf();this.total<t;)await Promise.race([new Promise((t=>this.Cf=t)),(0,b.wa)(2e3).then((()=>{if(this.closed)throw new Error('WorkerReader closed while reading.')}))]);return this.event?this.event.read:this.vf(t)}pf(t,i,s){if(this.closed)throw new Error('WorkerReader is closed!');if(!(this.event&&this.event.available>=s))return null;for(;s>0;){const e=this.mf();if(null===e)throw new Error('EOF - tried to read a fast byte when there was not enough immediate bytes.');t[i++]=e,this.total--,s--}return t}async wf(t,i,s){if(this.closed)throw new Error('WorkerReader is closed!');for(;s>0;)t[i++]=this.mf()??await this.vf(s),this.total--,s--;return t}uf(){if(this.closed)throw new Error('WorkerReader is closed!');const t=this.mf();return null===t?null:(this.total--,t)}async df(){if(this.closed)throw new Error('WorkerReader is closed!');const t=await this.vf(1);return this.total--,t}close(){this.closed=!0,this.Cf=null,this.total=0,this.event=null,this.queue.clear()}}var xt=s(7854),gt=s(2176),Ct=s(5868);class St extends at.K{load=async()=>{if(this.ii)this.si=!0;else{this.ii=!0;try{this.aa(),await this.ya(10,'Connecting to fileserver'),await G.A.load(await(await fetch('bz2.wasm')).arrayBuffer()),this.db=new R(await R.openDatabase());const t=new w.A(new Uint8Array(await(0,b.pa)(`${at.K.It}/crc`)));for(let i=0;i<9;i++)this.ri[i]=t.ut;at.K.Bt||await this.xa('scape_main',12345678,4e4,!1);const i=await this.fa('title','title screen',this.ri[1],10);this.gi=i,this.Ui=S.Dc(i,'p11'),this.Pi=S.Dc(i,'p12'),this.Ni=S.Dc(i,'b12'),this.Fi=S.Dc(i,'q8'),await this.nA(),this.rA();const s=await this.fa('config','config',this.ri[2],15),u=await this.fa('interface','interface',this.ri[3],20),A=await this.fa('media','2d graphics',this.ri[4],30),x=await this.fa('models','3d graphics',this.ri[5],40),g=await this.fa('textures','textures',this.ri[6],60),C=await this.fa('wordenc','chat system',this.ri[7],65),v=await this.fa('sounds','sound effects',this.ri[8],70);this.yr=new F.oA($.A.sr,$.A.Ar,$.A.Ar),this.dr=new F.aA($.A.sr,$.A.Ar+1,$.A.Ar+1),this.dr&&(this.un=new H.A(this.dr,$.A.Ar,$.A.sr,$.A.Ar));for(let t=0;t<$.A.sr;t++)this.ir[t]=new $.A;this.Ns=new p.A(512,512),await this.ya(75,'Unpacking media'),this.Os=y.A.Dc(A,'invback',0),this.Ls=y.A.Dc(A,'chatback',0),this.Rs=y.A.Dc(A,'mapback',0),this.Ds=y.A.Dc(A,'backbase1',0),this.ks=y.A.Dc(A,'backbase2',0),this.Ms=y.A.Dc(A,'backhmid1',0);for(let t=0;t<13;t++)this.Us[t]=y.A.Dc(A,'sideicons',t);this.Fs=p.A.Dc(A,'compass',0);try{for(let t=0;t<50;t++)22!==t&&(this.Vs[t]=y.A.Dc(A,'mapscene',t))}catch(t){}try{for(let t=0;t<50;t++)this.Gs[t]=p.A.Dc(A,'mapfunction',t)}catch(t){}try{for(let t=0;t<20;t++)this.Ws[t]=p.A.Dc(A,'hitmarks',t)}catch(t){}try{for(let t=0;t<20;t++)this.Ys[t]=p.A.Dc(A,'headicons',t)}catch(t){}this.Hs=p.A.Dc(A,'mapflag',0);for(let t=0;t<8;t++)this.zs[t]=p.A.Dc(A,'cross',t);this.Xs=p.A.Dc(A,'mapdots',0),this.Ks=p.A.Dc(A,'mapdots',1),this.Zs=p.A.Dc(A,'mapdots',2),this.js=p.A.Dc(A,'mapdots',3),this.qs=y.A.Dc(A,'scrollbar',0),this.$s=y.A.Dc(A,'scrollbar',1),this.Js=y.A.Dc(A,'redstone1',0),this.Qs=y.A.Dc(A,'redstone2',0),this.te=y.A.Dc(A,'redstone3',0),this.ie=y.A.Dc(A,'redstone1',0),this.ie?.lA(),this.se=y.A.Dc(A,'redstone2',0),this.se?.lA(),this.ee=y.A.Dc(A,'redstone1',0),this.ee?.cA(),this.he=y.A.Dc(A,'redstone2',0),this.he?.cA(),this.ne=y.A.Dc(A,'redstone3',0),this.ne?.cA(),this.re=y.A.Dc(A,'redstone1',0),this.re?.lA(),this.re?.cA(),this.oe=y.A.Dc(A,'redstone2',0),this.oe?.lA(),this.oe?.cA();const B=p.A.Dc(A,'backleft1',0);this.us=new f.A(B.width,B.height),B.fA(0,0);const I=p.A.Dc(A,'backleft2',0);this.ds=new f.A(I.width,I.height),I.fA(0,0);const E=p.A.Dc(A,'backright1',0);this.ys=new f.A(E.width,E.height),E.fA(0,0);const _=p.A.Dc(A,'backright2',0);this.ps=new f.A(_.width,_.height),_.fA(0,0);const T=p.A.Dc(A,'backtop1',0);this.ws=new f.A(T.width,T.height),T.fA(0,0);const O=p.A.Dc(A,'backtop2',0);this.As=new f.A(O.width,O.height),O.fA(0,0);const L=p.A.Dc(A,'backvmid1',0);this.xs=new f.A(L.width,L.height),L.fA(0,0);const D=p.A.Dc(A,'backvmid2',0);this.gs=new f.A(D.width,D.height),D.fA(0,0);const k=p.A.Dc(A,'backvmid3',0);this.Cs=new f.A(k.width,k.height),k.fA(0,0);const U=p.A.Dc(A,'backhmid2',0);this.Ss=new f.A(U.width,U.height),U.fA(0,0);const P=(21*Math.random()|0)-10,N=(21*Math.random()|0)-10,W=(21*Math.random()|0)-10,Y=(41*Math.random()|0)-20;for(let t=0;t<50;t++)this.Gs[t]&&this.Gs[t]?.translate(P+Y,N+Y,W+Y),this.Vs[t]&&this.Vs[t]?.translate(P+Y,N+Y,W+Y);await this.ya(80,'Unpacking textures'),d.A.uA(g),d.A.dA(.8),d.A.yA(20),await this.ya(83,'Unpacking models'),m.A.Dy(x),lt.A.Dy(x),ct.A.Dy(x),await this.ya(86,'Unpacking config'),e.A.Dy(s),h.A.Dy(s),ft.A.Dy(s),n.A.Dy(s,at.K.members),r.A.Dy(s),o.A.Dy(s),a.A.Dy(s),l.A.Dy(s),at.K.Bt||(await this.ya(90,'Unpacking sounds'),V.Dy(v)),await this.ya(92,'Unpacking interfaces'),c.A.Dy(u,A,[this.Ui,this.Pi,this.Ni,this.Fi]),await this.ya(97,'Preparing game engine');for(let t=0;t<33;t++){let i=999,s=0;for(let e=0;e<35;e++)if(0===this.Rs.Kc[e+t*this.Rs.width])999===i&&(i=e);else if(999!==i){s=e;break}this.Is[t]=i,this.Es[t]=s-i}for(let t=9;t<160;t++){let i=999,s=0;for(let e=10;e<168;e++)if(0===this.Rs.Kc[e+t*this.Rs.width]&&(e>34||t>34))999===i&&(i=e);else if(999!==i){s=e;break}this._s[t-9]=i-21,this.Ts[t-9]=s-i}d.A.pA(479,96),this.vs=d.A.wA,d.A.pA(190,261),this.Bs=d.A.wA,d.A.pA(512,334),this.bs=d.A.wA;const z=new Int32Array(9);for(let t=0;t<9;t++){const i=32*t+128+15,s=3*i+600,e=d.A.sin[i];z[t]=s*e>>16}H.A.init(512,334,500,800,z),M.Dy(C),this.AA(),await(this?.Xt())}catch(t){console.error(t),this.ei=!0}}};update=async()=>{this.si||this.ei||this.hi||(this.ni++,await this.Zt(),this.xA?await this.gA():await this.CA())};draw=async()=>{C.A.SA(),this.si||this.ei||this.hi?this.Ca():(this.xA?this.mA():await this.vA(),this.we=0,C.A.BA())};refresh=()=>{this.Ci=!0};ya=async(t,i)=>{if(console.log(`${t}%: ${i}`),await this.bA(),!this.gi)return void await super.ya(t,i);this.bi?.bind();this.Ni?.Fc(180,54,'RuneScape is loading - please wait...',g.A.Za);u.A.Ka(28,62,304,34,g.A.IA),u.A.Ka(29,63,302,32,g.A.dl),u.A.fillRect(30,64,3*t,30,g.A.IA),u.A.fillRect(30+3*t,64,300-3*t,30,g.A.dl),this.Ni?.Fc(180,85,i,g.A.Za),this.bi?.draw(214,186),this.Ci&&(this.Ci=!1,this.Gi||(this.Ii?.draw(0,0),this.Ei?.draw(661,0)),this.vi?.draw(128,0),this.Bi?.draw(214,386),this._i?.draw(0,265),this.Ti?.draw(574,265),this.Oi?.draw(128,186),this.Li?.draw(574,186)),await(0,b.wa)(5)};EA=()=>{this.Gi&&(this._A(),this._A(),this.TA())};bA=async()=>{this.vi||(this.sa=null,this.os=null,this.ns=null,this.hs=null,this.rs=null,this.ls=null,this.cs=null,this.fs=null,this.Ii=new f.A(128,265),u.A.clear(),this.Ei=new f.A(128,265),u.A.clear(),this.vi=new f.A(533,186),u.A.clear(),this.Bi=new f.A(360,146),u.A.clear(),this.bi=new f.A(360,200),u.A.clear(),this._i=new f.A(214,267),u.A.clear(),this.Ti=new f.A(215,267),u.A.clear(),this.Oi=new f.A(86,79),u.A.clear(),this.Li=new f.A(87,79),u.A.clear(),this.gi&&(await this.nA(),this.rA()),this.Ci=!0)};nA=async()=>{if(!this.gi)return;const t=await p.A.OA(this.gi,'title');this.Ii?.bind(),t.fA(0,0),this.Ei?.bind(),t.fA(-661,0),this.vi?.bind(),t.fA(-128,0),this.Bi?.bind(),t.fA(-214,-386),this.bi?.bind(),t.fA(-214,-186),this._i?.bind(),t.fA(0,-265),this.Ti?.bind(),t.fA(-128,-186),this.Oi?.bind(),t.fA(-128,-186),this.Li?.bind(),t.fA(-574,-186),t.lA(),this.Ii?.bind(),t.fA(394,0),this.Ei?.bind(),t.fA(-267,0),this.vi?.bind(),t.fA(266,0),this.Bi?.bind(),t.fA(180,-386),this.bi?.bind(),t.fA(180,-186),this._i?.bind(),t.fA(394,-265),this.Ti?.bind(),t.fA(-180,-265),this.Oi?.bind(),t.fA(212,-186),this.Li?.bind(),t.fA(-180,-186);const i=p.A.Dc(this.gi,'logo');this.vi?.bind(),i.draw((this.width/2|0)-(i.width/2|0)-128,18)};LA=t=>{if(!this.zi||!this.Hi)return;this.zi.fill(0);for(let t=0;t<5e3;t++){const t=128*Math.random()*256|0;this.zi[t]=256*Math.random()|0}for(let t=0;t<20;t++){for(let t=1;t<255;t++)for(let i=1;i<127;i++){const s=i+(t<<7);this.Hi[s]=(this.zi[s-1]+this.zi[s+1]+this.zi[s-128]+this.zi[s+128])/4|0}const t=this.zi;this.zi=this.Hi,this.Hi=t}if(t){let i=0;for(let s=0;s<t.height;s++)for(let e=0;e<t.width;e++)if(0!==t.Kc[i++]){const i=e+t.RA+16+(s+t.DA+16<<7);this.zi[i]=0}}};rA=()=>{if(this.gi){this.Ri=y.A.Dc(this.gi,'titlebox'),this.Di=y.A.Dc(this.gi,'titlebutton');for(let t=0;t<12;t++)this.Vi[t]=y.A.Dc(this.gi,'runes',t);this.Wi=new p.A(128,265),this.Yi=new p.A(128,265),this.Ii&&(0,b.kA)(this.Ii.Kc,0,this.Wi.Kc,0,33920),this.Ei&&(0,b.kA)(this.Ei.Kc,0,this.Yi.Kc,0,33920),this.ji=new Int32Array(256);for(let t=0;t<64;t++)this.ji[t]=262144*t;for(let t=0;t<64;t++)this.ji[t+64]=1024*t+g.A.RED;for(let t=0;t<64;t++)this.ji[t+128]=4*t+g.A.yl;for(let t=0;t<64;t++)this.ji[t+192]=g.A.Za;this.qi=new Int32Array(256);for(let t=0;t<64;t++)this.qi[t]=1024*t;for(let t=0;t<64;t++)this.qi[t+64]=4*t+g.A.GREEN;for(let t=0;t<64;t++)this.qi[t+128]=262144*t+g.A.jc;for(let t=0;t<64;t++)this.qi[t+192]=g.A.Za;this.$i=new Int32Array(256);for(let t=0;t<64;t++)this.$i[t]=4*t;for(let t=0;t<64;t++)this.$i[t+64]=262144*t+g.A.BLUE;for(let t=0;t<64;t++)this.$i[t+128]=1024*t+g.A.qc;for(let t=0;t<64;t++)this.$i[t+192]=g.A.Za;this.Zi=new Int32Array(256),this.zi=new Int32Array(32768),this.Hi=new Int32Array(32768),this.LA(null),this.Xi=new Int32Array(32768),this.Ki=new Int32Array(32768),this.ya(10,'Connecting to fileserver').then((()=>{this.Gi||(this.Gi=!0,this.es=setInterval(this.EA,35))}))}};CA=async()=>{if(0===this.Si){let t=(this.width/2|0)-80,i=20+(this.height/2|0);if(i+=20,1===this.MA&&this.UA>=t-75&&this.UA<=t+75&&this.PA>=i-20&&this.PA<=i+20){if(+at.K.getParameter('world')>=998)return void this.ca();this.Si=3,this.mi=0}t=80+(this.width/2|0),1===this.MA&&this.UA>=t-75&&this.UA<=t+75&&this.PA>=i-20&&this.PA<=i+20&&(this.ki='',this.Mi='Enter your username & password.',this.Si=2,this.mi=0)}else if(2===this.Si){let t=(this.height/2|0)-40;t+=30,t+=25,1===this.MA&&this.PA>=t-15&&this.PA<t&&(this.mi=0),t+=15,1===this.MA&&this.PA>=t-15&&this.PA<t&&(this.mi=1);let i=(this.width/2|0)-80,s=50+(this.height/2|0);for(s+=20,1===this.MA&&this.UA>=i-75&&this.UA<=i+75&&this.PA>=s-20&&this.PA<=s+20&&await this.NA(this.username,this.password,!1),i=80+(this.width/2|0),1===this.MA&&this.UA>=i-75&&this.UA<=i+75&&this.PA>=s-20&&this.PA<=s+20&&(this.Si=0,this.username='',this.password='');;){const t=this.FA();if(-1===t)return;let i=!1;for(let s=0;s<S.Bc.length;s++)if(String.fromCharCode(t)===S.Bc.charAt(s)){i=!0;break}0===this.mi?(8===t&&this.username.length>0&&(this.username=this.username.substring(0,this.username.length-1)),9!==t&&10!==t&&13!==t||(this.mi=1),i&&(this.username=this.username+String.fromCharCode(t)),this.username.length>12&&(this.username=this.username.substring(0,12))):1===this.mi&&(8===t&&this.password.length>0&&(this.password=this.password.substring(0,this.password.length-1)),9!==t&&10!==t&&13!==t||(this.mi=0),i&&(this.password=this.password+String.fromCharCode(t)),this.password.length>20&&(this.password=this.password.substring(0,20)))}}else if(3===this.Si){const t=this.width/2|0;let i=50+(this.height/2|0);i+=20,1===this.MA&&this.UA>=t-75&&this.UA<=t+75&&this.PA>=i-20&&this.PA<=i+20&&(this.Si=0)}};vA=async()=>{await this.bA(),this.bi?.bind(),this.Ri?.draw(0,0);if(0===this.Si){let t=180,i=80;this.Ni?.Il(t,i,'Welcome to RuneScape',g.A.yl,!0),t=100,i=120,this.Di?.draw(t-73,i-20),this.Ni?.Il(t,i+5,'New user',g.A.Za,!0),t=260,this.Di?.draw(t-73,i-20),this.Ni?.Il(t,i+5,'Existing User',g.A.Za,!0)}else if(2===this.Si){let t=100,i=60;this.ki.length>0?(this.Ni?.Il(180,i-15,this.ki,g.A.yl,!0),this.Ni?.Il(180,i,this.Mi,g.A.yl,!0),i+=30):(this.Ni?.Il(180,i-7,this.Mi,g.A.yl,!0),i+=30),this.Ni?._l(90,i,`Username: ${this.username}${0===this.mi&&this.ni%40<20?'@yel@|':''}`,g.A.Za,!0),i+=15,this.Ni?._l(92,i,`Password: ${W.A.VA(this.password)}${1===this.mi&&this.ni%40<20?'@yel@|':''}`,g.A.Za,!0),i=150,this.Di?.draw(t-73,i-20),this.Ni?.Il(t,i+5,'Login',g.A.Za,!0),t=260,this.Di?.draw(t-73,i-20),this.Ni?.Il(t,i+5,'Cancel',g.A.Za,!0)}else if(3===this.Si){this.Ni?.Il(180,40,'Create a free account',g.A.yl,!0);const t=180;let i=65;this.Ni?.Il(180,i,'To create a new account you need to',g.A.Za,!0),i+=15,this.Ni?.Il(180,i,'go back to the main RuneScape webpage',g.A.Za,!0),i+=15,this.Ni?.Il(180,i,"and choose the red 'create account'",g.A.Za,!0),i+=15,this.Ni?.Il(180,i,'button at the top right of that page.',g.A.Za,!0),i=150,this.Di?.draw(t-73,i-20),this.Ni?.Il(t,i+5,'Cancel',g.A.Za,!0)}this.bi?.draw(214,186),this.Ci&&(this.Ci=!1,this.vi?.draw(128,0),this.Bi?.draw(214,386),this._i?.draw(0,265),this.Ti?.draw(574,265),this.Oi?.draw(128,186),this.Li?.draw(574,186))};NA=async(t,i,s)=>{try{if(s||(this.ki='',this.Mi='Connecting to server...',C.A.BA(),C.A.SA(),await this.vA(),C.A.BA(),C.A.SA()),'998'===St.getParameter('world')){if(this.Ko&&!this.Ko.gt)return this.ki='You are not connected to a host.',void(this.Mi='Please try using world 999.');this.stream=new yt(this.wt,this.Ko.At)}else if('999'===St.getParameter('world')){if(!this.Xo)return this.ki='The server is starting up.',void(this.Mi='Please try again in a moment.');this.stream=new yt(this.wt,this.host.At)}else this.stream=new I(await I.ff(at.K.bt));await this.stream.yf(this.in.data,0,8),this.in.ft=0,this.ci=this.in.GA;const e=new Int32Array([Math.floor(99999999*Math.random()),Math.floor(99999999*Math.random()),Number(this.ci>>32n),Number(this.ci&BigInt(4294967295))]);this.ai.ft=0,this.ai.p1(10),this.ai.p4(e[0]),this.ai.p4(e[1]),this.ai.p4(e[2]),this.ai.p4(e[3]),this.ai.p4(0),this.ai.WA(t),this.ai.WA(i),this.ai.YA(at.K.Ot,at.K.exponent),this.li.ft=0,s?this.li.p1(18):this.li.p1(16),this.li.p1(this.ai.ft+36+1+1),this.li.p1(at.K.St),this.li.p1(at.K.Bt?1:0);for(let t=0;t<9;t++)this.li.p4(this.ri[t]);this.li.HA(this.ai.data,this.ai.ft,0),this.ai.random=new L(e);for(let t=0;t<4;t++)e[t]+=50;this.yi=new L(e),this.stream?.write(this.li.data,this.li.ft);const h=await this.stream.read();if(1===h)return await(0,b.wa)(2e3),void await this.NA(t,i,s);if(2===h||18===h){this.lo=18===h,Y.A.zA(),this.xA=!0,this.ai.ft=0,this.in.ft=0,this.pi=-1,this.wi=-1,this.Ai=-1,this.xi=-1,this.packetSize=0,this.fi=0,this.di=0,this.ui=0,this.Pe=0,this._e=0,this.me=!1,this.XA=Date.now();for(let t=0;t<100;t++)this.uh[t]=null;this.Oh=0,this.Wh=0,this.dn=0,this.Oo=0,this.Cn=(100*Math.random()|0)-50,this.Sn=(110*Math.random()|0)-55,this.mn=(80*Math.random()|0)-40,this.Nn=(120*Math.random()|0)-60,this.Fn=(30*Math.random()|0)-20,this.rr=(20*Math.random()|0)-10&2047,this.Wn=-1,this.wn=0,this.An=0,this.Rr=0,this.Vr=0;for(let t=0;t<this.Qt;t++)this.Lr[t]=null,this.Nr[t]=null;for(let t=0;t<8192;t++)this.Fr[t]=null;this.io=this.Lr[this.ti]=new Q.A,this.Wr.clear(),this.Yr.clear(),this.zr.clear();for(let t=0;t<$.A.sr;t++)for(let i=0;i<$.A.Ar;i++)for(let s=0;s<$.A.Ar;s++)this.Xr[t][i][s]=null;this.Zr=new v.A,this.yo=0,this.fh=-1,this.Le=-1,this.pe=-1,this.Oe=-1,this.Fh=!1,this.$e=3,this.lh=!1,this.me=!1,this.hh=!1,this.je=null,this.eo=0,this.qe=-1,this.co=!0,this.KA();for(let t=0;t<5;t++)this.do[t]=0;return(0,ot.Jo)(!0),at.K.Pt=0,at.K.Nt=0,at.K.Ft=0,at.K.Vt=0,at.K.Gt=0,at.K.Wt=0,at.K.Yt=0,at.K.Ht=0,at.K.zt=0,void await this.ZA()}if(3===h)return this.ki='',void(this.Mi='Invalid username or password.');if(4===h)return this.ki='Your account has been disabled.',void(this.Mi='Please check your message-centre for details.');if(5===h)return this.ki='Your account is already logged in.',void(this.Mi='Try again in 60 secs...');if(6===h)return this.ki='RuneScape has been updated!',void(this.Mi='Please reload this page.');if(7===h)return this.ki='This world is full.',void(this.Mi='Please use a different world.');if(8===h)return this.ki='Unable to connect.',void(this.Mi='Login server offline.');if(9===h)return this.ki='Login limit exceeded.',void(this.Mi='Too many connections from your address.');if(10===h)return this.ki='Unable to connect.',void(this.Mi='Bad session id.');if(11===h)return this.Mi='Login server rejected session.',void(this.Mi='Please try again.');if(12===h)return this.ki='You need a members account to login to this world.',void(this.Mi='Please subscribe, or use a different world.');if(13===h)return this.ki='Could not complete login.',void(this.Mi='Please try using a different world.');if(14===h)return this.ki='The server is being updated.',void(this.Mi='Please wait 1 minute and try again.');if(15===h)return this.xA=!0,this.ai.ft=0,this.in.ft=0,this.pi=-1,this.wi=-1,this.Ai=-1,this.xi=-1,this.packetSize=0,this.fi=0,this.di=0,this._e=0,void(this.me=!1);if(16===h)return this.ki='Login attempts exceeded.',void(this.Mi='Please wait 1 minute and try again.');17===h&&(this.ki='You are standing in a members-only area.',this.Mi='To play on this world move to a free area first')}catch(t){console.log(t),this.ki='',this.Mi='Error connecting to server.'}};gA=async()=>{if(null!==this.Lr){this.di>1&&this.di--,this.ui>0&&this.ui--;for(let t=0;t<Ct.A.jA&&await this.read();t++);if(this.xA){for(let t=0;t<this.Oo;t++)if(this.ko[t]<=0){try{const i=V.Zp(this.Ro[t],this.Do[t]);if(!i)throw new Error;Date.now()+(i.ft/22|0)>this.Fo+(this.No/22|0)&&(this.No=i.ft,this.Fo=Date.now(),this.Uo=this.Ro[t],this.Po=this.Do[t],await(0,ot.qA)(i.data.slice(0,i.ft),this.Mo))}catch(t){console.error(t)}this.Oo--;for(let i=t;i<this.Oo;i++)this.Ro[i]=this.Ro[i+1],this.Do[i]=this.Do[i+1],this.ko[i]=this.ko[i+1];t--}else this.ko[t]--;this.Vo>0&&(this.Vo-=20,this.Vo<0&&(this.Vo=0),0===this.Vo&&this.Go&&!at.K.Bt&&this.Wo&&await this.xa(this.Wo,this.Yo,this.Ho,!1));const t=Y.A.flush();if(t&&(this.ai.$A(k.qu),this.ai.p2(t.ft),this.ai.HA(t.data,t.ft,0),t.release()),this.fi++,this.fi>750&&await this.JA(),this.QA(),this.tx(),this.ix(),this.sx(),(1===this.hx[1]||1===this.hx[2]||1===this.hx[3]||1===this.hx[4])&&this.hr++>5&&(this.hr=0,this.ai.$A(k.$u),this.ai.p2(this.nr),this.ai.p2(this.rr),this.ai.p1(this.Nn),this.ai.p1(this.Fn)),this.yn++,0!==this.Ae&&(this.xe+=20,this.xe>=400&&(this.Ae=0)),0!==this.Mh&&(this.Nh++,this.Nh>=15&&(2===this.Mh&&(this.fe=!0),3===this.Mh&&(this.ue=!0),this.Mh=0)),0!==this.bh&&(this._h++,(this.ol>this.Ih+5||this.ol<this.Ih-5||this.al>this.Eh+5||this.al<this.Eh-5)&&(this.Th=!0),0===this.nx)){if(2===this.bh&&(this.fe=!0),3===this.bh&&(this.ue=!0),this.bh=0,this.Th&&this._h>=5&&(!Ct.A.ox||Ct.A.ox&&0==this.hx[6])){if(this.$h=-1,this.lx(),this.$h===this.mh&&this.Jh!==this.Bh){const t=c.A.ta[this.mh];if(t.sl){const i=t.sl[this.Jh];t.sl[this.Jh]=t.sl[this.Bh],t.sl[this.Bh]=i}if(t.el){const i=t.el[this.Jh];t.el[this.Jh]=t.el[this.Bh],t.el[this.Bh]=i}this.ai.$A(k.uy),this.ai.p2(this.mh),this.ai.p2(this.Bh),this.ai.p2(this.Jh)}}else(1===this.Xh||this.ux(this._e-1))&&this._e>2?this.yx():this._e>0&&await this.wx(this._e-1);this.Nh=10,this.MA=0}if(at.K.Dt++,at.K.Dt>127&&(at.K.Dt=0,this.ai.$A(k.fd),this.ai.p3(4991788)),-1!==H.A.Ax&&this.io){const t=H.A.Ax,i=H.A.xx,s=this.gx(this.io.Cx[0],this.io.Sx[0],t,i,0,0,0,0,0,0,!0);H.A.Ax=-1,s&&(this.ge=this.UA,this.Ce=this.PA,this.Ae=1,this.xe=0)}1===this.MA&&this.je&&(this.je=null,this.ue=!0,this.MA=0),await this.mx(),this.vx(),this.Bx(),this.bx(),1!==this.nx&&1!==this.MA||this.we++,2===this.dn&&(at.K._t?this.Ix():this.Ex()),2===this.dn&&this.xn&&this._x();for(let t=0;t<5;t++)this.In[t]++;if(await this.Tx(),Ct.A.Ox||Date.now()-this.XA>9e4&&(this.ui=250,this.XA=Date.now()-1e4,this.ai.$A(k.ju)),this.gn++,this.gn>500){this.gn=0;const t=8*Math.random()|0;1&~t||(this.Cn+=this.vn),2&~t||(this.Sn+=this.Bn),4&~t||(this.mn+=this.bn)}if(this.Cn<-50&&(this.vn=2),this.Cn>50&&(this.vn=-2),this.Sn<-55&&(this.Bn=2),this.Sn>55&&(this.Bn=-2),this.mn<-40&&(this.bn=1),this.mn>40&&(this.bn=-1),this.Pn++,this.Pn>500){this.Pn=0;const t=8*Math.random()|0;1&~t||(this.Nn+=this.Gn),2&~t||(this.Fn+=this.Vn)}this.Nn<-60&&(this.Gn=2),this.Nn>60&&(this.Gn=-2),this.Fn<-20&&(this.Vn=1),this.Fn>10&&(this.Vn=-1),at.K.kt++,at.K.kt>110&&(at.K.kt=0,this.ai.$A(k.ud),this.ai.p4(0)),this.ro++,this.ro>50&&this.ai.$A(k.Zu);try{this.stream&&this.ai.ft>0&&(this.stream.write(this.ai.data,this.ai.ft),this.ai.ft=0,this.ro=0)}catch(t){console.log(t),await this.JA()}}}};mA=()=>{if(null===this.Lr)return;this.Ci&&(this.Ci=!1,this.us?.draw(0,11),this.ds?.draw(0,375),this.ys?.draw(729,5),this.ps?.draw(752,231),this.ws?.draw(0,0),this.As?.draw(561,0),this.xs?.draw(520,11),this.gs?.draw(520,231),this.Cs?.draw(501,375),this.Ss?.draw(0,345),this.fe=!0,this.ue=!0,this.de=!0,this.ye=!0,2!==this.dn&&(this.rs?.draw(8,11),this.ns?.draw(561,5))),2===this.dn&&this.Lx(),this.me&&1===this.ve&&(this.fe=!0);let t=!1;if(-1!==this.Oe&&(t=this.Ma(this.Oe,this.yn),t&&(this.fe=!0)),2===this.Mh&&(this.fe=!0),2===this.bh&&(this.fe=!0),this.fe&&(this.Rx(),this.fe=!1),-1===this.Le){this.Re.Ja=this.De-this.ke-77,this.ol>453&&this.ol<565&&this.al>350&&this.Dx(this.ol-22,this.al-375,this.De,77,!1,463,0,this.Re);let t=this.De-this.Re.Ja-77;t<0&&(t=0),t>this.De-77&&(t=this.De-77),this.ke!==t&&(this.ke=t,this.ue=!0)}-1!==this.Le&&(t=this.Ma(this.Le,this.yn),t&&(this.ue=!0)),3===this.Mh&&(this.ue=!0),3===this.bh&&(this.ue=!0),this.je&&(this.ue=!0),this.me&&2===this.ve&&(this.ue=!0),this.ue&&(this.kx(),this.ue=!1),2===this.dn&&(this.Mx(),this.ns?.draw(561,5)),-1!==this.qe&&(this.de=!0),this.de&&(-1!==this.qe&&this.qe===this.$e&&(this.qe=-1,this.ai.$A(k.hy),this.ai.p1(this.$e)),this.de=!1,this.fs?.bind(),this.Ms?.draw(0,0),-1===this.Oe&&(-1!==this.Je[this.$e]&&(0===this.$e?this.Js?.draw(29,30):1===this.$e?this.Qs?.draw(59,29):2===this.$e?this.Qs?.draw(87,29):3===this.$e?this.te?.draw(115,29):4===this.$e?this.se?.draw(156,29):5===this.$e?this.se?.draw(184,29):6===this.$e&&this.ie?.draw(212,30)),-1!==this.Je[0]&&(0!==this.qe||this.ni%20<10)&&this.Us[0]?.draw(35,34),-1!==this.Je[1]&&(1!==this.qe||this.ni%20<10)&&this.Us[1]?.draw(59,32),-1!==this.Je[2]&&(2!==this.qe||this.ni%20<10)&&this.Us[2]?.draw(86,32),-1!==this.Je[3]&&(3!==this.qe||this.ni%20<10)&&this.Us[3]?.draw(121,33),-1!==this.Je[4]&&(4!==this.qe||this.ni%20<10)&&this.Us[4]?.draw(157,34),-1!==this.Je[5]&&(5!==this.qe||this.ni%20<10)&&this.Us[5]?.draw(185,32),-1!==this.Je[6]&&(6!==this.qe||this.ni%20<10)&&this.Us[6]?.draw(212,34)),this.fs?.draw(520,165),this.cs?.bind(),this.ks?.draw(0,0),-1===this.Oe&&(-1!==this.Je[this.$e]&&(7===this.$e?this.ee?.draw(49,0):8===this.$e?this.he?.draw(81,0):9===this.$e?this.he?.draw(108,0):10===this.$e?this.ne?.draw(136,1):11===this.$e?this.oe?.draw(178,0):12===this.$e?this.oe?.draw(205,0):13===this.$e&&this.re?.draw(233,0)),-1!==this.Je[8]&&(8!==this.qe||this.ni%20<10)&&this.Us[7]?.draw(80,2),-1!==this.Je[9]&&(9!==this.qe||this.ni%20<10)&&this.Us[8]?.draw(107,3),-1!==this.Je[10]&&(10!==this.qe||this.ni%20<10)&&this.Us[9]?.draw(142,4),-1!==this.Je[11]&&(11!==this.qe||this.ni%20<10)&&this.Us[10]?.draw(179,2),-1!==this.Je[12]&&(12!==this.qe||this.ni%20<10)&&this.Us[11]?.draw(206,2),-1!==this.Je[13]&&(13!==this.qe||this.ni%20<10)&&this.Us[12]?.draw(230,2)),this.cs?.draw(501,492),this.rs?.bind()),this.ye&&(this.ye=!1,this.ls?.bind(),this.Ds?.draw(0,0),this.Pi?.Il(57,33,'Public chat',g.A.Za,!0),0===this.Qe&&this.Pi?.Il(57,46,'On',g.A.GREEN,!0),1===this.Qe&&this.Pi?.Il(57,46,'Friends',g.A.yl,!0),2===this.Qe&&this.Pi?.Il(57,46,'Off',g.A.RED,!0),3===this.Qe&&this.Pi?.Il(57,46,'Hide',g.A.jc,!0),this.Pi?.Il(186,33,'Private chat',g.A.Za,!0),0===this.th&&this.Pi?.Il(186,46,'On',g.A.GREEN,!0),1===this.th&&this.Pi?.Il(186,46,'Friends',g.A.yl,!0),2===this.th&&this.Pi?.Il(186,46,'Off',g.A.RED,!0),this.Pi?.Il(326,33,'Trade/duel',g.A.Za,!0),0===this.ih&&this.Pi?.Il(326,46,'On',g.A.GREEN,!0),1===this.ih&&this.Pi?.Il(326,46,'Friends',g.A.yl,!0),2===this.ih&&this.Pi?.Il(326,46,'Off',g.A.RED,!0),this.Pi?.Il(462,38,'Report abuse',g.A.Za,!0),this.ls?.draw(0,471),this.rs?.bind()),this.yn=0};Lx=()=>{if(this.pn++,this.Ux(),this.Px(),this.Nx(),this.Fx(),this.Vx(),!this.xn){let t=this.nr;(this.Un/256|0)>t&&(t=this.Un/256|0),this.En[4]&&this.Tn[4]+128>t&&(t=this.Tn[4]+128);const i=this.rr+this.mn&2047;if(this.io&&this.Gx(this.cr,this.Wx(this.er,this.io.x,this.io.z)-50,this.ur,i,t,t*Ct.A.Yx+600),at.K.Rt++,at.K.Rt>1802){at.K.Rt=0,this.ai.$A(k.ld),this.ai.p1(0);const t=this.ai.ft;this.ai.p2(29711),this.ai.p1(70),this.ai.p1(256*Math.random()|0),this.ai.p1(242),this.ai.p1(186),this.ai.p1(39),this.ai.p1(61),2*Math.random()|0||this.ai.p1(13),2*Math.random()|0||this.ai.p2(57856),this.ai.p2(65536*Math.random()|0),this.ai.Hx(this.ai.ft-t)}}let t;t=this.xn?this.zx():this.Xx();const i=this.Ln,s=this.Rn,e=this.Dn,h=this.kn,n=this.Mn;let r;for(let t=0;t<5;t++)this.En[t]&&(r=Math.random()*(2*this._n[t]+1)-this._n[t]+Math.sin(this.In[t]*(this.On[t]/100))*this.Tn[t]|0,0===t&&(this.Ln+=r),1===t&&(this.Rn+=r),2===t&&(this.Dn+=r),3===t&&(this.Mn=this.Mn+r&2047),4===t&&(this.kn+=r,this.kn<128&&(this.kn=128),this.kn>383&&(this.kn=383)));r=d.A.Kx,m.A.Zx=!0,m.A.jx=0,m.A.ol=this.ol-8,m.A.al=this.al-11,u.A.clear(C.A.qx()),C.A.$x(),this.un?.draw(this.Ln,this.Rn,this.Dn,t,this.Mn,this.kn,this.ni),C.A.Jx(),this.un?.Qx(),this.tg(),this.ig(),Ct.A.sg&&this.eg(),this.hg(r),this.ng(),this.rs?.draw(8,11),this.Ln=i,this.Rn=s,this.Dn=e,this.kn=h,this.Mn=n};rg=()=>{h.A.og?.clear(),h.A.ag?.clear(),r.A.ia?.clear(),n.A.ia?.clear(),n.A.lg?.clear(),Q.A.ia?.clear(),a.A.ia?.clear()};cg=(t,i)=>{this.fg(t.x,i,t.z)};fg=(t,i,s)=>{if(t<128||s<128||t>13056||s>13056)return this.gr=-1,void(this.Cr=-1);const e=this.Wx(this.er,t,s)-i;this.ug(t,e,s)};ug=(t,i,s)=>{let e=t-this.Ln,h=i-this.Rn,n=s-this.Dn;const r=d.A.sin[this.kn],o=d.A.cos[this.kn],a=d.A.sin[this.Mn],l=d.A.cos[this.Mn];let c=n*a+e*l>>16;n=n*l-e*a>>16,e=c,c=h*o-n*r>>16,n=h*r+n*o>>16,h=c,n>=50?(this.gr=d.A.Dl+((e<<9)/n|0),this.Cr=d.A.kl+((h<<9)/n|0)):(this.gr=-1,this.Cr=-1)};tg=()=>{this.po=0;for(let t=-1;t<this.Rr+this.Vr;t++){let i=null;if(i=-1===t?this.io:t<this.Rr?this.Lr[this.Dr[t]]:this.Fr[this.Gr[t-this.Rr]],i&&i.isVisible()){if(t<this.Rr){let s=30;const e=i;if(0!==e.dg&&(this.cg(i,i.height+15),this.gr>-1))for(let t=0;t<8;t++)e.dg&1<<t&&(this.Ys[t]?.draw(this.gr-12,this.Cr-s),s-=25);t>=0&&10===this.Pe&&this.Ge===this.Dr[t]&&(this.cg(i,i.height+15),this.gr>-1&&this.Ys[7]?.draw(this.gr-12,this.Cr-s))}else 1===this.Pe&&this.Ne===this.Gr[t-this.Rr]&&this.ni%20<10&&(this.cg(i,i.height+15),this.gr>-1&&this.Ys[2]?.draw(this.gr-12,this.Cr-28));if(i.yg&&(t>=this.Rr||0===this.Qe||3===this.Qe||1===this.Qe&&this.pg(i.name))&&(this.cg(i,i.height),this.gr>-1&&this.po<at.K.wo&&this.Ni&&(this.So[this.po]=this.Ni.Nc(i.yg)/2|0,this.Co[this.po]=this.Ni.height,this.Ao[this.po]=this.gr,this.xo[this.po]=this.Cr,this.mo[this.po]=i.wg,this.vo[this.po]=i.Ag,this.Bo[this.po]=i.xg,this.bo[this.po++]=i.yg,0===this.Ah&&1===i.Ag&&(this.Co[this.po]+=10,this.xo[this.po]+=5),0===this.Ah&&2===i.Ag&&(this.So[this.po]=60))),i.gg>this.ni+100&&(this.cg(i,i.height+15),this.gr>-1)){let t=30*i.Cg/i.Sg|0;t>30&&(t=30),u.A.fillRect(this.gr-15,this.Cr-3,t,5,g.A.GREEN),u.A.fillRect(this.gr-15+t,this.Cr-3,30-t,5,g.A.RED)}if(i.gg>this.ni+330&&(this.cg(i,i.height/2|0),this.gr>-1&&(this.Ws[i.mg]?.draw(this.gr-12,this.Cr-12),this.Ui?.Fc(this.gr,this.Cr+4,i.vg.toString(),g.A.dl),this.Ui?.Fc(this.gr-1,this.Cr+3,i.vg.toString(),g.A.Za))),Ct.A.Bg){if(i.pathLength>0||i.bg>=this.ni||i.Ig>this.ni){const t=64*i.size;this.Eg(128*i.Cx[0]+t,128*i.Sx[0]+t,this.er,i.size,65535,!1)}this.Eg(i.x,i.z,this.er,i.size,6710886,!1)}if(Ct.A.sg){let s=0;if(this.cg(i,i.height+30),t<this.Rr){const t=i;if(this.Ui?.Fc(this.gr,this.Cr+s,t.name,g.A.Za),s-=15,-1!==t._g&&this.ni-t.Tg<30){if((t._g&Q.A.Og)===Q.A.Og&&(this.Ui?.Fc(this.gr,this.Cr+s,'Appearance Update',g.A.Za),s-=15),(t._g&Q.A.yw)===Q.A.yw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Play Seq: '+t.Pw,g.A.Za),s-=15),(t._g&Q.A.pw)===Q.A.pw){let i=t.Lg;i>32767&&(i-=32768),this.Ui?.Fc(this.gr,this.Cr+s,'Face Entity: '+i,g.A.Za),s-=15}(t._g&Q.A.ww)===Q.A.ww&&(this.Ui?.Fc(this.gr,this.Cr+s,'Say',g.A.Za),s-=15),(t._g&Q.A.Aw)===Q.A.Aw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Hit: Type '+t.mg+' Amount '+t.vg+' HP '+t.Cg+'/'+t.Sg,g.A.Za),s-=15),(t._g&Q.A.Cw)===Q.A.Cw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Face Coord: '+t.Rg/2+' '+t.Dg/2,g.A.Za),s-=15),(t._g&Q.A.kg)===Q.A.kg&&(this.Ui?.Fc(this.gr,this.Cr+s,'Chat',g.A.Za),s-=15),(t._g&Q.A.gw)===Q.A.gw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Play Spotanim: '+t.Sw,g.A.Za),s-=15),(t._g&Q.A.Mg)===Q.A.Mg&&(this.Ui?.Fc(this.gr,this.Cr+s,'Exact Move',g.A.Za),s-=15)}}else{const t=i;let s=0;if(this.cg(i,i.height+30),this.Ui?.Fc(this.gr,this.Cr+s,t.type?.name??null,g.A.Za),s-=15,-1!==t._g&&this.ni-t.Tg<30){if((t._g&it.yw)===it.yw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Play Seq: '+t.Pw,g.A.Za),s-=15),(t._g&it.pw)===it.pw){let i=t.Lg;i>32767&&(i-=32768),this.Ui?.Fc(this.gr,this.Cr+s,'Face Entity: '+i,g.A.Za),s-=15}(t._g&it.ww)===it.ww&&(this.Ui?.Fc(this.gr,this.Cr+s,'Say',g.A.Za),s-=15),(t._g&it.Aw)===it.Aw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Hit: Type '+t.mg+' Amount '+t.vg+' HP '+t.Cg+'/'+t.Sg,g.A.Za),s-=15),(t._g&it.xw)===it.xw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Change Type: '+t.type?.id??null,g.A.Za),s-=15),(t._g&it.gw)===it.gw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Play Spotanim: '+t.Sw,g.A.Za),s-=15),(t._g&it.Cw)===it.Cw&&(this.Ui?.Fc(this.gr,this.Cr+s,'Face Coord: '+t.Rg/2+' '+t.Dg/2,g.A.Za),s-=15)}}}}}if(Ct.A.Ug)for(let t=0;t<this.Zo.length;t++){const i=this.Zo[t];!i||i.level!==this.er||i.x<0||i.z<0||i.x>=104||i.z>=104||this.Eg(128*i.x+64,128*i.z+64,i.level,1,16776960,!1)}for(let t=0;t<this.po;t++){const i=this.Ao[t];let s=this.xo[t];const e=this.So[t],h=this.Co[t];let n=!0;for(;n;){n=!1;for(let r=0;r<t;r++)s+2>this.xo[r]-this.Co[r]&&s-h<this.xo[r]+2&&i-e<this.Ao[r]+this.So[r]&&i+e>this.Ao[r]-this.So[r]&&this.xo[r]-this.Co[r]<s&&(s=this.xo[r]-this.Co[r],n=!0)}this.gr=this.Ao[t],this.Cr=this.xo[t]=s;const r=this.bo[t];if(0===this.Ah){let i=g.A.yl;if(this.mo[t]<6&&(i=g.A.Pg[this.mo[t]]),6===this.mo[t]&&(i=this.pn%20<10?g.A.RED:g.A.yl),7===this.mo[t]&&(i=this.pn%20<10?g.A.BLUE:g.A.jc),8===this.mo[t]&&(i=this.pn%20<10?45056:8454016),9===this.mo[t]){const s=150-this.Bo[t];s<50?i=1280*s+g.A.RED:s<100?i=g.A.yl-327680*(s-50):s<150&&(i=5*(s-100)+g.A.GREEN)}if(10===this.mo[t]){const s=150-this.Bo[t];s<50?i=5*s+g.A.RED:s<100?i=g.A.qc-327680*(s-50):s<150&&(i=327680*(s-100)+g.A.BLUE-5*(s-100))}if(11===this.mo[t]){const s=150-this.Bo[t];s<50?i=g.A.Za-327685*s:s<100?i=327685*(s-50)+g.A.GREEN:s<150&&(i=g.A.Za-327680*(s-100))}if(0===this.vo[t]&&(this.Ni?.Fc(this.gr,this.Cr+1,r,g.A.dl),this.Ni?.Fc(this.gr,this.Cr,r,i)),1===this.vo[t]&&(this.Ni?.Hc(this.gr,this.Cr+1,r,g.A.dl,this.pn),this.Ni?.Hc(this.gr,this.Cr,r,i,this.pn)),2===this.vo[t]){const s=this.Ni?.Nc(r)??0,e=(150-this.Bo[t])*(s+100)/150;u.A.Ha(this.gr-50,0,this.gr+50,334),this.Ni?.fl(this.gr+50-e,this.Cr+1,r,g.A.dl),this.Ni?.fl(this.gr+50-e,this.Cr,r,i),u.A.Ng()}}else this.Ni?.Fc(this.gr,this.Cr+1,r,g.A.dl),this.Ni?.Fc(this.gr,this.Cr,r,g.A.yl)}};ig=()=>{2===this.Pe&&this.Ys[2]&&(this.fg((this.We-this.Kn<<7)+this.Fe,2*this.He,(this.Ye-this.Zn<<7)+this.Ve),this.gr>-1&&this.ni%20<10&&this.Ys[2].draw(this.gr-12,this.Cr-28))};eg=()=>{const t=507;let i=13;this.qo?this.Ui?.Yc(t,i,'tock',g.A.yl,!0):this.Ni?.Yc(t,i,'tick',g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,"Kit: "+(C.A.Gc?'WebGPU':'CPU'),g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,`Fps: ${this.Fg}, ${this.Vg} ms`,g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,`Draw: ${this.ms.toFixed(1)}, Avg: ${this.Gg.toFixed(1)}, Slow: ${this.Wg.toFixed(1)} ms`,g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,`Occluders: ${H.A.Yg[H.A.Hg]} Active: ${H.A.zg}`,g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'Local Pos: '+(this.io?.x??-1)+', '+(this.io?.z??-1)+', '+(this.io?.y??-1),g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'Camera Pos: '+this.Ln+', '+this.Dn+', '+this.Rn,g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'Camera Angle: '+this.Mn+', '+this.kn,g.A.yl,!0),at.K._t&&(i+=13,this.Ui?.Yc(t,i,'Cutscene Source: '+this.Ir+', '+this.Er+' '+this._r+'; '+this.Tr+', '+this.Or,g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'Cutscene Destination: '+this.Sr+', '+this.mr+' '+this.vr+'; '+this.Br+', '+this.br,g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'Instructions:',g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'- Arrows to move Camera',g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'- Shift to control Source or Dest',g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'- Alt to control Height',g.A.yl,!0),i+=13,this.Ui?.Yc(t,i,'- Ctrl to control Modifier',g.A.yl,!0))};Eg=(t,i,s,e,h,n)=>{const r=this.Wx(s,t,i),o=64*e;this.ug(t-o,r,i-o);const a=this.gr,l=this.Cr;this.ug(t+o,r,i-o);const c=this.gr,f=this.Cr;this.ug(t-o,r,i+o);const d=this.gr,y=this.Cr;this.ug(t+o,r,i+o);const p=this.gr,w=this.Cr;-1!==a&&-1!==c&&-1!==d&&-1!==p&&(n&&(u.A.Xg(a,l,p,w,(16711422&h)>>1),u.A.Xg(c,f,d,y,(16711422&h)>>1)),u.A.Xg(a,l,c,f,h),u.A.Xg(a,l,d,y,h),u.A.Xg(c,f,p,w,h),u.A.Xg(d,y,p,w,h))};Ix(){const t=1==this.hx[5]?2:1;1==this.hx[6]?(1==this.hx[1]?(this.Sr-=t,this.Sr<1&&(this.Sr=1)):1==this.hx[2]&&(this.Sr+=t,this.Sr>102&&(this.Sr=102)),1==this.hx[3]?1==this.hx[7]?this.vr+=2*t:(this.mr+=1,this.mr>102&&(this.mr=102)):1==this.hx[4]&&(1==this.hx[7]?this.vr-=2*t:(this.mr-=1,this.mr<1&&(this.mr=1)))):(1==this.hx[1]?(this.Ir-=t,this.Ir<1&&(this.Ir=1)):1==this.hx[2]&&(this.Ir+=t,this.Ir>102&&(this.Ir=102)),1==this.hx[3]?1==this.hx[7]?this._r+=2*t:(this.Er+=t,this.Er>102&&(this.Er=102)):1==this.hx[4]&&(1==this.hx[7]?this._r-=2*t:(this.Er-=t,this.Er<1&&(this.Er=1)))),this.Ln=128*this.Ir+64,this.Dn=128*this.Er+64,this.Rn=this.Wx(this.er,this.Ir,this.Er)-this._r;const i=128*this.Sr+64,s=128*this.mr+64,e=this.Wx(this.er,this.Sr,this.mr)-this.vr,h=i-this.Ln,n=e-this.Rn,r=s-this.Dn,o=0|Math.sqrt(h*h+r*r);this.kn=325.949*Math.atan2(n,o)&2047,this.Mn=-325.949*Math.atan2(h,r)&2047,this.kn<128&&(this.kn=128),this.kn>383&&(this.kn=383)}ng=()=>{if(this.Kg(),1===this.Ae&&this.zs[this.xe/100|0]?.draw(this.ge-8-8,this.Ce-8-11),2===this.Ae&&this.zs[4+(this.xe/100|0)]?.draw(this.ge-8-8,this.Ce-8-11),-1!==this.pe&&(this.Ma(this.pe,this.yn),this.Ya(c.A.ta[this.pe],0,0,0)),this.Zg(),this.me?0===this.ve&&this.jg():(this.lx(),this.qg()),1===this.eo&&(this.oo>0||1===this.ao?this.Ys[1]?.draw(472,258):this.Ys[1]?.draw(472,296)),this.oo>0&&(this.Ys[0]?.draw(472,296),this.Pi?.Fc(484,329,'Level: '+this.oo,g.A.yl)),1===this.ao&&(this.Ys[6]?.draw(472,296),this.Pi?.Fc(484,329,'Arena',g.A.yl)),0!==this.di){let t=this.di/50|0;const i=t/60|0;t%=60,t<10?this.Pi?.fl(4,329,'System update in: '+i+':0'+t,g.A.yl):this.Pi?.fl(4,329,'System update in: '+i+':'+t,g.A.yl)}};Kg=()=>{if(0===this.wh)return;const t=this.Pi;let i=0;0!==this.di&&(i=1);for(let s=0;s<100;s++){if(!this.uh[s])continue;const e=this.messageType[s];let h;if((3===e||7===e)&&(7===e||0===this.th||1===this.th&&this.pg(this.dh[s]))&&(h=329-13*i,t?.fl(4,h,'From '+this.dh[s]+': '+this.uh[s],g.A.dl),t?.fl(4,h-1,'From '+this.dh[s]+': '+this.uh[s],g.A.jc),i++,i>=5))return;if(5===e&&this.th<2&&(h=329-13*i,t?.fl(4,h,this.uh[s],g.A.dl),t?.fl(4,h-1,this.uh[s],g.A.jc),i++,i>=5))return;if(6===e&&this.th<2&&(h=329-13*i,t?.fl(4,h,'To '+this.dh[s]+': '+this.uh[s],g.A.dl),t?.fl(4,h-1,'To '+this.dh[s]+': '+this.uh[s],g.A.jc),i++,i>=5))return}};Zg=()=>{if(!this.io)return;const t=(this.io.x>>7)+this.Kn,i=(this.io.z>>7)+this.Zn;if(this.oo=t>=2944&&t<3392&&i>=3520&&i<6400?1+((i-3520)/8|0):t>=2944&&t<3392&&i>=9920&&i<12800?1+((i-9920)/8|0):0,this.ao=0,t>=3328&&t<3392&&i>=3200&&i<3264){const s=63&t,e=63&i;(s>=4&&s<=29&&e>=44&&e<=58||s>=36&&s<=61&&e>=44&&e<=58||s>=4&&s<=29&&e>=25&&e<=39||s>=36&&s<=61&&e>=25&&e<=39||s>=4&&s<=29&&e>=6&&e<=20||s>=36&&s<=61&&e>=6&&e<=20)&&(this.ao=1)}0===this.ao&&t>=3328&&t<=3393&&i>=3203&&i<=3325&&(this.ao=2),this.Se=0,(t>=3053&&t<=3156&&i>=3056&&i<=3136||t>=3072&&t<=3118&&i>=9492&&i<=9535)&&(this.Se=1),1===this.Se&&t>=3139&&t<=3199&&i>=3008&&i<=3062&&(this.Se=0)};Rx=()=>{this.hs?.bind(),this.Bs&&(d.A.wA=this.Bs),this.Os?.draw(0,0),-1!==this.Oe?this.Ya(c.A.ta[this.Oe],0,0,0):-1!==this.Je[this.$e]&&this.Ya(c.A.ta[this.Je[this.$e]],0,0,0),this.me&&1===this.ve&&this.jg(),this.hs?.draw(562,231),this.rs?.bind(),this.bs&&(d.A.wA=this.bs)};kx=()=>{if(this.os?.bind(),this.vs&&(d.A.wA=this.vs),this.Ls?.draw(0,0),this.hh)this.Ni?.Fc(239,40,this.nh,g.A.dl),this.Ni?.Fc(239,60,this.rh+'*',g.A.Qc);else if(this.lh)this.Ni?.Fc(239,40,'Enter amount:',g.A.dl),this.Ni?.Fc(239,60,this.ah+'*',g.A.Qc);else if(this.je)this.Ni?.Fc(239,40,this.je,g.A.dl),this.Ni?.Fc(239,60,'Click to continue',g.A.Qc);else if(-1!==this.Le)this.Ya(c.A.ta[this.Le],0,0,0);else if(-1===this.fh){let t=this.Pi;0===at.K.Et&&(t=this.Fi);let i=0;u.A.Ha(0,0,463,77);for(let s=0;s<100;s++){const e=this.uh[s];if(!e)continue;const h=this.messageType[s],n=this.ke+70-14*i;0===h&&(n>0&&n<110&&t?.fl(4,n,e,g.A.dl),i++),1===h&&(n>0&&n<110&&(t?.fl(4,n,this.dh[s]+':',g.A.Za),t?.fl(t.Nc(this.dh[s])+12,n,e,g.A.BLUE)),i++),2===h&&(0===this.Qe||1===this.Qe&&this.pg(this.dh[s]))&&(n>0&&n<110&&(t?.fl(4,n,this.dh[s]+':',g.A.dl),t?.fl(t.Nc(this.dh[s])+12,n,e,g.A.BLUE)),i++),3!==h&&7!==h||0!==this.wh||!(7===h||0===this.th||1===this.th&&this.pg(this.dh[s]))||(n>0&&n<110&&(t?.fl(4,n,'From '+this.dh[s]+':',g.A.dl),t?.fl(t.Nc('From '+this.dh[s])+12,n,e,g.A.Jc)),i++),4===h&&(0===this.ih||1===this.ih&&this.pg(this.dh[s]))&&(n>0&&n<110&&t?.fl(4,n,this.dh[s]+' '+this.uh[s],g.A.$g),i++),5===h&&0===this.wh&&this.th<2&&(n>0&&n<110&&t?.fl(4,n,e,g.A.Jc),i++),6===h&&0===this.wh&&this.th<2&&(n>0&&n<110&&(t?.fl(4,n,'To '+this.dh[s]+':',g.A.dl),t?.fl(t.Nc('To '+this.dh[s])+12,n,e,g.A.Jc)),i++),8===h&&(0===this.ih||1===this.ih&&this.pg(this.dh[s]))&&(n>0&&n<110&&t?.fl(4,n,this.dh[s]+' '+this.uh[s],g.A.Jg),i++)}u.A.Ng(),this.De=14*i+7,this.De<78&&(this.De=78),this._a(463,0,this.De-this.ke-77,this.De,77),0==at.K.Et?t?.fl(3,90,this.xh+'*',g.A.dl):1==at.K.Et?t?.fl(3,90,this.xh+'*',g.A.BLUE):(t?.fl(4,90,W.A.ql(this.username)+':',g.A.dl),t?.fl(t.Nc(this.username+': ')+6,90,this.xh+'*',g.A.BLUE)),u.A.Da(0,77,g.A.dl,479)}else this.Ya(c.A.ta[this.fh],0,0,0);this.me&&2===this.ve&&this.jg(),this.os?.draw(22,375),this.rs?.bind(),this.bs&&(d.A.wA=this.bs)};Mx=()=>{if(this.ns?.bind(),!this.io)return;const t=this.rr+this.Nn&2047;let i=48+(this.io.x/32|0),s=464-(this.io.z/32|0);this.Ns?.Qg(21,9,146,151,this._s,this.Ts,i,s,t,(this.Fn+256)*Ct.A.tC),this.Fs?.Qg(0,0,33,33,this.Is,this.Es,25,25,this.rr,256);for(let t=0;t<this.ln;t++)i=(4*this.cn[t]+2-(this.io.x/32|0))/Ct.A.tC|0,s=(4*this.fn[t]+2-(this.io.z/32|0))/Ct.A.tC|0,this.iC(s,this.ce[t],i);for(let t=0;t<$.A.Ar;t++)for(let e=0;e<$.A.Ar;e++){this.Xr[this.er][t][e]&&(i=(4*t+2-(this.io.x/32|0))/Ct.A.tC|0,s=(4*e+2-(this.io.z/32|0))/Ct.A.tC|0,this.iC(s,this.Xs,i))}for(let t=0;t<this.Vr;t++){const e=this.Fr[this.Gr[t]];e&&e.isVisible()&&e.type&&e.type.sC&&(i=((e.x/32|0)-(this.io.x/32|0))/Ct.A.tC|0,s=((e.z/32|0)-(this.io.z/32|0))/Ct.A.tC|0,this.iC(s,this.Ks,i))}for(let t=0;t<this.Rr;t++){const e=this.Lr[this.Dr[t]];if(e&&e.isVisible()&&e.name){i=((e.x/32|0)-(this.io.x/32|0))/Ct.A.tC|0,s=((e.z/32|0)-(this.io.z/32|0))/Ct.A.tC|0;let t=!1;const h=W.A.eC(e.name);for(let i=0;i<this.yo;i++)if(h===this.Eo[i]&&0!==this._o[i]){t=!0;break}t?this.iC(s,this.js,i):this.iC(s,this.Zs,i)}}0!==this.wn&&(i=(4*this.wn+2-(this.io.x/32|0))/Ct.A.tC|0,s=(4*this.An+2-(this.io.z/32|0))/Ct.A.tC|0,this.iC(s,this.Hs,i)),u.A.fillRect(93,82,3,3,g.A.Za),this.rs?.bind()};iC=(t,i,s)=>{if(!i)return;const e=this.rr+this.Nn&2047,h=s*s+t*t;if(h>6400)return;let n=d.A.sin[e],r=d.A.cos[e];n=256*n*Ct.A.tC/((this.Fn+256)*Ct.A.tC)|0,r=256*r*Ct.A.tC/((this.Fn+256)*Ct.A.tC)|0;const o=t*n+s*r>>16,a=t*r-s*n>>16;h>2500&&this.Rs?i.hC(o+94-(i.cl/2|0),83-a-(i.nC/2|0),this.Rs):i.draw(o+94-(i.cl/2|0),83-a-(i.nC/2|0))};rC=t=>{if(!this.Ns)return;const i=this.Ns.Kc,s=i.length;for(let t=0;t<s;t++)i[t]=0;for(let s=1;s<$.A.Ar-1;s++){let e=512*($.A.Ar-1-s)*4+24628;for(let h=1;h<$.A.Ar-1;h++)!this.yr||24&this.yr[t][h][s]||this.un?.oC(t,h,s,i,e,512),t<3&&this.yr&&8&this.yr[t+1][h][s]&&this.un?.oC(t+1,h,s,i,e,512),e+=4}const e=(238+(20*Math.random()|0)-10<<16)+(238+(20*Math.random()|0)-10<<8)+(20*Math.random()|0)+238-10,n=238+(20*Math.random()|0)-10<<16;this.Ns.bind();for(let i=1;i<$.A.Ar-1;i++)for(let s=1;s<$.A.Ar-1;s++)!this.yr||24&this.yr[t][s][i]||this.aC(s,i,t,e,n),t<3&&this.yr&&8&this.yr[t+1][s][i]&&this.aC(s,i,t+1,e,n);this.rs?.bind(),this.ln=0;for(let t=0;t<$.A.Ar;t++)for(let i=0;i<$.A.Ar;i++){let s=this.un?.lC(this.er,t,i)??0;if(0===s)continue;s=s>>14&32767;const e=h.A.get(s).cC;if(e<0)continue;let n=t,r=i;if(22!==e&&29!==e&&34!==e&&36!==e&&46!==e&&47!==e&&48!==e){const s=$.A.Ar,e=$.A.Ar,h=this.ir[this.er];if(h){const o=h.flags;for(let h=0;h<10;h++){const h=4*Math.random()|0;0===h&&n>0&&n>t-3&&(o[$.A.index(n-1,r)]&J.A.fC)===J.A.OPEN&&n--,1===h&&n<s-1&&n<t+3&&(o[$.A.index(n+1,r)]&J.A.uC)===J.A.OPEN&&n++,2===h&&r>0&&r>i-3&&(o[$.A.index(n,r-1)]&J.A.dC)===J.A.OPEN&&r--,3===h&&r<e-1&&r<i+3&&(o[$.A.index(n,r+1)]&J.A.yC)===J.A.OPEN&&r++}}}this.ce[this.ln]=this.Gs[e],this.cn[this.ln]=n,this.fn[this.ln]=r,this.ln++}};aC=(t,i,s,e,n)=>{if(!this.un||!this.Ns)return;let r=this.un.pC(s,t,i);if(0!==r){const o=this.un.wC(s,t,i,r),a=o>>6&3,l=31&o;let c=e;r>0&&(c=n);const f=this.Ns.Kc,u=4*t+512*(103-i)*4+24624,d=r>>14&32767,y=h.A.get(d);if(-1===y.AC)l!==K.A.xC.id&&l!==K.A.gC.id||(a===Z.A.CC?(f[u]=c,f[u+512]=c,f[u+1024]=c,f[u+1536]=c):a===Z.A.SC?(f[u]=c,f[u+1]=c,f[u+2]=c,f[u+3]=c):a===Z.A.mC?(f[u+3]=c,f[u+3+512]=c,f[u+3+1024]=c,f[u+3+1536]=c):a===Z.A.vC&&(f[u+1536]=c,f[u+1536+1]=c,f[u+1536+2]=c,f[u+1536+3]=c)),l===K.A.BC.id&&(a===Z.A.CC?f[u]=c:a===Z.A.SC?f[u+3]=c:a===Z.A.mC?f[u+3+1536]=c:a===Z.A.vC&&(f[u+1536]=c)),l===K.A.gC.id&&(a===Z.A.vC?(f[u]=c,f[u+512]=c,f[u+1024]=c,f[u+1536]=c):a===Z.A.CC?(f[u]=c,f[u+1]=c,f[u+2]=c,f[u+3]=c):a===Z.A.SC?(f[u+3]=c,f[u+3+512]=c,f[u+3+1024]=c,f[u+3+1536]=c):a===Z.A.mC&&(f[u+1536]=c,f[u+1536+1]=c,f[u+1536+2]=c,f[u+1536+3]=c));else{const s=this.Vs[y.AC];if(s){const e=(4*y.width-s.width)/2|0,h=(4*y.length-s.height)/2|0;s.draw(4*t+48+e,4*($.A.Ar-i-y.length)+h+48)}}}if(r=this.un.bC(s,t,i),0!==r){const e=this.un.wC(s,t,i,r),n=e>>6&3,o=31&e,a=r>>14&32767,l=h.A.get(a);if(-1!==l.AC){const s=this.Vs[l.AC];if(s){const e=(4*l.width-s.width)/2|0,h=(4*l.length-s.height)/2|0;s.draw(4*t+48+e,4*($.A.Ar-i-l.length)+h+48)}}else if(o===K.A.IC.id){let s=15658734;r>0&&(s=15597568);const e=this.Ns.Kc,h=4*t+512*($.A.Ar-1-i)*4+24624;n===Z.A.CC||n===Z.A.mC?(e[h+1536]=s,e[h+1024+1]=s,e[h+512+2]=s,e[h+3]=s):(e[h]=s,e[h+512+1]=s,e[h+1024+2]=s,e[h+1536+3]=s)}}if(r=this.un.lC(s,t,i),0!==r){const s=h.A.get(r>>14&32767);if(-1!==s.AC){const e=this.Vs[s.AC];if(e){const h=(4*s.width-e.width)/2|0,n=(4*s.length-e.height)/2|0;e.draw(4*t+48+h,4*($.A.Ar-i-s.length)+n+48)}}}};qg=()=>{if(this._e<2&&0===this.Oh&&0===this.Wh)return;let t;t=1===this.Oh&&this._e<2?'Use '+this.kh+' with...':1===this.Wh&&this._e<2?this.zh+'...':this.Te[this._e-1],this._e>2&&(t=t+'@whi@ / '+(this._e-2)+' more options'),this.Ni?.Vc(4,15,t,g.A.Za,!0,this.ni/1e3|0)};jg=()=>{const t=this.Be,i=this.be,s=this.Ie,e=this.Ee,h=g.A.EC;u.A.fillRect(t,i,s,e,h),u.A.fillRect(t+1,i+1,s-2,16,g.A.dl),u.A.Ka(t+1,i+18,s-2,e-19,g.A.dl),this.Ni?.fl(t+3,i+14,'Choose Option',h);let n=this.ol,r=this.al;0===this.ve&&(n-=8,r-=11),1===this.ve&&(n-=562,r-=231),2===this.ve&&(n-=22,r-=375);for(let e=0;e<this._e;e++){const h=i+15*(this._e-1-e)+31;let o=g.A.Za;n>t&&n<t+s&&r>h-13&&r<h+3&&(o=g.A.yl),this.Ni?._l(t+3,h,this.Te[e],o,!0)}};mx=async()=>{if(0!==this.bh)return;let t=this.MA;if(1===this.Wh&&this.UA>=520&&this.PA>=165&&this.UA<=788&&this.PA<=230&&(t=0),this.me){if(1!==t){let t=this.ol,i=this.al;0===this.ve?(t-=8,i-=11):1===this.ve?(t-=562,i-=231):2===this.ve&&(t-=22,i-=375),(t<this.Be-10||t>this.Be+this.Ie+10||i<this.be-10||i>this.be+this.Ee+10)&&(this.me=!1,1===this.ve&&(this.fe=!0),2===this.ve&&(this.ue=!0))}if(1===t){const t=this.Be,i=this.be,s=this.Ie;let e=this.UA,h=this.PA;0===this.ve?(e-=8,h-=11):1===this.ve?(e-=562,h-=231):2===this.ve&&(e-=22,h-=375);let n=-1;for(let r=0;r<this._e;r++){const o=i+15*(this._e-1-r)+31;e>t&&e<t+s&&h>o-13&&h<o+3&&(n=r)}-1!==n&&await this.wx(n),this.me=!1,1===this.ve?this.fe=!0:2===this.ve&&(this.ue=!0)}}else{if(1===t&&this._e>0){const t=this.Kh[this._e-1];if(602===t||596===t||22===t||892===t||415===t||405===t||38===t||422===t||478===t||347===t||188===t){const t=this.jh[this._e-1],i=this.qh[this._e-1];if(c.A.ta[i].draggable&&(!Ct.A.ox||Ct.A.ox&&0==this.hx[6]))return this.Th=!1,this._h=0,this.mh=i,this.Bh=t,this.bh=2,this.Ih=this.UA,this.Eh=this.PA,c.A.ta[i].aw===this.pe&&(this.bh=1),void(c.A.ta[i].aw===this.Le&&(this.bh=3))}}if(1===t&&(1===this.Xh||this.ux(this._e-1))&&this._e>2&&(t=2),1===t&&this._e>0&&await this.wx(this._e-1),2!==t||this._e<=0)return;this.yx()}};vx=()=>{if(1===this.MA&&this.io){let t=this.UA-21-561,i=this.PA-9-5;if(t>=0&&i>=0&&t<146&&i<151){t-=73,i-=75;const s=this.rr+this.Nn&2047;let e=d.A.sin[s],h=d.A.cos[s];e=e*((this.Fn+256)*Ct.A.tC)>>8,h=h*((this.Fn+256)*Ct.A.tC)>>8;const n=i*e+t*h>>11,r=i*h-t*e>>11,o=this.io.x+n>>7,a=this.io.z-r>>7;this.gx(this.io.Cx[0],this.io.Sx[0],o,a,1,0,0,0,0,0,!0)&&(this.ai.p1(t),this.ai.p1(i),this.ai.p2(this.rr),this.ai.p1(57),this.ai.p1(this.Nn),this.ai.p1(this.Fn),this.ai.p1(89),this.ai.p2(this.io.x),this.ai.p2(this.io.z),this.ai.p1(this.Qr),this.ai.p1(63))}}};ux=t=>{if(t<0)return!1;let i=this.Kh[t];return i>=2e3&&(i-=2e3),406===i};wx=async t=>{if(t<0)return;this.lh&&(this.lh=!1,this.ue=!0);let i=this.Kh[t];const s=this.Zh[t],e=this.jh[t],r=this.qh[t];if(i>=2e3&&(i-=2e3),903===i||363===i){let s=this.Te[t];const e=s.indexOf('@whi@');if(-1!==e){s=s.substring(e+5).trim();const t=W.A.ql(W.A.$l(W.A.eC(s)));let h=!1;for(let s=0;s<this.Rr;s++){const e=this.Lr[this.Dr[s]];if(e&&e.name&&e.name.toLowerCase()===t.toLowerCase()&&this.io){this.gx(this.io.Cx[0],this.io.Sx[0],e.Cx[0],e.Sx[0],2,1,1,0,0,0,!1),903===i?this.ai.$A(k.Fd):363===i&&this.ai.$A(k.Ud),this.ai.p2(this.Dr[s]),h=!0;break}}h||this._C(0,'Unable to find '+t,'')}}else if(450===i&&this.TC(k.Md,e,r,s))this.ai.p2(this.Dh),this.ai.p2(this.Lh),this.ai.p2(this.Rh);else if(405===i||38===i||422===i||478===i||347===i)478===i?(3&e||at.K.Gt++,at.K.Gt>=90&&this.ai.$A(k.ed),this.ai.$A(k.zd)):347===i?this.ai.$A(k.Xd):422===i?this.ai.$A(k.Hd):405===i?(at.K.Ft+=s,at.K.Ft>=97&&(this.ai.$A(k.td),this.ai.p3(14953816)),this.ai.$A(k.Wd)):38===i&&this.ai.$A(k.Yd),this.ai.p2(s),this.ai.p2(e),this.ai.p2(r),this.Nh=0,this.Ph=r,this.Uh=e,this.Mh=2,c.A.ta[r].aw===this.pe&&(this.Mh=1),c.A.ta[r].aw===this.Le&&(this.Mh=3);else if(728===i||542===i||6===i||963===i||245===i){const t=this.Fr[s];t&&this.io&&(this.gx(this.io.Cx[0],this.io.Sx[0],t.Cx[0],t.Sx[0],2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,542===i?this.ai.$A(k.vd):6===i?(3&s||at.K.Nt++,at.K.Nt>=124&&(this.ai.$A(k.Qu),this.ai.p4(0)),this.ai.$A(k.Bd)):963===i?this.ai.$A(k.bd):728===i?this.ai.$A(k.md):245===i&&(3&s||at.K.Vt++,at.K.Vt>=85&&(this.ai.$A(k.sd),this.ai.p2(39596)),this.ai.$A(k.Id)),this.ai.p2(s))}else if(217===i){if(this.io){this.gx(this.io.Cx[0],this.io.Sx[0],e,r,2,0,0,0,0,0,!1)||this.gx(this.io.Cx[0],this.io.Sx[0],e,r,2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,this.ai.$A(k.Sd),this.ai.p2(e+this.Kn),this.ai.p2(r+this.Zn),this.ai.p2(s),this.ai.p2(this.Dh),this.ai.p2(this.Lh),this.ai.p2(this.Rh)}}else if(1175===i){const t=s>>14&32767,i=h.A.get(t);let e;e=i.OC?i.OC:"It's a "+i.name+'.',this._C(0,e,'')}else if(285===i)this.TC(k.Td,e,r,s);else if(881===i)this.ai.$A(k.Zd),this.ai.p2(s),this.ai.p2(e),this.ai.p2(r),this.ai.p2(this.Dh),this.ai.p2(this.Lh),this.ai.p2(this.Rh),this.Nh=0,this.Ph=r,this.Uh=e,this.Mh=2,c.A.ta[r].aw===this.pe&&(this.Mh=1),c.A.ta[r].aw===this.Le&&(this.Mh=3);else if(391===i)this.ai.$A(k.Kd),this.ai.p2(s),this.ai.p2(e),this.ai.p2(r),this.ai.p2(this.Yh),this.Nh=0,this.Ph=r,this.Uh=e,this.Mh=2,c.A.ta[r].aw===this.pe&&(this.Mh=1),c.A.ta[r].aw===this.Le&&(this.Mh=3);else if(660===i)this.me?this.un?.click(e-8,r-11):this.un?.click(this.UA-8,this.PA-11);else{if(188===i)return this.Oh=1,this.Lh=e,this.Rh=r,this.Dh=s,this.kh=n.A.get(s).name,void(this.Wh=0);if(44===i)this.Fh||(this.ai.$A(k.iy),this.ai.p2(r),this.Fh=!0);else if(1773===i){const t=n.A.get(s);let i;i=r>=1e5?r+' x '+t.name:t.OC?t.OC:"It's a "+t.name+'.',this._C(0,i,'')}else if(900===i){const t=this.Fr[s];t&&this.io&&(this.gx(this.io.Cx[0],this.io.Sx[0],t.Cx[0],t.Sx[0],2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,this.ai.$A(k._d),this.ai.p2(s),this.ai.p2(this.Dh),this.ai.p2(this.Lh),this.ai.p2(this.Rh))}else if(1373===i||1544===i||151===i||1101===i){const t=this.Lr[s];t&&this.io&&(this.gx(this.io.Cx[0],this.io.Sx[0],t.Cx[0],t.Sx[0],2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,1101===i?this.ai.$A(k.Ud):151===i?(at.K.Ht++,at.K.Ht>=90&&(this.ai.$A(k.rd),this.ai.p2(31114)),this.ai.$A(k.Pd)):1373===i?this.ai.$A(k.Fd):1544===i&&this.ai.$A(k.Nd),this.ai.p2(s))}else if(265===i){const t=this.Fr[s];t&&this.io&&(this.gx(this.io.Cx[0],this.io.Sx[0],t.Cx[0],t.Sx[0],2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,this.ai.$A(k.Ed),this.ai.p2(s),this.ai.p2(this.Yh))}else if(679===i){const i=this.Te[t],s=i.indexOf('@whi@');if(-1!==s){const t=W.A.eC(i.substring(s+5).trim());let e=-1;for(let i=0;i<this.yo;i++)if(this.Eo[i]===t){e=i;break}-1!==e&&this._o[e]>0&&(this.ue=!0,this.lh=!1,this.hh=!0,this.rh='',this.oh=3,this.To=this.Eo[e],this.nh='Enter message to send to '+this.Io[e])}}else if(55===i)this.TC(k.kd,e,r,s)&&this.ai.p2(this.Yh);else if(224===i||993===i||99===i||746===i||877===i){if(this.io){this.gx(this.io.Cx[0],this.io.Sx[0],e,r,2,0,0,0,0,0,!1)||this.gx(this.io.Cx[0],this.io.Sx[0],e,r,2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,224===i?this.ai.$A(k.pd):746===i?this.ai.$A(k.xd):877===i?this.ai.$A(k.gd):99===i?this.ai.$A(k.Ad):993===i&&this.ai.$A(k.wd),this.ai.p2(e+this.Kn),this.ai.p2(r+this.Zn),this.ai.p2(s)}}else if(1607===i){const t=this.Fr[s];if(t&&t.type){let i;i=t.type.OC?t.type.OC:"It's a "+t.type.name+'.',this._C(0,i,'')}}else if(504===i)this.TC(k.Od,e,r,s);else{if(930===i){const t=c.A.ta[r];this.Wh=1,this.Yh=r,this.Hh=t.LC,this.Oh=0;let i=t.RC;i&&-1!==i.indexOf(' ')&&(i=i.substring(0,i.indexOf(' ')));let s=t.RC;return s&&-1!==s.indexOf(' ')&&(s=s.substring(s.indexOf(' ')+1)),this.zh=i+' '+t.action+' '+s,void(16===this.Hh&&(this.fe=!0,this.$e=3,this.de=!0))}if(951===i){const t=c.A.ta[r];let i=!0;t.ja>0&&(i=this.DC(t)),i&&(this.ai.$A(k.ty),this.ai.p2(r))}else if(602===i||596===i||22===i||892===i||415===i)22===i?this.ai.$A(k.$d):415===i?(3&r||at.K.Yt++,at.K.Yt>=55&&(this.ai.$A(k.nd),this.ai.p4(0)),this.ai.$A(k.Qd)):602===i?this.ai.$A(k.jd):892===i?(3&e||at.K.zt++,at.K.zt>=130&&(this.ai.$A(k.od),this.ai.p1(177)),this.ai.$A(k.Jd)):596===i&&this.ai.$A(k.qd),this.ai.p2(s),this.ai.p2(e),this.ai.p2(r),this.Nh=0,this.Ph=r,this.Uh=e,this.Mh=2,c.A.ta[r].aw===this.pe&&(this.Mh=1),c.A.ta[r].aw===this.Le&&(this.Mh=3);else if(581===i)3&s||at.K.Pt++,at.K.Pt>=99&&(this.ai.$A(k.Ju),this.ai.p4(0)),this.TC(k.Rd,e,r,s);else if(965===i){if(this.io){this.gx(this.io.Cx[0],this.io.Sx[0],e,r,2,0,0,0,0,0,!1)||this.gx(this.io.Cx[0],this.io.Sx[0],e,r,2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,this.ai.$A(k.Cd),this.ai.p2(e+this.Kn),this.ai.p2(r+this.Zn),this.ai.p2(s),this.ai.p2(this.Yh)}}else if(1501===i)at.K.Wt+=this.Zn,at.K.Wt>=92&&(this.ai.$A(k.hd),this.ai.p4(0)),this.TC(k.Dd,e,r,s);else if(364===i)this.TC(k.Ld,e,r,s);else if(1102===i){const t=n.A.get(s);let i;i=t.OC?t.OC:"It's a "+t.name+'.',this._C(0,i,'')}else if(960===i){this.ai.$A(k.ty),this.ai.p2(r);const t=c.A.ta[r];if(t.scripts&&t.scripts[0]&&5===t.scripts[0][0]){const i=t.scripts[0][1];t.Ea&&this.Vh[i]!==t.Ea[0]&&(this.Vh[i]=t.Ea[0],await this.kC(i),this.fe=!0)}}else if(34===i){const i=this.Te[t],s=i.indexOf('@whi@');if(-1!==s){this.MC(),this.tn=i.substring(s+5).trim(),this.sn=!1;for(let t=0;t<c.A.ta.length;t++)if(c.A.ta[t]&&c.A.ta[t].ja===c.A.cc){this.en=this.pe=c.A.ta[t].aw;break}}}else if(947===i)this.MC();else if(367===i){const t=this.Lr[s];t&&this.io&&(this.gx(this.io.Cx[0],this.io.Sx[0],t.Cx[0],t.Sx[0],2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,this.ai.$A(k.Gd),this.ai.p2(s),this.ai.p2(this.Dh),this.ai.p2(this.Lh),this.ai.p2(this.Rh))}else if(465===i){this.ai.$A(k.ty),this.ai.p2(r);const t=c.A.ta[r];if(t.scripts&&t.scripts[0]&&5===t.scripts[0][0]){const i=t.scripts[0][1];this.Vh[i]=1-this.Vh[i],await this.kC(i),this.fe=!0}}else if(406===i||436===i||557===i||556===i){const s=this.Te[t],e=s.indexOf('@whi@');if(-1!==e){const t=W.A.eC(s.substring(e+5).trim());406===i?this.UC(t):436===i?this.PC(t):557===i?this.NC(t):556===i&&this.FC(t)}}else if(651===i){const t=this.Lr[s];t&&this.io&&(this.gx(this.io.Cx[0],this.io.Sx[0],t.Cx[0],t.Sx[0],2,1,1,0,0,0,!1),this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,this.ai.$A(k.Vd),this.ai.p2(s),this.ai.p2(this.Yh))}}}this.Oh=0,this.Wh=0};DC=t=>{const i=t.ja;if(i===c.A.VC&&(this.ue=!0,this.lh=!1,this.hh=!0,this.rh='',this.oh=1,this.nh='Enter name of friend to add to list'),i===c.A.GC&&(this.ue=!0,this.lh=!1,this.hh=!0,this.rh='',this.oh=2,this.nh='Enter name of friend to delete from list'),i===c.A.WC)return this.ui=250,!0;if(i===c.A.YC&&(this.ue=!0,this.lh=!1,this.hh=!0,this.rh='',this.oh=4,this.nh='Enter name of player to add to list'),i===c.A.HC&&(this.ue=!0,this.lh=!1,this.hh=!0,this.rh='',this.oh=5,this.nh='Enter name of player to delete from list'),i>=c.A.zC&&i<=c.A.XC){const t=(i-300)/2|0,s=1&i;let e=this.uo[t];if(-1!==e)for(;;)if(0===s&&(e--,e<0&&(e=o.A.count-1)),1===s&&(e++,e>=o.A.count&&(e=0)),!o.A.ta[e].disable&&o.A.ta[e].type===t+(this.co?0:7)){this.uo[t]=e,this.fo=!0;break}}if(i>=c.A.KC&&i<=c.A.ZC){const t=(i-314)/2|0,s=1&i;let e=this.do[t];0===s&&(e--,e<0&&(e=Q.A.sc[t].length-1)),1===s&&(e++,e>=Q.A.sc[t].length&&(e=0)),this.do[t]=e,this.fo=!0}if(i!==c.A.ac||this.co||(this.co=!0,this.KA()),i===c.A.lc&&this.co&&(this.co=!1,this.KA()),i===c.A.jC){this.ai.$A(k.wy),this.ai.p1(this.co?0:1);for(let t=0;t<7;t++)this.ai.p1(this.uo[t]);for(let t=0;t<5;t++)this.ai.p1(this.do[t]);return!0}return i===c.A.fc&&(this.sn=!this.sn),i>=c.A.qC&&i<=c.A.$C&&(this.MC(),this.tn.length>0&&(this.ai.$A(k.oy),this.ai.JC(W.A.eC(this.tn)),this.ai.p1(i-601),this.ai.p1(this.sn?1:0))),!1};KA=()=>{this.fo=!0;for(let t=0;t<7;t++){this.uo[t]=-1;for(let i=0;i<o.A.count;i++)if(!o.A.ta[i].disable&&o.A.ta[i].type===t+(this.co?0:7)){this.uo[t]=i;break}}};TC=(t,i,s,e)=>{if(!this.io||!this.un)return!1;const n=e>>14&32767,r=this.un.wC(this.er,i,s,e);if(-1===r)return!1;const o=31&r,a=r>>6&3;if(o===K.A.QC.id||o===K.A.tS.id||o===K.A.iS.id){const t=h.A.get(n);let e,r;a===Z.A.CC||a===Z.A.mC?(e=t.width,r=t.length):(e=t.length,r=t.width);let o=t.sS;0!==a&&(o=(o<<a&15)+(o>>4-a)),this.gx(this.io.Cx[0],this.io.Sx[0],i,s,2,e,r,0,0,o,!1)}else this.gx(this.io.Cx[0],this.io.Sx[0],i,s,2,0,0,a,o+1,0,!1);return this.ge=this.UA,this.Ce=this.PA,this.Ae=2,this.xe=0,this.ai.$A(t),this.ai.p2(i+this.Kn),this.ai.p2(s+this.Zn),this.ai.p2(n),!0};Bx=()=>{1===this.MA&&(this.UA>=549&&this.UA<=583&&this.PA>=195&&this.PA<231&&-1!==this.Je[0]?(this.fe=!0,this.$e=0,this.de=!0):this.UA>=579&&this.UA<=609&&this.PA>=194&&this.PA<231&&-1!==this.Je[1]?(this.fe=!0,this.$e=1,this.de=!0):this.UA>=607&&this.UA<=637&&this.PA>=194&&this.PA<231&&-1!==this.Je[2]?(this.fe=!0,this.$e=2,this.de=!0):this.UA>=635&&this.UA<=679&&this.PA>=194&&this.PA<229&&-1!==this.Je[3]?(this.fe=!0,this.$e=3,this.de=!0):this.UA>=676&&this.UA<=706&&this.PA>=194&&this.PA<231&&-1!==this.Je[4]?(this.fe=!0,this.$e=4,this.de=!0):this.UA>=704&&this.UA<=734&&this.PA>=194&&this.PA<231&&-1!==this.Je[5]?(this.fe=!0,this.$e=5,this.de=!0):this.UA>=732&&this.UA<=766&&this.PA>=195&&this.PA<231&&-1!==this.Je[6]?(this.fe=!0,this.$e=6,this.de=!0):this.UA>=550&&this.UA<=584&&this.PA>=492&&this.PA<528&&-1!==this.Je[7]?(this.fe=!0,this.$e=7,this.de=!0):this.UA>=582&&this.UA<=612&&this.PA>=492&&this.PA<529&&-1!==this.Je[8]?(this.fe=!0,this.$e=8,this.de=!0):this.UA>=609&&this.UA<=639&&this.PA>=492&&this.PA<529&&-1!==this.Je[9]?(this.fe=!0,this.$e=9,this.de=!0):this.UA>=637&&this.UA<=681&&this.PA>=493&&this.PA<528&&-1!==this.Je[10]?(this.fe=!0,this.$e=10,this.de=!0):this.UA>=679&&this.UA<=709&&this.PA>=492&&this.PA<529&&-1!==this.Je[11]?(this.fe=!0,this.$e=11,this.de=!0):this.UA>=706&&this.UA<=736&&this.PA>=492&&this.PA<529&&-1!==this.Je[12]?(this.fe=!0,this.$e=12,this.de=!0):this.UA>=734&&this.UA<=768&&this.PA>=492&&this.PA<528&&-1!==this.Je[13]&&(this.fe=!0,this.$e=13,this.de=!0),at.K.Lt++,at.K.Lt>150&&(at.K.Lt=0,this.ai.$A(k.ad),this.ai.p1(43)))};Tx=async()=>{for(;;){let t;do{for(;;){if(t=this.FA(),-1===t)return;if(-1!==this.pe&&this.pe===this.en){8===t&&this.tn.length>0&&(this.tn=this.tn.substring(0,this.tn.length-1));break}if(this.hh){if(t>=32&&t<=122&&this.rh.length<80&&(this.rh=this.rh+String.fromCharCode(t),this.ue=!0),8===t&&this.rh.length>0&&(this.rh=this.rh.substring(0,this.rh.length-1),this.ue=!0),13===t||10===t){let t;if(this.hh=!1,this.ue=!0,1===this.oh&&(t=W.A.eC(this.rh),this.UC(t)),2===this.oh&&this.yo>0&&(t=W.A.eC(this.rh),this.NC(t)),3===this.oh&&this.rh.length>0&&this.To){this.ai.$A(k.lu),this.ai.p1(0);const t=this.ai.ft;this.ai.JC(this.To),U.Ep(this.ai,this.rh),this.ai.Hx(this.ai.ft-t),this.rh=W.A.eS(this.rh),this.rh=M.filter(this.rh),this._C(6,this.rh,W.A.ql(W.A.$l(this.To))),2===this.th&&(this.th=1,this.ye=!0,this.ai.$A(k.Ay),this.ai.p1(this.Qe),this.ai.p1(this.th),this.ai.p1(this.ih))}4===this.oh&&this.Me<100&&(t=W.A.eC(this.rh),this.PC(t)),5===this.oh&&this.Me>0&&(t=W.A.eC(this.rh),this.FC(t))}}else if(this.lh){if(t>=48&&t<=57&&this.ah.length<10&&(this.ah=this.ah+String.fromCharCode(t),this.ue=!0),8===t&&this.ah.length>0&&(this.ah=this.ah.substring(0,this.ah.length-1),this.ue=!0),13===t||10===t){if(this.ah.length>0){let t=0;try{t=parseInt(this.ah,10)}catch(t){}this.ai.$A(k.ey),this.ai.p4(t)}this.lh=!1,this.ue=!0}}else if(-1===this.Le&&(t>=32&&t<=126&&this.xh.length<80&&(this.xh=this.xh+String.fromCharCode(t),this.ue=!0),8===t&&this.xh.length>0&&(this.xh=this.xh.substring(0,this.xh.length-1),this.ue=!0),(13===t||10===t)&&this.xh.length>0)){if('::clientdrop'===this.xh)await this.JA();else if(this.lo&&'::noclip'===this.xh)for(let t=0;t<$.A.sr;t++)for(let i=1;i<$.A.Ar-1;i++)for(let s=1;s<$.A.Ar-1;s++){const e=this.ir[t];e&&(e.flags[$.A.index(i,s)]=0)}else if('::entityoverlay'===this.xh)Ct.A.Bg=!Ct.A.Bg;else if('::roofs'===this.xh)Ct.A.hS=!Ct.A.hS;else if('::nodrag'===this.xh)Ct.A.ox=!Ct.A.ox;else if('::tilemarkers'===this.xh)Ct.A.Ug=!Ct.A.Ug;else if('::debug'===this.xh)Ct.A.sg=!Ct.A.sg;else if('::gpu'===this.xh)if(C.A.Gc)C.A.Sa();else try{C.A.Gc=await gt.O.init(xt.nS,this.width,this.height),C.A.Gc||this._C(0,'Failed to enable webgpu','')}catch(t){t instanceof Error&&this._C(0,'Error enabling webgpu: '+t.message,''),console.error('Failed creating webgpu renderer',t)}else if('::chat'===this.xh)at.K.Et=(at.K.Et+1)%3;else if('::peer'===this.xh)999==+at.K.getParameter('world')&&this.ca();else if(this.xh.startsWith('::fps '))try{this.rS(parseInt(this.xh.substring(6),10))}catch(t){}else if(this.xh.startsWith('::camera'))at.K._t=!at.K._t,this.xn=at.K._t,this.Sr=52,this.mr=52,this.Ir=52,this.Er=52,this._r=1e3,this.vr=1e3;else if(this.xh.startsWith('::camsrc ')){const t=this.xh.split(' ');3===t.length?(this.Ir=parseInt(t[1],10),this.Er=parseInt(t[2],10)):4===t.length&&(this.Ir=parseInt(t[1],10),this.Er=parseInt(t[2],10),this._r=parseInt(t[3],10))}else if(this.xh.startsWith('::camdst ')){const t=this.xh.split(' ');3===t.length?(this.Sr=parseInt(t[1],10),this.mr=parseInt(t[2],10)):4===t.length&&(this.Sr=parseInt(t[1],10),this.mr=parseInt(t[2],10),this.vr=parseInt(t[3],10))}if(this.xh.startsWith('::'))this.ai.$A(k.Cy),this.ai.p1(this.xh.length-1),this.ai.WA(this.xh.substring(2));else{let t=0;this.xh.startsWith('yellow:')?(t=0,this.xh=this.xh.substring(7)):this.xh.startsWith('red:')?(t=1,this.xh=this.xh.substring(4)):this.xh.startsWith('green:')?(t=2,this.xh=this.xh.substring(6)):this.xh.startsWith('cyan:')?(t=3,this.xh=this.xh.substring(5)):this.xh.startsWith('purple:')?(t=4,this.xh=this.xh.substring(7)):this.xh.startsWith('white:')?(t=5,this.xh=this.xh.substring(6)):this.xh.startsWith('flash1:')?(t=6,this.xh=this.xh.substring(7)):this.xh.startsWith('flash2:')?(t=7,this.xh=this.xh.substring(7)):this.xh.startsWith('flash3:')?(t=8,this.xh=this.xh.substring(7)):this.xh.startsWith('glow1:')?(t=9,this.xh=this.xh.substring(6)):this.xh.startsWith('glow2:')?(t=10,this.xh=this.xh.substring(6)):this.xh.startsWith('glow3:')&&(t=11,this.xh=this.xh.substring(6));let i=0;this.xh.startsWith('wave:')&&(i=1,this.xh=this.xh.substring(5)),this.xh.startsWith('scroll:')&&(i=2,this.xh=this.xh.substring(7)),this.ai.$A(k.Sy),this.ai.p1(0);const s=this.ai.ft;this.ai.p1(t),this.ai.p1(i),U.Ep(this.ai,this.xh),this.ai.Hx(this.ai.ft-s),this.xh=W.A.eS(this.xh),this.xh=M.filter(this.xh),this.io&&this.io.name&&(this.io.yg=this.xh,this.io.wg=t,this.io.Ag=i,this.io.xg=150,this._C(2,this.io.yg,this.io.name)),2===this.Qe&&(this.Qe=3,this.ye=!0,this.ai.$A(k.Ay),this.ai.p1(this.Qe),this.ai.p1(this.th),this.ai.p1(this.ih))}this.xh='',this.ue=!0}}}while((t<97||t>122)&&(t<65||t>90)&&(t<48||t>57)&&32!==t);this.tn.length<12&&(this.tn=this.tn+String.fromCharCode(t))}};bx=()=>{if(1===this.MA)if(this.UA>=8&&this.UA<=108&&this.PA>=490&&this.PA<=522)this.Qe=(this.Qe+1)%4,this.ye=!0,this.ue=!0,this.ai.$A(k.Ay),this.ai.p1(this.Qe),this.ai.p1(this.th),this.ai.p1(this.ih);else if(this.UA>=137&&this.UA<=237&&this.PA>=490&&this.PA<=522)this.th=(this.th+1)%3,this.ye=!0,this.ue=!0,this.ai.$A(k.Ay),this.ai.p1(this.Qe),this.ai.p1(this.th),this.ai.p1(this.ih);else if(this.UA>=275&&this.UA<=375&&this.PA>=490&&this.PA<=522)this.ih=(this.ih+1)%3,this.ye=!0,this.ue=!0,this.ai.$A(k.Ay),this.ai.p1(this.Qe),this.ai.p1(this.th),this.ai.p1(this.ih);else if(this.UA>=416&&this.UA<=516&&this.PA>=490&&this.PA<=522){this.MC(),this.tn='',this.sn=!1;for(let t=0;t<c.A.ta.length;t++)if(c.A.ta[t]&&600===c.A.ta[t].ja)return void(this.en=this.pe=c.A.ta[t].aw)}};Dx=(t,i,s,e,h,n,r,o)=>{if(this.sh?this.eh=32:this.eh=0,this.sh=!1,t>=n&&t<n+16&&i>=r&&i<r+16)o.Ja-=4*this.we,h&&(this.fe=!0);else if(t>=n&&t<n+16&&i>=r+e-16&&i<r+e)o.Ja+=4*this.we,h&&(this.fe=!0);else if(t>=n-this.eh&&t<n+this.eh+16&&i>=r+16&&i<r+e-16&&this.we>0){let t=(e-32)*e/s|0;t<8&&(t=8);const n=i-r-(t/2|0)-16,a=e-t-32;o.Ja=(s-e)*n/a|0,h&&(this.fe=!0),this.sh=!0}};ZA=async()=>{this.os||(this.Qo(),this.sa=null,this.vi=null,this.Bi=null,this.bi=null,this.Ii=null,this.Ei=null,this._i=null,this.Ti=null,this.Oi=null,this.Li=null,this.os=new f.A(479,96),this.ns=new f.A(168,160),u.A.clear(),this.Rs?.draw(0,0),this.hs=new f.A(190,261),this.rs=new f.A(512,334),u.A.clear(),this.ls=new f.A(501,61),this.cs=new f.A(288,40),this.fs=new f.A(269,66),this.Ci=!0),await(this?.Kt())};pg=t=>{if(!t)return!1;for(let i=0;i<this.yo;i++)if(t.toLowerCase()===this.Io[i]?.toLowerCase())return!0;return!!this.io&&t.toLowerCase()===this.io.name?.toLowerCase()};UC=t=>{if(0n===t)return;if(this.yo>=100)return void this._C(0,'Your friends list is full. Max of 100 hit','');const i=W.A.ql(W.A.$l(t));for(let s=0;s<this.yo;s++)if(this.Eo[s]===t)return void this._C(0,i+' is already on your friend list','');for(let s=0;s<this.Me;s++)if(this.Ue[s]===t)return void this._C(0,'Please remove '+i+' from your ignore list first','');this.io&&this.io.name&&i!==this.io.name&&(this.Io[this.yo]=i,this.Eo[this.yo]=t,this._o[this.yo]=0,this.yo++,this.fe=!0,this.ai.$A(k.gy),this.ai.JC(t))};NC=t=>{if(0n!==t)for(let i=0;i<this.yo;i++)if(this.Eo[i]===t){this.yo--,this.fe=!0;for(let t=i;t<this.yo;t++)this.Io[t]=this.Io[t+1],this._o[t]=this._o[t+1],this.Eo[t]=this.Eo[t+1];return this.ai.$A(k.xy),void this.ai.JC(t)}};PC=t=>{if(0n===t)return;if(this.Me>=100)return void this._C(0,'Your ignore list is full. Max of 100 hit','');const i=W.A.ql(W.A.$l(t));for(let s=0;s<this.Me;s++)if(this.Ue[s]===t)return void this._C(0,i+' is already on your ignore list','');for(let s=0;s<this.yo;s++)if(this.Eo[s]===t)return void this._C(0,'Please remove '+i+' from your friend list first','');this.Ue[this.Me++]=t,this.fe=!0,this.ai.$A(k.py),this.ai.JC(t)};FC=t=>{if(0n!==t)for(let i=0;i<this.Me;i++)if(this.Ue[i]===t){this.Me--,this.fe=!0;for(let t=i;t<this.Me;t++)this.Ue[t]=this.Ue[t+1];return this.ai.$A(k.yy),void this.ai.JC(t)}};oS=(t,i)=>{const s=this.Xr[this.er][t][i];if(!s)return void this.un?.aS(this.er,t,i);let e=-99999999,h=null;for(let t=s.head();t;t=s.next()){const i=n.A.get(t.index);let s=i.lS;i.Gl&&(s*=t.count+1),s>e&&(e=s,h=t)}if(!h)return;s.cS(h);let r=-1,o=-1,a=0,l=0;for(let t=s.head();t;t=s.next())t.index!==h.index&&-1===r&&(r=t.index,a=t.count),t.index!==h.index&&t.index!==r&&-1===o&&(o=t.index,l=t.count);let c=null;-1!==r&&(c=n.A.get(r).fS(a));let f=null;-1!==o&&(f=n.A.get(o).fS(l));const u=t+(i<<7)+1610612736|0,d=n.A.get(h.index);this.un?.uS(t,i,this.Wx(this.er,128*t+64,128*i+64),this.er,u,d.fS(h.count),f,c)};dS=(t,i,s,e,n,r,o)=>{if(i<1||s<1||i>102||s>102)return;if(at.K.Bt&&t!==this.er)return;if(!this.un)return;let a=0;if(o===X.A.yS&&(a=this.un.pC(t,i,s)),o===X.A.pS&&(a=this.un.wS(t,s,i)),o===X.A.AS&&(a=this.un.bC(t,i,s)),o===X.A.iS&&(a=this.un.lC(t,i,s)),0!==a){const e=this.un.wC(t,i,s,a),n=a>>14&32767,r=31&e,l=e>>6;if(o===X.A.yS){this.un?.xS(t,i,s,1);const e=h.A.get(n);e.gS&&this.ir[t]?.xS(i,s,r,l,e.CS)}if(o===X.A.pS&&this.un?.SS(t,i,s),o===X.A.AS){this.un.mS(t,i,s);const e=h.A.get(n);if(i+e.width>$.A.Ar-1||s+e.width>$.A.Ar-1||i+e.length>$.A.Ar-1||s+e.length>$.A.Ar-1)return;e.gS&&this.ir[t]?.mS(i,s,e.width,e.length,l,e.CS)}if(o===X.A.iS){this.un?.vS(t,i,s);const e=h.A.get(n);e.gS&&e.active&&this.ir[t]?.BS(i,s)}}if(e>=0){let h=t;this.yr&&t<3&&!(2&~this.yr[1][i][s])&&(h=t+1),this.dr&&z.A.dS(t,i,s,this.un,this.dr,this.Hr,this.ir[t],e,r,n,h)}};MC=()=>{this.ai.$A(k.sy),-1!==this.Oe&&(this.Oe=-1,this.fe=!0,this.Fh=!1,this.de=!0),-1!==this.Le&&(this.Le=-1,this.ue=!0,this.Fh=!1),this.pe=-1};JA=async()=>{this.ui>0?await this.bS():(this.rs?.bind(),this.Pi?.Fc(257,144,'Connection lost',g.A.dl),this.Pi?.Fc(256,143,'Connection lost',g.A.Za),this.Pi?.Fc(257,159,'Please wait - attempting to reestablish',g.A.dl),this.Pi?.Fc(256,158,'Please wait - attempting to reestablish',g.A.Za),this.rs?.draw(8,11),this.wn=0,this.stream?.close(),this.xA=!1,await this.NA(this.username,this.password,!0),this.xA||await this.bS())};bS=async()=>{this.stream&&this.stream.close(),this.stream=null,this.xA=!1,this.Si=0,this.username='',this.password='',Y.A.zA(),this.rg(),this.un?.reset();for(let t=0;t<$.A.sr;t++)this.ir[t]?.reset();(0,ot.Jo)(!1),this.Wo=null,await this.qt()};read=async()=>{if(!this.stream)return!1;try{let t=this.stream.available;if(0===t)return!1;if(-1===this.pi&&(await this.stream.yf(this.in.data,0,1),this.pi=255&this.in.data[0],this.yi&&(this.pi=this.pi-this.yi.vc&255),this.packetSize=O.If[this.pi],t--),-1===this.packetSize){if(t<=0)return!1;await this.stream.yf(this.in.data,0,1),this.packetSize=255&this.in.data[0],t--}if(-2===this.packetSize){if(t<=1)return!1;await this.stream.yf(this.in.data,0,2),this.in.ft=0,this.packetSize=this.in.ct,t-=2}if(t<this.packetSize)return!1;if(this.in.ft=0,await this.stream.yf(this.in.data,0,this.packetSize),this.fi=0,this.xi=this.Ai,this.Ai=this.wi,this.wi=this.pi,this.pi===D._u){const t=this.in.ct,i=this.in.Mc;return this.Gh[t]=i,this.Vh[t]!==i&&(this.Vh[t]=i,await this.kC(t),this.fe=!0,-1!==this.fh&&(this.ue=!0)),this.pi=-1,!0}if(this.pi===D.cu){const t=this.in.GA,i=this.in.kc;let s=W.A.ql(W.A.$l(t));for(let e=0;e<this.yo;e++)if(t===this.Eo[e]){this._o[e]!==i&&(this._o[e]=i,this.fe=!0,i>0&&this._C(5,s+' has logged in.',''),0===i&&this._C(5,s+' has logged out.','')),s=null;break}s&&this.yo<100&&(this.Eo[this.yo]=t,this.Io[this.yo]=s,this._o[this.yo]=i,this.yo++,this.fe=!0);let e=!1;for(;!e;){e=!0;for(let t=0;t<this.yo-1;t++)if(this._o[t]!==at.K.vt&&this._o[t+1]===at.K.vt||0===this._o[t]&&0!==this._o[t+1]){const i=this._o[t];this._o[t]=this._o[t+1],this._o[t+1]=i;const s=this.Io[t];this.Io[t]=this.Io[t+1],this.Io[t+1]=s;const h=this.Eo[t];this.Eo[t]=this.Eo[t+1],this.Eo[t+1]=h,this.fe=!0,e=!1}}return this.pi=-1,!0}if(this.pi===D.yu)return this.di=30*this.in.ct,this.pi=-1,!0;if(this.pi===D.Bu){const t=this.in.kc,i=this.in.kc;let s=-1;if(this.$n)for(let e=0;e<this.$n.length;e++)this.$n[e]===(t<<8)+i&&(s=e);if(-1!==s){const e=this.jn;if(e){const h=e[s];-1!==s&&h&&(this.db?.Aa(`m${t}_${i}`,h),this.dn=1)}}return this.pi=-1,!0}if(this.pi===D.su)return this.IS(this.in,this.packetSize),this.pi=-1,!0;if(this.pi===D.Eu){const t=this.in.ct,i=this.in.ct;if(this.zn===t&&this.Xn===i&&0!==this.dn)return this.pi=-1,!0;this.zn=t,this.Xn=i,this.Kn=8*(this.zn-6),this.Zn=8*(this.Xn-6),this.dn=1,this.rs?.bind(),this.Pi?.Fc(257,151,'Loading - please wait.',g.A.dl),this.Pi?.Fc(256,150,'Loading - please wait.',g.A.Za),this.rs?.draw(8,11);const s=(this.packetSize-2)/10|0;this.jn=new F.Ps(s,null),this.qn=new F.Ps(s,null),this.$n=new Int32Array(s),this.ai.$A(k.Ku),this.ai.p1(0);let e=0;for(let t=0;t<s;t++){const i=this.in.kc,s=this.in.kc,h=this.in.ut,n=this.in.ut;let r;this.$n[t]=(i<<8)+s,0!==h&&(r=await(this.db?.ua(`m${i}_${s}`)),r&&w.A.da(r)!==h&&(r=void 0),r?this.jn[t]=r:(this.dn=0,this.ai.p1(0),this.ai.p1(i),this.ai.p1(s),e+=3)),0!==n&&(r=await(this.db?.ua(`l${i}_${s}`)),r&&w.A.da(r)!==n&&(r=void 0),r?this.qn[t]=r:(this.dn=0,this.ai.p1(1),this.ai.p1(i),this.ai.p1(s),e+=3))}this.ai.Hx(e),this.rs?.bind(),0===this.dn&&(this.Pi?.Fc(257,166,'Map area updated since last visit, so load will take longer this time only',g.A.dl),this.Pi?.Fc(256,165,'Map area updated since last visit, so load will take longer this time only',g.A.Za)),this.rs?.draw(8,11);const h=this.Kn-this.Jn,n=this.Zn-this.Qn;this.Jn=this.Kn,this.Qn=this.Zn;for(let t=0;t<8192;t++){const i=this.Fr[t];if(i){for(let t=0;t<10;t++)i.Cx[t]-=h,i.Sx[t]-=n;i.x-=128*h,i.z-=128*n}}for(let t=0;t<this.Qt;t++){const i=this.Lr[t];if(i){for(let t=0;t<10;t++)i.Cx[t]-=h,i.Sx[t]-=n;i.x-=128*h,i.z-=128*n}}let r=0,o=$.A.Ar,a=1;h<0&&(r=$.A.Ar-1,o=-1,a=-1);let l=0,c=$.A.Ar,f=1;n<0&&(l=$.A.Ar-1,c=-1,f=-1);for(let t=r;t!==o;t+=a)for(let i=l;i!==c;i+=f){const s=t+h,e=i+n;for(let h=0;h<$.A.sr;h++)s>=0&&e>=0&&s<$.A.Ar&&e<$.A.Ar?this.Xr[h][t][i]=this.Xr[h][s][e]:this.Xr[h][t][i]=null}for(let t=this.Zr.head();t;t=this.Zr.next())t.x-=h,t.z-=n,(t.x<0||t.z<0||t.x>=$.A.Ar||t.z>=$.A.Ar)&&t.ES();return 0!==this.wn&&(this.wn-=h,this.An-=n),this.xn=!1,this.pi=-1,!0}if(this.pi===D.Yf)return c.A.ta[this.in.ct].model=this.io?._S()||null,this.pi=-1,!0;if(this.pi===D.du)return this.Pe=this.in.kc,1===this.Pe&&(this.Ne=this.in.ct),this.Pe>=2&&this.Pe<=6&&(2===this.Pe&&(this.Fe=64,this.Ve=64),3===this.Pe&&(this.Fe=0,this.Ve=64),4===this.Pe&&(this.Fe=128,this.Ve=64),5===this.Pe&&(this.Fe=64,this.Ve=0),6===this.Pe&&(this.Fe=64,this.Ve=128),this.Pe=2,this.We=this.in.ct,this.Ye=this.in.ct,this.He=this.in.kc),10===this.Pe&&(this.Ge=this.in.ct),this.pi=-1,!0;if(this.pi===D.Ru){const t=this.in.TS,i=this.in.ut,s=this.in.ut;return t!==this.Wo&&this.Go&&!at.K.Bt&&await this.xa(t,i,s,!0),this.Wo=t,this.Yo=i,this.Ho=s,this.Vo=0,this.pi=-1,!0}if(this.pi===D.Cu)return await this.bS(),this.pi=-1,!1;if(this.pi===D.vu){const t=this.in.kc,i=this.in.kc;let s=-1;if(this.$n)for(let e=0;e<this.$n.length;e++)this.$n[e]===(t<<8)+i&&(s=e);if(-1!==s){const e=this.qn;if(e){const h=e[s];-1!==s&&h&&(this.db?.Aa(`l${t}_${i}`,h),this.dn=1)}}return this.pi=-1,!0}if(this.pi===D.fu)return this.wn=0,this.pi=-1,!0;if(this.pi===D.xu)return this.ho=this.in.ct,this.pi=-1,!0;if(this.pi===D.Hu||this.pi===D.Pu||this.pi===D.Vu||this.pi===D.zu||this.pi===D.Wu||this.pi===D.Fu||this.pi===D.Xu||this.pi===D.Nu||this.pi===D.Yu||this.pi===D.Gu)return this.OS(this.in,this.pi),this.pi=-1,!0;if(this.pi===D.Lf){const t=this.in.ct,i=this.in.ct;return-1!==this.Le&&(this.Le=-1,this.ue=!0),this.lh&&(this.lh=!1,this.ue=!0),this.pe=t,this.Oe=i,this.fe=!0,this.de=!0,this.Fh=!1,this.pi=-1,!0}if(this.pi===D.Tu){const t=this.in.ct,i=this.in.ut;return this.Gh[t]=i,this.Vh[t]!==i&&(this.Vh[t]=i,await this.kC(t),this.fe=!0,-1!==this.fh&&(this.ue=!0)),this.pi=-1,!0}if(this.pi===D.Wf){const t=this.in.ct;return c.A.ta[t].Pa=this.in.ct,this.pi=-1,!0}if(this.pi===D.Df){let t=this.in.ct;const i=this.in.kc;return 65535===t&&(t=-1),this.Je[i]=t,this.fe=!0,this.de=!0,this.pi=-1,!0}if(this.pi===D.Iu){const t=this.in.kc,i=this.in.kc,s=this.in.ct,e=this.in.ct;let h=-1;if(this.$n)for(let s=0;s<this.$n.length;s++)this.$n[s]===(t<<8)+i&&(h=s);if(-1!==h&&this.qn){this.qn[h]&&this.qn[h]?.length===e||(this.qn[h]=new Int8Array(e));const t=this.qn[h];t&&this.in.LS(this.packetSize-6,s,t)}return this.pi=-1,!0}if(this.pi===D.hu){const t=Y.A.stop();return t&&(this.ai.$A(k.qu),this.ai.p2(t.ft),this.ai.HA(t.data,t.ft,0),t.release()),this.pi=-1,!0}if(this.pi===D.qf){this.fe=!0;const t=this.in.ct,i=c.A.ta[t],s=this.in.kc;if(i.sl&&i.el){for(let t=0;t<s;t++){i.sl[t]=this.in.ct;let s=this.in.kc;255===s&&(s=this.in.ut),i.el[t]=s}for(let t=s;t<i.sl.length;t++)i.sl[t]=0,i.el[t]=0}else for(let t=0;t<s;t++)this.in.ct,255===this.in.kc&&this.in.ut;return this.pi=-1,!0}if(this.pi===D.nu)return Y.A.RS(),this.pi=-1,!0;if(this.pi===D.Su)return this.hh=!1,this.lh=!0,this.ah='',this.ue=!0,this.pi=-1,!0;if(this.pi===D.jf){const t=c.A.ta[this.in.ct];if(t.sl)for(let i=0;i<t.sl.length;i++)t.sl[i]=-1,t.sl[i]=0;return this.pi=-1,!0}if(this.pi===D.gu){if(this.hn=this.in.ut,this.nn=this.in.ct,this.rn=this.in.kc,this.an=this.in.ct,0!==this.hn&&-1===this.pe){this.MC();let t=650;201!==this.rn&&(t=655),this.tn='',this.sn=!1;for(let i=0;i<c.A.ta.length;i++)if(c.A.ta[i]&&c.A.ta[i].ja===t){this.pe=c.A.ta[i].aw;break}}return this.pi=-1,!0}if(this.pi===D.Kf)return this.qe=this.in.kc,this.qe===this.$e&&(3===this.qe?this.$e=1:this.$e=3,this.fe=!0),this.pi=-1,!0;if(this.pi===D.Du){if(this.Go&&!at.K.Bt){const t=this.in.ct,i=this.in.ut,s=this.packetSize-6,e=G.A.read(i,Int8Array.from(this.in.data),s,this.in.ft);(0,ot.ga)(e,this.zo,!1),this.Vo=t}return this.pi=-1,!0}if(this.pi===D.mu)return this.eo=this.in.kc,this.pi=-1,!0;if(this.pi===D.Lu){const t=this.in.ct,i=this.in.kc,s=this.in.ct;return this.Lo&&!at.K.Bt&&this.Oo<50&&(this.Ro[this.Oo]=t,this.Do[this.Oo]=i,this.ko[this.Oo]=s+V.Jp[t],this.Oo++),this.pi=-1,!0}if(this.pi===D.zf){const t=this.in.ct,i=this.in.ct,s=r.A.get(i);return c.A.ta[t].model=s._S(),this.pi=-1,!0}if(this.pi===D.ku)return this.Yn=this.in.kc,this.Hn=this.in.kc,this.pi=-1,!0;if(this.pi===D.Gf){const t=this.in.ct,i=this.in.ct,s=this.in.ct,e=c.A.ta[t].model;return e?.ic(i,s),this.pi=-1,!0}if(this.pi===D.au)return this.Qe=this.in.kc,this.th=this.in.kc,this.ih=this.in.kc,this.ye=!0,this.ue=!0,this.pi=-1,!0;if(this.pi===D.Mf){const t=this.in.ct;return this.DS(t),-1!==this.Le&&(this.Le=-1,this.ue=!0),this.lh&&(this.lh=!1,this.ue=!0),this.Oe=t,this.fe=!0,this.de=!0,this.pe=-1,this.Fh=!1,this.pi=-1,!0}if(this.pi===D.Of){const t=this.in.ct;return this.DS(t),-1!==this.Oe&&(this.Oe=-1,this.fe=!0,this.de=!0),this.Le=t,this.ue=!0,this.pe=-1,this.Fh=!1,this.pi=-1,!0}if(this.pi===D.Xf){const t=this.in.ct,i=this.in.kS,s=this.in.kS,e=c.A.ta[t];return e.x=i,e.y=s,this.pi=-1,!0}if(this.pi===D.tu)return this.xn=!0,this.Ir=this.in.kc,this.Er=this.in.kc,this._r=this.in.ct,this.Tr=this.in.kc,this.Or=this.in.kc,this.Or>=100&&(this.Ln=128*this.Ir+64,this.Dn=128*this.Er+64,this.Rn=this.Wx(this.er,this.Ir,this.Er)-this._r),this.pi=-1,!0;if(this.pi===D.Mu){this.Yn=this.in.kc,this.Hn=this.in.kc;for(let t=this.Yn;t<this.Yn+8;t++)for(let i=this.Hn;i<this.Hn+8;i++)this.Xr[this.er][t][i]&&(this.Xr[this.er][t][i]=null,this.oS(t,i));for(let t=this.Zr.head();t;t=this.Zr.next())t.x>=this.Yn&&t.x<this.Yn+8&&t.z>=this.Hn&&t.z<this.Hn+8&&t.ow===this.er&&(this.dS(t.ow,t.x,t.z,t.cw,t.fw,t.uw,t.aw),t.ES());return this.pi=-1,!0}if(this.pi===D.bu){const t=this.in.kc,i=this.in.kc,s=this.in.ct,e=this.in.ct;let h=-1;if(this.$n)for(let s=0;s<this.$n.length;s++)this.$n[s]===(t<<8)+i&&(h=s);if(-1!==h&&this.jn){this.jn[h]&&this.jn[h]?.length===e||(this.jn[h]=new Int8Array(e));const t=this.jn[h];t&&this.in.LS(this.packetSize-6,s,t)}return this.pi=-1,!0}if(this.pi===D.lu){const t=this.in.GA,i=this.in.ut,s=this.in.kc;let e=!1;for(let t=0;t<100;t++)if(this.yh[t]===i){e=!0;break}if(s<=1)for(let i=0;i<this.Me;i++)if(this.Ue[i]===t){e=!0;break}if(!e&&0===this.Se)try{this.yh[this.ph]=i,this.ph=(this.ph+1)%100;const e=U.Dy(this.in,this.packetSize-13),h=M.filter(e);s>1?this._C(7,h,W.A.ql(W.A.$l(t))):this._C(3,h,W.A.ql(W.A.$l(t)))}catch(t){}return this.pi=-1,!0}if(this.pi===D.Ou){for(let t=0;t<this.Vh.length;t++)this.Vh[t]!==this.Gh[t]&&(this.Vh[t]=this.Gh[t],await this.kC(t),this.fe=!0);return this.pi=-1,!0}if(this.pi===D.Vf){const t=this.in.ct,i=this.in.ct;return c.A.ta[t].model=m.A.model(i),this.pi=-1,!0}if(this.pi===D.Zf)return this.fh=this.in.kS,this.ue=!0,this.pi=-1,!0;if(this.pi===D.wu)return 12===this.$e&&(this.fe=!0),this.so=this.in.kc,this.pi=-1,!0;if(this.pi===D.Jf){if(this.xn=!0,this.Sr=this.in.kc,this.mr=this.in.kc,this.vr=this.in.ct,this.Br=this.in.kc,this.br=this.in.kc,this.br>=100){const t=128*this.Sr+64,i=128*this.mr+64,s=this.Wx(this.er,this.Sr,this.mr)-this.vr,e=t-this.Ln,h=s-this.Rn,n=i-this.Dn,r=0|Math.sqrt(e*e+n*n);this.kn=325.949*Math.atan2(h,r)&2047,this.Mn=-325.949*Math.atan2(e,n)&2047,this.kn<128&&(this.kn=128),this.kn>383&&(this.kn=383)}return this.pi=-1,!0}if(this.pi===D.Ff)return this.$e=this.in.kc,this.fe=!0,this.de=!0,this.pi=-1,!0;if(this.pi===D.ru){const t=this.in.TS;let i;if(t.endsWith(':tradereq:')){const s=t.substring(0,t.indexOf(':'));i=W.A.eC(s);let e=!1;for(let t=0;t<this.Me;t++)if(this.Ue[t]===i){e=!0;break}e||0!==this.Se||this._C(4,'wishes to trade with you.',s)}else if(t.endsWith(':duelreq:')){const s=t.substring(0,t.indexOf(':'));i=W.A.eC(s);let e=!1;for(let t=0;t<this.Me;t++)if(this.Ue[t]===i){e=!0;break}e||0!==this.Se||this._C(8,'wishes to duel with you.',s)}else this._C(0,t,'');return this.pi=-1,!0}if(this.pi===D.Nf){const t=this.in.ct,i=this.in.ct,s=this.in.ct,e=n.A.get(i);return c.A.ta[t].model=e.fS(50),c.A.ta[t].Ml=e.MS,c.A.ta[t].Fl=e.US,c.A.ta[t].zoom=100*e.PS/s|0,this.pi=-1,!0}if(this.pi===D.kf){const t=this.in.ct;return this.DS(t),-1!==this.Oe&&(this.Oe=-1,this.fe=!0,this.de=!0),-1!==this.Le&&(this.Le=-1,this.ue=!0),this.lh&&(this.lh=!1,this.ue=!0),this.pe=t,this.Fh=!1,this.pi=-1,!0}if(this.pi===D.Uf){const t=this.in.ct,i=this.in.ct,s=i>>10&31,e=i>>5&31,h=31&i;return c.A.ta[t].Al=(s<<19)+(e<<11)+(h<<3),this.pi=-1,!0}if(this.pi===D.Au){for(let t=0;t<this.Lr.length;t++){const i=this.Lr[t];i&&(i.Pw=-1)}for(let t=0;t<this.Fr.length;t++){const i=this.Fr[t];i&&(i.Pw=-1)}return this.pi=-1,!0}if(this.pi===D.Pf){const t=this.in.ct;return c.A.ta[t].hide=1===this.in.kc,this.pi=-1,!0}if(this.pi===D.ou){this.Me=this.packetSize/8|0;for(let t=0;t<this.Me;t++)this.Ue[t]=this.in.GA;return this.pi=-1,!0}if(this.pi===D.iu){this.xn=!1;for(let t=0;t<5;t++)this.En[t]=!1;return this.pi=-1,!0}if(this.pi===D.Rf)return-1!==this.Oe&&(this.Oe=-1,this.fe=!0,this.de=!0),-1!==this.Le&&(this.Le=-1,this.ue=!0),this.lh&&(this.lh=!1,this.ue=!0),this.pe=-1,this.Fh=!1,this.pi=-1,!0;if(this.pi===D.Hf){const t=this.in.ct;return c.A.ta[t].text=this.in.TS,c.A.ta[t].aw===this.Je[this.$e]&&(this.fe=!0),this.pi=-1,!0}if(this.pi===D.pu){this.fe=!0;const t=this.in.kc,i=this.in.ut,s=this.in.kc;this.ze[t]=i,this.Xe[t]=s,this.Ke[t]=1;for(let s=0;s<98;s++)i>=this.Ze[s]&&(this.Ke[t]=s+2);return this.jt(t,i,s),this.pi=-1,!0}if(this.pi===D.Uu){for(this.Yn=this.in.kc,this.Hn=this.in.kc;this.in.ft<this.packetSize;){const t=this.in.kc;this.OS(this.in,t)}return this.pi=-1,!0}if(this.pi===D.uu)return 12===this.$e&&(this.fe=!0),this.no=this.in.kS,this.pi=-1,!0;if(this.pi===D.Qf){const t=this.in.kc,i=this.in.kc,s=this.in.kc,e=this.in.kc;return this.En[t]=!0,this._n[t]=i,this.Tn[t]=s,this.On[t]=e,this.In[t]=0,this.pi=-1,!0}if(this.pi===D.$f){this.fe=!0;const t=this.in.ct,i=c.A.ta[t];for(;this.in.ft<this.packetSize;){const t=this.in.kc,s=this.in.ct;let e=this.in.kc;255===e&&(e=this.in.ut),i.sl&&i.el&&t>=0&&t<i.sl.length&&(i.sl[t]=s,i.el[t]=e)}return this.pi=-1,!0}if(this.pi===D.eu)return this.qo=!this.qo,this.NS(this.in,this.packetSize),1===this.dn&&(this.dn=2,z.A.VS=this.er,this.GS()),at.K.Bt&&2===this.dn&&z.A.VS!==this.er&&(this.rs?.bind(),this.Pi?.Fc(257,151,'Loading - please wait.',g.A.dl),this.Pi?.Fc(256,150,'Loading - please wait.',g.A.Za),this.rs?.draw(8,11),z.A.VS=this.er,this.GS()),this.er!==this.Wn&&2===this.dn&&(this.Wn=this.er,this.rC(this.er)),this.pi=-1,!0;await this.bS()}catch(t){console.log(t),await this.JA()}return!0};GS=()=>{try{this.Wn=-1,this.zr.clear(),this.Hr.clear(),this.Yr.clear(),this.Wr.clear(),d.A.WS(),this.rg(),this.un?.reset();for(let t=0;t<$.A.sr;t++)this.ir[t]?.reset();const t=new z.A($.A.Ar,$.A.Ar,this.dr,this.yr);z.A.Bt=at.K.Bt;const i=this.jn?.length??0;if(this.$n)for(let t=0;t<i;t++){const i=this.$n[t]>>8,s=255&this.$n[t];if(33===i&&s>=71&&s<=73){z.A.Bt=!1;break}}if(at.K.Bt?this.un?.YS(this.er):this.un?.YS(0),this.$n&&this.jn){this.ai.$A(k.Zu);for(let s=0;s<i;s++){const i=64*(this.$n[s]>>8)-this.Kn,e=64*(255&this.$n[s])-this.Zn,h=this.jn[s];if(h){const s=new w.A(new Uint8Array(h)).ut,n=G.A.read(s,h,h.length-4,4);t.HS(8*(this.zn-6),8*(this.Xn-6),i,e,n)}else this.Xn<800&&t.zS(e,i,64,64)}}if(this.$n&&this.qn){this.ai.$A(k.Zu);for(let s=0;s<i;s++){const i=this.qn[s];if(i){const e=new w.A(new Uint8Array(i)).ut,h=G.A.read(e,i,i.length-4,4),n=64*(this.$n[s]>>8)-this.Kn,r=64*(255&this.$n[s])-this.Zn;t.XS(this.un,this.Hr,this.ir,h,n,r)}}}this.ai.$A(k.Zu),t.KS(this.un,this.ir),this.rs?.bind(),this.ai.$A(k.Zu);for(let t=this.Hr.head();t;t=this.Hr.next())2===(this.yr&&2&this.yr[1][t.ZS][t.jS])&&(t.qS--,t.qS<0&&t.ES());for(let t=0;t<$.A.Ar;t++)for(let i=0;i<$.A.Ar;i++)this.oS(t,i);for(let t=this.Zr.head();t;t=this.Zr.next())this.dS(t.ow,t.x,t.z,t.lw,t.angle,t.shape,t.aw)}catch(t){}h.A.og?.clear(),d.A.yA(20)};DS=t=>{const i=c.A.ta[t];if(i.Ua)for(let t=0;t<i.Ua.length&&-1!==i.Ua[t];t++){const s=c.A.ta[i.Ua[t]];1===s.type&&this.DS(s.id),s.Va=0,s.Fa=0}};AA=()=>{let t=0;for(let i=0;i<99;i++){const s=i+1;t+=s+300*Math.pow(2,s/7)|0,this.Ze[i]=t/4|0}};_C=(t,i,s)=>{0===t&&-1!==this.fh&&(this.je=i,this.MA=0),-1===this.Le&&(this.ue=!0);for(let t=99;t>0;t--)this.messageType[t]=this.messageType[t-1],this.dh[t]=this.dh[t-1],this.uh[t]=this.uh[t-1];Ct.A.sg&&0===t&&(i='['+(this.ni/30|0)+']: '+i),this.messageType[0]=t,this.dh[0]=s,this.uh[0]=i};kC=async t=>{const i=l.A.ta[t].$S;if(0!==i){const s=this.Vh[t];if(1===i&&(1===s&&d.A.dA(.9),2===s&&d.A.dA(.8),3===s&&d.A.dA(.7),4===s&&d.A.dA(.6),n.A.lg?.clear(),this.Ci=!0),3===i){const t=this.Go;0===s&&(this.zo=256,(0,ot.JS)(256),this.Go=!0),1===s&&(this.zo=192,(0,ot.JS)(192),this.Go=!0),2===s&&(this.zo=128,(0,ot.JS)(128),this.Go=!0),3===s&&(this.zo=64,(0,ot.JS)(64),this.Go=!0),4===s&&(this.Go=!1),this.Go!==t&&(this.Go&&this.Wo?await this.xa(this.Wo,this.Yo,this.Ho,!1):(0,ot.Jo)(!1),this.Vo=0)}4===i&&(0===s&&(this.Mo=256,(0,ot.QS)(256),this.Lo=!0),1===s&&(this.Mo=192,(0,ot.QS)(192),this.Lo=!0),2===s&&(this.Mo=128,(0,ot.QS)(128),this.Lo=!0),3===s&&(this.Mo=64,(0,ot.QS)(64),this.Lo=!0),4===s&&(this.Lo=!1)),5===i&&(this.Xh=s),6===i&&(this.Ah=s),8===i&&(this.wh=s,this.ue=!0)}};tm=(t,i)=>{let s=0;for(let t=0;t<100;t++){if(!this.uh[t])continue;const e=this.messageType[t],h=this.ke+70+4-14*s;if(h<-20)break;0===e&&s++,1!==e&&2!==e||!(1===e||0===this.Qe||1===this.Qe&&this.pg(this.dh[t]))||(i>h-14&&i<=h&&this.io&&this.dh[t]!==this.io.name&&(this.lo&&(this.Te[this._e]='Report abuse @whi@'+this.dh[t],this.Kh[this._e]=34,this._e++),this.Te[this._e]='Add ignore @whi@'+this.dh[t],this.Kh[this._e]=436,this._e++,this.Te[this._e]='Add friend @whi@'+this.dh[t],this.Kh[this._e]=406,this._e++),s++),3!==e&&7!==e||0!==this.wh||!(7===e||0===this.th||1===this.th&&this.pg(this.dh[t]))||(i>h-14&&i<=h&&(this.lo&&(this.Te[this._e]='Report abuse @whi@'+this.dh[t],this.Kh[this._e]=34,this._e++),this.Te[this._e]='Add ignore @whi@'+this.dh[t],this.Kh[this._e]=436,this._e++,this.Te[this._e]='Add friend @whi@'+this.dh[t],this.Kh[this._e]=406,this._e++),s++),4===e&&(0===this.ih||1===this.ih&&this.pg(this.dh[t]))&&(i>h-14&&i<=h&&(this.Te[this._e]='Accept trade @whi@'+this.dh[t],this.Kh[this._e]=903,this._e++),s++),(5===e||6===e)&&0===this.wh&&this.th<2&&s++,8===e&&(0===this.ih||1===this.ih&&this.pg(this.dh[t]))&&(i>h-14&&i<=h&&(this.Te[this._e]='Accept duel @whi@'+this.dh[t],this.Kh[this._e]=363,this._e++),s++)}};im=t=>{if(0===this.wh)return;let i=0;0!==this.di&&(i=1);for(let s=0;s<100;s++)if(null!==this.uh[s]){const e=this.messageType[s];if((3===e||7===e)&&(7===e||0===this.th||1===this.th&&this.pg(this.dh[s]))){const e=329-13*i;if(this.ol>8&&this.ol<520&&t-11>e-10&&t-11<=e+3&&(this.lo&&(this.Te[this._e]='Report abuse @whi@'+this.dh[s],this.Kh[this._e]=2034,this._e++),this.Te[this._e]='Add ignore @whi@'+this.dh[s],this.Kh[this._e]=2436,this._e++,this.Te[this._e]='Add friend @whi@'+this.dh[s],this.Kh[this._e]=2406,this._e++),i++,i>=5)return}if((5===e||6===e)&&this.th<2&&(i++,i>=5))return}};sm=(t,i,s,e,h,r)=>{if(0!==t.type||!t.Ua||t.hide||i<e||s<h||i>e+t.width||s>h+t.height||!t.za||!t.Xa)return;const o=t.Ua.length;for(let a=0;a<o;a++){let o=t.za[a]+e,l=t.Xa[a]+h-r;const f=c.A.ta[t.Ua[a]];if(o+=f.x,l+=f.y,(f.hm>=0||0!==f.gl)&&i>=o&&s>=l&&i<o+f.width&&s<l+f.height&&(f.hm>=0?this.Qh=f.hm:this.Qh=f.id),0===f.type)this.sm(f,i,s,o,l,f.Ja),f.scroll>f.height&&this.Dx(i,s,f.scroll,f.height,!0,o+f.width,l,f);else if(2===f.type){let t=0;for(let e=0;e<f.height;e++)for(let h=0;h<f.width;h++){let r=o+h*(f.hl+32),a=l+e*(f.nl+32);if(t<20&&f.tl&&f.il&&(r+=f.tl[t],a+=f.il[t]),i<r||s<a||i>=r+32||s>=a+32){t++;continue}if(this.Jh=t,this.$h=f.id,!f.sl||f.sl[t]<=0){t++;continue}const c=n.A.get(f.sl[t]-1);if(1===this.Oh&&f.nm)f.id===this.Rh&&t===this.Lh||(this.Te[this._e]='Use '+this.kh+' with @lre@'+c.name,this.Kh[this._e]=881,this.Zh[this._e]=c.id,this.jh[this._e]=t,this.qh[this._e]=f.id,this._e++);else if(1===this.Wh&&f.nm)16&~this.Hh||(this.Te[this._e]=this.zh+' @lre@'+c.name,this.Kh[this._e]=391,this.Zh[this._e]=c.id,this.jh[this._e]=t,this.qh[this._e]=f.id,this._e++);else{if(f.nm)for(let i=4;i>=3;i--)c.rm&&c.rm[i]?(this.Te[this._e]=c.rm[i]+' @lre@'+c.name,3===i?this.Kh[this._e]=478:4===i&&(this.Kh[this._e]=347),this.Zh[this._e]=c.id,this.jh[this._e]=t,this.qh[this._e]=f.id,this._e++):4===i&&(this.Te[this._e]='Drop @lre@'+c.name,this.Kh[this._e]=347,this.Zh[this._e]=c.id,this.jh[this._e]=t,this.qh[this._e]=f.id,this._e++);if(f.om&&(this.Te[this._e]='Use @lre@'+c.name,this.Kh[this._e]=188,this.Zh[this._e]=c.id,this.jh[this._e]=t,this.qh[this._e]=f.id,this._e++),f.nm&&c.rm)for(let i=2;i>=0;i--)c.rm[i]&&(this.Te[this._e]=c.rm[i]+' @lre@'+c.name,0===i?this.Kh[this._e]=405:1===i?this.Kh[this._e]=38:2===i&&(this.Kh[this._e]=422),this.Zh[this._e]=c.id,this.jh[this._e]=t,this.qh[this._e]=f.id,this._e++);if(f.am)for(let i=4;i>=0;i--)f.am[i]&&(this.Te[this._e]=f.am[i]+' @lre@'+c.name,0===i?this.Kh[this._e]=602:1===i?this.Kh[this._e]=596:2===i?this.Kh[this._e]=22:3===i?this.Kh[this._e]=892:4===i&&(this.Kh[this._e]=415),this.Zh[this._e]=c.id,this.jh[this._e]=t,this.qh[this._e]=f.id,this._e++);this.Te[this._e]='Examine @lre@'+c.name,Ct.A.sg&&(this.Te[this._e]+='@whi@ ('+c.id+')'),this.Kh[this._e]=1773,this.Zh[this._e]=c.id,f.el&&(this.qh[this._e]=f.el[t]),this._e++}t++}}else if(i>=o&&s>=l&&i<o+f.width&&s<l+f.height)if(f.ml===c.A.lm){let t=!1;0!==f.ja&&(t=this.fm(f)),!t&&f.um&&(this.Te[this._e]=f.um,this.Kh[this._e]=951,this.qh[this._e]=f.id,this._e++)}else if(f.ml===c.A.dm&&0===this.Wh){let t=f.RC;t&&-1!==t.indexOf(' ')&&(t=t.substring(0,t.indexOf(' '))),this.Te[this._e]=t+' @gre@'+f.action,this.Kh[this._e]=930,this.qh[this._e]=f.id,this._e++}else f.ml===c.A.ym?(this.Te[this._e]='Close',this.Kh[this._e]=947,this.qh[this._e]=f.id,this._e++):f.ml===c.A.pm&&f.um?(this.Te[this._e]=f.um,this.Kh[this._e]=465,this.qh[this._e]=f.id,this._e++):f.ml===c.A.wm&&f.um?(this.Te[this._e]=f.um,this.Kh[this._e]=960,this.qh[this._e]=f.id,this._e++):f.ml===c.A.vl&&!this.Fh&&f.um&&(this.Te[this._e]=f.um,this.Kh[this._e]=44,this.qh[this._e]=f.id,this._e++)}};fm=t=>{let i=t.ja;return i>=c.A.Yl&&i<=c.A.Xl?(i>=c.A.zl?i-=c.A.zl:i--,this.Te[this._e]='Remove @whi@'+this.Io[i],this.Kh[this._e]=557,this._e++,this.Te[this._e]='Message @whi@'+this.Io[i],this.Kh[this._e]=679,this._e++,!0):i>=c.A.Zl&&i<=c.A.jl&&(this.Te[this._e]='Remove @whi@'+t.text,this.Kh[this._e]=556,this._e++,!0)};Am=()=>{0===this.Oh&&0===this.Wh&&(this.Te[this._e]='Walk here',this.Kh[this._e]=660,this.jh[this._e]=this.ol,this.qh[this._e]=this.al,this._e++);let t=-1;for(let i=0;i<m.A.jx;i++){const s=m.A.xm[i],e=127&s,r=s>>7&127,o=s>>29&3,a=s>>14&32767;if(s!==t){if(t=s,2===o&&this.un&&this.un.wC(this.er,e,r,s)>=0){const t=h.A.get(a);if(1===this.Oh)this.Te[this._e]='Use '+this.kh+' with @cya@'+t.name,this.Kh[this._e]=450,this.Zh[this._e]=s,this.jh[this._e]=e,this.qh[this._e]=r,this._e++;else if(1!==this.Wh){if(t.gm)for(let i=4;i>=0;i--)t.gm[i]&&(this.Te[this._e]=t.gm[i]+' @cya@'+t.name,0===i&&(this.Kh[this._e]=285),1===i&&(this.Kh[this._e]=504),2===i&&(this.Kh[this._e]=364),3===i&&(this.Kh[this._e]=581),4===i&&(this.Kh[this._e]=1501),this.Zh[this._e]=s,this.jh[this._e]=e,this.qh[this._e]=r,this._e++);this.Te[this._e]='Examine @cya@'+t.name,Ct.A.sg&&(this.Te[this._e]+='@whi@ ('+t.id+')'),this.Kh[this._e]=1175,this.Zh[this._e]=s,this.jh[this._e]=e,this.qh[this._e]=r,this._e++}else 4&~this.Hh||(this.Te[this._e]=this.zh+' @cya@'+t.name,this.Kh[this._e]=55,this.Zh[this._e]=s,this.jh[this._e]=e,this.qh[this._e]=r,this._e++)}if(1===o){const t=this.Fr[a];if(t&&t.type&&1===t.type.size&&64==(127&t.x)&&64==(127&t.z))for(let i=0;i<this.Vr;i++){const s=this.Fr[this.Gr[i]];s&&s!==t&&s.type&&1===s.type.size&&s.x===t.x&&s.z===t.z&&this.Cm(s.type,this.Gr[i],e,r)}t&&t.type&&this.Cm(t.type,a,e,r)}if(0===o){const t=this.Lr[a];if(t&&64==(127&t.x)&&64==(127&t.z)){for(let i=0;i<this.Vr;i++){const s=this.Fr[this.Gr[i]];s&&s.type&&1===s.type.size&&s.x===t.x&&s.z===t.z&&this.Cm(s.type,this.Gr[i],e,r)}for(let i=0;i<this.Rr;i++){const s=this.Lr[this.Dr[i]];s&&s!==t&&s.x===t.x&&s.z===t.z&&this.Sm(s,this.Dr[i],e,r)}}t&&this.Sm(t,a,e,r)}if(3===o){const t=this.Xr[this.er][e][r];if(!t)continue;for(let i=t.vm();i;i=t.Bm()){const t=n.A.get(i.index);if(1===this.Oh)this.Te[this._e]='Use '+this.kh+' with @lre@'+t.name,this.Kh[this._e]=217,this.Zh[this._e]=i.index,this.jh[this._e]=e,this.qh[this._e]=r,this._e++;else if(1!==this.Wh){for(let s=4;s>=0;s--)t.gm&&t.gm[s]?(this.Te[this._e]=t.gm[s]+' @lre@'+t.name,0===s&&(this.Kh[this._e]=224),1===s&&(this.Kh[this._e]=993),2===s&&(this.Kh[this._e]=99),3===s&&(this.Kh[this._e]=746),4===s&&(this.Kh[this._e]=877),this.Zh[this._e]=i.index,this.jh[this._e]=e,this.qh[this._e]=r,this._e++):2===s&&(this.Te[this._e]='Take @lre@'+t.name,this.Kh[this._e]=99,this.Zh[this._e]=i.index,this.jh[this._e]=e,this.qh[this._e]=r,this._e++);this.Te[this._e]='Examine @lre@'+t.name,Ct.A.sg&&(this.Te[this._e]+='@whi@ ('+i.index+')'),this.Kh[this._e]=1102,this.Zh[this._e]=i.index,this.jh[this._e]=e,this.qh[this._e]=r,this._e++}else 1&~this.Hh||(this.Te[this._e]=this.zh+' @lre@'+t.name,this.Kh[this._e]=965,this.Zh[this._e]=i.index,this.jh[this._e]=e,this.qh[this._e]=r,this._e++)}}}}};Cm=(t,i,s,e)=>{if(this._e>=400)return;let h=t.name;if(0!==t.bm&&this.io&&(h=h+this.Im(this.io.Sc,t.bm)+' (level-'+t.bm+')'),1===this.Oh)this.Te[this._e]='Use '+this.kh+' with @yel@'+h,this.Kh[this._e]=900,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++;else if(1!==this.Wh){let n;if(t.gm)for(n=4;n>=0;n--)t.gm[n]&&'attack'!==t.gm[n]?.toLowerCase()&&(this.Te[this._e]=t.gm[n]+' @yel@'+h,0===n?this.Kh[this._e]=728:1===n?this.Kh[this._e]=542:2===n?this.Kh[this._e]=6:3===n?this.Kh[this._e]=963:4===n&&(this.Kh[this._e]=245),this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++);if(t.gm)for(n=4;n>=0;n--)if(t.gm[n]&&'attack'===t.gm[n]?.toLowerCase()){let r=0;this.io&&t.bm>this.io.Sc&&(r=2e3),this.Te[this._e]=t.gm[n]+' @yel@'+h,0===n?this.Kh[this._e]=r+728:1===n?this.Kh[this._e]=r+542:2===n?this.Kh[this._e]=r+6:3===n?this.Kh[this._e]=r+963:4===n&&(this.Kh[this._e]=r+245),this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++}this.Te[this._e]='Examine @yel@'+h,Ct.A.sg&&(this.Te[this._e]+='@whi@ ('+t.id+')'),this.Kh[this._e]=1607,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++}else 2&~this.Hh||(this.Te[this._e]=this.zh+' @yel@'+h,this.Kh[this._e]=265,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++)};Sm=(t,i,s,e)=>{if(t===this.io||this._e>=400)return;let h=null;this.io&&(h=t.name+this.Im(this.io.Sc,t.Sc)+' (level-'+t.Sc+')'),1===this.Oh?(this.Te[this._e]='Use '+this.kh+' with @whi@'+h,this.Kh[this._e]=367,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++):1!==this.Wh?(this.Te[this._e]='Follow @whi@'+h,this.Kh[this._e]=1544,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++,0===this.Se&&(this.Te[this._e]='Trade with @whi@'+h,this.Kh[this._e]=1373,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++),this.oo>0&&(this.Te[this._e]='Attack @whi@'+h,this.io&&this.io.Sc>=t.Sc?this.Kh[this._e]=151:this.Kh[this._e]=2151,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++),1===this.ao&&(this.Te[this._e]='Fight @whi@'+h,this.Kh[this._e]=151,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++),2===this.ao&&(this.Te[this._e]='Duel-with @whi@'+h,this.Kh[this._e]=1101,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++)):8&~this.Hh||(this.Te[this._e]=this.zh+' @whi@'+h,this.Kh[this._e]=651,this.Zh[this._e]=i,this.jh[this._e]=s,this.qh[this._e]=e,this._e++);for(let t=0;t<this._e;t++)if(660===this.Kh[t])return void(this.Te[t]='Walk here @whi@'+h)};Im=(t,i)=>{const s=t-i;return s<-9?'@red@':s<-6?'@or3@':s<-3?'@or2@':s<0?'@or1@':s>9?'@gre@':s>6?'@gr3@':s>3?'@gr2@':s>0?'@gr1@':'@yel@'};lx=()=>{if(0===this.bh){this.Te[0]='Cancel',this.Kh[0]=1252,this._e=1,this.im(this.al),this.Qh=0,this.ol>8&&this.al>11&&this.ol<520&&this.al<345&&(-1===this.pe?this.Am():this.sm(c.A.ta[this.pe],this.ol,this.al,8,11,0)),this.Qh!==this.gh&&(this.gh=this.Qh),this.Qh=0,this.ol>562&&this.al>231&&this.ol<752&&this.al<492&&(-1!==this.Oe?this.sm(c.A.ta[this.Oe],this.ol,this.al,562,231,0):-1!==this.Je[this.$e]&&this.sm(c.A.ta[this.Je[this.$e]],this.ol,this.al,562,231,0)),this.Qh!==this.Ch&&(this.fe=!0,this.Ch=this.Qh),this.Qh=0,this.ol>22&&this.al>375&&this.ol<431&&this.al<471&&(-1===this.Le?this.tm(this.ol-22,this.al-375):this.sm(c.A.ta[this.Le],this.ol,this.al,22,375,0)),-1!==this.Le&&this.Qh!==this.Sh&&(this.ue=!0,this.Sh=this.Qh);let t=!1;for(;!t;){t=!0;for(let i=0;i<this._e-1;i++)if(this.Kh[i]<1e3&&this.Kh[i+1]>1e3){const s=this.Te[i];this.Te[i]=this.Te[i+1],this.Te[i+1]=s;const e=this.Kh[i];this.Kh[i]=this.Kh[i+1],this.Kh[i+1]=e;const h=this.jh[i];this.jh[i]=this.jh[i+1],this.jh[i+1]=h;const n=this.qh[i];this.qh[i]=this.qh[i+1],this.qh[i+1]=n;const r=this.Zh[i];this.Zh[i]=this.Zh[i+1],this.Zh[i+1]=r,t=!1}}}};yx=()=>{let t=0;if(this.Ni){let i;t=this.Ni.Nc('Choose Option');for(let s=0;s<this._e;s++)i=this.Ni.Nc(this.Te[s]),i>t&&(t=i)}t+=8;const i=15*this._e+21;let s,e;this.UA>8&&this.PA>11&&this.UA<520&&this.PA<345&&(s=this.UA-(t/2|0)-8,s+t>512?s=512-t:s<0&&(s=0),e=this.PA-11,e+i>334?e=334-i:e<0&&(e=0),this.me=!0,this.ve=0,this.Be=s,this.be=e,this.Ie=t,this.Ee=15*this._e+22),this.UA>562&&this.PA>231&&this.UA<752&&this.PA<492&&(s=this.UA-(t/2|0)-562,s<0?s=0:s+t>190&&(s=190-t),e=this.PA-231,e<0?e=0:e+i>261&&(e=261-i),this.me=!0,this.ve=1,this.Be=s,this.be=e,this.Ie=t,this.Ee=15*this._e+22),this.UA>22&&this.PA>375&&this.UA<501&&this.PA<471&&(s=this.UA-(t/2|0)-22,s<0?s=0:s+t>479&&(s=479-t),e=this.PA-375,e<0?e=0:e+i>96&&(e=96-i),this.me=!0,this.ve=2,this.Be=s,this.be=e,this.Ie=t,this.Ee=15*this._e+22)};gx=(t,i,s,e,h,n,r,o,a,l,c)=>{const f=this.ir[this.er];if(!f)return!1;const u=$.A.Ar,d=$.A.Ar;for(let t=0;t<u;t++)for(let i=0;i<d;i++){const s=$.A.index(t,i);this.$r[s]=0,this.Jr[s]=99999999}let y=t,p=i;const w=$.A.index(t,i);this.$r[w]=99,this.Jr[w]=0;let A=0,x=0;this.jr[A]=t,this.qr[A++]=i;let g=!1,C=this.jr.length;const S=f.flags;for(;x!==A;){if(y=this.jr[x],p=this.qr[x],x=(x+1)%C,y===s&&p===e){g=!0;break}if(a!==K.A.xC.id){if((a<K.A.Em.id||a===K.A.QC.id)&&f._m(y,p,s,e,a-1,o)){g=!0;break}if(a<K.A.QC.id&&f.Tm(y,p,s,e,a-1,o)){g=!0;break}}if(0!==n&&0!==r&&f.Om(y,p,s,e,n,r,l)){g=!0;break}const t=this.Jr[$.A.index(y,p)]+1;let i=$.A.index(y-1,p);y>0&&0===this.$r[i]&&(S[i]&J.A.fC)===J.A.OPEN&&(this.jr[A]=y-1,this.qr[A]=p,A=(A+1)%C,this.$r[i]=2,this.Jr[i]=t),i=$.A.index(y+1,p),y<u-1&&0===this.$r[i]&&(S[i]&J.A.uC)===J.A.OPEN&&(this.jr[A]=y+1,this.qr[A]=p,A=(A+1)%C,this.$r[i]=8,this.Jr[i]=t),i=$.A.index(y,p-1),p>0&&0===this.$r[i]&&(S[i]&J.A.dC)===J.A.OPEN&&(this.jr[A]=y,this.qr[A]=p-1,A=(A+1)%C,this.$r[i]=1,this.Jr[i]=t),i=$.A.index(y,p+1),p<d-1&&0===this.$r[i]&&(S[i]&J.A.yC)===J.A.OPEN&&(this.jr[A]=y,this.qr[A]=p+1,A=(A+1)%C,this.$r[i]=4,this.Jr[i]=t),i=$.A.index(y-1,p-1),y>0&&p>0&&0===this.$r[i]&&!(S[i]&J.A.Lm)&&(S[$.A.index(y-1,p)]&J.A.fC)===J.A.OPEN&&(S[$.A.index(y,p-1)]&J.A.dC)===J.A.OPEN&&(this.jr[A]=y-1,this.qr[A]=p-1,A=(A+1)%C,this.$r[i]=3,this.Jr[i]=t),i=$.A.index(y+1,p-1),y<u-1&&p>0&&0===this.$r[i]&&!(S[i]&J.A.Rm)&&(S[$.A.index(y+1,p)]&J.A.uC)===J.A.OPEN&&(S[$.A.index(y,p-1)]&J.A.dC)===J.A.OPEN&&(this.jr[A]=y+1,this.qr[A]=p-1,A=(A+1)%C,this.$r[i]=9,this.Jr[i]=t),i=$.A.index(y-1,p+1),y>0&&p<d-1&&0===this.$r[i]&&!(S[i]&J.A.Dm)&&(S[$.A.index(y-1,p)]&J.A.fC)===J.A.OPEN&&(S[$.A.index(y,p+1)]&J.A.yC)===J.A.OPEN&&(this.jr[A]=y-1,this.qr[A]=p+1,A=(A+1)%C,this.$r[i]=6,this.Jr[i]=t),i=$.A.index(y+1,p+1),y<u-1&&p<d-1&&0===this.$r[i]&&!(S[i]&J.A.km)&&(S[$.A.index(y+1,p)]&J.A.uC)===J.A.OPEN&&(S[$.A.index(y,p+1)]&J.A.yC)===J.A.OPEN&&(this.jr[A]=y+1,this.qr[A]=p+1,A=(A+1)%C,this.$r[i]=12,this.Jr[i]=t)}if(this.Qr=0,!g){if(c){let t=100;for(let i=1;i<2;i++){for(let h=s-i;h<=s+i;h++)for(let s=e-i;s<=e+i;s++){const i=$.A.index(h,s);h>=0&&s>=0&&h<$.A.Ar&&s<$.A.Ar&&this.Jr[i]<t&&(t=this.Jr[i],y=h,p=s,this.Qr=1,g=!0)}if(g)break}}if(!g)return!1}x=0,this.jr[x]=y,this.qr[x++]=p;let m=this.$r[$.A.index(y,p)],v=m;for(;y!==t||p!==i;)v!==m&&(m=v,this.jr[x]=y,this.qr[x++]=p),v&dt.A.mC?y++:v&dt.A.CC&&y--,v&dt.A.SC?p++:v&dt.A.vC&&p--,v=this.$r[$.A.index(y,p)];if(x>0){C=Math.min(x,25),x--;const t=this.jr[x],i=this.qr[x];if(Ct.A.Ug&&1===this.hx[6]&&1===this.hx[7]){for(let t=0;t<this.Zo.length;t++){const i=this.Zo[t];if(i&&i.x===H.A.Ax&&i.z===H.A.xx)return this.Zo[t]=null,!1}return this.Zo[this.jo]=new ut.A(this.er,H.A.Ax,H.A.xx),this.jo=this.jo+1&this.Zo.length-1,!1}0===h?(this.ai.$A(k.my),this.ai.p1(C+C+3)):1===h?(this.ai.$A(k.ly),this.ai.p1(C+C+3+14)):2===h&&(this.ai.$A(k.ny),this.ai.p1(C+C+3)),1===this.hx[5]?this.ai.p1(1):this.ai.p1(0),this.ai.p2(t+this.Kn),this.ai.p2(i+this.Zn),this.wn=this.jr[0],this.An=this.qr[0];for(let s=1;s<C;s++)x--,this.ai.p1(this.jr[x]-t),this.ai.p1(this.qr[x]-i);return!0}return 1!==h};NS=(t,i)=>{this.Mr=0,this.kr=0,this.Mm(t),this.Um(t),this.Pm(t,i),this.Nm(t);for(let t=0;t<this.Mr;t++){const i=this.Pr[t],s=this.Lr[i];s&&(s.Kx!==this.ni&&(this.Lr[i]=null))}if(t.ft!==i)throw new Error(`eek! Error packet size mismatch in getplayer pos:${t.ft} psize:${i}`);for(let t=0;t<this.Rr;t++)if(!this.Lr[this.Dr[t]])throw new Error(`eek! ${this.username} null entry in pl list - pos:${t} size:${this.Rr}`)};Mm=t=>{t.Fm();if(0!==t.Vm(1)){const i=t.Vm(2);if(0===i)this.Ur[this.kr++]=this.ti;else if(1===i){const i=t.Vm(3);this.io?.step(!1,i);1===t.Vm(1)&&(this.Ur[this.kr++]=this.ti)}else if(2===i){const i=t.Vm(3);this.io?.step(!0,i);const s=t.Vm(3);this.io?.step(!0,s);1===t.Vm(1)&&(this.Ur[this.kr++]=this.ti)}else if(3===i){this.er=t.Vm(2);const i=t.Vm(7),s=t.Vm(7),e=t.Vm(1);this.io?.move(1===e,i,s);1===t.Vm(1)&&(this.Ur[this.kr++]=this.ti)}}};Um=t=>{const i=t.Vm(8);if(i<this.Rr)for(let t=i;t<this.Rr;t++)this.Pr[this.Mr++]=this.Dr[t];if(i>this.Rr)throw new Error(`eek! ${this.username} Too many players`);this.Rr=0;for(let s=0;s<i;s++){const i=this.Dr[s],e=this.Lr[i];if(0===t.Vm(1))this.Dr[this.Rr++]=i,e&&(e.Kx=this.ni);else{const s=t.Vm(2);if(0===s)this.Dr[this.Rr++]=i,e&&(e.Kx=this.ni),this.Ur[this.kr++]=i;else if(1===s){this.Dr[this.Rr++]=i,e&&(e.Kx=this.ni);const s=t.Vm(3);e?.step(!1,s);1===t.Vm(1)&&(this.Ur[this.kr++]=i)}else if(2===s){this.Dr[this.Rr++]=i,e&&(e.Kx=this.ni);const s=t.Vm(3);e?.step(!0,s);const h=t.Vm(3);e?.step(!0,h);1===t.Vm(1)&&(this.Ur[this.kr++]=i)}else 3===s&&(this.Pr[this.Mr++]=i)}}};Pm=(t,i)=>{let s;for(;t.Gm+10<8*i&&(s=t.Vm(11),2047!==s);){if(!this.Lr[s]){this.Lr[s]=new Q.A;const t=this.Nr[s];t&&this.Lr[s]?.read(t)}this.Dr[this.Rr++]=s;const i=this.Lr[s];i&&(i.Kx=this.ni);let e=t.Vm(5);e>15&&(e-=32);let h=t.Vm(5);h>15&&(h-=32);const n=t.Vm(1);this.io&&i?.move(1===n,this.io.Cx[0]+e,this.io.Sx[0]+h);1===t.Vm(1)&&(this.Ur[this.kr++]=s)}t.xf()};Nm=t=>{for(let i=0;i<this.kr;i++){const s=this.Ur[i],e=this.Lr[s];if(!e)continue;let h=t.kc;(h&Q.A.Wm)===Q.A.Wm&&(h+=t.kc<<8),this.Ym(e,s,h,t)}};Ym=(t,i,s,h)=>{if(t._g=s,t.Tg=this.ni,(s&Q.A.Og)===Q.A.Og){const s=h.kc,e=new Uint8Array(s),n=new w.A(e);h.LS(s,0,e),this.Nr[i]=n,t.read(n)}if((s&Q.A.yw)===Q.A.yw){let i=h.ct;65535===i&&(i=-1),i===t.Pw&&(t.Hm=0);const s=h.kc;(-1===i||-1===t.Pw||e.A.ta[i].priority>e.A.ta[t.Pw].priority||0===e.A.ta[t.Pw].priority)&&(t.Pw=i,t.Fw=0,t.zm=0,t.Nw=s,t.Hm=0)}if((s&Q.A.pw)===Q.A.pw&&(t.Lg=h.ct,65535===t.Lg&&(t.Lg=-1)),(s&Q.A.ww)===Q.A.ww&&(t.yg=h.TS,t.wg=0,t.Ag=0,t.xg=150,t.name&&this._C(2,t.yg,t.name)),(s&Q.A.Aw)===Q.A.Aw&&(t.vg=h.kc,t.mg=h.kc,t.gg=this.ni+400,t.Cg=h.kc,t.Sg=h.kc),(s&Q.A.Cw)===Q.A.Cw&&(t.Xm=h.ct,t.Km=h.ct,t.Rg=t.Xm,t.Dg=t.Km),(s&Q.A.kg)===Q.A.kg){const i=h.ct,s=h.kc,e=h.kc,n=h.ft;if(t.name){const n=W.A.eC(t.name);let r=!1;if(s<=1)for(let t=0;t<this.Me;t++)if(this.Ue[t]===n){r=!0;break}if(!r&&0===this.Se)try{const n=U.Dy(h,e),r=M.filter(n);t.yg=r,t.wg=i>>8,t.Ag=255&i,t.xg=150,s>1?this._C(1,r,t.name):this._C(2,r,t.name)}catch(t){}}h.ft=n+e}if((s&Q.A.gw)===Q.A.gw){t.Sw=h.ct;const i=h.ut;t.Ew=i>>16,t.Zm=this.ni+(65535&i),t.mw=0,t.jm=0,t.Zm>this.ni&&(t.mw=-1),65535===t.Sw&&(t.Sw=-1)}(s&Q.A.Mg)===Q.A.Mg&&(t.qm=h.kc,t.$m=h.kc,t.Jm=h.kc,t.Qm=h.kc,t.bg=h.ct+this.ni,t.Ig=h.ct+this.ni,t.tv=h.kc,t.pathLength=0,t.Cx[0]=t.Jm,t.Sx[0]=t.Qm)};IS=(t,i)=>{this.Mr=0,this.kr=0,this.iv(t),this.sv(t,i),this.ev(t);for(let t=0;t<this.Mr;t++){const i=this.Pr[t],s=this.Fr[i];s&&(s.Kx!==this.ni&&(s.type=null,this.Fr[i]=null))}if(t.ft!==i)throw new Error(`eek! ${this.username} size mismatch in getnpcpos - pos:${t.ft} psize:${i}`);for(let t=0;t<this.Vr;t++)if(!this.Fr[this.Gr[t]])throw new Error(`eek! ${this.username} null entry in npc list - pos:${t} size:${this.Vr}`)};iv=t=>{t.Fm();const i=t.Vm(8);if(i<this.Vr)for(let t=i;t<this.Vr;t++)this.Pr[this.Mr++]=this.Gr[t];if(i>this.Vr)throw new Error(`eek! ${this.username} Too many npcs`);this.Vr=0;for(let s=0;s<i;s++){const i=this.Gr[s],e=this.Fr[i];if(0===t.Vm(1))this.Gr[this.Vr++]=i,e&&(e.Kx=this.ni);else{const s=t.Vm(2);if(0===s)this.Gr[this.Vr++]=i,e&&(e.Kx=this.ni),this.Ur[this.kr++]=i;else if(1===s){this.Gr[this.Vr++]=i,e&&(e.Kx=this.ni);const s=t.Vm(3);e?.step(!1,s);1===t.Vm(1)&&(this.Ur[this.kr++]=i)}else if(2===s){this.Gr[this.Vr++]=i,e&&(e.Kx=this.ni);const s=t.Vm(3);e?.step(!0,s);const h=t.Vm(3);e?.step(!0,h);1===t.Vm(1)&&(this.Ur[this.kr++]=i)}else 3===s&&(this.Pr[this.Mr++]=i)}}};sv=(t,i)=>{for(;t.Gm+21<8*i;){const i=t.Vm(13);if(8191===i)break;this.Fr[i]||(this.Fr[i]=new it);const s=this.Fr[i];this.Gr[this.Vr++]=i,s?(s.Kx=this.ni,s.type=r.A.get(t.Vm(11)),s.size=s.type.size,s.hv=s.type.nv,s.rv=s.type.ov,s.av=s.type.lv,s.cv=s.type.fv,s.hc=s.type.uv):t.Vm(11);let e=t.Vm(5);e>15&&(e-=32);let h=t.Vm(5);h>15&&(h-=32),this.io&&s?.move(!1,this.io.Cx[0]+e,this.io.Sx[0]+h);1===t.Vm(1)&&(this.Ur[this.kr++]=i)}t.xf()};ev=t=>{for(let i=0;i<this.kr;i++){const s=this.Ur[i],h=this.Fr[s];if(!h)continue;const n=t.kc;if(h._g=n,h.Tg=this.ni,(n&it.yw)===it.yw){let i=t.ct;65535===i&&(i=-1),i===h.Pw&&(h.Hm=0);const s=t.kc;(-1===i||-1===h.Pw||e.A.ta[i].priority>e.A.ta[h.Pw].priority||0===e.A.ta[h.Pw].priority)&&(h.Pw=i,h.Fw=0,h.zm=0,h.Nw=s,h.Hm=0)}if((n&it.pw)===it.pw&&(h.Lg=t.ct,65535===h.Lg&&(h.Lg=-1)),(n&it.ww)===it.ww&&(h.yg=t.TS,h.xg=100),(n&it.Aw)===it.Aw&&(h.vg=t.kc,h.mg=t.kc,h.gg=this.ni+400,h.Cg=t.kc,h.Sg=t.kc),(n&it.xw)===it.xw&&(h.type=r.A.get(t.ct),h.hv=h.type.nv,h.rv=h.type.ov,h.av=h.type.lv,h.cv=h.type.fv,h.hc=h.type.uv),(n&it.gw)===it.gw){h.Sw=t.ct;const i=t.ut;h.Ew=i>>16,h.Zm=this.ni+(65535&i),h.mw=0,h.jm=0,h.Zm>this.ni&&(h.mw=-1),65535===h.Sw&&(h.Sw=-1)}(n&it.Cw)===it.Cw&&(h.Xm=t.ct,h.Km=t.ct,h.Rg=h.Xm,h.Dg=h.Km)}};QA=()=>{for(let t=-1;t<this.Rr;t++){let i;i=-1===t?this.ti:this.Dr[t];const s=this.Lr[i];s&&this.dv(s)}if(at.K.Ut++,at.K.Ut>1406){at.K.Ut=0,this.ai.$A(k.yd),this.ai.p1(0);const t=this.ai.ft;this.ai.p1(162),this.ai.p1(22),2*Math.random()|0||this.ai.p1(84),this.ai.p2(31824),this.ai.p2(13490),2*Math.random()|0||this.ai.p1(123),2*Math.random()|0||this.ai.p1(134),this.ai.p1(100),this.ai.p1(94),this.ai.p2(35521),this.ai.Hx(this.ai.ft-t)}};dv=t=>{(t.x<128||t.z<128||t.x>=13184||t.z>=13184)&&(t.Pw=-1,t.Sw=-1,t.bg=0,t.Ig=0,t.x=128*t.Cx[0]+64*t.size,t.z=128*t.Sx[0]+64*t.size,t.pathLength=0),t===this.io&&(t.x<1536||t.z<1536||t.x>=11776||t.z>=11776)&&(t.Pw=-1,t.Sw=-1,t.bg=0,t.Ig=0,t.x=128*t.Cx[0]+64*t.size,t.z=128*t.Sx[0]+64*t.size,t.pathLength=0),t.bg>this.ni?this.yv(t):t.Ig>=this.ni?this.pv(t):this.wv(t),this.Av(t),this.xv(t)};Ux=()=>{if(this.io){this.io.x>>7===this.wn&&this.io.z>>7===this.An&&(this.wn=0);for(let t=-1;t<this.Rr;t++){let i,s;if(-1===t?(i=this.io,s=this.ti<<14):(i=this.Lr[this.Dr[t]],s=this.Dr[t]<<14),!i||!i.isVisible())continue;i.Bt=(at.K.Bt&&this.Rr>50||this.Rr>200)&&-1!==t&&i.Vw===i.hc;const e=i.x>>7,h=i.z>>7;if(!(e<0||e>=$.A.Ar||h<0||h>=$.A.Ar))if(!i.gv||this.ni<i.Cv||this.ni>=i.Sv){if(64==(127&i.x)&&64==(127&i.z)){if(this.pr[e][h]===this.pn)continue;this.pr[e][h]=this.pn}i.y=this.Wx(this.er,i.x,i.z),this.un?.mv(this.er,i.x,i.y,i.z,null,i,s,i.Qw,60,i.vv)}else i.Bt=!1,i.y=this.Wx(this.er,i.x,i.z),this.un?.Bv(this.er,i.x,i.y,i.z,i.bv,i.Iv,i.Ev,i._v,null,i,s,i.Qw)}}};tx=()=>{for(let t=0;t<this.Vr;t++){const i=this.Gr[t],s=this.Fr[i];s&&s.type&&this.dv(s)}};Px=()=>{for(let t=0;t<this.Vr;t++){const i=this.Fr[this.Gr[t]],s=536870912+(this.Gr[t]<<14)|0;if(!i||!i.isVisible())continue;const e=i.x>>7,h=i.z>>7;if(!(e<0||e>=$.A.Ar||h<0||h>=$.A.Ar)){if(1===i.size&&64==(127&i.x)&&64==(127&i.z)){if(this.pr[e][h]===this.pn)continue;this.pr[e][h]=this.pn}this.un?.mv(this.er,i.x,this.Wx(this.er,i.x,i.z),i.z,null,i,s,i.Qw,64*(i.size-1)+60,i.vv)}}};Nx=()=>{for(let t=this.Wr.head();t;t=this.Wr.next())if(t.level!==this.er||this.ni>t.dw)t.ES();else if(this.ni>=t.Zw){if(t.target>0){const i=this.Fr[t.target-1];i&&t.tA(i.x,this.Wx(t.level,i.x,i.z)-t.offsetY,i.z,this.ni)}if(t.target<0){const i=-t.target-1;let s;s=i===this.ho?this.io:this.Lr[i],s&&t.tA(s.x,this.Wx(t.level,s.x,s.z)-t.offsetY,s.z,this.ni)}t.update(this.yn),this.un?.mv(this.er,0|t.x,0|t.y,0|t.z,null,t,-1,t.Qw,60,!1)}};Fx=()=>{for(let t=this.Yr.head();t;t=this.Yr.next())t.level!==this.er||t.sA?t.ES():this.ni>=t.Zw&&(t.update(this.yn),t.sA?t.ES():this.un?.mv(t.level,t.x,t.y,t.z,null,t,-1,0,60,!1))};Vx=()=>{for(let t=this.Hr.head();t;t=this.Hr.next()){let i=!1;if(t.Fa+=this.yn,-1===t.Va&&(t.Va=0,i=!0),t._w.delay)for(;t.Fa>t._w.delay[t.Va];)if(t.Fa-=t._w.delay[t.Va]+1,t.Va++,i=!0,t.Va>=t._w.Ga&&(t.Va-=t._w.Wa,t.Va<0||t.Va>=t._w.Ga)){t.ES(),i=!1;break}if(i&&this.un){const i=t.qS,s=t.ZS,e=t.jS;let n=0;if(0===t.Tv?n=this.un.pC(i,s,e):1===t.Tv?n=this.un.wS(i,e,s):2===t.Tv?n=this.un.bC(i,s,e):3===t.Tv&&(n=this.un.lC(i,s,e)),this.dr&&0!==n&&(n>>14&32767)===t.index){const r=this.dr[i][s][e],o=this.dr[i][s+1][e],a=this.dr[i][s+1][e+1],l=this.dr[i][s][e+1],c=h.A.get(t.index);let f=-1;if(-1!==t.Va&&t._w.frames&&(f=t._w.frames[t.Va]),2===t.Tv){const t=this.un.wC(i,s,e,n);let h=31&t;const u=t>>6;h===K.A.tS.id&&(h=K.A.QC.id),this.un?.Ov(i,s,e,c.Ul(h,u,r,o,a,l,f))}else if(1===t.Tv)this.un?.Lv(i,s,e,c.Ul(K.A.Rv.id,0,r,o,a,l,f));else if(0===t.Tv){const t=this.un.wC(i,s,e,n),h=31&t,u=t>>6;if(h===K.A.gC.id){const t=u+1&3;this.un?.Dv(s,e,i,c.Ul(K.A.gC.id,u+4,r,o,a,l,f),c.Ul(K.A.gC.id,t,r,o,a,l,f))}else this.un?.kv(i,s,e,c.Ul(h,u,r,o,a,l,f))}else if(3===t.Tv){const t=this.un.wC(i,s,e,n)>>6;this.un?.Mv(i,s,e,c.Ul(K.A.iS.id,t,r,o,a,l,f))}}else t.ES()}}};ix=()=>{for(let t=-1;t<this.Rr;t++){let i;i=-1===t?this.ti:this.Dr[t];const s=this.Lr[i];s&&s.xg>0&&(s.xg--,0===s.xg&&(s.yg=null))}for(let t=0;t<this.Vr;t++){const i=this.Gr[t],s=this.Fr[i];s&&s.xg>0&&(s.xg--,0===s.xg&&(s.yg=null))}};sx=()=>{if(2===this.dn){for(let t=this.zr.head();t;t=this.zr.next())this.ni>=t.dw&&(this.dS(t.ow,t.x,t.z,t.lw,t.angle,t.shape,t.aw),t.ES());at.K.Mt++,at.K.Mt>85&&(at.K.Mt=0,this.ai.$A(k.dd))}};yv=t=>{const i=t.bg-this.ni,s=128*t.qm+64*t.size,e=128*t.$m+64*t.size;t.x+=(s-t.x)/i|0,t.z+=(e-t.z)/i|0,t.Uv=0,0===t.tv&&(t.Pv=1024),1===t.tv&&(t.Pv=1536),2===t.tv&&(t.Pv=0),3===t.tv&&(t.Pv=512)};pv=t=>{if(t.Ig===this.ni||-1===t.Pw||0!==t.Nw||t.zm+1>e.A.ta[t.Pw].delay[t.Fw]){const i=t.Ig-t.bg,s=this.ni-t.bg,e=128*t.qm+64*t.size,h=128*t.$m+64*t.size,n=128*t.Jm+64*t.size,r=128*t.Qm+64*t.size;t.x=(e*(i-s)+n*s)/i|0,t.z=(h*(i-s)+r*s)/i|0}t.Uv=0,0===t.tv&&(t.Pv=1024),1===t.tv&&(t.Pv=1536),2===t.tv&&(t.Pv=0),3===t.tv&&(t.Pv=512),t.Qw=t.Pv};Av=t=>{if(-1!==t.Lg&&t.Lg<32768){const i=this.Fr[t.Lg];if(i){const s=t.x-i.x,e=t.z-i.z;0===s&&0===e||(t.Pv=325.949*Math.atan2(s,e)&2047)}}if(t.Lg>=32768){let i=t.Lg-32768;i===this.ho&&(i=this.ti);const s=this.Lr[i];if(s){const i=t.x-s.x,e=t.z-s.z;0===i&&0===e||(t.Pv=325.949*Math.atan2(i,e)&2047)}}if((0!==t.Xm||0!==t.Km)&&(0===t.pathLength||t.Uv>0)){const i=t.x-64*(t.Xm-this.Kn-this.Kn),s=t.z-64*(t.Km-this.Zn-this.Zn);0===i&&0===s||(t.Pv=325.949*Math.atan2(i,s)&2047),t.Xm=0,t.Km=0}const i=t.Pv-t.Qw&2047;if(0!==i&&(i<32||i>2016?t.Qw=t.Pv:i>1024?t.Qw-=32:t.Qw+=32,t.Qw&=2047,t.Vw===t.hc&&t.Qw!==t.Pv)){if(-1!==t.Nv)return void(t.Vw=t.Nv);t.Vw=t.hv}};xv=t=>{let i;if(t.vv=!1,-1!==t.Vw&&(i=e.A.ta[t.Vw],t.Fv++,i.delay&&t.Gw<i.Ga&&t.Fv>i.delay[t.Gw]&&(t.Fv=0,t.Gw++),t.Gw>=i.Ga&&(t.Fv=0,t.Gw=0)),-1!==t.Pw&&0===t.Nw){for(i=e.A.ta[t.Pw],t.zm++;i.delay&&t.Fw<i.Ga&&t.zm>i.delay[t.Fw];)t.zm-=i.delay[t.Fw],t.Fw++;t.Fw>=i.Ga&&(t.Fw-=i.Wa,t.Hm++,t.Hm>=i.Vv&&(t.Pw=-1),(t.Fw<0||t.Fw>=i.Ga)&&(t.Pw=-1)),t.vv=i.Gv}if(t.Nw>0&&t.Nw--,-1!==t.Sw&&this.ni>=t.Zm){for(t.mw<0&&(t.mw=0),i=a.A.ta[t.Sw]._w,t.jm++;i&&i.delay&&t.mw<i.Ga&&t.jm>i.delay[t.mw];)t.jm-=i.delay[t.mw],t.mw++;i&&t.mw>=i.Ga&&(t.mw<0||t.mw>=i.Ga)&&(t.Sw=-1)}};wv=t=>{if(t.Vw=t.hc,0===t.pathLength)return void(t.Uv=0);if(-1!==t.Pw&&0===t.Nw){if(!e.A.ta[t.Pw].Ww)return void t.Uv++}const i=t.x,s=t.z,h=128*t.Cx[t.pathLength-1]+64*t.size,n=128*t.Sx[t.pathLength-1]+64*t.size;if(h-i<=256&&h-i>=-256&&n-s<=256&&n-s>=-256){t.Pv=i<h?s<n?1280:s>n?1792:1536:i>h?s<n?768:s>n?256:512:s<n?1024:0;let e=t.Pv-t.Qw&2047;e>1024&&(e-=2048);let r=t.rv;e>=-256&&e<=256?r=t.hv:e>=256&&e<768?r=t.cv:e>=-768&&e<=-256&&(r=t.av),-1===r&&(r=t.hv),t.Vw=r;let o=4;t.Qw!==t.Pv&&-1===t.Lg&&(o=2),t.pathLength>2&&(o=6),t.pathLength>3&&(o=8),t.Uv>0&&t.pathLength>1&&(o=8,t.Uv--),t.Wv[t.pathLength-1]&&(o<<=1),o>=8&&t.Vw===t.hv&&-1!==t.Yv&&(t.Vw=t.Yv),i<h?(t.x+=o,t.x>h&&(t.x=h)):i>h&&(t.x-=o,t.x<h&&(t.x=h)),s<n?(t.z+=o,t.z>n&&(t.z=n)):s>n&&(t.z-=o,t.z<n&&(t.z=n)),t.x===h&&t.z===n&&t.pathLength--}else t.x=h,t.z=n};Xx=()=>{if(Ct.A.hS)return this.er;let t=3;if(this.kn<310&&this.io){let i=this.Ln>>7,s=this.Dn>>7;const e=this.io.x>>7,h=this.io.z>>7;let n,r,o,a;if(this.yr&&4&this.yr[this.er][i][s]&&(t=this.er),n=e>i?e-i:i-e,r=h>s?h-s:s-h,n>r)for(o=65536*r/n|0,a=32768;i!==e;)i<e?i++:i>e&&i--,this.yr&&4&this.yr[this.er][i][s]&&(t=this.er),a+=o,a>=65536&&(a-=65536,s<h?s++:s>h&&s--,this.yr&&4&this.yr[this.er][i][s]&&(t=this.er));else for(o=65536*n/r|0,a=32768;s!==h;)s<h?s++:s>h&&s--,this.yr&&4&this.yr[this.er][i][s]&&(t=this.er),a+=o,a>=65536&&(a-=65536,i<e?i++:i>e&&i--,this.yr&&4&this.yr[this.er][i][s]&&(t=this.er))}return this.io&&this.yr&&4&this.yr[this.er][this.io.x>>7][this.io.z>>7]&&(t=this.er),t};zx=()=>{if(!this.yr)return 0;return this.Wx(this.er,this.Ln,this.Dn)-this.Rn>=800||!(4&this.yr[this.er][this.Ln>>7][this.Dn>>7])?3:this.er};Wx=(t,i,s)=>{if(!this.dr)return 0;const e=Math.min(i>>7,$.A.Ar-1),h=Math.min(s>>7,$.A.Ar-1);let n=t;t<3&&this.yr&&!(2&~this.yr[1][e][h])&&(n=t+1);const r=127&i,o=127&s;return(this.dr[n][e][h]*(128-r)+this.dr[n][e+1][h]*r>>7)*(128-o)+(this.dr[n][e][h+1]*(128-r)+this.dr[n][e+1][h+1]*r>>7)*o>>7};Gx=(t,i,s,e,h,n)=>{const r=2048-h&2047,o=2048-e&2047;let a,l,c,f=0,u=0,y=n;0!==r&&(a=d.A.sin[r],l=d.A.cos[r],c=u*l-n*a>>16,y=u*a+n*l>>16,u=c),0!==o&&(a=d.A.sin[o],l=d.A.cos[o],c=y*a+f*l>>16,y=y*l-f*a>>16,f=c),this.Ln=t-f,this.Rn=i-u,this.Dn=s-y,this.kn=h,this.Mn=e};Ex=()=>{if(!this.io)return;const t=this.io.x+this.Cn,i=this.io.z+this.Sn;(this.cr-t<-500||this.cr-t>500||this.ur-i<-500||this.ur-i>500)&&(this.cr=t,this.ur=i),this.cr!==t&&(this.cr+=(t-this.cr)/16|0),this.ur!==i&&(this.ur+=(i-this.ur)/16|0),1===this.hx[1]?this.ar+=(-this.ar-24)/2|0:1===this.hx[2]?this.ar+=(24-this.ar)/2|0:this.ar=this.ar/2|0,1===this.hx[3]?this.lr+=(12-this.lr)/2|0:1===this.hx[4]?this.lr+=(-this.lr-12)/2|0:this.lr=this.lr/2|0,this.rr=this.rr+this.ar/2&2047,this.nr+=this.lr/2|0,this.nr<128&&(this.nr=128),this.nr>383&&(this.nr=383);const s=this.cr>>7,e=this.ur>>7,h=this.Wx(this.er,this.cr,this.ur);let n=0;if(this.dr&&s>3&&e>3&&s<100&&e<100)for(let t=s-4;t<=s+4;t++)for(let i=e-4;i<=e+4;i++){let s=this.er;s<3&&this.yr&&!(2&~this.yr[1][t][i])&&s++;const e=h-this.dr[s][t][i];e>n&&(n=e)}let r=192*n;r>98048&&(r=98048),r<32768&&(r=32768),r>this.Un?this.Un+=(r-this.Un)/24|0:r<this.Un&&(this.Un+=(r-this.Un)/80|0)};_x=()=>{let t=128*this.Ir+64,i=128*this.Er+64,s=this.Wx(this.er,this.Ir,this.Er)-this._r;this.Ln<t&&(this.Ln+=this.Tr+((t-this.Ln)*this.Or/1e3|0),this.Ln>t&&(this.Ln=t)),this.Ln>t&&(this.Ln-=this.Tr+((this.Ln-t)*this.Or/1e3|0),this.Ln<t&&(this.Ln=t)),this.Rn<s&&(this.Rn+=this.Tr+((s-this.Rn)*this.Or/1e3|0),this.Rn>s&&(this.Rn=s)),this.Rn>s&&(this.Rn-=this.Tr+((this.Rn-s)*this.Or/1e3|0),this.Rn<s&&(this.Rn=s)),this.Dn<i&&(this.Dn+=this.Tr+((i-this.Dn)*this.Or/1e3|0),this.Dn>i&&(this.Dn=i)),this.Dn>i&&(this.Dn-=this.Tr+((this.Dn-i)*this.Or/1e3|0),this.Dn<i&&(this.Dn=i)),t=128*this.Sr+64,i=128*this.mr+64,s=this.Wx(this.er,this.Sr,this.mr)-this.vr;const e=t-this.Ln,h=s-this.Rn,n=i-this.Dn,r=0|Math.sqrt(e*e+n*n);let o=325.949*Math.atan2(h,r)&2047;const a=-325.949*Math.atan2(e,n)&2047;o<128&&(o=128),o>383&&(o=383),this.kn<o&&(this.kn+=this.Br+((o-this.kn)*this.br/1e3|0),this.kn>o&&(this.kn=o)),this.kn>o&&(this.kn-=this.Br+((this.kn-o)*this.br/1e3|0),this.kn<o&&(this.kn=o));let l=a-this.Mn;l>1024&&(l-=2048),l<-1024&&(l+=2048),l>0&&(this.Mn+=this.Br+(l*this.br/1e3|0),this.Mn&=2047),l<0&&(this.Mn-=this.Br+(-l*this.br/1e3|0),this.Mn&=2047);let c=a-this.Mn;c>1024&&(c-=2048),c<-1024&&(c+=2048),(c<0&&l>0||c>0&&l<0)&&(this.Mn=a)};OS=(t,i)=>{const s=t.kc;let n=this.Yn+(s>>4&7),r=this.Hn+(7&s);if(i===D.Gu||i===D.Yu){const s=t.kc,e=s>>2,h=3&s,o=K.A.of(e).aw;let a;if(a=i===D.Yu?-1:t.ct,n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar){let t=null;for(let i=this.Zr.head();i;i=this.Zr.next())if(i.ow===this.er&&i.x===n&&i.z===r&&i.aw===o){t=i;break}if(!t&&this.un){let i=0,s=-1,e=0,h=0;if(o===X.A.yS?i=this.un.pC(this.er,n,r):o===X.A.pS?i=this.un.wS(this.er,r,n):o===X.A.AS?i=this.un.bC(this.er,n,r):o===X.A.iS&&(i=this.un.lC(this.er,n,r)),0!==i){const t=this.un.wC(this.er,n,r,i);s=i>>14&32767,e=31&t,h=t>>6}t=new j(this.er,o,n,r,0,Z.A.CC,K.A.xC.id,s,h,e),this.Zr.Sf(t)}t&&(t.lw=a,t.shape=e,t.angle=h),this.dS(this.er,n,r,a,h,e,o)}}else if(i===D.Nu){const i=t.kc>>2,s=K.A.of(i).aw,h=t.ct;if(n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar&&this.un){let t=0;if(s===X.A.yS?t=this.un.pC(this.er,n,r):s===X.A.pS?t=this.un.wS(this.er,r,n):s===X.A.AS?t=this.un.bC(this.er,n,r):s===X.A.iS&&(t=this.un.lC(this.er,n,r)),0!==t){const i=new et.A(t>>14&32767,this.er,s,n,r,e.A.ta[h],!1);this.Hr.Sf(i)}}}else if(i===D.Xu){const i=t.ct,s=t.ct;if(n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar){const t=new st(i,s);this.Xr[this.er][n][r]||(this.Xr[this.er][n][r]=new v.A),this.Xr[this.er][n][r]?.Sf(t),this.oS(n,r)}}else if(i===D.Fu){const i=t.ct;if(n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar){const t=this.Xr[this.er][n][r];if(t){for(let s=t.head();s;s=t.next())if(s.index===(32767&i)){s.ES();break}t.head()||(this.Xr[this.er][n][r]=null),this.oS(n,r)}}}else if(i===D.Wu){let i=n+t.Mc,s=r+t.Mc;const e=t.kS,h=t.ct,o=t.kc,a=t.kc,l=t.ct,c=t.ct,f=t.kc,u=t.kc;if(n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar&&i>=0&&s>=0&&i<$.A.Ar&&s<$.A.Ar){n=128*n+64,r=128*r+64,i=128*i+64,s=128*s+64;const t=new nt(h,this.er,n,this.Wx(this.er,n,r)-o,r,l+this.ni,c+this.ni,f,u,e,a);t.tA(i,this.Wx(this.er,i,s)-a,s,l+this.ni),this.Wr.Sf(t)}}else if(i===D.zu){const i=t.ct,s=t.kc,e=t.ct;if(n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar){n=128*n+64,r=128*r+64;const t=new rt(i,this.er,n,r,this.Wx(this.er,n,r)-s,this.ni,e);this.Yr.Sf(t)}}else if(i===D.Vu){const i=t.ct,s=t.ct,e=t.ct;if(n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar&&e!==this.ho){const t=new st(i,s);this.Xr[this.er][n][r]||(this.Xr[this.er][n][r]=new v.A),this.Xr[this.er][n][r]?.Sf(t),this.oS(n,r)}}else if(i===D.Pu){const i=t.kc,s=i>>2,e=3&i,o=K.A.of(s).aw,a=t.ct,l=t.ct,c=t.ct,f=t.ct;let u,d=t.Mc,y=t.Mc,p=t.Mc,w=t.Mc;if(u=f===this.ho?this.io:this.Lr[f],u&&this.dr){const t=new q(this.er,o,n,r,-1,e,s,l+this.ni);this.zr.Sf(t);const i=new q(this.er,o,n,r,a,e,s,c+this.ni);this.zr.Sf(i);const f=this.dr[this.er][n][r],A=this.dr[this.er][n+1][r],x=this.dr[this.er][n+1][r+1],g=this.dr[this.er][n][r+1],C=h.A.get(a);u.Cv=l+this.ni,u.Sv=c+this.ni,u.gv=C.Ul(s,e,f,A,x,g,-1);let S,m=C.width,v=C.length;e!==Z.A.SC&&e!==Z.A.vC||(m=C.length,v=C.width),u.Hv=128*n+64*m,u.zv=128*r+64*v,u.Xv=this.Wx(this.er,u.Hv,u.zv),d>p&&(S=d,d=p,p=S),y>w&&(S=y,y=w,w=S),u.bv=n+d,u.Ev=n+p,u.Iv=r+y,u._v=r+w}}else if(i===D.Hu){const i=t.ct,s=t.ct,e=t.ct;if(n>=0&&r>=0&&n<$.A.Ar&&r<$.A.Ar){const t=this.Xr[this.er][n][r];if(t){for(let h=t.head();h;h=t.next())if(h.index===(32767&i)&&h.count===s){h.count=e;break}this.oS(n,r)}}}};hg=t=>{if(!at.K.Bt){if(d.A.Kv[17]>=t){const t=d.A.Zv[17];if(!t)return;const i=t.width*t.height-1,s=t.width*this.yn*2,e=t.Kc,h=this.tr;for(let t=0;t<=i;t++)h[t]=e[t-s&i];t.Kc=h,this.tr=e,d.A.jv(17)}if(d.A.Kv[24]>=t){const t=d.A.Zv[24];if(!t)return;const i=t.width*t.height-1,s=t.width*this.yn*2,e=t.Kc,h=this.tr;for(let t=0;t<=i;t++)h[t]=e[t-s&i];t.Kc=h,this.tr=e,d.A.jv(24)}}};_A=()=>{if(!(this.Xi&&this.Ki&&this.zi&&this.Ji))return;for(let t=10;t<117;t++){(100*Math.random()|0)<50&&(this.Xi[t+32512]=255)}for(let t=0;t<100;t++){const t=2+(124*Math.random()|0)+(128+(128*Math.random()|0)<<7);this.Xi[t]=192}for(let t=1;t<255;t++)for(let i=1;i<127;i++){const s=i+(t<<7);this.Ki[s]=(this.Xi[s-1]+this.Xi[s+1]+this.Xi[s-128]+this.Xi[s+128])/4|0}this.Qi+=128,this.Qi>this.zi.length&&(this.Qi-=this.zi.length,this.LA(this.Vi[12*Math.random()|0]));for(let t=1;t<255;t++)for(let i=1;i<127;i++){const s=i+(t<<7);let e=this.Ki[s+128]-(this.zi[s+this.Qi&this.zi.length-1]/5|0);e<0&&(e=0),this.Xi[s]=e}for(let t=0;t<255;t++)this.Ji[t]=this.Ji[t+1];if(this.Ji[255]=16*Math.sin(this.ni/14)+14*Math.sin(this.ni/15)+12*Math.sin(this.ni/16)|0,this.ts>0&&(this.ts-=4),this.ss>0&&(this.ss-=4),0===this.ts&&0===this.ss){const t=2e3*Math.random()|0;0===t?this.ts=1024:1===t&&(this.ss=1024)}};qv=(t,i,s)=>{const e=256-i;return((16711935&t)*e+(16711935&s)*i&4278255360)+((65280&t)*e+(65280&s)*i&16711680)>>8};TA=()=>{if(!(this.Zi&&this.ji&&this.qi&&this.$i&&this.Ji&&this.Xi))return;const t=256;if(this.ts>0)for(let t=0;t<256;t++)this.ts>768?this.Zi[t]=this.qv(this.ji[t],1024-this.ts,this.qi[t]):this.ts>256?this.Zi[t]=this.qi[t]:this.Zi[t]=this.qv(this.qi[t],256-this.ts,this.ji[t]);else if(this.ss>0)for(let t=0;t<256;t++)this.ss>768?this.Zi[t]=this.qv(this.ji[t],1024-this.ss,this.$i[t]):this.ss>256?this.Zi[t]=this.$i[t]:this.Zi[t]=this.qv(this.$i[t],256-this.ss,this.ji[t]);else for(let t=0;t<256;t++)this.Zi[t]=this.ji[t];for(let t=0;t<33920;t++)this.Ii&&this.Wi&&(this.Ii.Kc[t]=this.Wi.Kc[t]);let i=0,s=1152;for(let e=1;e<255;e++){let h=(this.Ji[e]*(t-e)/t|0)+22;h<0&&(h=0),i+=h;for(let t=h;t<128;t++){let t=this.Xi[i++];if(0===t)s++;else{const i=t,e=256-t;if(t=this.Zi[t],this.Ii){const h=this.Ii.Kc[s];this.Ii.Kc[s++]=((16711935&t)*i+(16711935&h)*e&4278255360)+((65280&t)*i+(65280&h)*e&16711680)>>8}}}s+=h}this.Ii?.draw(0,0);for(let t=0;t<33920;t++)this.Ei&&this.Yi&&(this.Ei.Kc[t]=this.Yi.Kc[t]);i=0,s=1176;for(let e=1;e<255;e++){const h=this.Ji[e]*(t-e)/t|0,n=103-h;s+=h;for(let t=0;t<n;t++){let t=this.Xi[i++];if(0===t)s++;else{const i=t,e=256-t;if(t=this.Zi[t],this.Ei){const h=this.Ei.Kc[s];this.Ei.Kc[s++]=((16711935&t)*i+(16711935&h)*e&4278255360)+((65280&t)*i+(65280&h)*e&16711680)>>8}}}i+=128-n,s+=128-n-h}this.Ei?.draw(661,0)}}},8370:(t,i,s)=>{s.d(i,{A:()=>u});var e=s(1183),h=s(4583),n=s(9234);const r=['F11','F12'],o={'Backspace':{code:8,ch:8},'Enter':{code:10,ch:10},'Shift':{code:16,ch:65535},'Escape':{code:27,ch:27},'Tab':{code:9,ch:9},'CapsLock':{code:20,ch:65535},' ':{code:32,ch:32},'Control':{code:17,ch:65535},'Alt':{code:18,ch:65535},'Meta':{code:524,ch:65535},'ArrowLeft':{code:37,ch:65535},'ArrowRight':{code:39,ch:65535},'ArrowUp':{code:38,ch:65535},'ArrowDown':{code:40,ch:65535},'Insert':{code:155,ch:65535},'Home':{code:36,ch:65535},'PageUp':{code:33,ch:65535},'Delete':{code:127,ch:127},'End':{code:35,ch:65535},'PageDown':{code:34,ch:65535},'`':{code:192,ch:96},'~':{code:192,ch:126},'!':{code:49,ch:33},'@':{code:50,ch:64},'#':{code:51,ch:35},'$':{code:52,ch:36},'%':{code:53,ch:37},'^':{code:54,ch:94},'&':{code:55,ch:38},'*':{code:56,ch:42},'(':{code:57,ch:40},')':{code:48,ch:41},'-':{code:45,ch:45},'_':{code:45,ch:95},'=':{code:61,ch:61},'+':{code:61,ch:43},'[':{code:91,ch:91},'{':{code:91,ch:123},']':{code:93,ch:93},'}':{code:93,ch:125},'\\':{code:92,ch:92},'|':{code:92,ch:124},';':{code:59,ch:59},':':{code:59,ch:58},"'":{code:222,ch:39},'"':{code:222,ch:34},',':{code:44,ch:44},'<':{code:44,ch:60},'.':{code:46,ch:46},'>':{code:46,ch:62},'/':{code:47,ch:47},'?':{code:47,ch:63},'F1':{code:112,ch:65535},'F2':{code:113,ch:65535},'F3':{code:114,ch:65535},'F4':{code:115,ch:65535},'F5':{code:116,ch:65535},'F6':{code:117,ch:65535},'F7':{code:118,ch:65535},'F8':{code:119,ch:65535},'F9':{code:120,ch:65535},'F10':{code:121,ch:65535},'F11':{code:122,ch:65535},'F12':{code:123,ch:65535},0:{code:48,ch:48},1:{code:49,ch:49},2:{code:50,ch:50},3:{code:51,ch:51},4:{code:52,ch:52},5:{code:53,ch:53},6:{code:54,ch:54},7:{code:55,ch:55},8:{code:56,ch:56},9:{code:57,ch:57},'a':{code:65,ch:97},'b':{code:66,ch:98},'c':{code:67,ch:99},'d':{code:68,ch:100},'e':{code:69,ch:101},'f':{code:70,ch:102},'g':{code:71,ch:103},'h':{code:72,ch:104},'i':{code:73,ch:105},'j':{code:74,ch:106},'k':{code:75,ch:107},'l':{code:76,ch:108},'m':{code:77,ch:109},'n':{code:78,ch:110},'o':{code:79,ch:111},'p':{code:80,ch:112},'q':{code:81,ch:113},'r':{code:82,ch:114},'s':{code:83,ch:115},'t':{code:84,ch:116},'u':{code:85,ch:117},'v':{code:86,ch:118},'w':{code:87,ch:119},'x':{code:88,ch:120},'y':{code:89,ch:121},'z':{code:90,ch:122},'A':{code:65,ch:65},'B':{code:66,ch:66},'C':{code:67,ch:67},'D':{code:68,ch:68},'E':{code:69,ch:69},'F':{code:70,ch:70},'G':{code:71,ch:71},'H':{code:72,ch:72},'I':{code:73,ch:73},'J':{code:74,ch:74},'K':{code:75,ch:75},'L':{code:76,ch:76},'M':{code:77,ch:77},'N':{code:78,ch:78},'O':{code:79,ch:79},'P':{code:80,ch:80},'Q':{code:81,ch:81},'R':{code:82,ch:82},'S':{code:83,ch:83},'T':{code:84,ch:84},'U':{code:85,ch:85},'V':{code:86,ch:86},'W':{code:87,ch:87},'X':{code:88,ch:88},'Y':{code:89,ch:89},'Z':{code:90,ch:90}};var a=s(2595),l=s(7854),c=s(643),f=s(5868);class u{static getParameter(t){return new URLSearchParams(window.location.search).get(t)??''}static setParameter(t,i){const s=new URL(window.location.toString());s.searchParams.set(t,i),window.history.pushState(null,'',s.toString())}Wg=0;$v=[];Jv=0;sa=null;state=0;Vg=20;Qv=1;tB=[];Fg=0;iB=0;sB=[];eB=!0;hB=!1;nB=50;hasFocus=!0;xA=!1;XA=Date.now();nx=0;ol=0;al=0;MA=0;UA=0;PA=0;hx=[];rB=[];oB=0;aB=0;input=null;lB=!1;cB=!1;fB=!1;time=-1;uB=0;dB=0;yB=0;pB=0;wB=0;AB=0;xB=!1;nr=128;rr=0;gB=0;CB=0;constructor(t=!1){l.SB.tabIndex=-1,l.ma.fillStyle='black',l.ma.fillRect(0,0,l.mB.width,l.mB.height),this.hB=t,this.hB?this.resize(window.innerWidth,window.innerHeight):this.resize(l.mB.width,l.mB.height)}get width(){return l.mB.width}get height(){return l.mB.height}resize=(t,i)=>{l.mB.width=t,l.mB.height=i,this.sa=new e.A(t,i),h.A.vB(),c.A.resize(t,i)};run=async()=>{l.mB.addEventListener('resize',(()=>{this.hB&&this.resize(window.innerWidth,window.innerHeight)}),!1),l.SB.onmousedown=this.onmousedown,l.SB.onmouseup=this.onmouseup,l.SB.onmouseenter=this.onmouseenter,l.SB.onmouseleave=this.onmouseleave,l.SB.onmousemove=this.onmousemove,window.onbeforeunload=this.$o,l.SB.onfocus=this.onfocus,l.SB.onblur=this.onblur,l.SB.onwheel=this.onwheel,this.BB?(l.SB.ontouchstart=this.ontouchstart,l.SB.ontouchend=this.ontouchend,l.SB.ontouchmove=this.ontouchmove):(l.SB.onkeydown=this.onkeydown,l.SB.onkeyup=this.onkeyup),l.SB.oncontextmenu=t=>{t.preventDefault()},window.oncontextmenu=t=>{t.preventDefault()},this.BB&&'low'===u.getParameter('detail')&&(this.nB=30),await this.ya(0,'Loading...'),await this.load();for(let t=0;t<10;t++)this.tB[t]=performance.now();let t,i=0,s=256,e=1,h=0;for(;this.state>=0;){if(this.state>0&&(this.state--,0===this.state))return void this.bB();const r=s,o=e;s=300,e=1,t=performance.now();const a=this.tB[i];if(0===a?(s=r,e=o):t>a&&(s=2560*this.Vg/(t-a)|0),s<25?s=25:s>256&&(s=256,e=this.Vg-(t-a)/10|0),this.tB[i]=t,i=(i+1)%10,e>1)for(let t=0;t<10;t++)0!==this.tB[t]&&(this.tB[t]+=e);for(e<this.Qv&&(e=this.Qv),await(0,n.wa)(e);h<256;)await this.update(),this.MA=0,this.oB=this.aB,h+=s;h&=255,this.Vg>0&&(this.Fg=1e3*s/(256*this.Vg)|0);const l=performance.now();if(await this.draw(),this.sB[this.iB]=(performance.now()-l)/1e3,this.iB=(this.iB+1)%this.sB.length,this.nB<50){const i=1e3/this.nB-(performance.now()-t);i>0&&await(0,n.wa)(i)}}-1===this.state&&this.bB()};bB=()=>{this.state=-2,this.$o()};va=t=>{this.Vg=1e3/t|0};rS=t=>{this.nB=Math.max(Math.min(50,0|t),0)};start=()=>{this.state>=0&&(this.state=0)};stop=()=>{this.state>=0&&(this.state=4e3/this.Vg|0)};destroy=()=>{this.state=-1};load=async()=>{};update=async()=>{};$o=()=>{};draw=async()=>{};refresh=()=>{};async ya(t,i){const s=this.width,e=this.height;this.eB&&(l.ma.fillStyle='black',l.ma.fillRect(0,0,s,e),this.eB=!1);const h=e/2-18;l.ma.fillStyle='rgb(140, 17, 17)',l.ma.rect((s/2|0)-152,h,304,34),l.ma.fillRect((s/2|0)-150,h+2,3*t,30),l.ma.fillStyle='black',l.ma.fillRect((s/2|0)-150+3*t,h+2,300-3*t,30),l.ma.font='bold 13px helvetica, sans-serif',l.ma.textAlign='center',l.ma.fillStyle='white',l.ma.fillText(i,s/2|0,h+22),await(0,n.wa)(5)}FA=()=>{let t=-1;return this.aB!==this.oB&&(t=this.rB[this.oB],this.oB=this.oB+1&127),t};get ms(){const t=this.sB.length;let i=0;for(let s=0;s<t;s++)i+=this.sB[s];const s=i/t*1e3;return s>this.Wg&&(this.Wg=s),this.$v[this.Jv]=s,this.Jv=(this.Jv+1)%250,s}get Gg(){return this.$v.reduce(((t,i)=>t+i),0)/250}onkeydown=t=>{const i=t.key;this.XA=Date.now();const s=o[i];if(!s||0===t.code.length&&!t.isTrusted)return void console.warn(`Unhandled key: ${i}`);const e=s.code;let h=s.ch;t.ctrlKey&&(h>='A'.charCodeAt(0)&&h<=']'.charCodeAt(0)||h=='_'.charCodeAt(0)?h-='A'.charCodeAt(0)-1:h>='a'.charCodeAt(0)&&h<='z'.charCodeAt(0)&&(h-='a'.charCodeAt(0)-1)),h<30&&(h=0),e===o.ArrowLeft.code?h=1:e===o.ArrowRight.code?h=2:e===o.ArrowUp.code?h=3:e===o.ArrowDown.code?h=4:e===o.Control.code?h=5:e===o.Shift.code?h=6:e===o.Alt.code?h=7:e===o.Backspace.code||e===o.Delete.code?h=8:e===o.Tab.code?h=9:e===o.Enter.code?h=10:e>=o.F1.code&&e<=o.F12.code?h=e+1008-o.F1.code:e===o.Home.code?h=1e3:e===o.End.code?h=1001:e===o.PageUp.code?h=1002:e===o.PageDown.code&&(h=1003),h>0&&h<128&&(this.hx[h]=1),h>4&&(this.rB[this.aB]=h,this.aB=this.aB+1&127),a.A.enabled&&a.A.IB(h),r.includes(i)||t.preventDefault()};onkeyup=t=>{const i=t.key;this.XA=Date.now();const s=o[i];if(!s||0===t.code.length&&!t.isTrusted)return void console.warn(`Unhandled key: ${i}`);const e=s.code;let h=s.ch;h<30&&(h=0),e===o.ArrowLeft.code?h=1:e===o.ArrowRight.code?h=2:e===o.ArrowUp.code?h=3:e===o.ArrowDown.code?h=4:e===o.Control.code?h=5:e===o.Shift.code?h=6:e===o.Alt.code?h=7:e===o.Backspace.code||e===o.Delete.code?h=8:e===o.Tab.code?h=9:e===o.Enter.code?h=10:e>=o.F1.code&&e<=o.F12.code?h=e+1008-o.F1.code:e===o.Home.code?h=1e3:e===o.End.code?h=1001:e===o.PageUp.code?h=1002:e===o.PageDown.code&&(h=1003),h>0&&h<128&&(this.hx[h]=0),a.A.enabled&&a.A.EB(h),r.includes(i)||t.preventDefault()};onmousedown=t=>{if(1===t.button)return this.xB=!0,this.gB=t.screenX,this.CB=t.screenY,void t.preventDefault();if(this.lB=!1,(t.clientX>0||t.clientY>0)&&this._B(t),this.XA=Date.now(),this.UA=this.ol,this.PA=this.al,this.BB&&!this.TB){if(this.OB()||this.LB()||this.RB())return this.MA=1,void(this.nx=1);t.timeStamp>=this.time+500?(this.MA=2,this.nx=2):(this.MA=1,this.nx=1)}else 2===t.button?(this.MA=2,this.nx=2):(this.MA=1,this.nx=1);a.A.enabled&&a.A.DB(this.UA,this.PA,t.buttons)};onmouseup=t=>{1===t.button&&(this.xB=!1),this._B(t),this.XA=Date.now(),this.nx=0,a.A.enabled&&a.A.kB(t.buttons)};onmouseenter=t=>{this._B(t),a.A.enabled&&a.A.MB()};onmouseleave=t=>{this._B(t),this.XA=Date.now(),this.ol=-1,this.al=-1,this.nx=0,this.UA=-1,this.PA=-1,a.A.enabled&&a.A.UB()};onmousemove=t=>{if(this._B(t),this.XA=Date.now(),a.A.enabled&&a.A.PB(this.ol,this.al),this.xB){const i=this.gB-t.screenX,s=this.CB-t.screenY;this.NB(i,-s),this.gB=t.screenX,this.CB=t.screenY}};NB(t,i){this.rr+=t,this.nr+=i/2|0}onfocus=t=>{this.hasFocus=!0,this.eB=!0,this.refresh(),a.A.enabled&&a.A.FB()};onblur=t=>{this.hasFocus=!1;for(let t=0;t<128;t++)this.hx[t]=0;a.A.enabled&&a.A.VB()};onwheel=t=>{t.deltaY>0?this.GB()?f.A.tC<4&&(f.A.tC+=.25):f.A.Yx<15&&f.A.Yx++:this.GB()?f.A.tC>1&&(f.A.tC-=.25):f.A.Yx>0&&f.A.Yx--};ontouchstart=t=>{if(!this.BB)return;null!==this.input&&(this.input.parentNode?.removeChild(this.input),this.input=null),this.lB=!0;const i=t.changedTouches[0],s=0|i.clientX,e=0|i.clientY;this.onmousemove(new MouseEvent('mousemove',{clientX:s,clientY:e})),this.uB=this.wB=this.yB=0|i.screenX,this.dB=this.AB=this.pB=0|i.screenY,this.time=t.timeStamp,this.cB=this.WB(),this.fB=this.YB()};ontouchend=t=>{if(!this.BB||!this.lB)return;const i=t.changedTouches[0],s=0|i.clientX,e=0|i.clientY;if(this.onmousemove(new MouseEvent('mousemove',{clientX:s,clientY:e})),this.wB=0|i.screenX,this.AB=0|i.screenY,this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowLeft',code:'ArrowLeft'})),this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowUp',code:'ArrowUp'})),this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowRight',code:'ArrowRight'})),this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowDown',code:'ArrowDown'})),this.cB&&!this.WB())return void(this.lB=!1);if(this.fB&&!this.YB())return void(this.lB=!1);if(this.OB()||this.HB()||this.LB()||this.RB()){null!==this.input&&(this.input.parentNode?.contains(this.input)&&this.input.parentNode?.removeChild(this.input),this.input=null);const t=document.createElement('input');return this.LB()?(t.setAttribute('id','username'),t.setAttribute('placeholder','Username')):this.RB()?(t.setAttribute('id','password'),t.setAttribute('placeholder','Password')):this.OB()?(t.setAttribute('id','chatinput'),t.setAttribute('placeholder','Chatinput')):this.HB()&&(t.setAttribute('id','chatpopup'),t.setAttribute('placeholder','Chatpopup')),this.zB?t.setAttribute('type','password'):t.setAttribute('type',this.RB()?'password':'text'),t.setAttribute('autofocus','autofocus'),t.setAttribute('spellcheck','false'),t.setAttribute('autocomplete','off'),t.setAttribute('style',`position: fixed; left: ${s}px; top: ${e}px; width: 1px; height: 1px; opacity: 0; z-index: 20;`),document.body.appendChild(t),t.focus(),t.click(),this.zB&&(t.oninput=t=>{if(!(t instanceof InputEvent))return;const i=t,s=i.data;null!==s&&'insertText'===i.inputType&&this.onkeydown(new KeyboardEvent('keydown',{key:s,code:s}))}),t.onkeydown=t=>{this.zB&&'Enter'!==t.key&&'Backspace'!==t.key||this.onkeydown(new KeyboardEvent('keydown',{key:t.key,code:t.key}))},t.onkeyup=t=>{this.zB&&'Enter'!==t.key&&'Backspace'!==t.key||this.onkeyup(new KeyboardEvent('keyup',{key:t.key,code:t.key}))},t.onfocus=t=>{this.input?.parentNode?.removeChild(this.input),this.input=null,this.onfocus(t)},this.input=t,void(this.lB=!1)}const h=t.timeStamp>=this.time+500,n=Math.abs(this.uB-this.wB)>16||Math.abs(this.dB-this.AB)>16;h&&!n?(this.lB=!0,this.onmousedown(new MouseEvent('mousedown',{buttons:2}))):(this.nx=0,this.lB=!1)};ontouchmove=t=>{if(!this.BB||!this.lB)return;const i=t.changedTouches[0],s=0|i.clientX,e=0|i.clientY;this.onmousemove(new MouseEvent('mousemove',{clientX:s,clientY:e})),this.wB=0|i.screenX,this.AB=0|i.screenY,this.cB&&-1===this.oa()?(this.yB-this.wB>0?this.rotate(2):this.yB-this.wB<0&&this.rotate(0),this.pB-this.AB>0?this.rotate(3):this.pB-this.AB<0&&this.rotate(1)):(this.fB||-1!==this.oa())&&this.onmousedown(new MouseEvent('mousedown',{buttons:1})),this.yB=this.wB,this.pB=this.AB};get BB(){return['Android','webOS','iPhone','iPad','iPod','BlackBerry','Windows Phone'].some((t=>navigator.userAgent.includes(t)))}get zB(){return['Android'].some((t=>navigator.userAgent.includes(t)))}get TB(){return['Capacitor'].some((t=>navigator.userAgent.includes(t)))}GB=()=>this.xA&&this.ol>=570&&this.ol<=740&&this.al>=11&&this.al<=171;WB=()=>this.xA&&this.ol>=8&&this.ol<=520&&this.al>=11&&this.al<=345;OB=()=>this.xA&&-1===this.ra()&&!this.ha()&&!this.na()&&this.ol>=11&&this.ol<=506&&this.al>=449&&this.al<=482;HB=()=>this.xA&&(this.ha()||this.na())&&this.ol>=11&&this.ol<=506&&this.al>=383&&this.al<=482;YB=()=>this.xA&&this.ol>=562&&this.ol<=752&&this.al>=231&&this.al<=492;LB=()=>!this.xA&&2===this.ea()&&this.ol>=301&&this.ol<=562&&this.al>=262&&this.al<=279;RB=()=>!this.xA&&2===this.ea()&&this.ol>=301&&this.ol<=562&&this.al>=279&&this.al<=296;rotate=t=>{0===t?(this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowRight',code:'ArrowRight'})),this.onkeydown(new KeyboardEvent('keydown',{key:'ArrowLeft',code:'ArrowLeft'}))):1===t?(this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowDown',code:'ArrowDown'})),this.onkeydown(new KeyboardEvent('keydown',{key:'ArrowUp',code:'ArrowUp'}))):2===t?(this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowLeft',code:'ArrowLeft'})),this.onkeydown(new KeyboardEvent('keydown',{key:'ArrowRight',code:'ArrowRight'}))):3===t&&(this.onkeyup(new KeyboardEvent('keyup',{key:'ArrowUp',code:'ArrowUp'})),this.onkeydown(new KeyboardEvent('keydown',{key:'ArrowDown',code:'ArrowDown'})))};XB=()=>null!==document.fullscreenElement;_B=t=>{if(this.XB()){const i=t.target.getBoundingClientRect(),s=window.innerHeight/l.mB.height,e=(window.innerWidth-l.mB.width*s)/2;this.ol=0|this.KB(t.clientX-i.left-e,0,l.mB.width*s,0,789),this.al=0|this.KB(t.clientY-i.top,0,l.mB.height*s,0,532)}else{const i=l.mB.getBoundingClientRect(),s=l.mB.width/i.width,e=l.mB.height/i.height;this.ol=(t.clientX-i.left)*s|0,this.al=(t.clientY-i.top)*e|0}this.ol<0&&(this.ol=0),this.al<0&&(this.al=0),this.ol>789&&(this.ol=789),this.al>532&&(this.al=532)};KB=(t,i,s,e,h)=>(t-i)*(h-e)/(s-i)+e}},2595:(t,i,s)=>{s.d(i,{A:()=>h});var e=s(1069);class h{static enabled=!1;static ZB=null;static jB=null;static qB=0;static $B=0;static JB=0;static QB=0;static tb=0;static RS=()=>{this.ZB=e.A.oi(1),this.jB=null,this.qB=performance.now(),this.enabled=!0};static zA=()=>{this.enabled=!1,this.ZB=null};static flush=()=>{let t=null;return this.jB&&this.enabled&&(t=this.jB),this.jB=null,t};static stop=()=>{let t=null;return this.ZB&&this.ZB.ft>0&&this.enabled&&(t=this.ZB),this.zA(),t};static DB=(t,i,s)=>{if(!(this.enabled&&t>=0&&t<789&&i>=0&&i<532))return;this.$B++;const e=performance.now();let h=(e-this.qB)/10|0;h>250&&(h=250),this.qB=e,this.ib(5),1===s?this.ZB?.p1(1):this.ZB?.p1(2),this.ZB?.p1(h),this.ZB?.p3(t+(i<<10))};static kB=t=>{if(!this.enabled)return;this.$B++;const i=performance.now();let s=(i-this.qB)/10|0;s>250&&(s=250),this.qB=i,this.ib(2),1===t?this.ZB?.p1(3):this.ZB?.p1(4),this.ZB?.p1(s)};static PB=(t,i)=>{if(!(this.enabled&&t>=0&&t<789&&i>=0&&i<532))return;const s=performance.now();if(s-this.JB>=50){this.JB=s,this.$B++;let e=(s-this.qB)/10|0;e>250&&(e=250),this.qB=s,t-this.QB<8&&t-this.QB>=-8&&i-this.tb<8&&i-this.tb>=-8?(this.ib(3),this.ZB?.p1(5),this.ZB?.p1(e),this.ZB?.p1(t+(i-this.tb+8<<4)+8-this.QB)):t-this.QB<128&&t-this.QB>=-128&&i-this.tb<128&&i-this.tb>=-128?(this.ib(4),this.ZB?.p1(6),this.ZB?.p1(e),this.ZB?.p1(t+128-this.QB),this.ZB?.p1(i+128-this.tb)):(this.ib(5),this.ZB?.p1(7),this.ZB?.p1(e),this.ZB?.p3(t+(i<<10))),this.QB=t,this.tb=i}};static IB=t=>{if(!this.enabled)return;this.$B++;const i=performance.now();let s=(i-this.qB)/10|0;s>250&&(s=250),this.qB=i,1e3===t?t=11:1001===t?t=12:1002===t?t=14:1003===t?t=15:t>=1008&&(t-=992),this.ib(3),this.ZB?.p1(8),this.ZB?.p1(s),this.ZB?.p1(t)};static EB=t=>{if(!this.enabled)return;this.$B++;const i=performance.now();let s=(i-this.qB)/10|0;s>250&&(s=250),this.qB=i,1e3===t?t=11:1001===t?t=12:1002===t?t=14:1003===t?t=15:t>=1008&&(t-=992),this.ib(3),this.ZB?.p1(9),this.ZB?.p1(s),this.ZB?.p1(t)};static FB=()=>{if(!this.enabled)return;this.$B++;const t=performance.now();let i=(t-this.qB)/10|0;i>250&&(i=250),this.qB=t,this.ib(2),this.ZB?.p1(10),this.ZB?.p1(i)};static VB=()=>{if(!this.enabled)return;this.$B++;const t=performance.now();let i=(t-this.qB)/10|0;i>250&&(i=250),this.qB=t,this.ib(2),this.ZB?.p1(11),this.ZB?.p1(i)};static MB=()=>{if(!this.enabled)return;this.$B++;const t=performance.now();let i=(t-this.qB)/10|0;i>250&&(i=250),this.qB=t,this.ib(2),this.ZB?.p1(12),this.ZB?.p1(i)};static UB=()=>{if(!this.enabled)return;this.$B++;const t=performance.now();let i=(t-this.qB)/10|0;i>250&&(i=250),this.qB=t,this.ib(2),this.ZB?.p1(13),this.ZB?.p1(i)};static ib=t=>{if(this.ZB&&this.ZB.ft+t>=500){const t=this.ZB;this.ZB=e.A.oi(1),this.jB=t}}}},1120:(t,i,s)=>{s.d(i,{A:()=>c});var e=s(1069),h=s(8665),n=s(2031),r=s(1122),o=s(3819),a=s(3867),l=s(8950);class c{static ta=[];static sb=null;static ia=null;static $a=0;static eb=1;static Qa=2;static wl=3;static xl=4;static Tl=5;static Rl=6;static Vl=7;static lm=1;static dm=2;static ym=3;static pm=4;static wm=5;static vl=6;static Yl=1;static Hl=100;static zl=101;static Xl=200;static VC=201;static GC=202;static Kl=203;static WC=205;static zC=300;static hb=301;static nb=302;static rb=303;static ob=304;static ab=305;static lb=306;static cb=307;static fb=308;static ub=309;static yb=310;static pb=311;static wb=312;static XC=313;static KC=314;static Ab=315;static xb=316;static gb=317;static Cb=318;static Sb=319;static mb=320;static vb=321;static Bb=322;static ZC=323;static ac=324;static lc=325;static jC=326;static Ql=327;static Zl=401;static jl=500;static YC=501;static HC=502;static Jl=503;static cc=600;static qC=601;static bb=602;static Ib=603;static Eb=604;static _b=605;static Tb=606;static Ob=607;static Lb=608;static Rb=609;static Db=610;static kb=611;static $C=612;static fc=613;static uc=650;static Ac=651;static xc=652;static gc=653;static Cc=654;static dc=655;static Dy=(t,i,s)=>{this.sb=new n.A(5e4),this.ia=new n.A(5e4);const h=new e.A(t.read('data'));let r=-1;for(h.ft+=2;h.ft<h.length;){let t=h.ct;65535===t&&(r=h.ct,t=h.ct);const e=this.ta[t]=new c;e.id=t,e.aw=r,e.type=h.kc,e.ml=h.kc,e.ja=h.ct,e.width=h.ct,e.height=h.ct,e.hm=h.kc,0===e.hm?e.hm=-1:e.hm=(e.hm-1<<8)+h.kc;const n=h.kc;if(n>0){e.ba=new Uint8Array(n),e.Ea=new Uint16Array(n);for(let t=0;t<n;t++)e.ba[t]=h.kc,e.Ea[t]=h.ct}const o=h.kc;if(o>0){e.scripts=new a.Ps(o,null);for(let t=0;t<o;t++){const i=h.ct,s=new Uint16Array(i);e.scripts[t]=s;for(let t=0;t<i;t++)s[t]=h.ct}}if(e.type===c.$a){e.scroll=h.ct,e.hide=1===h.kc;const t=h.kc;e.Ua=new Array(t),e.za=new Array(t),e.Xa=new Array(t);for(let i=0;i<t;i++)e.Ua[i]=h.ct,e.za[i]=h.kS,e.Xa[i]=h.kS}if(e.type===c.eb&&(h.ft+=3),e.type===c.Qa){e.sl=new Int32Array(e.width*e.height),e.el=new Int32Array(e.width*e.height),e.draggable=1===h.kc,e.nm=1===h.kc,e.om=1===h.kc,e.hl=h.kc,e.nl=h.kc,e.tl=new Int16Array(20),e.il=new Int16Array(20),e.pl=new a.Ps(20,null);for(let t=0;t<20;t++)if(1===h.kc){e.tl[t]=h.kS,e.il[t]=h.kS;const s=h.TS;if(s.length>0){const h=s.lastIndexOf(',');e.pl[t]=this.Mb(i,s.substring(0,h),parseInt(s.substring(h+1),10))}}e.am=new a.Ps(5,null);for(let t=0;t<5;t++){const i=h.TS;e.am[t]=i,0===i.length&&(e.am[t]=null)}}if(e.type===c.wl&&(e.fill=1===h.kc),e.type===c.xl||e.type===c.eb){e.bl=1===h.kc;const t=h.kc;s&&(e.font=s[t]),e.El=1===h.kc}if(e.type===c.xl&&(e.text=h.TS,e.Sl=h.TS),e.type!==c.eb&&e.type!==c.wl&&e.type!==c.xl||(e.Al=h.ut),e.type!==c.wl&&e.type!==c.xl||(e.Cl=h.ut,e.gl=h.ut),e.type===c.Tl){const t=h.TS;if(t.length>0){const s=t.lastIndexOf(',');e.Ll=this.Mb(i,t.substring(0,s),parseInt(t.substring(s+1),10))}const s=h.TS;if(s.length>0){const t=s.lastIndexOf(',');e.Ol=this.Mb(i,s.substring(0,t),parseInt(s.substring(t+1),10))}}if(e.type===c.Rl){const t=h.kc;0!==t&&(e.model=this.Ul((t-1<<8)+h.kc));const i=h.kc;0!==i&&(e.Ub=this.Ul((i-1<<8)+h.kc)),e.Pa=h.kc,0===e.Pa?e.Pa=-1:e.Pa=(e.Pa-1<<8)+h.kc,e.Na=h.kc,0===e.Na?e.Na=-1:e.Na=(e.Na-1<<8)+h.kc,e.zoom=h.ct,e.Ml=h.ct,e.Fl=h.ct}if(e.type===c.Vl){e.sl=new Int32Array(e.width*e.height),e.el=new Int32Array(e.width*e.height),e.bl=1===h.kc;const t=h.kc;s&&(e.font=s[t]),e.El=1===h.kc,e.Al=h.ut,e.hl=h.kS,e.nl=h.kS,e.nm=1===h.kc,e.am=new a.Ps(5,null);for(let t=0;t<5;t++){const i=h.TS;e.am[t]=i,0===i.length&&(e.am[t]=null)}}e.ml!==c.dm&&e.type!==c.Qa||(e.RC=h.TS,e.action=h.TS,e.LC=h.ct),e.ml!==c.lm&&e.ml!==c.pm&&e.ml!==c.wm&&e.ml!==c.vl||(e.um=h.TS,0===e.um.length&&(e.ml===c.lm?e.um='Ok':e.ml===c.pm||e.ml===c.wm?e.um='Select':e.ml===c.vl&&(e.um='Continue')))}this.sb=null,this.ia=null};static Mb=(t,i,s)=>{const e=o.A.Pb(i)<<8n|BigInt(s);if(this.sb){const t=this.sb.get(e);if(t)return t}let h;try{h=r.A.Dc(t,i,s),this.sb?.put(e,h)}catch(t){return null}return h};static Ul=t=>{if(this.ia){const i=this.ia.get(BigInt(t));if(i)return i}const i=h.A.model(t);return this.ia?.put(BigInt(t),i),i};id=-1;aw=-1;type=-1;ml=-1;ja=0;width=0;height=0;hm=-1;ba=null;Ea=null;scripts=null;scroll=0;hide=!1;draggable=!1;nm=!1;om=!1;hl=0;nl=0;tl=null;il=null;pl=null;am=null;fill=!1;bl=!1;font=null;El=!1;text=null;Sl=null;Al=0;Cl=0;gl=0;Ll=null;Ol=null;model=null;Ub=null;Pa=-1;Na=-1;zoom=0;Ml=0;Fl=0;RC=null;action=null;LC=-1;um=null;Ua=null;za=null;Xa=null;x=0;y=0;Ja=0;sl=null;el=null;Va=0;Fa=0;Ul(t,i,s){let e=this.model;if(s&&(e=this.Ub),!e)return null;if(-1===t&&-1===i&&!e.Nb)return e;const n=h.A.bw(e,!0,!0,!1);return-1===t&&-1===i||n.nc(),-1!==t&&n.rc(t),-1!==i&&n.rc(i),n.oc(64,768,-50,-10,-50,!0),n}Fb(){if(this.aw===this.id)return this.x;let t=c.ta[this.aw];if(!t.Ua||!t.za||!t.Xa)return this.x;let i=t.Ua.indexOf(this.id);if(-1===i)return this.x;let s=t.za[i];for(;t.aw!==t.id;){const e=c.ta[t.aw];e.Ua&&e.za&&e.Xa&&(i=e.Ua.indexOf(t.id),-1!==i&&(s+=e.za[i])),t=e}return s}Vb(){if(this.aw===this.id)return this.y;let t=c.ta[this.aw];if(!t.Ua||!t.za||!t.Xa)return this.y;let i=t.Ua.indexOf(this.id);if(-1===i)return this.y;let s=t.Xa[i];for(;t.aw!==t.id;){const e=c.ta[t.aw];e.Ua&&e.za&&e.Xa&&(i=e.Ua.indexOf(t.id),-1!==i&&(s+=e.Xa[i])),t=e}return s}outline(t){const i=this.Fb(),s=this.Vb();l.A.Ka(i,s,this.width,this.height,t)}move(t,i){if(this.aw===this.id)return;this.x=0,this.y=0;const s=c.ta[this.aw];if(s.Ua&&s.za&&s.Xa){const e=s.Ua.indexOf(this.id);-1!==e&&(s.za[e]=t,s.Xa[e]=i)}}delete(){if(this.aw===this.id)return;const t=c.ta[this.aw];if(t.Ua&&t.za&&t.Xa){const i=t.Ua.indexOf(this.id);-1!==i&&(t.Ua.splice(i,1),t.za.splice(i,1),t.Xa.splice(i,1))}}}},6333:(t,i,s)=>{s.d(i,{$:()=>e});class e{id;Gb=null;constructor(t){this.id=t}Wb(t){for(;;){const i=t.kc;if(0===i)break;this.decode(i,t)}return this}}},2164:(t,i,s)=>{s.d(i,{A:()=>n});var e=s(1069),h=s(6333);class n extends h.${static count=0;static ta=[];static Dy=t=>{const i=new e.A(t.read('flo.dat'));this.count=i.ct;for(let t=0;t<this.count;t++)this.ta[t]=new n(t).Wb(i)};static Yb=(t,i,s)=>(s>179&&(i=i/2|0),s>192&&(i=i/2|0),s>217&&(i=i/2|0),s>243&&(i=i/2|0),(t/4<<10)+(i/32<<7)+(s/2|0));static Hb=(t,i)=>-1===t?12345678:((i=i*(127&t)/128|0)<2?i=2:i>126&&(i=126),(65408&t)+i);static zb=(t,i)=>-2===t?12345678:-1===t?(i<0?i=0:i>127&&(i=127),127-i):((i=i*(127&t)/128|0)<2?i=2:i>126&&(i=126),(65408&t)+i);Xb=0;texture=-1;Kb=!1;Zb=!0;jb=0;qb=0;$b=0;Jb=0;Qb=0;tI=0;decode(t,i){1===t?(this.Xb=i.lt,this.setColor(this.Xb)):2===t?this.texture=i.kc:3===t?this.Kb=!0:5===t?this.Zb=!1:6===t?this.Gb=i.TS:console.log('Error unrecognised config code: ',t)}setColor(t){const i=(t>>16&255)/256,s=(t>>8&255)/256,e=(255&t)/256;let h=i;s<i&&(h=s),e<h&&(h=e);let r=i;s>i&&(r=s),e>r&&(r=e);let o=0,a=0;const l=(h+r)/2;h!==r&&(l<.5&&(a=(r-h)/(r+h)),l>=.5&&(a=(r-h)/(2-r-h)),i===r?o=(s-e)/(r-h):s===r?o=(e-i)/(r-h)+2:e===r&&(o=(i-s)/(r-h)+4)),o/=6,this.jb=256*o|0,this.qb=256*a|0,this.$b=256*l|0,this.qb<0?this.qb=0:this.qb>255&&(this.qb=255),this.$b<0?this.$b=0:this.$b>255&&(this.$b=255),this.Jb=l>.5?(1-l)*a*512|0:l*a*512|0,this.Jb<1&&(this.Jb=1),this.Qb=o*this.Jb|0;let c=this.jb+(16*Math.random()|0)-8;c<0?c=0:c>255&&(c=255);let f=this.qb+(48*Math.random()|0)-24;f<0?f=0:f>255&&(f=255);let u=this.$b+(48*Math.random()|0)-24;u<0?u=0:u>255&&(u=255),this.tI=n.Yb(c,f,u)}}},8317:(t,i,s)=>{s.d(i,{A:()=>o});var e=s(1069),h=s(6333),n=s(8665),r=s(3867);class o extends h.${static count=0;static ta=[];static Dy=t=>{const i=new e.A(t.read('idk.dat'));this.count=i.ct;for(let t=0;t<this.count;t++)this.ta[t]=new o(t).Wb(i)};type=-1;iI=null;sI=new Int32Array(5).fill(-1);eI=new Int32Array(6);hI=new Int32Array(6);disable=!1;decode(t,i){if(1===t)this.type=i.kc;else if(2===t){const t=i.kc;this.iI=new Int32Array(t);for(let s=0;s<t;s++)this.iI[s]=i.ct}else 3===t?this.disable=!0:t>=40&&t<50?this.eI[t-40]=i.ct:t>=50&&t<60?this.hI[t-50]=i.ct:t>=60&&t<70?this.sI[t-60]=i.ct:console.log('Error unrecognised config code: ',t)}Ul(){if(!this.iI)return null;const t=new r.Ps(this.iI.length,null);for(let i=0;i<this.iI.length;i++)t[i]=n.A.model(this.iI[i]);let i;i=1===t.length?t[0]:n.A.tc(t,t.length);for(let t=0;t<6&&0!==this.eI[t];t++)i?.ic(this.eI[t],this.hI[t]);return i}_S(){let t=0;const i=new r.Ps(5,null);for(let s=0;s<5;s++)-1!==this.sI[s]&&(i[t++]=n.A.model(this.sI[s]));const s=n.A.tc(i,t);for(let t=0;t<6&&0!==this.eI[t];t++)s.ic(this.eI[t],this.hI[t]);return s}}},5637:(t,i,s)=>{s.d(i,{A:()=>c});var e=s(6333),h=s(1069),n=s(2031),r=s(8665),o=s(1023),a=s(6169),l=s(3867);class c extends e.${static count=0;static cache=null;static nI=null;static rI=null;static oI=0;static og=new n.A(500);static ag=new n.A(30);static Dy=t=>{this.nI=new h.A(t.read('loc.dat'));const i=new h.A(t.read('loc.idx'));this.count=i.ct,this.rI=new Int32Array(this.count);let s=2;for(let t=0;t<this.count;t++)this.rI[t]=s,s+=i.ct;this.cache=new l.Ps(10,null);for(let t=0;t<10;t++)this.cache[t]=new c(-1)};static get=t=>{if(!this.cache||!this.rI||!this.nI)throw new Error('LocType not loaded!!!');for(let i=0;i<10;i++){const s=this.cache[i];if(s&&s.id===t)return s}this.oI=(this.oI+1)%10;const i=this.cache[this.oI];return this.nI.ft=this.rI[t],i.id=t,i.reset(),i.Wb(this.nI),i.aI||(i.aI=new Int32Array(1)),-1===i.lI&&i.aI&&(i.active=i.aI.length>0&&i.aI[0]===o.A.QC.id,i.gm&&(i.active=!0)),i};static $o=()=>{this.og=null,this.ag=null,this.rI=null,this.cache=null,this.nI=null};iI=null;aI=null;name=null;OC=null;eI=null;hI=null;width=1;length=1;gS=!0;CS=!0;active=!1;lI=-1;cI=!1;fI=!1;Zb=!1;Pa=-1;Iw=!1;uI=16;Dw=0;kw=0;gm=null;cC=-1;AC=-1;dI=!1;yI=!0;pI=128;wI=128;AI=128;sS=0;xI=0;gI=0;CI=0;SI=!1;decode(t,i){if(1===t){const t=i.kc;this.iI=new Int32Array(t),this.aI=new Int32Array(t);for(let s=0;s<t;s++)this.iI[s]=i.ct,this.aI[s]=i.kc}else if(2===t)this.name=i.TS;else if(3===t)this.OC=i.TS;else if(14===t)this.width=i.kc;else if(15===t)this.length=i.kc;else if(17===t)this.gS=!1;else if(18===t)this.CS=!1;else if(19===t)this.lI=i.kc,1===this.lI&&(this.active=!0);else if(21===t)this.cI=!0;else if(22===t)this.fI=!0;else if(23===t)this.Zb=!0;else if(24===t)this.Pa=i.ct,65535===this.Pa&&(this.Pa=-1);else if(25===t)this.Iw=!0;else if(28===t)this.uI=i.kc;else if(29===t)this.Dw=i.Mc;else if(39===t)this.kw=i.Mc;else if(t>=30&&t<39)this.gm||(this.gm=new l.Ps(5,null)),this.gm[t-30]=i.TS,'hidden'===this.gm[t-30]?.toLowerCase()&&(this.gm[t-30]=null);else if(40===t){const t=i.kc;this.eI=new Uint16Array(t),this.hI=new Uint16Array(t);for(let s=0;s<t;s++)this.eI[s]=i.ct,this.hI[s]=i.ct}else 60===t?this.cC=i.ct:62===t?this.dI=!0:64===t?this.yI=!1:65===t?this.pI=i.ct:66===t?this.wI=i.ct:67===t?this.AI=i.ct:68===t?this.AC=i.ct:69===t?this.sS=i.kc:70===t?this.xI=i.kS:71===t?this.gI=i.kS:72===t?this.CI=i.kS:73===t&&(this.SI=!0)}Ul(t,i,s,e,h,n,o){if(!this.aI)return null;let l=-1;for(let i=0;i<this.aI.length;i++)if(this.aI[i]===t){l=i;break}if(-1===l)return null;const f=BigInt(BigInt(this.id)<<6n)+BigInt(BigInt(l)<<3n)+BigInt(i)+BigInt(BigInt(o)+1n<<32n);let u=c.ag?.get(f);if(u){if((this.cI||this.fI)&&(u=r.A.mI(u,this.cI,this.fI)),this.cI){const t=(s+e+h+n)/4|0;for(let i=0;i<u.vI;i++){const r=u.BI[i],o=s+((e-s)*(r+64)/128|0),a=o+((n+((h-n)*(r+64)/128|0)-o)*(u.bI[i]+64)/128|0);u.II[i]+=a-t}u.EI()}return u}if(!this.iI)return null;if(l>=this.iI.length)return null;let d=this.iI[l];if(-1===d)return null;const y=this.dI!==i>3;y&&(d+=65536);let p=c.og?.get(BigInt(d));p||(p=r.A.model(65535&d),y&&p._I(),c.og?.put(BigInt(d),p));const w=128!==this.pI||128!==this.wI||128!==this.AI,A=0!==this.xI||0!==this.gI||0!==this.CI;let x=r.A.bw(p,!this.eI,!this.Iw,i===a.A.CC&&-1===o&&!w&&!A);for(-1!==o&&(x.nc(),x.rc(o),x.Tw=null,x.Ow=null);i-- >0;)x.eA();if(this.eI&&this.hI)for(let t=0;t<this.eI.length;t++)x.ic(this.eI[t],this.hI[t]);if(w&&x.scale(this.pI,this.wI,this.AI),A&&x.translate(this.gI,this.xI,this.CI),x.oc(64+(255&this.Dw),5*(255&this.kw)+768,-50,-10,-50,!this.fI),this.gS&&(x.TI=x.Yw),c.ag?.put(f,x),(this.cI||this.fI)&&(x=r.A.mI(x,this.cI,this.fI)),this.cI){const t=(s+e+h+n)/4|0;for(let i=0;i<x.vI;i++){const r=x.BI[i],o=s+((e-s)*(r+64)/128|0),a=o+((n+((h-n)*(r+64)/128|0)-o)*(x.bI[i]+64)/128|0);x.II[i]+=a-t}x.EI()}return x}reset(){this.iI=null,this.aI=null,this.name=null,this.OC=null,this.eI=null,this.hI=null,this.width=1,this.length=1,this.gS=!0,this.CS=!0,this.active=!1,this.lI=-1,this.cI=!1,this.fI=!1,this.Zb=!1,this.Pa=-1,this.uI=16,this.Dw=0,this.kw=0,this.gm=null,this.Iw=!1,this.cC=-1,this.AC=-1,this.dI=!1,this.yI=!0,this.pI=128,this.wI=128,this.AI=128,this.sS=0,this.xI=0,this.gI=0,this.CI=0,this.SI=!1}}},6948:(t,i,s)=>{s.d(i,{A:()=>a});var e=s(6333),h=s(1069),n=s(2031),r=s(8665),o=s(3867);class a extends e.${static count=0;static cache=null;static nI=null;static rI=null;static oI=0;static ia=new n.A(30);static Dy=t=>{this.nI=new h.A(t.read('npc.dat'));const i=new h.A(t.read('npc.idx'));this.count=i.ct,this.rI=new Int32Array(this.count);let s=2;for(let t=0;t<this.count;t++)this.rI[t]=s,s+=i.ct;this.cache=new o.Ps(20,null);for(let t=0;t<20;t++)this.cache[t]=new a(-1)};static get=t=>{if(!this.cache||!this.rI||!this.nI)throw new Error('NpcType not loaded!!!');for(let i=0;i<20;i++){const s=this.cache[i];if(s&&s.id===t)return s}this.oI=(this.oI+1)%20;const i=this.cache[this.oI]=new a(t);return this.nI.ft=this.rI[t],i.Wb(this.nI),i};static $o=()=>{this.ia=null,this.rI=null,this.cache=null,this.nI=null};name=null;OC=null;size=1;iI=null;sI=null;Iw=!1;uv=-1;nv=-1;ov=-1;lv=-1;fv=-1;eI=null;hI=null;gm=null;pI=-1;wI=-1;AI=-1;sC=!0;bm=-1;Lw=128;Rw=128;decode(t,i){if(1===t){const t=i.kc;this.iI=new Uint16Array(t);for(let s=0;s<t;s++)this.iI[s]=i.ct}else if(2===t)this.name=i.TS;else if(3===t)this.OC=i.TS;else if(12===t)this.size=i.Mc;else if(13===t)this.uv=i.ct;else if(14===t)this.nv=i.ct;else if(16===t)this.Iw=!0;else if(17===t)this.nv=i.ct,this.ov=i.ct,this.lv=i.ct,this.fv=i.ct;else if(t>=30&&t<40)this.gm||(this.gm=new o.Ps(5,null)),this.gm[t-30]=i.TS,'hidden'===this.gm[t-30]?.toLowerCase()&&(this.gm[t-30]=null);else if(40===t){const t=i.kc;this.eI=new Uint16Array(t),this.hI=new Uint16Array(t);for(let s=0;s<t;s++)this.eI[s]=i.ct,this.hI[s]=i.ct}else if(60===t){const t=i.kc;this.sI=new Uint16Array(t);for(let s=0;s<t;s++)this.sI[s]=i.ct}else 90===t?this.pI=i.ct:91===t?this.wI=i.ct:92===t?this.AI=i.ct:93===t?this.sC=!1:95===t?this.bm=i.ct:97===t?this.Lw=i.ct:98===t&&(this.Rw=i.ct)}Bw(t,i,s){let e=null,h=null;if(a.ia&&(h=a.ia.get(BigInt(this.id)),!h&&this.iI)){const t=new o.Ps(this.iI.length,null);for(let i=0;i<this.iI.length;i++)t[i]=r.A.model(this.iI[i]);if(h=1===t.length?t[0]:r.A.tc(t,t.length),this.eI&&this.hI)for(let t=0;t<this.eI.length;t++)h?.ic(this.eI[t],this.hI[t]);h?.nc(),h?.oc(64,850,-30,-50,-30,!0),h&&a.ia.put(BigInt(this.id),h)}return h?(e=r.A.OI(h,!this.Iw),-1!==t&&-1!==i?e.LI(t,i,s):-1!==t&&e.rc(t),128===this.Lw&&128===this.Rw||e.scale(this.Lw,this.Rw,this.Lw),e.RI(),e.Tw=null,e.Ow=null,1===this.size&&(e.Uw=!0),e):null}_S(){if(!this.sI)return null;const t=new o.Ps(this.sI.length,null);for(let i=0;i<this.sI.length;i++)t[i]=r.A.model(this.sI[i]);let i;if(i=1===t.length?t[0]:r.A.tc(t,t.length),this.eI&&this.hI)for(let t=0;t<this.eI.length;t++)i?.ic(this.eI[t],this.hI[t]);return i}}},1302:(t,i,s)=>{s.d(i,{A:()=>u});var e=s(6333),h=s(1069),n=s(1122),r=s(2031),o=s(8665),a=s(4583),l=s(8950),c=s(9298),f=s(3867);class u extends e.${static count=0;static cache=null;static nI=null;static rI=null;static oI=0;static DI=!0;static ia=new r.A(50);static lg=new r.A(200);static Dy=(t,i)=>{this.DI=i,this.nI=new h.A(t.read('obj.dat'));const s=new h.A(t.read('obj.idx'));this.count=s.ct,this.rI=new Int32Array(this.count);let e=2;for(let t=0;t<this.count;t++)this.rI[t]=e,e+=s.ct;this.cache=new f.Ps(10,null);for(let t=0;t<10;t++)this.cache[t]=new u(-1)};static get=t=>{if(!this.cache||!this.rI||!this.nI)throw new Error('ObjType not loaded!!!');for(let i=0;i<10;i++){const s=this.cache[i];if(s&&s.id===t)return s}this.oI=(this.oI+1)%10;const i=this.cache[this.oI];return this.nI.ft=this.rI[t],i.id=t,i.reset(),i.Wb(this.nI),-1!==i.kI&&i.MI(),!this.DI&&i.members&&(i.name='Members Object',i.OC="Login to a members' server to use this object.",i.gm=null,i.rm=null),i};static $o=()=>{this.ia=null,this.lg=null,this.rI=null,this.cache=null,this.nI=null};static rl=(t,i)=>{if(u.lg){let s=u.lg.get(BigInt(t));if(s&&s.nC!==i&&-1!==s.nC&&(s.ES(),s=null),s)return s}let s=u.get(t);if(s.UI||(i=-1),s.UI&&s.NI&&i>1){let t=-1;for(let e=0;e<10;e++)i>=s.NI[e]&&0!==s.NI[e]&&(t=s.UI[e]);-1!==t&&(s=u.get(t))}const e=new n.A(32,32),h=a.A.Dl,r=a.A.kl,o=a.A.wA,f=l.A.Kc,d=l.A.zc,y=l.A.FI,p=l.A.left,w=l.A.right,A=l.A.top,x=l.A.bottom;a.A.VI=!1,l.A.bind(e.Kc,32,32),l.A.fillRect(0,0,32,32,c.A.dl),a.A.vB();const g=s.fS(1),C=a.A.sin[s.MS]*s.PS>>16,S=a.A.cos[s.MS]*s.PS>>16;g.Nl(0,s.US,s.GI,s.MS,s.WI,C+(g.Yw/2|0)+s.YI,S+s.YI);for(let t=31;t>=0;t--)for(let i=31;i>=0;i--)0===e.Kc[t+32*i]&&(t>0&&e.Kc[t+32*i-1]>1||i>0&&e.Kc[t+32*(i-1)]>1||t<31&&e.Kc[t+32*i+1]>1||i<31&&e.Kc[t+32*(i+1)]>1)&&(e.Kc[t+32*i]=1);for(let t=31;t>=0;t--)for(let i=31;i>=0;i--)0===e.Kc[t+32*i]&&t>0&&i>0&&e.Kc[t+32*(i-1)-1]>0&&(e.Kc[t+32*i]=3153952);if(-1!==s.kI){const t=this.rl(s.HI,10),i=t.cl,e=t.nC;t.cl=32,t.nC=32,t.zI(5,5,22,22),t.cl=i,t.nC=e}return u.lg?.put(BigInt(t),e),l.A.bind(f,d,y),l.A.Ha(p,A,w,x),a.A.Dl=h,a.A.kl=r,a.A.wA=o,a.A.VI=!0,s.Gl?e.cl=33:e.cl=32,e.nC=i,e};model=0;name=null;OC=null;eI=null;hI=null;PS=2e3;MS=0;US=0;GI=0;WI=0;YI=0;XI=!1;KI=-1;Gl=!1;lS=1;members=!1;gm=null;rm=null;ZI=-1;jI=-1;qI=0;$I=-1;JI=-1;QI=0;tE=-1;iE=-1;sE=-1;eE=-1;hE=-1;nE=-1;UI=null;NI=null;HI=-1;kI=-1;decode(t,i){if(1===t)this.model=i.ct;else if(2===t)this.name=i.TS;else if(3===t)this.OC=i.TS;else if(4===t)this.PS=i.ct;else if(5===t)this.MS=i.ct;else if(6===t)this.US=i.ct;else if(7===t)this.WI=i.kS,this.WI>32767&&(this.WI-=65536);else if(8===t)this.YI=i.kS,this.YI>32767&&(this.YI-=65536);else if(9===t)this.XI=!0;else if(10===t)this.KI=i.ct;else if(11===t)this.Gl=!0;else if(12===t)this.lS=i.ut;else if(16===t)this.members=!0;else if(23===t)this.ZI=i.ct,this.qI=i.Mc;else if(24===t)this.jI=i.ct;else if(25===t)this.$I=i.ct,this.QI=i.Mc;else if(26===t)this.JI=i.ct;else if(t>=30&&t<35)this.gm||(this.gm=new f.Ps(5,null)),this.gm[t-30]=i.TS,'hidden'===this.gm[t-30]?.toLowerCase()&&(this.gm[t-30]=null);else if(t>=35&&t<40)this.rm||(this.rm=new f.Ps(5,null)),this.rm[t-35]=i.TS;else if(40===t){const t=i.kc;this.eI=new Uint16Array(t),this.hI=new Uint16Array(t);for(let s=0;s<t;s++)this.eI[s]=i.ct,this.hI[s]=i.ct}else 78===t?this.tE=i.ct:79===t?this.iE=i.ct:90===t?this.sE=i.ct:91===t?this.hE=i.ct:92===t?this.eE=i.ct:93===t?this.nE=i.ct:95===t?this.GI=i.ct:97===t?this.HI=i.ct:98===t?this.kI=i.ct:t>=100&&t<110&&(this.UI&&this.NI||(this.UI=new Uint16Array(10),this.NI=new Uint16Array(10)),this.UI[t-100]=i.ct,this.NI[t-100]=i.ct)}rE(t){let i=this.ZI;if(1===t&&(i=this.$I),-1===i)return null;let s=this.jI,e=this.tE;1===t&&(s=this.JI,e=this.iE);let h=o.A.model(i);if(-1!==s){const t=o.A.model(s);if(-1===e){const i=[h,t];h=o.A.tc(i,2)}else{const i=[h,t,o.A.model(e)];h=o.A.tc(i,3)}}if(0===t&&0!==this.qI&&h.translate(this.qI,0,0),1===t&&0!==this.QI&&h.translate(this.QI,0,0),this.eI&&this.hI)for(let t=0;t<this.eI.length;t++)h.ic(this.eI[t],this.hI[t]);return h}_S(t){let i=this.sE;if(1===t&&(i=this.hE),-1===i)return null;let s=this.eE;1===t&&(s=this.nE);let e=o.A.model(i);if(-1!==s){const t=[e,o.A.model(s)];e=o.A.tc(t,2)}if(this.eI&&this.hI)for(let t=0;t<this.eI.length;t++)e.ic(this.eI[t],this.hI[t]);return e}fS(t){if(this.UI&&this.NI&&t>1){let i=-1;for(let s=0;s<10;s++)t>=this.NI[s]&&0!==this.NI[s]&&(i=this.UI[s]);if(-1!==i)return u.get(i).fS(1)}if(u.ia){const t=u.ia.get(BigInt(this.id));if(t)return t}const i=o.A.model(this.model);if(this.eI&&this.hI)for(let t=0;t<this.eI.length;t++)i.ic(this.eI[t],this.hI[t]);return i.oc(64,768,-50,-10,-50,!0),i.Uw=!0,u.ia?.put(BigInt(this.id),i),i}MI(){const t=u.get(this.kI);this.model=t.model,this.PS=t.PS,this.MS=t.MS,this.US=t.US,this.GI=t.GI,this.WI=t.WI,this.YI=t.YI,this.eI=t.eI,this.hI=t.hI;const i=u.get(this.HI);this.name=i.name,this.members=i.members,this.lS=i.lS;let s='a';const e=(i.name||'').toLowerCase().charAt(0);'a'!==e&&'e'!==e&&'i'!==e&&'o'!==e&&'u'!==e||(s='an'),this.OC=`Swap this note at any bank for ${s} ${i.name}.`,this.Gl=!0}reset(){this.model=0,this.name=null,this.OC=null,this.eI=null,this.hI=null,this.PS=2e3,this.MS=0,this.US=0,this.GI=0,this.WI=0,this.YI=0,this.XI=!1,this.KI=-1,this.Gl=!1,this.lS=1,this.members=!1,this.gm=null,this.rm=null,this.ZI=-1,this.jI=-1,this.qI=0,this.$I=-1,this.JI=-1,this.QI=0,this.tE=-1,this.iE=-1,this.sE=-1,this.eE=-1,this.hE=-1,this.nE=-1,this.UI=null,this.NI=null,this.HI=-1,this.kI=-1}}},1312:(t,i,s)=>{s.d(i,{A:()=>r});var e=s(6333),h=s(1069),n=s(6730);class r extends e.${static count=0;static ta=[];static Dy=t=>{const i=new h.A(t.read('seq.dat'));this.count=i.ct;for(let t=0;t<this.count;t++){const s=new r(t).Wb(i);0===s.Ga&&(s.Ga=1,s.frames=new Int16Array(1),s.frames[0]=-1,s.Pl=new Int16Array(1),s.Pl[0]=-1,s.delay=new Int16Array(1),s.delay[0]=-1),this.ta[t]=s}};Ga=0;frames=null;Pl=null;delay=null;Wa=-1;Ww=null;Gv=!1;priority=5;oE=-1;aE=-1;Vv=99;duration=0;decode(t,i){if(1===t){this.Ga=i.kc,this.frames=new Int16Array(this.Ga),this.Pl=new Int16Array(this.Ga),this.delay=new Int16Array(this.Ga);for(let t=0;t<this.Ga;t++)this.frames[t]=i.ct,this.Pl[t]=i.ct,65535===this.Pl[t]&&(this.Pl[t]=-1),this.delay[t]=i.ct,0===this.delay[t]&&(this.delay[t]=n.A.ta[this.frames[t]].delay),0===this.delay[t]&&(this.delay[t]=1),this.duration+=this.delay[t]}else if(2===t)this.Wa=i.ct;else if(3===t){const t=i.kc;this.Ww=new Int32Array(t+1);for(let s=0;s<t;s++)this.Ww[s]=i.kc;this.Ww[t]=9999999}else 4===t?this.Gv=!0:5===t?this.priority=i.kc:6===t?this.oE=i.ct:7===t?this.aE=i.ct:8===t?this.Vv=i.kc:console.log('Error unrecognised seq config code: ',t)}}},8738:(t,i,s)=>{s.d(i,{A:()=>a});var e=s(6333),h=s(1069),n=s(1312),r=s(8665),o=s(2031);class a extends e.${static count=0;static ta=[];static ia=new o.A(30);static Dy=t=>{const i=new h.A(t.read('spotanim.dat'));this.count=i.ct;for(let t=0;t<this.count;t++)this.ta[t]=new a(t).Wb(i)};model=0;Pa=-1;_w=null;Iw=!1;eI=new Uint16Array(6);hI=new Uint16Array(6);Lw=128;Rw=128;orientation=0;Dw=0;kw=0;decode(t,i){1===t?this.model=i.ct:2===t?(this.Pa=i.ct,n.A.ta&&(this._w=n.A.ta[this.Pa])):3===t?this.Iw=!0:4===t?this.Lw=i.ct:5===t?this.Rw=i.ct:6===t?this.orientation=i.ct:7===t?this.Dw=i.kc:8===t?this.kw=i.kc:t>=40&&t<50?this.eI[t-40]=i.ct:t>=50&&t<60?this.hI[t-50]=i.ct:console.log('Error unrecognised spotanim config code: ',t)}Ul(){let t=a.ia?.get(BigInt(this.id));if(t)return t;t=r.A.model(this.model);for(let i=0;i<6;i++)0!==this.eI[0]&&t.ic(this.eI[i],this.hI[i]);return a.ia?.put(BigInt(this.id),t),t}}},3764:(t,i,s)=>{s.d(i,{A:()=>n});var e=s(6333),h=s(1069);class n extends e.${static count=0;static ta=[];static lE=[];static cE=0;static Dy=t=>{const i=new h.A(t.read('varp.dat'));this.count=i.ct;for(let t=0;t<this.count;t++)this.ta[t]=new n(t).Wb(i)};scope=0;type=0;lE=!1;fE=!0;$S=0;uE=0;dE=!1;yE=!1;decode(t,i){1===t?this.scope=i.kc:2===t?this.type=i.kc:3===t?(this.lE=!0,n.lE[n.cE++]=this.id):4===t?this.fE=!1:5===t?this.$S=i.ct:6===t?this.dE=!0:7===t?this.uE=i.ut:8===t?this.yE=!0:10===t?this.Gb=i.TS:console.log('Error unrecognised config code: ',t)}}},9456:(t,i,s)=>{s.d(i,{A:()=>e});class e{static OPEN=0;static pE=1;static wE=2;static AE=4;static xE=8;static gE=e.pE<<4;static CE=e.wE<<4;static SE=e.AE<<4;static mE=e.xE<<4;static vE=256;static BE=512;static bE=1024;static IE=2048;static EE=4096;static _E=e.BE<<4;static TE=e.bE<<4;static OE=e.IE<<4;static LE=e.EE<<4;static RE=e.vE<<9;static DE=524288;static kE=2097152;static ME=e.kE|e.DE;static UE=e.vE|e.ME;static dC=e.wE|e.UE;static fC=e.xE|e.UE;static Lm=e.wE|e.AE|e.fC;static yC=e.CE|e.UE;static Dm=e.xE|e.gE|e.yC;static uC=e.mE|e.UE;static Rm=e.pE|e.wE|e.uC;static km=e.CE|e.SE|e.uC;static PE=16777215}},670:(t,i,s)=>{s.d(i,{A:()=>o});var e=s(9456),h=s(6169),n=s(1023),r=s(4909);class o{static sr=4;static Ar=104;static index=(t,i)=>t*o.Ar+i;offsetX;NE;sizeX;sizeZ;flags;constructor(){this.offsetX=0,this.NE=0,this.sizeX=o.Ar,this.sizeZ=o.Ar,this.flags=new Int32Array(this.sizeX*this.sizeZ),this.reset()}reset=()=>{for(let t=0;t<this.sizeX;t++)for(let i=0;i<this.sizeZ;i++){const s=o.index(t,i);0===t||0===i||t===this.sizeX-1||i===this.sizeZ-1?this.flags[s]=e.A.PE:this.flags[s]=e.A.OPEN}};FE=(t,i)=>{this.flags[o.index(t-this.offsetX,i-this.NE)]|=e.A.kE};BS=(t,i)=>{this.flags[o.index(t-this.offsetX,i-this.NE)]&=~e.A.kE};dS=(t,i,s,n,r,o)=>{let a=e.A.vE;o&&(a|=e.A.RE);const l=t-this.offsetX,c=i-this.NE;if(r===h.A.SC||r===h.A.vC){const t=s;s=n,n=t}for(let t=l;t<l+s;t++)if(t>=0&&t<this.sizeX)for(let i=c;i<c+n;i++)i>=0&&i<this.sizeZ&&this.add(t,i,a)};mS=(t,i,s,n,r,o)=>{let a=e.A.vE;o&&(a|=e.A.RE);const l=t-this.offsetX,c=i-this.NE;if(r===h.A.SC||r===h.A.vC){const t=s;s=n,n=t}for(let t=l;t<l+s;t++)if(t>=0&&t<this.sizeX)for(let i=c;i<c+n;i++)i>=0&&i<this.sizeZ&&this.remove(t,i,a)};VE=(t,i,s,r,o)=>{const a=t-this.offsetX,l=i-this.NE,c=o?e.A.LE:e.A.mE,f=o?e.A.EE:e.A.xE,u=o?e.A.bE:e.A.wE,d=o?e.A.TE:e.A.CE,y=o?e.A.BE:e.A.pE,p=o?e.A._E:e.A.gE,w=o?e.A.IE:e.A.AE,A=o?e.A.OE:e.A.SE;s===n.A.xC.id?r===h.A.CC?(this.add(a,l,c),this.add(a-1,l,f)):r===h.A.SC?(this.add(a,l,u),this.add(a,l+1,d)):r===h.A.mC?(this.add(a,l,f),this.add(a+1,l,c)):r===h.A.vC&&(this.add(a,l,d),this.add(a,l-1,u)):s===n.A.GE.id||s===n.A.BC.id?r===h.A.CC?(this.add(a,l,y),this.add(a-1,l+1,p)):r===h.A.SC?(this.add(a,l,w),this.add(a+1,l+1,A)):r===h.A.mC?(this.add(a,l,p),this.add(a+1,l-1,y)):r===h.A.vC&&(this.add(a,l,A),this.add(a-1,l-1,w)):s===n.A.gC.id&&(r===h.A.CC?(this.add(a,l,u|c),this.add(a-1,l,f),this.add(a,l+1,d)):r===h.A.SC?(this.add(a,l,u|f),this.add(a,l+1,d),this.add(a+1,l,c)):r===h.A.mC?(this.add(a,l,d|f),this.add(a+1,l,c),this.add(a,l-1,u)):r===h.A.vC&&(this.add(a,l,d|c),this.add(a,l-1,u),this.add(a-1,l,f))),o&&this.VE(t,i,s,r,!1)};xS=(t,i,s,r,o)=>{const a=t-this.offsetX,l=i-this.NE,c=o?e.A.LE:e.A.mE,f=o?e.A.EE:e.A.xE,u=o?e.A.bE:e.A.wE,d=o?e.A.TE:e.A.CE,y=o?e.A.BE:e.A.pE,p=o?e.A._E:e.A.gE,w=o?e.A.IE:e.A.AE,A=o?e.A.OE:e.A.SE;s===n.A.xC.id?r===h.A.CC?(this.remove(a,l,c),this.remove(a-1,l,f)):r===h.A.SC?(this.remove(a,l,u),this.remove(a,l+1,d)):r===h.A.mC?(this.remove(a,l,f),this.remove(a+1,l,c)):r===h.A.vC&&(this.remove(a,l,d),this.remove(a,l-1,u)):s===n.A.GE.id||s===n.A.BC.id?r===h.A.CC?(this.remove(a,l,y),this.remove(a-1,l+1,p)):r===h.A.SC?(this.remove(a,l,w),this.remove(a+1,l+1,A)):r===h.A.mC?(this.remove(a,l,p),this.remove(a+1,l-1,y)):r===h.A.vC&&(this.remove(a,l,A),this.remove(a-1,l-1,w)):s===n.A.gC.id&&(r===h.A.CC?(this.remove(a,l,u|c),this.remove(a-1,l,f),this.remove(a,l+1,d)):r===h.A.SC?(this.remove(a,l,u|f),this.remove(a,l+1,d),this.remove(a+1,l,c)):r===h.A.mC?(this.remove(a,l,d|f),this.remove(a+1,l,c),this.remove(a,l-1,u)):r===h.A.vC&&(this.remove(a,l,d|c),this.remove(a,l-1,u),this.remove(a-1,l,f))),o&&this.xS(t,i,s,r,!1)};_m=(t,i,s,r,a,l)=>{if(t===s&&i===r)return!0;const c=t-this.offsetX,f=i-this.NE,u=s-this.offsetX,d=r-this.NE,y=o.index(c,f);if(a===n.A.xC.id){if(l===h.A.CC){if(c===u-1&&f===d)return!0;if(c===u&&f===d+1&&(this.flags[y]&e.A.yC)===e.A.OPEN)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.dC)===e.A.OPEN)return!0}else if(l===h.A.SC){if(c===u&&f===d+1)return!0;if(c===u-1&&f===d&&(this.flags[y]&e.A.fC)===e.A.OPEN)return!0;if(c===u+1&&f===d&&(this.flags[y]&e.A.uC)===e.A.OPEN)return!0}else if(l===h.A.mC){if(c===u+1&&f===d)return!0;if(c===u&&f===d+1&&(this.flags[y]&e.A.yC)===e.A.OPEN)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.dC)===e.A.OPEN)return!0}else if(l===h.A.vC){if(c===u&&f===d-1)return!0;if(c===u-1&&f===d&&(this.flags[y]&e.A.fC)===e.A.OPEN)return!0;if(c===u+1&&f===d&&(this.flags[y]&e.A.uC)===e.A.OPEN)return!0}}else if(a===n.A.gC.id){if(l===h.A.CC){if(c===u-1&&f===d)return!0;if(c===u&&f===d+1)return!0;if(c===u+1&&f===d&&(this.flags[y]&e.A.uC)===e.A.OPEN)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.dC)===e.A.OPEN)return!0}else if(l===h.A.SC){if(c===u-1&&f===d&&(this.flags[y]&e.A.fC)===e.A.OPEN)return!0;if(c===u&&f===d+1)return!0;if(c===u+1&&f===d)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.dC)===e.A.OPEN)return!0}else if(l===h.A.mC){if(c===u-1&&f===d&&(this.flags[y]&e.A.fC)===e.A.OPEN)return!0;if(c===u&&f===d+1&&(this.flags[y]&e.A.yC)===e.A.OPEN)return!0;if(c===u+1&&f===d)return!0;if(c===u&&f===d-1)return!0}else if(l===h.A.vC){if(c===u-1&&f===d)return!0;if(c===u&&f===d+1&&(this.flags[y]&e.A.yC)===e.A.OPEN)return!0;if(c===u+1&&f===d&&(this.flags[y]&e.A.uC)===e.A.OPEN)return!0;if(c===u&&f===d-1)return!0}}else if(a===n.A.IC.id){if(c===u&&f===d+1&&(this.flags[y]&e.A.CE)===e.A.OPEN)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.wE)===e.A.OPEN)return!0;if(c===u-1&&f===d&&(this.flags[y]&e.A.xE)===e.A.OPEN)return!0;if(c===u+1&&f===d&&(this.flags[y]&e.A.mE)===e.A.OPEN)return!0}return!1};Tm=(t,i,s,r,a,l)=>{if(t===s&&i===r)return!0;const c=t-this.offsetX,f=i-this.NE,u=s-this.offsetX,d=r-this.NE,y=o.index(c,f);if(a===n.A.WE.id||a===n.A.YE.id){if(a===n.A.YE.id&&(l=l+2&3),l===h.A.CC){if(c===u+1&&f===d&&(this.flags[y]&e.A.mE)===e.A.OPEN)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.wE)===e.A.OPEN)return!0}else if(l===h.A.SC){if(c===u-1&&f===d&&(this.flags[y]&e.A.xE)===e.A.OPEN)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.wE)===e.A.OPEN)return!0}else if(l===h.A.mC){if(c===u-1&&f===d&&(this.flags[y]&e.A.xE)===e.A.OPEN)return!0;if(c===u&&f===d+1&&(this.flags[y]&e.A.CE)===e.A.OPEN)return!0}else if(l===h.A.vC){if(c===u+1&&f===d&&(this.flags[y]&e.A.mE)===e.A.OPEN)return!0;if(c===u&&f===d+1&&(this.flags[y]&e.A.CE)===e.A.OPEN)return!0}}else if(a===n.A.HE.id){if(c===u&&f===d+1&&(this.flags[y]&e.A.CE)===e.A.OPEN)return!0;if(c===u&&f===d-1&&(this.flags[y]&e.A.wE)===e.A.OPEN)return!0;if(c===u-1&&f===d&&(this.flags[y]&e.A.xE)===e.A.OPEN)return!0;if(c===u+1&&f===d&&(this.flags[y]&e.A.mE)===e.A.OPEN)return!0}return!1};Om=(t,i,s,h,n,a,l)=>{const c=s+n-1,f=h+a-1,u=o.index(t-this.offsetX,i-this.NE);return t>=s&&t<=c&&i>=h&&i<=f||(t===s-1&&i>=h&&i<=f&&(this.flags[u]&e.A.xE)===e.A.OPEN&&(l&r.A.CC)===e.A.OPEN||(t===c+1&&i>=h&&i<=f&&(this.flags[u]&e.A.mE)===e.A.OPEN&&(l&r.A.mC)===e.A.OPEN||(i===h-1&&t>=s&&t<=c&&(this.flags[u]&e.A.wE)===e.A.OPEN&&(l&r.A.vC)===e.A.OPEN||i===f+1&&t>=s&&t<=c&&(this.flags[u]&e.A.CE)===e.A.OPEN&&(l&r.A.SC)===e.A.OPEN)))};add=(t,i,s)=>{this.flags[o.index(t,i)]|=s};remove=(t,i,s)=>{this.flags[o.index(t,i)]&=e.A.PE-s}}},4909:(t,i,s)=>{s.d(i,{A:()=>e});class e{static SC=1;static mC=2;static vC=4;static CC=8}},6169:(t,i,s)=>{s.d(i,{A:()=>e});class e{static CC=0;static SC=1;static mC=2;static vC=3}},5599:(t,i,s)=>{s.d(i,{A:()=>e});class e{static yS=0;static pS=1;static AS=2;static iS=3}},1023:(t,i,s)=>{s.d(i,{A:()=>h});var e=s(5599);class h{static xC=new h(0,e.A.yS);static GE=new h(1,e.A.yS);static gC=new h(2,e.A.yS);static BC=new h(3,e.A.yS);static Rv=new h(4,e.A.pS);static Em=new h(5,e.A.pS);static WE=new h(6,e.A.pS);static YE=new h(7,e.A.pS);static HE=new h(8,e.A.pS);static IC=new h(9,e.A.AS);static QC=new h(10,e.A.AS);static tS=new h(11,e.A.AS);static zE=new h(12,e.A.AS);static XE=new h(13,e.A.AS);static KE=new h(14,e.A.AS);static ZE=new h(15,e.A.AS);static jE=new h(16,e.A.AS);static qE=new h(17,e.A.AS);static $E=new h(18,e.A.AS);static JE=new h(19,e.A.AS);static QE=new h(20,e.A.AS);static t_=new h(21,e.A.AS);static iS=new h(22,e.A.iS);static values(){return[this.xC,this.GE,this.qE,this.ZE,this.gC,this.KE,this.IC,this.BC,this.iS,this.zE,this.tS,this.WE,this.QE,this.QC,this.Em,this.XE,this.YE,this.Rv,this.jE,this.HE,this.JE,this.t_,this.$E]}static of(t){const i=this.values();for(let s=0;s<i.length;s++){const e=i[s];if(e.id===t)return e}throw Error('shape not found')}id;aw;constructor(t,i){this.id=t,this.aw=i}}},818:(t,i,s)=>{s.d(i,{A:()=>w});var e=s(670),h=s(2164),n=s(1069),r=s(4583),o=s(198),a=s(5637),l=s(4197),c=s(1312),f=s(1023),u=s(6169),d=s(9298),y=s(5518),p=s(3867);class w{static i_=Int8Array.of(1,2,4,8);static s_=Uint8Array.of(16,32,64,128);static e_=Int8Array.of(1,0,-1,0);static h_=Int8Array.of(0,-1,0,1);static n_=(17*Math.random()|0)-8;static r_=(33*Math.random()|0)-16;static Bt=!0;static VS=0;static o_=!1;static a_=(t,i)=>{let s=this.l_(t+45365,i+91923,4)+(this.l_(t+10294,i+37821,2)-128>>1)+(this.l_(t,i,1)-128>>2)-128;return s=35+(.3*s|0),s<10?s=10:s>60&&(s=60),s};static l_=(t,i,s)=>{const e=t/s|0,h=t&s-1,n=i/s|0,r=i&s-1,o=this.c_(e,n),a=this.c_(e+1,n),l=this.c_(e,n+1),c=this.c_(e+1,n+1),f=this.f_(o,a,h,s),u=this.f_(l,c,h,s);return this.f_(f,u,r,s)};static f_=(t,i,s,e)=>{const h=65536-r.A.cos[1024*s/e|0]>>1;return(t*(65536-h)>>16)+(i*h>>16)};static c_=(t,i)=>((this.Lp(t-1,i-1)+this.Lp(t+1,i-1)+this.Lp(t-1,i+1)+this.Lp(t+1,i+1))/16|0)+((this.Lp(t-1,i)+this.Lp(t+1,i)+this.Lp(t,i-1)+this.Lp(t,i+1))/8|0)+(this.Lp(t,i)/4|0);static Lp=(t,i)=>{const s=t+57*i,e=BigInt(s<<13^s);return 255&Number((e*(e*e*15731n+789221n)+1376312589n&0x7fffffffn)>>19n)};static dS=(t,i,s,e,h,n,r,o,d,y,p)=>{const A=h[p][i][s],x=h[p][i+1][s],g=h[p][i+1][s+1],C=h[p][i][s+1],S=A+x+g+C>>2,m=a.A.get(o);let v=i+(s<<7)+(o<<14)+1073741824|0;m.active||(v+=-2147483648),v|=0;const B=(y<<6)+d<<24>>24;if(d===f.A.iS.id)e?.u_(m.Ul(f.A.iS.id,y,A,x,g,C,-1),t,i,s,S,v,B),m.gS&&m.active&&r?.FE(i,s),-1!==m.Pa&&n.Sf(new l.A(o,t,3,i,s,c.A.ta[m.Pa],!0));else if(d===f.A.QC.id||d===f.A.tS.id){const h=m.Ul(f.A.QC.id,y,A,x,g,C,-1);if(h){let n,r,o=0;d===f.A.tS.id&&(o+=256),y===u.A.SC||y===u.A.vC?(n=m.length,r=m.width):(n=m.width,r=m.length),e?.dS(t,i,s,S,h,null,v,B,n,r,o)}m.gS&&r?.dS(i,s,m.width,m.length,y,m.CS),-1!==m.Pa&&n.Sf(new l.A(o,t,2,i,s,c.A.ta[m.Pa],!0))}else if(d>=f.A.zE.id)e?.dS(t,i,s,S,m.Ul(d,y,A,x,g,C,-1),null,v,B,1,1,0),m.gS&&r?.dS(i,s,m.width,m.length,y,m.CS),-1!==m.Pa&&n.Sf(new l.A(o,t,2,i,s,c.A.ta[m.Pa],!0));else if(d===f.A.xC.id)e?.VE(t,i,s,S,w.i_[y],0,m.Ul(f.A.xC.id,y,A,x,g,C,-1),null,v,B),m.gS&&r?.VE(i,s,d,y,m.CS),-1!==m.Pa&&n.Sf(new l.A(o,t,0,i,s,c.A.ta[m.Pa],!0));else if(d===f.A.GE.id)e?.VE(t,i,s,S,w.s_[y],0,m.Ul(f.A.GE.id,y,A,x,g,C,-1),null,v,B),m.gS&&r?.VE(i,s,d,y,m.CS),-1!==m.Pa&&n.Sf(new l.A(o,t,0,i,s,c.A.ta[m.Pa],!0));else if(d===f.A.gC.id){const h=y+1&3;e?.VE(t,i,s,S,w.i_[y],w.i_[h],m.Ul(f.A.gC.id,y+4,A,x,g,C,-1),m.Ul(f.A.gC.id,h,A,x,g,C,-1),v,B),m.gS&&r?.VE(i,s,d,y,m.CS),-1!==m.Pa&&n.Sf(new l.A(o,t,0,i,s,c.A.ta[m.Pa],!0))}else if(d===f.A.BC.id)e?.VE(t,i,s,S,w.s_[y],0,m.Ul(f.A.BC.id,y,A,x,g,C,-1),null,v,B),m.gS&&r?.VE(i,s,d,y,m.CS),-1!==m.Pa&&n.Sf(new l.A(o,t,0,i,s,c.A.ta[m.Pa],!0));else if(d===f.A.IC.id)e?.dS(t,i,s,S,m.Ul(d,y,A,x,g,C,-1),null,v,B,1,1,0),m.gS&&r?.dS(i,s,m.width,m.length,y,m.CS),-1!==m.Pa&&n.Sf(new l.A(o,t,2,i,s,c.A.ta[m.Pa],!0));else if(d===f.A.Rv.id)e?.d_(t,i,s,S,0,0,v,m.Ul(f.A.Rv.id,u.A.CC,A,x,g,C,-1),B,512*y,w.i_[y]),-1!==m.Pa&&n.Sf(new l.A(o,t,1,i,s,c.A.ta[m.Pa],!0));else if(d===f.A.Em.id){let h=16;if(e){const n=e.pC(t,i,s);n>0&&(h=a.A.get(n>>14&32767).uI)}e?.d_(t,i,s,S,w.e_[y]*h,w.h_[y]*h,v,m.Ul(f.A.Rv.id,u.A.CC,A,x,g,C,-1),B,512*y,w.i_[y]),-1!==m.Pa&&n.Sf(new l.A(o,t,1,i,s,c.A.ta[m.Pa],!0))}else d===f.A.WE.id?(e?.d_(t,i,s,S,0,0,v,m.Ul(f.A.Rv.id,u.A.CC,A,x,g,C,-1),B,y,256),-1!==m.Pa&&n.Sf(new l.A(o,t,1,i,s,c.A.ta[m.Pa],!0))):d===f.A.YE.id?(e?.d_(t,i,s,S,0,0,v,m.Ul(f.A.Rv.id,u.A.CC,A,x,g,C,-1),B,y,512),-1!==m.Pa&&n.Sf(new l.A(o,t,1,i,s,c.A.ta[m.Pa],!0))):d===f.A.HE.id&&(e?.d_(t,i,s,S,0,0,v,m.Ul(f.A.Rv.id,u.A.CC,A,x,g,C,-1),B,y,768),-1!==m.Pa&&n.Sf(new l.A(o,t,1,i,s,c.A.ta[m.Pa],!0)))};Ev;_v;dr;yr;y_;p_;w_;A_;x_;g_;C_;S_;m_;v_;B_;b_;constructor(t,i,s,h){this.Ev=t,this._v=i,this.dr=s,this.yr=h,this.y_=new p.oA(e.A.sr,t,i),this.p_=new p.oA(e.A.sr,t,i),this.w_=new p.oA(e.A.sr,t,i),this.A_=new p.oA(e.A.sr,t,i),this.b_=new p.aA(e.A.sr,t+1,i+1),this.x_=new p.oA(e.A.sr,t+1,i+1),this.g_=new p.wr(t+1,i+1),this.C_=new Int32Array(i),this.S_=new Int32Array(i),this.m_=new Int32Array(i),this.v_=new Int32Array(i),this.B_=new Int32Array(i)}KS=(t,i)=>{for(let t=0;t<e.A.sr;t++)for(let s=0;s<e.A.Ar;s++)for(let h=0;h<e.A.Ar;h++)if(!(1&~this.yr[t][s][h])){let e=t;2&~this.yr[1][s][h]||e--,e>=0&&i[e]?.FE(s,h)}w.n_+=(5*Math.random()|0)-2,w.n_<-8?w.n_=-8:w.n_>8&&(w.n_=8),w.r_+=(5*Math.random()|0)-2,w.r_<-16?w.r_=-16:w.r_>16&&(w.r_=16);for(let i=0;i<e.A.sr;i++){const s=this.x_[i],e=96,n=-50,o=-10,a=-50,l=768*(0|Math.sqrt(n*n+o*o+a*a))>>8;for(let t=1;t<this._v-1;t++)for(let h=1;h<this.Ev-1;h++){const r=this.dr[i][h+1][t]-this.dr[i][h-1][t],c=this.dr[i][h][t+1]-this.dr[i][h][t-1],f=0|Math.sqrt(r*r+c*c+65536),u=e+((n*((r<<8)/f|0)+o*(65536/f|0)+a*((c<<8)/f|0))/l|0),d=(s[h-1][t]>>2)+(s[h+1][t]>>3)+(s[h][t-1]>>2)+(s[h][t+1]>>3)+(s[h][t]>>1);this.g_[h][t]=u-d}for(let t=0;t<this._v;t++)this.C_[t]=0,this.S_[t]=0,this.m_[t]=0,this.v_[t]=0,this.B_[t]=0;for(let s=-5;s<this.Ev+5;s++){for(let t=0;t<this._v;t++){const e=s+5;let n;if(e>=0&&e<this.Ev){const s=255&this.y_[i][e][t];if(s>0){const i=h.A.ta[s-1];this.C_[t]+=i.Qb,this.S_[t]+=i.qb,this.m_[t]+=i.$b,this.v_[t]+=i.Jb,n=this.B_[t]++}}const r=s-5;if(r>=0&&r<this.Ev){const s=255&this.y_[i][r][t];if(s>0){const i=h.A.ta[s-1];this.C_[t]-=i.Qb,this.S_[t]-=i.qb,this.m_[t]-=i.$b,this.v_[t]-=i.Jb,n=this.B_[t]--}}}if(s>=1&&s<this.Ev-1){let e=0,n=0,o=0,a=0,l=0;for(let c=-5;c<this._v+5;c++){const f=c+5;f>=0&&f<this._v&&(e+=this.C_[f],n+=this.S_[f],o+=this.m_[f],a+=this.v_[f],l+=this.B_[f]);const p=c-5;if(p>=0&&p<this._v&&(e-=this.C_[p],n-=this.S_[p],o-=this.m_[p],a-=this.v_[p],l-=this.B_[p]),c>=1&&c<this._v-1&&(!w.Bt||!(16&this.yr[i][s][c])&&this.I_(i,s,c)===w.VS)){const f=255&this.y_[i][s][c],p=255&this.p_[i][s][c];if(f>0||p>0){const A=this.dr[i][s][c],x=this.dr[i][s+1][c],g=this.dr[i][s+1][c+1],C=this.dr[i][s][c+1],S=this.g_[s][c],m=this.g_[s+1][c],v=this.g_[s+1][c+1],B=this.g_[s][c+1];let b=-1,I=-1;if(f>0){const t=256*e/a|0,i=n/l|0;let s=o/l|0;b=h.A.Yb(t,i,s);const r=t+w.n_&255;s+=w.r_,s<0?s=0:s>255&&(s=255),I=h.A.Yb(r,i,s)}if(i>0){let t=0!==f||this.w_[i][s][c]===y.A.E_;p>0&&!h.A.ta[p-1].Zb&&(t=!1),t&&A===x&&A===g&&A===C&&(this.b_[i][s][c]|=2340)}let E=0;if(-1!==b&&(E=r.A.palette[h.A.Hb(I,96)]),0===p)t?.__(i,s,c,y.A.E_,u.A.CC,-1,A,x,g,C,h.A.Hb(b,S),h.A.Hb(b,m),h.A.Hb(b,v),h.A.Hb(b,B),d.A.dl,d.A.dl,d.A.dl,d.A.dl,E,d.A.dl);else{const e=this.w_[i][s][c]+1,n=this.A_[i][s][c],o=h.A.ta[p-1];let a,l,f=o.texture;f>=0?(l=r.A.T_(f),a=-1):o.Xb===d.A.qc?(l=0,a=-2,f=-1):(a=h.A.Yb(o.jb,o.qb,o.$b),l=r.A.palette[h.A.zb(o.tI,96)]),t?.__(i,s,c,e,n,f,A,x,g,C,h.A.Hb(b,S),h.A.Hb(b,m),h.A.Hb(b,v),h.A.Hb(b,B),h.A.zb(a,S),h.A.zb(a,m),h.A.zb(a,v),h.A.zb(a,B),E,l)}}}}}}for(let s=1;s<this._v-1;s++)for(let e=1;e<this.Ev-1;e++)t?.O_(i,e,s,this.I_(i,e,s))}w.o_||t?.L_(64,768,-50,-10,-50);for(let i=0;i<this.Ev;i++)for(let s=0;s<this._v;s++)2&~this.yr[1][i][s]||t?.R_(i,s);if(!w.o_){let t=1,i=2,s=4;for(let h=0;h<e.A.sr;h++){h>0&&(t<<=3,i<<=3,s<<=3);for(let e=0;e<=h;e++)for(let n=0;n<=this._v;n++)for(let r=0;r<=this.Ev;r++){if(this.b_[e][r][n]&t){let i=n,s=n,a=e,l=e;for(;i>0&&this.b_[e][r][i-1]&t;)i--;for(;s<this._v&&this.b_[e][r][s+1]&t;)s++;t:for(;a>0;){for(let e=i;e<=s;e++)if(!(this.b_[a-1][r][e]&t))break t;a--}t:for(;l<h;){for(let e=i;e<=s;e++)if(!(this.b_[l+1][r][e]&t))break t;l++}if((l+1-a)*(s+1-i)>=8){const e=this.dr[l][r][i]-240,n=this.dr[a][r][i];o.A.D_(h,1,128*r,e,128*i,128*r,n,128*s+128);for(let e=a;e<=l;e++)for(let h=i;h<=s;h++)this.b_[e][r][h]&=~t}}if(this.b_[e][r][n]&i){let t=r,s=r,a=e,l=e;for(;t>0&&this.b_[e][t-1][n]&i;)t--;for(;s<this.Ev&&this.b_[e][s+1][n]&i;)s++;t:for(;a>0;){for(let e=t;e<=s;e++)if(!(this.b_[a-1][e][n]&i))break t;a--}t:for(;l<h;){for(let e=t;e<=s;e++)if(!(this.b_[l+1][e][n]&i))break t;l++}if((l+1-a)*(s+1-t)>=8){const e=this.dr[l][t][n]-240,r=this.dr[a][t][n];o.A.D_(h,2,128*t,e,128*n,128*s+128,r,128*n);for(let e=a;e<=l;e++)for(let h=t;h<=s;h++)this.b_[e][h][n]&=~i}}if(this.b_[e][r][n]&s){let t=r,i=r,a=n,l=n;for(;a>0&&this.b_[e][r][a-1]&s;)a--;for(;l<this._v&&this.b_[e][r][l+1]&s;)l++;t:for(;t>0;){for(let i=a;i<=l;i++)if(!(this.b_[e][t-1][i]&s))break t;t--}t:for(;i<this.Ev;){for(let t=a;t<=l;t++)if(!(this.b_[e][i+1][t]&s))break t;i++}if((i+1-t)*(l+1-a)>=4){const n=this.dr[e][t][a];o.A.D_(h,4,128*t,n,128*a,128*i+128,n,128*l+128);for(let h=t;h<=i;h++)for(let t=a;t<=l;t++)this.b_[e][h][t]&=~s}}}}}};zS=(t,i,s,n)=>{let r=0;for(let t=0;t<h.A.count;t++)if('water'===h.A.ta[t].Gb?.toLowerCase()){r=t+1<<24>>24;break}for(let h=t;h<t+s;h++)for(let t=i;t<i+n;t++)if(t>=0&&t<this.Ev&&h>=0&&h<this._v){this.p_[0][t][h]=r;for(let i=0;i<e.A.sr;i++)this.dr[i][t][h]=0,this.yr[i][t][h]=0}};HS=(t,i,s,h,r)=>{const o=new n.A(new Uint8Array(r));for(let n=0;n<e.A.sr;n++)for(let r=0;r<64;r++)for(let a=0;a<64;a++){const l=r+s,c=a+h;let f;if(l>=0&&l<e.A.Ar&&c>=0&&c<e.A.Ar)for(this.yr[n][l][c]=0;;){if(f=o.kc,0===f){0===n?this.dr[0][l][c]=8*-w.a_(l+t+932731,c+556238+i):this.dr[n][l][c]=this.dr[n-1][l][c]-240;break}if(1===f){let t=o.kc;1===t&&(t=0),0===n?this.dr[0][l][c]=8*-t:this.dr[n][l][c]=this.dr[n-1][l][c]-8*t;break}f<=49?(this.p_[n][l][c]=o.Mc,this.w_[n][l][c]=(f-2)/4<<24>>24,this.A_[n][l][c]=(f-2&3)<<24>>24):f<=81?this.yr[n][l][c]=f-49<<24>>24:this.y_[n][l][c]=f-81<<24>>24}else for(;f=o.kc,0!==f;){if(1===f){o.kc;break}f<=49&&o.kc}}};XS=(t,i,s,h,r,o)=>{const a=new n.A(new Uint8Array(h));let l=-1;for(;;){const h=a.qp;if(0===h)return;l+=h;let n=0;for(;;){const h=a.qp;if(0===h)break;n+=h-1;const c=63&n,f=n>>6&63,u=n>>12,d=a.kc,y=d>>2,p=3&d,w=f+r,A=c+o;if(w>0&&A>0&&w<e.A.Ar-1&&A<e.A.Ar-1){let e=u;2&~this.yr[1][w][A]||(e=u-1);let h=null;e>=0&&(h=s[e]),this.dS(u,w,A,t,i,h,l,y,p)}}}};dS=(t,i,s,e,h,n,r,o,d)=>{if(w.Bt){if(16&this.yr[t][i][s])return;if(this.I_(t,i,s)!==w.VS)return}const y=this.dr[t][i][s],p=this.dr[t][i+1][s],A=this.dr[t][i+1][s+1],x=this.dr[t][i][s+1],g=y+p+A+x>>2,C=a.A.get(r);let S=i+(s<<7)+(r<<14)+1073741824|0;C.active||(S+=-2147483648),S|=0;const m=(d<<6)+o<<24>>24;if(o===f.A.iS.id)(!w.Bt||C.active||C.SI)&&(e?.u_(C.Ul(f.A.iS.id,d,y,p,A,x,-1),t,i,s,g,S,m),C.gS&&C.active&&n?.FE(i,s),-1!==C.Pa&&h.Sf(new l.A(r,t,3,i,s,c.A.ta[C.Pa],!0)));else if(o===f.A.QC.id||o===f.A.tS.id){const a=C.Ul(f.A.QC.id,d,y,p,A,x,-1);if(a){let h,n,r=0;if(o===f.A.tS.id&&(r+=256),d===u.A.SC||d===u.A.vC?(h=C.length,n=C.width):(h=C.width,n=C.length),e?.dS(t,i,s,g,a,null,S,m,h,n,r)&&C.yI)for(let e=0;e<=h;e++)for(let h=0;h<=n;h++){let n=a.k_/4|0;n>30&&(n=30),n>this.x_[t][i+e][s+h]&&(this.x_[t][i+e][s+h]=n<<24>>24)}}C.gS&&n?.dS(i,s,C.width,C.length,d,C.CS),-1!==C.Pa&&h.Sf(new l.A(r,t,2,i,s,c.A.ta[C.Pa],!0))}else if(o>=f.A.zE.id)e?.dS(t,i,s,g,C.Ul(o,d,y,p,A,x,-1),null,S,m,1,1,0),o>=f.A.zE.id&&o<=f.A.qE.id&&o!==f.A.XE.id&&t>0&&(this.b_[t][i][s]|=2340),C.gS&&n?.dS(i,s,C.width,C.length,d,C.CS),-1!==C.Pa&&h.Sf(new l.A(r,t,2,i,s,c.A.ta[C.Pa],!0));else if(o===f.A.xC.id)e?.VE(t,i,s,g,w.i_[d],0,C.Ul(f.A.xC.id,d,y,p,A,x,-1),null,S,m),d===u.A.CC?(C.yI&&(this.x_[t][i][s]=50,this.x_[t][i][s+1]=50),C.Zb&&(this.b_[t][i][s]|=585)):d===u.A.SC?(C.yI&&(this.x_[t][i][s+1]=50,this.x_[t][i+1][s+1]=50),C.Zb&&(this.b_[t][i][s+1]|=1170)):d===u.A.mC?(C.yI&&(this.x_[t][i+1][s]=50,this.x_[t][i+1][s+1]=50),C.Zb&&(this.b_[t][i+1][s]|=585)):d===u.A.vC&&(C.yI&&(this.x_[t][i][s]=50,this.x_[t][i+1][s]=50),C.Zb&&(this.b_[t][i][s]|=1170)),C.gS&&n?.VE(i,s,o,d,C.CS),-1!==C.Pa&&h.Sf(new l.A(r,t,0,i,s,c.A.ta[C.Pa],!0)),16!==C.uI&&e?.M_(t,i,s,C.uI);else if(o===f.A.GE.id)e?.VE(t,i,s,g,w.s_[d],0,C.Ul(f.A.GE.id,d,y,p,A,x,-1),null,S,m),C.yI&&(d===u.A.CC?this.x_[t][i][s+1]=50:d===u.A.SC?this.x_[t][i+1][s+1]=50:d===u.A.mC?this.x_[t][i+1][s]=50:d===u.A.vC&&(this.x_[t][i][s]=50)),C.gS&&n?.VE(i,s,o,d,C.CS),-1!==C.Pa&&h.Sf(new l.A(r,t,0,i,s,c.A.ta[C.Pa],!0));else if(o===f.A.gC.id){const a=d+1&3;e?.VE(t,i,s,g,w.i_[d],w.i_[a],C.Ul(f.A.gC.id,d+4,y,p,A,x,-1),C.Ul(f.A.gC.id,a,y,p,A,x,-1),S,m),C.Zb&&(d===u.A.CC?(this.b_[t][i][s]|=265,this.b_[t][i][s+1]|=1170):d===u.A.SC?(this.b_[t][i][s+1]|=1170,this.b_[t][i+1][s]|=585):d===u.A.mC?(this.b_[t][i+1][s]|=585,this.b_[t][i][s]|=1170):d===u.A.vC&&(this.b_[t][i][s]|=1170,this.b_[t][i][s]|=585)),C.gS&&n?.VE(i,s,o,d,C.CS),-1!==C.Pa&&h.Sf(new l.A(r,t,0,i,s,c.A.ta[C.Pa],!0)),16!==C.uI&&e?.M_(t,i,s,C.uI)}else if(o===f.A.BC.id)e?.VE(t,i,s,g,w.s_[d],0,C.Ul(f.A.BC.id,d,y,p,A,x,-1),null,S,m),C.yI&&(d===u.A.CC?this.x_[t][i][s+1]=50:d===u.A.SC?this.x_[t][i+1][s+1]=50:d===u.A.mC?this.x_[t][i+1][s]=50:d===u.A.vC&&(this.x_[t][i][s]=50)),C.gS&&n?.VE(i,s,o,d,C.CS),-1!==C.Pa&&h.Sf(new l.A(r,t,0,i,s,c.A.ta[C.Pa],!0));else if(o===f.A.IC.id)e?.dS(t,i,s,g,C.Ul(o,d,y,p,A,x,-1),null,S,m,1,1,0),C.gS&&n?.dS(i,s,C.width,C.length,d,C.CS),-1!==C.Pa&&h.Sf(new l.A(r,t,2,i,s,c.A.ta[C.Pa],!0));else if(o===f.A.Rv.id)e?.d_(t,i,s,g,0,0,S,C.Ul(f.A.Rv.id,u.A.CC,y,p,A,x,-1),m,512*d,w.i_[d]),-1!==C.Pa&&h.Sf(new l.A(r,t,1,i,s,c.A.ta[C.Pa],!0));else if(o===f.A.Em.id){let n=16;if(e){const h=e.pC(t,i,s);h>0&&(n=a.A.get(h>>14&32767).uI)}e?.d_(t,i,s,g,w.e_[d]*n,w.h_[d]*n,S,C.Ul(f.A.Rv.id,u.A.CC,y,p,A,x,-1),m,512*d,w.i_[d]),-1!==C.Pa&&h.Sf(new l.A(r,t,1,i,s,c.A.ta[C.Pa],!0))}else o===f.A.WE.id?(e?.d_(t,i,s,g,0,0,S,C.Ul(f.A.Rv.id,u.A.CC,y,p,A,x,-1),m,d,256),-1!==C.Pa&&h.Sf(new l.A(r,t,1,i,s,c.A.ta[C.Pa],!0))):o===f.A.YE.id?(e?.d_(t,i,s,g,0,0,S,C.Ul(f.A.Rv.id,u.A.CC,y,p,A,x,-1),m,d,512),-1!==C.Pa&&h.Sf(new l.A(r,t,1,i,s,c.A.ta[C.Pa],!0))):o===f.A.HE.id&&(e?.d_(t,i,s,g,0,0,S,C.Ul(f.A.Rv.id,u.A.CC,y,p,A,x,-1),m,d,768),-1!==C.Pa&&h.Sf(new l.A(r,t,1,i,s,c.A.ta[C.Pa],!0)))};I_=(t,i,s)=>8&this.yr[t][i][s]?0:t<=0||!(2&this.yr[1][i][s])?t:t-1}},198:(t,i,s)=>{s.d(i,{A:()=>C});var e=s(4583);class h{level;y;x;z;model;U_;Qw;P_;N_;F_;V_;G_;info;W_=0;Kx=0;constructor(t,i,s,e,h,n,r,o,a,l,c,f,u){this.level=t,this.y=i,this.x=s,this.z=e,this.model=h,this.U_=n,this.Qw=r,this.P_=o,this.N_=a,this.F_=l,this.V_=c,this.G_=f,this.info=u}}var n=s(3795);class r{bv;Ev;Iv;_v;type;Y_;H_;z_;X_;K_;Yw;mode=0;Z_=0;j_=0;q_=0;J_=0;Q_=0;tT=0;constructor(t,i,s,e,h,n,r,o,a,l,c){this.bv=t,this.Ev=i,this.Iv=s,this._v=e,this.type=h,this.Y_=n,this.H_=r,this.z_=o,this.X_=a,this.K_=l,this.Yw=c}}var o=s(670);class a{y;x;z;model;G_;info;constructor(t,i,s,e,h,n){this.y=t,this.x=i,this.z=s,this.model=e,this.G_=h,this.info=n}}class l{y;x;z;iT;sT;eT;hT;G_;info;constructor(t,i,s,e,h,n,r,o,a){this.y=t,this.x=i,this.z=s,this.iT=e,this.sT=h,this.eT=n,this.hT=r,this.G_=o,this.info=a}}class c{y;x;z;type;angle;model;G_;info;constructor(t,i,s,e,h,n,r,o){this.y=t,this.x=i,this.z=s,this.type=e,this.angle=h,this.model=n,this.G_=r,this.info=o}}var f=s(6666);class u{y;x;z;nT;rT;oT;G_;offset;constructor(t,i,s,e,h,n,r,o){this.y=t,this.x=i,this.z=s,this.nT=e,this.rT=h,this.oT=n,this.G_=r,this.offset=o}}class d{aT;lT;cT;fT;uT;color;flat;constructor(t,i,s,e,h,n,r){this.aT=t,this.lT=i,this.cT=s,this.fT=e,this.uT=h,this.color=n,this.flat=r}}var y=s(8950);class p{static dT=new Int32Array(6);static yT=new Int32Array(6);static pT=new Int32Array(6);static wT=new Int32Array(6);static AT=new Int32Array(6);static xT=[Int8Array.of(1,3,5,7),Int8Array.of(1,3,5,7),Int8Array.of(1,3,5,7),Int8Array.of(1,3,5,7,6),Int8Array.of(1,3,5,7,6),Int8Array.of(1,3,5,7,6),Int8Array.of(1,3,5,7,6),Int8Array.of(1,3,5,7,2,6),Int8Array.of(1,3,5,7,2,8),Int8Array.of(1,3,5,7,2,8),Int8Array.of(1,3,5,7,11,12),Int8Array.of(1,3,5,7,11,12),Int8Array.of(1,3,5,7,13,14)];static gT=[Int8Array.of(0,1,2,3,0,0,1,3),Int8Array.of(1,1,2,3,1,0,1,3),Int8Array.of(0,1,2,3,1,0,1,3),Int8Array.of(0,0,1,2,0,0,2,4,1,0,4,3),Int8Array.of(0,0,1,4,0,0,4,3,1,1,2,4),Int8Array.of(0,0,4,3,1,0,1,2,1,0,2,4),Int8Array.of(0,1,2,4,1,0,1,4,1,0,4,3),Int8Array.of(0,4,1,2,0,4,2,5,1,0,4,5,1,0,5,3),Int8Array.of(0,4,1,2,0,4,2,3,0,4,3,5,1,0,4,5),Int8Array.of(0,0,4,5,1,4,1,2,1,4,2,3,1,4,3,5),Int8Array.of(0,0,1,5,0,1,4,5,0,1,2,4,1,0,5,3,1,5,4,3,1,4,2,3),Int8Array.of(1,0,1,5,1,1,4,5,1,1,2,4,0,0,5,3,0,5,4,3,0,4,2,3),Int8Array.of(1,0,5,4,1,0,1,5,0,0,4,3,0,4,5,3,0,5,2,3,0,1,2,5)];static CT=128;static ST=this.CT/2|0;static mT=this.CT/4|0;static vT=3*this.CT/4|0;BI;II;bI;BT;bT;IT;ET;_T;TT;OT;flat;shape;angle;LT;RT;constructor(t,i,s,e,h,n,r,o,a,l,c,f,u,d,y,w,A,x,g){this.flat=!(A!==e||A!==d||A!==o),this.shape=i,this.angle=n,this.LT=u,this.RT=a;const C=p.xT[i],S=C.length;this.BI=new Int32Array(S),this.II=new Int32Array(S),this.bI=new Int32Array(S);const m=new Int32Array(S),v=new Int32Array(S),B=t*p.CT,b=x*p.CT;for(let t=0;t<S;t++){let i,a,c,u,x,S=C[t];!(1&S)&&S<=8&&(S=1+(S-n-n-1&7)),S>8&&S<=12&&(S=9+(S-n-9&3)),S>12&&S<=16&&(S=13+(S-n-13&3)),1===S?(i=B,a=b,c=A,u=r,x=l):2===S?(i=B+p.ST,a=b,c=A+e>>1,u=r+g>>1,x=l+s>>1):3===S?(i=B+p.CT,a=b,c=e,u=g,x=s):4===S?(i=B+p.CT,a=b+p.ST,c=e+d>>1,u=g+h>>1,x=s+y>>1):5===S?(i=B+p.CT,a=b+p.CT,c=d,u=h,x=y):6===S?(i=B+p.ST,a=b+p.CT,c=d+o>>1,u=h+w>>1,x=y+f>>1):7===S?(i=B,a=b+p.CT,c=o,u=w,x=f):8===S?(i=B,a=b+p.ST,c=o+A>>1,u=w+r>>1,x=f+l>>1):9===S?(i=B+p.ST,a=b+p.mT,c=A+e>>1,u=r+g>>1,x=l+s>>1):10===S?(i=B+p.vT,a=b+p.ST,c=e+d>>1,u=g+h>>1,x=s+y>>1):11===S?(i=B+p.ST,a=b+p.vT,c=d+o>>1,u=h+w>>1,x=y+f>>1):12===S?(i=B+p.mT,a=b+p.ST,c=o+A>>1,u=w+r>>1,x=f+l>>1):13===S?(i=B+p.mT,a=b+p.mT,c=A,u=r,x=l):14===S?(i=B+p.vT,a=b+p.mT,c=e,u=g,x=s):15===S?(i=B+p.vT,a=b+p.vT,c=d,u=h,x=y):(i=B+p.mT,a=b+p.vT,c=o,u=w,x=f),this.BI[t]=i,this.II[t]=c,this.bI[t]=a,m[t]=u,v[t]=x}const I=p.gT[i],E=I.length/4|0;this.ET=new Int32Array(E),this._T=new Int32Array(E),this.TT=new Int32Array(E),this.BT=new Int32Array(E),this.bT=new Int32Array(E),this.IT=new Int32Array(E),this.OT=-1!==c?new Int32Array(E):null;let _=0;for(let t=0;t<E;t++){const i=I[_];let s=I[_+1],e=I[_+2],h=I[_+3];_+=4,s<4&&(s=s-n&3),e<4&&(e=e-n&3),h<4&&(h=h-n&3),this.ET[t]=s,this._T[t]=e,this.TT[t]=h,0===i?(this.BT[t]=m[s],this.bT[t]=m[e],this.IT[t]=m[h],this.OT&&(this.OT[t]=-1)):(this.BT[t]=v[s],this.bT[t]=v[e],this.IT[t]=v[h],this.OT&&(this.OT[t]=c))}}}var w=s(5518),A=s(6169),x=s(3867),g=s(5868);class C{static DT=new x.kT(8,32,2*g.A.MT+1,2*g.A.MT+1,!1);static UT=new x.Ps(100,null);static Yg=new Int32Array(o.A.sr);static PT=new x.NT(o.A.sr,500,null);static FT=new x.Ps(500,null);static VT=new f.A;static Kx=0;static GT=0;static WT=0;static YT=0;static HT=0;static zT=0;static XT=0;static KT=0;static ZT=0;static jT=0;static qT=0;static $T=0;static JT=0;static QT=0;static tO=0;static iO=0;static sO=0;static eO=0;static hO=0;static nO=0;static Hg=0;static rO=0;static oO=!1;static aO=null;static lO=Uint8Array.of(19,55,38,155,255,110,137,205,76);static cO=Uint8Array.of(160,192,80,96,0,144,80,48,160);static fO=Uint8Array.of(76,8,137,4,0,1,38,2,19);static uO=Int8Array.of(0,0,2,0,0,2,1,1,0);static dO=Int8Array.of(2,0,0,2,0,0,0,4,4);static yO=Int8Array.of(0,4,4,8,0,0,8,0,0);static pO=Int8Array.of(1,1,0,0,0,8,0,0,8);static wO=Int8Array.of(53,-53,-53,53);static AO=Int8Array.of(-53,-53,53,53);static xO=Int8Array.of(-45,45,45,-45);static gO=Int8Array.of(45,45,-45,-45);static CO=[new Int8Array(16),Int8Array.of(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Int8Array.of(1,0,0,0,1,1,0,0,1,1,1,0,1,1,1,1),Int8Array.of(1,1,0,0,1,1,0,0,1,0,0,0,1,0,0,0),Int8Array.of(0,0,1,1,0,0,1,1,0,0,0,1,0,0,0,1),Int8Array.of(0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1),Int8Array.of(1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1),Int8Array.of(1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0),Int8Array.of(0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0),Int8Array.of(1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,1),Int8Array.of(1,1,1,1,1,1,0,0,1,0,0,0,1,0,0,0),Int8Array.of(0,0,0,0,0,0,1,1,0,1,1,1,0,1,1,1),Int8Array.of(0,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1)];static SO=[Int8Array.of(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15),Int8Array.of(12,8,4,0,13,9,5,1,14,10,6,2,15,11,7,3),Int8Array.of(15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0),Int8Array.of(3,7,11,15,2,6,10,14,1,5,9,13,0,4,8,12)];static mO=Int32Array.of(41,39248,41,4643,41,41,41,41,41,41,41,41,41,41,41,43086,41,41,41,41,41,41,41,8602,41,28992,41,41,41,41,41,5056,41,41,41,41,41,41,41,41,41,41,41,41,41,41,3131,41,41,41);static zg=0;static ol=0;static al=0;static Ax=-1;static xx=-1;static Bt=!0;static init=(t,i,s,h,n)=>{this.GT=0,this.WT=0,this.YT=t,this.HT=i,this.zT=t/2|0,this.XT=i/2|0;const r=new x.kT(9,32,2*g.A.MT+3,2*g.A.MT+3,!1);for(let t=128;t<=384;t+=32)for(let i=0;i<2048;i+=64){this.KT=e.A.sin[t],this.ZT=e.A.cos[t],this.jT=e.A.sin[i],this.qT=e.A.cos[i];const o=(t-128)/32|0,a=i/64|0;for(let t=-(g.A.MT+1);t<=g.A.MT+1;t++)for(let i=-(g.A.MT+1);i<=g.A.MT+1;i++){const e=128*t,l=128*i;let c=!1;for(let t=-s;t<=h;t+=128)if(this.vO(e,l,n[o]+t)){c=!0;break}r[o][a][t+g.A.MT+1][i+g.A.MT+1]=c}}for(let t=0;t<8;t++)for(let i=0;i<32;i++)for(let s=-g.A.MT;s<g.A.MT;s++)for(let e=-g.A.MT;e<g.A.MT;e++){let h=!1;t:for(let n=-1;n<=1;n++)for(let o=-1;o<=1;o++){if(r[t][i][s+n+g.A.MT+1][e+o+g.A.MT+1]){h=!0;break t}if(r[t][(i+1)%31][s+n+g.A.MT+1][e+o+g.A.MT+1]){h=!0;break t}if(r[t+1][i][s+n+g.A.MT+1][e+o+g.A.MT+1]){h=!0;break t}if(r[t+1][(i+1)%31][s+n+g.A.MT+1][e+o+g.A.MT+1]){h=!0;break t}}this.DT[t][i][s+g.A.MT][e+g.A.MT]=h}};static $o=()=>{this.UT=null,this.Yg=null,this.PT=null,this.VT=null,this.DT=null,this.FT=null,this.aO=null,console.log('World3D unloaded!')};static D_=(t,i,s,e,h,n,o,a)=>{C.PT[t][C.Yg[t]++]=new r(s/128|0,n/128|0,h/128|0,a/128|0,i,s,n,h,a,e,o)};static vO=(t,i,s)=>{const e=i*this.jT+t*this.qT>>16,h=i*this.qT-t*this.jT>>16,n=s*this.KT+h*this.ZT>>16,r=s*this.ZT-h*this.KT>>16;if(n<50||n>140*g.A.MT)return!1;const o=this.zT+((e<<9)/n|0),a=this.XT+((r<<9)/n|0);return o>=this.GT&&o<=this.YT&&a>=this.WT&&a<=this.HT};BO;Ev;_v;bO;IO;zr;EO;_O;TO;OO=0;LO=0;RO=0;constructor(t,i,s,e){this.BO=s,this.Ev=e,this._v=i,this.IO=new x.Kr(s,e,i,null),this.EO=new x.aA(s,e+1,i+1),this.bO=t,this.zr=new x.Ps(5e3,null),this._O=new Int32Array(1e4),this.TO=new Int32Array(1e4),this.reset()}reset=()=>{for(let t=0;t<this.BO;t++)for(let i=0;i<this.Ev;i++)for(let s=0;s<this._v;s++)this.IO[t][i][s]=null;for(let t=0;t<o.A.sr;t++){for(let i=0;i<C.Yg[t];i++)C.PT[t][i]=null;C.Yg[t]=0}for(let t=0;t<this.OO;t++)this.zr[t]=null;this.OO=0,C.UT.fill(null)};YS=t=>{this.LO=t;for(let i=0;i<this.Ev;i++)for(let s=0;s<this._v;s++)this.IO[t][i][s]=new n.A(t,i,s)};R_=(t,i)=>{const s=this.IO[0][t][i];for(let s=0;s<3;s++){this.IO[s][t][i]=this.IO[s+1][t][i];const e=this.IO[s][t][i];e&&e.level--}this.IO[0][t][i]||(this.IO[0][t][i]=new n.A(0,t,i));const e=this.IO[0][t][i];e&&(e.DO=s),this.IO[3][t][i]=null};O_=(t,i,s,e)=>{const h=this.IO[t][i][s];h&&(h.kO=e)};__=(t,i,s,e,h,r,o,a,l,c,f,u,y,A,x,g,C,S,m,v)=>{if(e===w.A.E_){for(let e=t;e>=0;e--)this.IO[e][i][s]||(this.IO[e][i][s]=new n.A(e,i,s));const e=this.IO[t][i][s];e&&(e.MO=new d(f,u,y,A,-1,m,!1))}else if(e===w.A.UO){for(let e=t;e>=0;e--)this.IO[e][i][s]||(this.IO[e][i][s]=new n.A(e,i,s));const e=this.IO[t][i][s];e&&(e.MO=new d(x,g,C,S,r,v,o===a&&o===l&&o===c))}else{for(let e=t;e>=0;e--)this.IO[e][i][s]||(this.IO[e][i][s]=new n.A(e,i,s));const d=this.IO[t][i][s];d&&(d.PO=new p(i,e,g,a,y,h,f,c,v,x,r,S,m,l,C,A,o,s,u))}};u_=(t,i,s,e,h,r,o)=>{this.IO[i][s][e]||(this.IO[i][s][e]=new n.A(i,s,e));const l=this.IO[i][s][e];l&&(l.NO=new a(h,128*s+64,128*e+64,t,r,o))};vS=(t,i,s)=>{const e=this.IO[t][i][s];e&&(e.NO=null)};uS=(t,i,s,e,h,r,o,a)=>{let l=0;const c=this.IO[e][t][i];if(c)for(let t=0;t<c.FO;t++){const i=c.VO[t];if(!i||!i.model)continue;const s=i.model.TI;s>l&&(l=s)}else this.IO[e][t][i]=new n.A(e,t,i);const f=this.IO[e][t][i];f&&(f.GO=new u(s,128*t+64,128*i+64,r,o,a,h,l))};aS=(t,i,s)=>{const e=this.IO[t][i][s];e&&(e.GO=null)};VE=(t,i,s,e,h,r,o,a,c,f)=>{if(!o&&!a)return;for(let e=t;e>=0;e--)this.IO[e][i][s]||(this.IO[e][i][s]=new n.A(e,i,s));const u=this.IO[t][i][s];u&&(u.WO=new l(e,128*i+64,128*s+64,h,r,o,a,c,f))};xS=(t,i,s,e)=>{const h=this.IO[t][i][s];1===e&&h&&(h.WO=null)};d_=(t,i,s,e,h,r,o,a,l,f,u)=>{if(!a)return;for(let e=t;e>=0;e--)this.IO[e][i][s]||(this.IO[e][i][s]=new n.A(e,i,s));const d=this.IO[t][i][s];d&&(d.YO=new c(e,128*i+h+64,128*s+r+64,u,f,a,o,l))};SS=(t,i,s)=>{const e=this.IO[t][i][s];e&&(e.YO=null)};M_=(t,i,s,e)=>{const h=this.IO[t][i][s];if(!h)return;const n=h.YO;if(!n)return;const r=128*i+64,o=128*s+64;n.x=r+((n.x-r)*e/16|0),n.z=o+((n.z-o)*e/16|0)};Lv=(t,i,s,e)=>{if(!e)return;const h=this.IO[t][i][s];if(!h)return;const n=h.YO;n&&(n.model=e)};Mv=(t,i,s,e)=>{if(!e)return;const h=this.IO[t][i][s];if(!h)return;const n=h.NO;n&&(n.model=e)};kv=(t,i,s,e)=>{if(!e)return;const h=this.IO[t][i][s];if(!h)return;const n=h.WO;n&&(n.eT=e)};Dv=(t,i,s,e,h)=>{if(!e)return;const n=this.IO[s][t][i];if(!n)return;const r=n.WO;r&&(r.eT=e,r.hT=h)};dS=(t,i,s,e,h,n,r,o,a,l,c)=>{if(!h&&!n)return!0;const f=128*i+64*a,u=128*s+64*l;return this.HO(f,u,e,t,i,s,a,l,h,n,r,o,c,!1)};mv=(t,i,s,e,h,n,r,o,a,l)=>{if(!h&&!n)return!0;let c=i-a,f=e-a,u=i+a,d=e+a;return l&&(o>640&&o<1408&&(d+=128),o>1152&&o<1920&&(u+=128),(o>1664||o<384)&&(f-=128),o>128&&o<896&&(c-=128)),c=c/128|0,f=f/128|0,u=u/128|0,d=d/128|0,this.HO(i,e,s,t,c,f,u+1-c,d-f+1,h,n,r,0,o,!0)};Bv=(t,i,s,e,h,n,r,o,a,l,c,f)=>!a&&!l||this.HO(i,e,s,t,h,n,r+1-h,o-n+1,a,l,c,0,f,!0);mS=(t,i,s)=>{const e=this.IO[t][i][s];if(e)for(let t=0;t<e.FO;t++){const h=e.VO[t];if(h&&2==(h.G_>>29&3)&&h.P_===i&&h.F_===s)return void this.zO(h)}};Ov=(t,i,s,e)=>{if(!e)return;const h=this.IO[t][i][s];if(h)for(let t=0;t<h.FO;t++){const i=h.VO[t];if(i&&2==(i.G_>>29&3))return void(i.model=e)}};Qx=()=>{for(let t=0;t<this.OO;t++){const i=this.zr[t];i&&this.zO(i),this.zr[t]=null}this.OO=0};pC=(t,i,s)=>{const e=this.IO[t][i][s];return e&&e.WO?e.WO.G_:0};wS=(t,i,s)=>{const e=this.IO[t][s][i];return e&&e.YO?e.YO.G_:0};bC=(t,i,s)=>{const e=this.IO[t][i][s];if(!e)return 0;for(let t=0;t<e.FO;t++){const h=e.VO[t];if(h&&2==(h.G_>>29&3)&&h.P_===i&&h.F_===s)return h.G_}return 0};lC=(t,i,s)=>{const e=this.IO[t][i][s];return e&&e.NO?e.NO.G_:0};wC=(t,i,s,e)=>{const h=this.IO[t][i][s];if(h){if(h.WO&&h.WO.G_===e)return 255&h.WO.info;if(h.YO&&h.YO.G_===e)return 255&h.YO.info;if(h.NO&&h.NO.G_===e)return 255&h.NO.info;for(let t=0;t<h.FO;t++){const i=h.VO[t];if(i&&i.G_===e)return 255&i.info}return-1}return-1};L_=(t,i,s,e,h)=>{const n=i*(0|Math.sqrt(s*s+e*e+h*h))>>8;for(let i=0;i<this.BO;i++)for(let r=0;r<this.Ev;r++)for(let o=0;o<this._v;o++){const a=this.IO[i][r][o];if(!a)continue;const l=a.WO;l&&l.eT&&l.eT.XO&&(this.KO(i,r,o,1,1,l.eT),l.hT&&l.hT.XO&&(this.KO(i,r,o,1,1,l.hT),this.ZO(l.eT,l.hT,0,0,0,!1),l.hT.jO(t,n,s,e,h)),l.eT.jO(t,n,s,e,h));for(let l=0;l<a.FO;l++){const c=a.VO[l];c&&c.model&&c.model.XO&&(this.KO(i,r,o,c.N_+1-c.P_,c.V_-c.F_+1,c.model),c.model.jO(t,n,s,e,h))}const c=a.NO;c&&c.model&&c.model.XO&&(this.qO(i,r,o,c.model),c.model.jO(t,n,s,e,h))}};qO=(t,i,s,e)=>{if(i<this.Ev){const h=this.IO[t][i+1][s];h&&h.NO&&h.NO.model&&h.NO.model.XO&&this.ZO(e,h.NO.model,128,0,0,!0)}if(s<this.Ev){const h=this.IO[t][i][s+1];h&&h.NO&&h.NO.model&&h.NO.model.XO&&this.ZO(e,h.NO.model,0,0,128,!0)}if(i<this.Ev&&s<this._v){const h=this.IO[t][i+1][s+1];h&&h.NO&&h.NO.model&&h.NO.model.XO&&this.ZO(e,h.NO.model,128,0,128,!0)}if(i<this.Ev&&s>0){const h=this.IO[t][i+1][s-1];h&&h.NO&&h.NO.model&&h.NO.model.XO&&this.ZO(e,h.NO.model,128,0,-128,!0)}};KO=(t,i,s,e,h,n)=>{let r=!0,o=i;const a=i+e,l=s-1,c=s+h;for(let f=t;f<=t+1;f++)if(f!==this.BO){for(let u=o;u<=a;u++)if(!(u<0||u>=this.Ev))for(let o=l;o<=c;o++){if(o<0||o>=this._v||r&&u<a&&o<c&&(o>=s||u===i))continue;const l=this.IO[f][u][o];if(!l)continue;const d=128*(u-i)+64*(1-e),y=128*(o-s)+64*(1-h),p=((this.bO[f][u][o]+this.bO[f][u+1][o]+this.bO[f][u][o+1]+this.bO[f][u+1][o+1])/4|0)-((this.bO[t][i][s]+this.bO[t][i+1][s]+this.bO[t][i][s+1]+this.bO[t][i+1][s+1])/4|0),w=l.WO;w&&w.eT&&w.eT.XO&&this.ZO(n,w.eT,d,p,y,r),w&&w.hT&&w.hT.XO&&this.ZO(n,w.hT,d,p,y,r);for(let t=0;t<l.FO;t++){const o=l.VO[t];if(!o||!o.model||!o.model.XO)continue;const a=o.N_+1-o.P_,c=o.V_+1-o.F_;this.ZO(n,o.model,128*(o.P_-i)+64*(a-e),p,128*(o.F_-s)+64*(c-h),r)}}o--,r=!1}};ZO=(t,i,s,e,h,n)=>{this.RO++;let r=0;const o=i.BI,a=i.vI;if(t.XO&&t.$O)for(let n=0;n<t.vI;n++){const l=t.XO[n],c=t.$O[n];if(c&&0!==c.w){const f=t.II[n]-e;if(f>i.K_)continue;const u=t.BI[n]-s;if(u<i.Y_||u>i.H_)continue;const d=t.bI[n]-h;if(d<i.z_||d>i.X_)continue;if(i.XO&&i.$O)for(let t=0;t<a;t++){const s=i.XO[t],e=i.$O[t];u!==o[t]||d!==i.bI[t]||f!==i.II[t]||e&&0===e.w||(l&&s&&e&&(l.x+=e.x,l.y+=e.y,l.z+=e.z,l.w+=e.w,s.x+=c.x,s.y+=c.y,s.z+=c.z,s.w+=c.w,r++),this._O[n]=this.RO,this.TO[t]=this.RO)}}}if(!(r<3)&&n){if(t.JO)for(let i=0;i<t.QO;i++)this._O[t.tL[i]]===this.RO&&this._O[t.iL[i]]===this.RO&&this._O[t.sL[i]]===this.RO&&(t.JO[i]=-1);if(i.JO)for(let t=0;t<i.QO;t++)this.TO[i.tL[t]]===this.RO&&this.TO[i.iL[t]]===this.RO&&this.TO[i.sL[t]]===this.RO&&(i.JO[t]=-1)}};oC=(t,i,s,e,h,n)=>{const r=this.IO[t][i][s];if(!r)return;const o=r.MO;if(o){const t=o.color;if(0!==t)for(let i=0;i<4;i++)e[h]=t,e[h+1]=t,e[h+2]=t,e[h+3]=t,h+=n;return}const a=r.PO;if(!a)return;const l=a.shape,c=a.angle,f=a.LT,u=a.RT,d=C.CO[l],y=C.SO[c];let p=0;if(0===f)for(let t=0;t<4;t++)0!==d[y[p++]]&&(e[h]=u),0!==d[y[p++]]&&(e[h+1]=u),0!==d[y[p++]]&&(e[h+2]=u),0!==d[y[p++]]&&(e[h+3]=u),h+=n;else for(let t=0;t<4;t++)e[h]=0===d[y[p++]]?f:u,e[h+1]=0===d[y[p++]]?f:u,e[h+2]=0===d[y[p++]]?f:u,e[h+3]=0===d[y[p++]]?f:u,h+=n};click=(t,i)=>{C.oO=!0,C.ol=t,C.al=i,C.Ax=-1,C.xx=-1};draw=(t,i,s,h,n,r,o)=>{t<0?t=0:t>=128*this.Ev&&(t=128*this.Ev-1),s<0?s=0:s>=128*this._v&&(s=128*this._v-1),C.Kx++,C.KT=e.A.sin[r],C.ZT=e.A.cos[r],C.jT=e.A.sin[n],C.qT=e.A.cos[n],C.aO=C.DT[(r-128)/32|0][n/64|0],C.$T=t,C.JT=i,C.QT=s,C.tO=t/128|0,C.iO=s/128|0,C.Hg=h,C.sO=C.tO-g.A.MT,C.sO<0&&(C.sO=0),C.hO=C.iO-g.A.MT,C.hO<0&&(C.hO=0),C.eO=C.tO+g.A.MT,C.eO>this.Ev&&(C.eO=this.Ev),C.nO=C.iO+g.A.MT,C.nO>this._v&&(C.nO=this._v),this.eL(),C.rO=0;for(let t=this.LO;t<this.BO;t++){const s=this.IO[t];for(let e=C.sO;e<C.eO;e++)for(let n=C.hO;n<C.nO;n++){const r=s[e][n];r&&(r.kO<=h&&(C.aO[e+g.A.MT-C.tO][n+g.A.MT-C.iO]||this.bO[t][e][n]-i>=2e3)?(r.visible=!0,r.update=!0,r.hL=r.FO>0,C.rO++):(r.visible=!1,r.update=!1,r.nL=0))}}for(let t=this.LO;t<this.BO;t++){const i=this.IO[t];for(let t=-g.A.MT;t<=0;t++){const s=C.tO+t,e=C.tO-t;if(!(s<C.sO&&e>=C.eO))for(let t=-g.A.MT;t<=0;t++){const h=C.iO+t,n=C.iO-t;let r;if(s>=C.sO&&(h>=C.hO&&(r=i[s][h],r&&r.visible&&this.rL(r,!0,o)),n<C.nO&&(r=i[s][n],r&&r.visible&&this.rL(r,!0,o))),e<C.eO&&(h>=C.hO&&(r=i[e][h],r&&r.visible&&this.rL(r,!0,o)),n<C.nO&&(r=i[e][n],r&&r.visible&&this.rL(r,!0,o))),0===C.rO)return void(C.oO=!1)}}}for(let t=this.LO;t<this.BO;t++){const i=this.IO[t];for(let t=-g.A.MT;t<=0;t++){const s=C.tO+t,e=C.tO-t;if(!(s<C.sO&&e>=C.eO))for(let t=-g.A.MT;t<=0;t++){const h=C.iO+t,n=C.iO-t;let r;if(s>=C.sO&&(h>=C.hO&&(r=i[s][h],r&&r.visible&&this.rL(r,!1,o)),n<C.nO&&(r=i[s][n],r&&r.visible&&this.rL(r,!1,o))),e<C.eO&&(h>=C.hO&&(r=i[e][h],r&&r.visible&&this.rL(r,!1,o)),n<C.nO&&(r=i[e][n],r&&r.visible&&this.rL(r,!1,o))),0===C.rO)return void(C.oO=!1)}}}};HO=(t,i,s,e,r,o,a,l,c,f,u,d,y,p)=>{if(!c&&!f)return!1;for(let t=r;t<r+a;t++)for(let i=o;i<o+l;i++){if(t<0||i<0||t>=this.Ev||i>=this._v)return!1;const s=this.IO[e][t][i];if(s&&s.FO>=5)return!1}const w=new h(e,s,t,i,c,f,y,r,r+a-1,o,o+l-1,u,d);for(let t=r;t<r+a;t++)for(let i=o;i<o+l;i++){let s=0;t>r&&(s|=1),t<r+a-1&&(s+=4),i>o&&(s+=8),i<o+l-1&&(s+=2);for(let s=e;s>=0;s--)this.IO[s][t][i]||(this.IO[s][t][i]=new n.A(s,t,i));const h=this.IO[e][t][i];h&&(h.VO[h.FO]=w,h.oL[h.FO]=s,h.aL|=s,h.FO++)}return p&&(this.zr[this.OO++]=w),!0};zO=t=>{for(let i=t.P_;i<=t.N_;i++)for(let s=t.F_;s<=t.V_;s++){const e=this.IO[t.level][i][s];if(e){for(let i=0;i<e.FO;i++)if(e.VO[i]===t){e.FO--;for(let t=i;t<e.FO;t++)e.VO[t]=e.VO[t+1],e.oL[t]=e.oL[t+1];e.VO[e.FO]=null;break}e.aL=0;for(let t=0;t<e.FO;t++)e.aL|=e.oL[t]}}};eL=()=>{const t=C.Yg[C.Hg],i=C.PT[C.Hg];C.zg=0;for(let s=0;s<t;s++){const t=i[s];if(!t)continue;let e,h,n,r;if(1===t.type){if(e=t.bv+g.A.MT-C.tO,e>=0&&e<=50){h=t.Iv+g.A.MT-C.iO,h<0&&(h=0),n=t._v+g.A.MT-C.iO,n>50&&(n=50);let i=!1;for(;h<=n;)if(C.aO&&C.aO[e][h++]){i=!0;break}if(i){if(r=C.$T-t.Y_,r>32)t.mode=1;else{if(r>=-32)continue;t.mode=2,r=-r}t.q_=(t.z_-C.QT<<8)/r|0,t.J_=(t.X_-C.QT<<8)/r|0,t.Q_=(t.K_-C.JT<<8)/r|0,t.tT=(t.Yw-C.JT<<8)/r|0,C.FT[C.zg++]=t}}}else if(2===t.type){if(e=t.Iv+g.A.MT-C.iO,e>=0&&e<=50){h=t.bv+g.A.MT-C.tO,h<0&&(h=0),n=t.Ev+g.A.MT-C.tO,n>50&&(n=50);let i=!1;for(;h<=n;)if(C.aO&&C.aO[h++][e]){i=!0;break}if(i){if(r=C.QT-t.z_,r>32)t.mode=3;else{if(r>=-32)continue;t.mode=4,r=-r}t.Z_=(t.Y_-C.$T<<8)/r|0,t.j_=(t.H_-C.$T<<8)/r|0,t.Q_=(t.K_-C.JT<<8)/r|0,t.tT=(t.Yw-C.JT<<8)/r|0,C.FT[C.zg++]=t}}}else if(4===t.type&&(e=t.K_-C.JT,e>128&&(h=t.Iv+g.A.MT-C.iO,h<0&&(h=0),n=t._v+g.A.MT-C.iO,n>50&&(n=50),h<=n))){let i=t.bv+g.A.MT-C.tO;i<0&&(i=0),r=t.Ev+g.A.MT-C.tO,r>50&&(r=50);let s=!1;t:for(let t=i;t<=r;t++)for(let i=h;i<=n;i++)if(C.aO&&C.aO[t][i]){s=!0;break t}s&&(t.mode=5,t.Z_=(t.Y_-C.$T<<8)/e|0,t.j_=(t.H_-C.$T<<8)/e|0,t.q_=(t.z_-C.QT<<8)/e|0,t.J_=(t.X_-C.QT<<8)/e|0,C.FT[C.zg++]=t)}}};rL=(t,i,s)=>{for(C.VT.Sf(t);;){let t;do{if(t=C.VT.Bf(),!t)return}while(!t.update);const e=t.x,h=t.z,n=t.level,r=t.lL,o=this.IO[n];if(t.visible){if(i){if(n>0){const t=this.IO[n-1][e][h];if(t&&t.update)continue}if(e<=C.tO&&e>C.sO){const i=o[e-1][h];if(i&&i.update&&(i.visible||!(1&t.aL)))continue}if(e>=C.tO&&e<C.eO-1){const i=o[e+1][h];if(i&&i.update&&(i.visible||!(4&t.aL)))continue}if(h<=C.iO&&h>C.hO){const i=o[e][h-1];if(i&&i.update&&(i.visible||!(8&t.aL)))continue}if(h>=C.iO&&h<C.nO-1){const i=o[e][h+1];if(i&&i.update&&(i.visible||!(2&t.aL)))continue}}else i=!0;if(t.visible=!1,t.DO){const i=t.DO;i.MO?this.cL(0,e,h)||this.fL(i.MO,0,e,h,C.KT,C.ZT,C.jT,C.qT):i.PO&&!this.cL(0,e,h)&&this.uL(e,h,i.PO,C.KT,C.ZT,C.jT,C.qT);const n=i.WO;n&&n.eT?.draw(0,C.KT,C.ZT,C.jT,C.qT,n.x-C.$T,n.y-C.JT,n.z-C.QT,n.G_);for(let t=0;t<i.FO;t++){const e=i.VO[t];if(e){let t=e.model;t||(t=e.U_?.draw(s)??null),t?.draw(e.Qw,C.KT,C.ZT,C.jT,C.qT,e.x-C.$T,e.y-C.JT,e.z-C.QT,e.G_)}}}let a=!1;t.MO?this.cL(r,e,h)||(a=!0,this.fL(t.MO,r,e,h,C.KT,C.ZT,C.jT,C.qT)):t.PO&&!this.cL(r,e,h)&&(a=!0,this.uL(e,h,t.PO,C.KT,C.ZT,C.jT,C.qT));let l=0,c=0;const f=t.WO,u=t.YO;if((f||u)&&(C.tO===e?l+=1:C.tO<e&&(l+=2),C.iO===h?l+=3:C.iO>h&&(l+=6),c=C.lO[l],t.dL=C.fO[l]),f&&(f.iT&C.cO[l]?16===f.iT?(t.nL=3,t.yL=C.uO[l],t.pL=3-t.yL):32===f.iT?(t.nL=6,t.yL=C.dO[l],t.pL=6-t.yL):64===f.iT?(t.nL=12,t.yL=C.yO[l],t.pL=12-t.yL):(t.nL=9,t.yL=C.pO[l],t.pL=9-t.yL):t.nL=0,f.iT&c&&!this.wL(r,e,h,f.iT)&&f.eT?.draw(0,C.KT,C.ZT,C.jT,C.qT,f.x-C.$T,f.y-C.JT,f.z-C.QT,f.G_),f.sT&c&&!this.wL(r,e,h,f.sT)&&f.hT?.draw(0,C.KT,C.ZT,C.jT,C.qT,f.x-C.$T,f.y-C.JT,f.z-C.QT,f.G_)),u&&!this.visible(r,e,h,u.model.Yw))if(u.type&c)u.model.draw(u.angle,C.KT,C.ZT,C.jT,C.qT,u.x-C.$T,u.y-C.JT,u.z-C.QT,u.G_);else if(768&u.type){const t=u.x-C.$T,i=u.y-C.JT,s=u.z-C.QT,e=u.angle;let h,n;if(h=e===A.A.SC||e===A.A.mC?-t:t,n=e===A.A.mC||e===A.A.vC?-s:s,256&u.type&&n<h){const h=t+C.wO[e],n=s+C.AO[e];u.model.draw(512*e+256,C.KT,C.ZT,C.jT,C.qT,h,i,n,u.G_)}if(512&u.type&&n>h){const h=t+C.xO[e],n=s+C.gO[e];u.model.draw(512*e+1280&2047,C.KT,C.ZT,C.jT,C.qT,h,i,n,u.G_)}}if(a){const i=t.NO;i&&i.model?.draw(0,C.KT,C.ZT,C.jT,C.qT,i.x-C.$T,i.y-C.JT,i.z-C.QT,i.G_);const s=t.GO;s&&0===s.offset&&(s.oT&&s.oT.draw(0,C.KT,C.ZT,C.jT,C.qT,s.x-C.$T,s.y-C.JT,s.z-C.QT,s.G_),s.rT&&s.rT.draw(0,C.KT,C.ZT,C.jT,C.qT,s.x-C.$T,s.y-C.JT,s.z-C.QT,s.G_),s.nT&&s.nT.draw(0,C.KT,C.ZT,C.jT,C.qT,s.x-C.$T,s.y-C.JT,s.z-C.QT,s.G_))}const d=t.aL;if(0!==d){if(e<C.tO&&4&d){const t=o[e+1][h];t&&t.update&&C.VT.Sf(t)}if(h<C.iO&&2&d){const t=o[e][h+1];t&&t.update&&C.VT.Sf(t)}if(e>C.tO&&1&d){const t=o[e-1][h];t&&t.update&&C.VT.Sf(t)}if(h>C.iO&&8&d){const t=o[e][h-1];t&&t.update&&C.VT.Sf(t)}}}if(0!==t.nL){let i=!0;for(let s=0;s<t.FO;s++){const e=t.VO[s];if(e&&(e.Kx!==C.Kx&&(t.oL[s]&t.nL)===t.yL)){i=!1;break}}if(i){const i=t.WO;i&&!this.wL(r,e,h,i.iT)&&i.eT?.draw(0,C.KT,C.ZT,C.jT,C.qT,i.x-C.$T,i.y-C.JT,i.z-C.QT,i.G_),t.nL=0}}if(t.hL){const i=t.FO;t.hL=!1;let n=0;t:for(let s=0;s<i;s++){const i=t.VO[s];if(!i||i.Kx===C.Kx)continue;for(let s=i.P_;s<=i.N_;s++)for(let e=i.F_;e<=i.V_;e++){const h=o[s][e];if(h){if(!h.visible){if(0===h.nL)continue;let n=0;if(s>i.P_&&(n+=1),s<i.N_&&(n+=4),e>i.F_&&(n+=8),e<i.V_&&(n+=2),(n&h.nL)!==t.pL)continue}t.hL=!0;continue t}}C.UT[n++]=i;let e=C.tO-i.P_;const h=i.N_-C.tO;h>e&&(e=h);const r=C.iO-i.F_,a=i.V_-C.iO;i.W_=a>r?e+a:e+r}for(;;){let t=-50,i=-1;for(let s=0;s<n;s++){const e=C.UT[s];e&&(e.Kx!==C.Kx&&e.W_>t&&(t=e.W_,i=s))}if(-1===i)break;const a=C.UT[i];if(a){a.Kx=C.Kx;let t=a.model;t||(t=a.U_?.draw(s)??null),t&&!this.xL(r,a.P_,a.N_,a.F_,a.V_,t.Yw)&&t.draw(a.Qw,C.KT,C.ZT,C.jT,C.qT,a.x-C.$T,a.y-C.JT,a.z-C.QT,a.G_);for(let t=a.P_;t<=a.N_;t++)for(let i=a.F_;i<=a.V_;i++){const s=o[t][i];s&&(0!==s.nL?C.VT.Sf(s):t===e&&i===h||!s.update||C.VT.Sf(s))}}}if(t.hL)continue}if(!t.update||0!==t.nL)continue;if(e<=C.tO&&e>C.sO){const t=o[e-1][h];if(t&&t.update)continue}if(e>=C.tO&&e<C.eO-1){const t=o[e+1][h];if(t&&t.update)continue}if(h<=C.iO&&h>C.hO){const t=o[e][h-1];if(t&&t.update)continue}if(h>=C.iO&&h<C.nO-1){const t=o[e][h+1];if(t&&t.update)continue}t.update=!1,C.rO--;const a=t.GO;if(a&&0!==a.offset&&(a.oT&&a.oT.draw(0,C.KT,C.ZT,C.jT,C.qT,a.x-C.$T,a.y-C.JT-a.offset,a.z-C.QT,a.G_),a.rT&&a.rT.draw(0,C.KT,C.ZT,C.jT,C.qT,a.x-C.$T,a.y-C.JT-a.offset,a.z-C.QT,a.G_),a.nT&&a.nT.draw(0,C.KT,C.ZT,C.jT,C.qT,a.x-C.$T,a.y-C.JT-a.offset,a.z-C.QT,a.G_)),0!==t.dL){const i=t.YO;if(i&&!this.visible(r,e,h,i.model.Yw))if(i.type&t.dL)i.model.draw(i.angle,C.KT,C.ZT,C.jT,C.qT,i.x-C.$T,i.y-C.JT,i.z-C.QT,i.G_);else if(768&i.type){const t=i.x-C.$T,s=i.y-C.JT,e=i.z-C.QT,h=i.angle;let n,r;if(n=h===A.A.SC||h===A.A.mC?-t:t,r=h===A.A.mC||h===A.A.vC?-e:e,256&i.type&&r>=n){const n=t+C.wO[h],r=e+C.AO[h];i.model.draw(512*h+256,C.KT,C.ZT,C.jT,C.qT,n,s,r,i.G_)}if(512&i.type&&r<=n){const n=t+C.xO[h],r=e+C.gO[h];i.model.draw(512*h+1280&2047,C.KT,C.ZT,C.jT,C.qT,n,s,r,i.G_)}}const s=t.WO;s&&(s.sT&t.dL&&!this.wL(r,e,h,s.sT)&&s.hT?.draw(0,C.KT,C.ZT,C.jT,C.qT,s.x-C.$T,s.y-C.JT,s.z-C.QT,s.G_),s.iT&t.dL&&!this.wL(r,e,h,s.iT)&&s.eT?.draw(0,C.KT,C.ZT,C.jT,C.qT,s.x-C.$T,s.y-C.JT,s.z-C.QT,s.G_))}if(n<this.BO-1){const t=this.IO[n+1][e][h];t&&t.update&&C.VT.Sf(t)}if(e<C.tO){const t=o[e+1][h];t&&t.update&&C.VT.Sf(t)}if(h<C.iO){const t=o[e][h+1];t&&t.update&&C.VT.Sf(t)}if(e>C.tO){const t=o[e-1][h];t&&t.update&&C.VT.Sf(t)}if(h>C.iO){const t=o[e][h-1];t&&t.update&&C.VT.Sf(t)}}};fL=(t,i,s,h,n,r,o,a)=>{let l,c,f,u,d=l=(s<<7)-C.$T,p=c=(h<<7)-C.QT,w=f=d+128,A=u=p+128,x=this.bO[i][s][h]-C.JT,g=this.bO[i][s+1][h]-C.JT,S=this.bO[i][s+1][h+1]-C.JT,m=this.bO[i][s][h+1]-C.JT,v=p*o+d*a>>16;if(p=p*a-d*o>>16,d=v,v=x*r-p*n>>16,p=x*n+p*r>>16,x=v,p<50)return;if(v=c*o+w*a>>16,c=c*a-w*o>>16,w=v,v=g*r-c*n>>16,c=g*n+c*r>>16,g=v,c<50)return;if(v=A*o+f*a>>16,A=A*a-f*o>>16,f=v,v=S*r-A*n>>16,A=S*n+A*r>>16,S=v,A<50)return;if(v=u*o+l*a>>16,u=u*a-l*o>>16,l=v,v=m*r-u*n>>16,u=m*n+u*r>>16,m=v,u<50)return;const B=e.A.Dl+((d<<9)/p|0),b=e.A.kl+((x<<9)/p|0),I=e.A.Dl+((w<<9)/c|0),E=e.A.kl+((g<<9)/c|0),_=e.A.Dl+((f<<9)/A|0),T=e.A.kl+((S<<9)/A|0),O=e.A.Dl+((l<<9)/u|0),L=e.A.kl+((m<<9)/u|0);if(e.A.alpha=0,(_-O)*(E-L)-(T-L)*(I-O)>0)if(e.A.gL=_<0||O<0||I<0||_>y.A.CL||O>y.A.CL||I>y.A.CL,C.oO&&this.SL(C.ol,C.al,T,L,E,_,O,I)&&(C.Ax=s,C.xx=h),-1===t.uT)12345678!==t.cT&&e.A.mL(_,O,I,T,L,E,t.cT,t.fT,t.lT);else if(C.Bt){const i=C.mO[t.uT];e.A.mL(_,O,I,T,L,E,this.vL(i,t.cT),this.vL(i,t.fT),this.vL(i,t.lT))}else t.flat?e.A.BL(_,O,I,T,L,E,t.cT,t.fT,t.lT,d,x,p,w,l,g,m,c,u,t.uT):e.A.BL(_,O,I,T,L,E,t.cT,t.fT,t.lT,f,S,A,l,w,m,g,u,c,t.uT);if(!((B-I)*(L-E)-(b-E)*(O-I)<=0))if(e.A.gL=B<0||I<0||O<0||B>y.A.CL||I>y.A.CL||O>y.A.CL,C.oO&&this.SL(C.ol,C.al,b,E,L,B,I,O)&&(C.Ax=s,C.xx=h),-1!==t.uT){if(!C.Bt)return void e.A.BL(B,I,O,b,E,L,t.aT,t.lT,t.fT,d,x,p,w,l,g,m,c,u,t.uT);const i=C.mO[t.uT];e.A.mL(B,I,O,b,E,L,this.vL(i,t.aT),this.vL(i,t.lT),this.vL(i,t.fT))}else 12345678!==t.aT&&e.A.mL(B,I,O,b,E,L,t.aT,t.lT,t.fT)};uL=(t,i,s,h,n,r,o)=>{let a=s.BI.length;for(let t=0;t<a;t++){let i=s.BI[t]-C.$T,a=s.II[t]-C.JT,l=s.bI[t]-C.QT,c=l*r+i*o>>16;if(l=l*o-i*r>>16,i=c,c=a*n-l*h>>16,l=a*h+l*n>>16,a=c,l<50)return;s.OT&&(p.pT[t]=i,p.wT[t]=a,p.AT[t]=l),p.dT[t]=e.A.Dl+((i<<9)/l|0),p.yT[t]=e.A.kl+((a<<9)/l|0)}e.A.alpha=0,a=s.ET.length;for(let h=0;h<a;h++){const n=s.ET[h],r=s._T[h],o=s.TT[h],a=p.dT[n],l=p.dT[r],c=p.dT[o],f=p.yT[n],u=p.yT[r],d=p.yT[o];if((a-l)*(d-u)-(f-u)*(c-l)>0)if(e.A.gL=a<0||l<0||c<0||a>y.A.CL||l>y.A.CL||c>y.A.CL,C.oO&&this.SL(C.ol,C.al,f,u,d,a,l,c)&&(C.Ax=t,C.xx=i),s.OT&&-1!==s.OT[h])if(C.Bt){const t=C.mO[s.OT[h]];e.A.mL(a,l,c,f,u,d,this.vL(t,s.BT[h]),this.vL(t,s.bT[h]),this.vL(t,s.IT[h]))}else s.flat?e.A.BL(a,l,c,f,u,d,s.BT[h],s.bT[h],s.IT[h],p.pT[0],p.wT[0],p.AT[0],p.pT[1],p.pT[3],p.wT[1],p.wT[3],p.AT[1],p.AT[3],s.OT[h]):e.A.BL(a,l,c,f,u,d,s.BT[h],s.bT[h],s.IT[h],p.pT[n],p.wT[n],p.AT[n],p.pT[r],p.pT[o],p.wT[r],p.wT[o],p.AT[r],p.AT[o],s.OT[h]);else 12345678!==s.BT[h]&&e.A.mL(a,l,c,f,u,d,s.BT[h],s.bT[h],s.IT[h])}};cL=(t,i,s)=>{const e=this.EO[t][i][s];if(e===-C.Kx)return!1;if(e===C.Kx)return!0;{const e=i<<7,h=s<<7;return this.bL(e+1,this.bO[t][i][s],h+1)&&this.bL(e+128-1,this.bO[t][i+1][s],h+1)&&this.bL(e+128-1,this.bO[t][i+1][s+1],h+128-1)&&this.bL(e+1,this.bO[t][i][s+1],h+128-1)?(this.EO[t][i][s]=C.Kx,!0):(this.EO[t][i][s]=-C.Kx,!1)}};wL=(t,i,s,e)=>{if(!this.cL(t,i,s))return!1;const h=i<<7,n=s<<7,r=this.bO[t][i][s]-1,o=r-120,a=r-230,l=r-238;if(e<16){if(1===e){if(h>C.$T){if(!this.bL(h,r,n))return!1;if(!this.bL(h,r,n+128))return!1}if(t>0){if(!this.bL(h,o,n))return!1;if(!this.bL(h,o,n+128))return!1}return!!this.bL(h,a,n)&&this.bL(h,a,n+128)}if(2===e){if(n<C.QT){if(!this.bL(h,r,n+128))return!1;if(!this.bL(h+128,r,n+128))return!1}if(t>0){if(!this.bL(h,o,n+128))return!1;if(!this.bL(h+128,o,n+128))return!1}return!!this.bL(h,a,n+128)&&this.bL(h+128,a,n+128)}if(4===e){if(h<C.$T){if(!this.bL(h+128,r,n))return!1;if(!this.bL(h+128,r,n+128))return!1}if(t>0){if(!this.bL(h+128,o,n))return!1;if(!this.bL(h+128,o,n+128))return!1}return!!this.bL(h+128,a,n)&&this.bL(h+128,a,n+128)}if(8===e){if(n>C.QT){if(!this.bL(h,r,n))return!1;if(!this.bL(h+128,r,n))return!1}if(t>0){if(!this.bL(h,o,n))return!1;if(!this.bL(h+128,o,n))return!1}return!!this.bL(h,a,n)&&this.bL(h+128,a,n)}}return!!this.bL(h+64,l,n+64)&&(16===e?this.bL(h,a,n+128):32===e?this.bL(h+128,a,n+128):64===e?this.bL(h+128,a,n):128===e?this.bL(h,a,n):(console.warn('Warning unsupported wall type!'),!0))};visible=(t,i,s,e)=>{if(this.cL(t,i,s)){const h=i<<7,n=s<<7;return this.bL(h+1,this.bO[t][i][s]-e,n+1)&&this.bL(h+128-1,this.bO[t][i+1][s]-e,n+1)&&this.bL(h+128-1,this.bO[t][i+1][s+1]-e,n+128-1)&&this.bL(h+1,this.bO[t][i][s+1]-e,n+128-1)}return!1};xL=(t,i,s,e,h,n)=>{let r,o;if(i!==s||e!==h){for(r=i;r<=s;r++)for(o=e;o<=h;o++)if(this.EO[t][r][o]===-C.Kx)return!1;o=1+(i<<7);const a=2+(e<<7),l=this.bO[t][i][e]-n;if(!this.bL(o,l,a))return!1;const c=(s<<7)-1;if(!this.bL(c,l,a))return!1;const f=(h<<7)-1;return!!this.bL(o,l,f)&&this.bL(c,l,f)}return!!this.cL(t,i,e)&&(r=i<<7,o=e<<7,this.bL(r+1,this.bO[t][i][e]-n,o+1)&&this.bL(r+128-1,this.bO[t][i+1][e]-n,o+1)&&this.bL(r+128-1,this.bO[t][i+1][e+1]-n,o+128-1)&&this.bL(r+1,this.bO[t][i][e+1]-n,o+128-1))};bL=(t,i,s)=>{for(let e=0;e<C.zg;e++){const h=C.FT[e];if(h)if(1===h.mode){const e=h.Y_-t;if(e>0){const t=h.z_+(h.q_*e>>8),n=h.X_+(h.J_*e>>8),r=h.K_+(h.Q_*e>>8),o=h.Yw+(h.tT*e>>8);if(s>=t&&s<=n&&i>=r&&i<=o)return!0}}else if(2===h.mode){const e=t-h.Y_;if(e>0){const t=h.z_+(h.q_*e>>8),n=h.X_+(h.J_*e>>8),r=h.K_+(h.Q_*e>>8),o=h.Yw+(h.tT*e>>8);if(s>=t&&s<=n&&i>=r&&i<=o)return!0}}else if(3===h.mode){const e=h.z_-s;if(e>0){const s=h.Y_+(h.Z_*e>>8),n=h.H_+(h.j_*e>>8),r=h.K_+(h.Q_*e>>8),o=h.Yw+(h.tT*e>>8);if(t>=s&&t<=n&&i>=r&&i<=o)return!0}}else if(4===h.mode){const e=s-h.z_;if(e>0){const s=h.Y_+(h.Z_*e>>8),n=h.H_+(h.j_*e>>8),r=h.K_+(h.Q_*e>>8),o=h.Yw+(h.tT*e>>8);if(t>=s&&t<=n&&i>=r&&i<=o)return!0}}else if(5===h.mode){const e=i-h.K_;if(e>0){const i=h.Y_+(h.Z_*e>>8),n=h.H_+(h.j_*e>>8),r=h.z_+(h.q_*e>>8),o=h.X_+(h.J_*e>>8);if(t>=i&&t<=n&&s>=r&&s<=o)return!0}}}return!1};SL=(t,i,s,e,h,n,r,o)=>{if(i<s&&i<e&&i<h)return!1;if(i>s&&i>e&&i>h)return!1;if(t<n&&t<r&&t<o)return!1;if(t>n&&t>r&&t>o)return!1;const a=(i-e)*(o-r)-(t-r)*(h-e);return((i-s)*(r-n)-(t-n)*(e-s))*a>0&&a*((i-h)*(n-o)-(t-o)*(s-h))>0};vL=(t,i)=>((i=(127-i)*(127&t)/160|0)<2?i=2:i>126&&(i=126),(65408&t)+i)}},7121:(t,i,s)=>{s.d(i,{A:()=>h});var e=s(1982);class h extends e.A{}},4197:(t,i,s)=>{s.d(i,{A:()=>h});var e=s(1982);class h extends e.A{qS;Tv;ZS;jS;index;_w;Va;Fa;constructor(t,i,s,e,h,n,r){super(),this.qS=i,this.Tv=s,this.ZS=e,this.jS=h,this.index=t,this._w=n,r&&-1!==n.Wa&&this._w.delay?(this.Va=Math.random()*this._w.Ga|0,this.Fa=Math.random()*this._w.delay[this.Va]|0):(this.Va=-1,this.Fa=0)}}},9418:(t,i,s)=>{s.d(i,{A:()=>r});var e=s(7121),h=s(1312),n=s(3867);class r extends e.A{x=0;z=0;Qw=0;vv=!1;size=1;hc=-1;Nv=-1;hv=-1;rv=-1;av=-1;cv=-1;Yv=-1;yg=null;xg=100;wg=0;Ag=0;vg=0;mg=0;gg=-1e3;Cg=0;Sg=0;Lg=-1;Xm=0;Km=0;Vw=-1;Gw=0;Fv=0;Pw=-1;Fw=0;zm=0;Nw=0;Hm=0;Sw=-1;mw=0;jm=0;Zm=0;Ew=0;qm=0;Jm=0;$m=0;Qm=0;bg=0;Ig=0;tv=0;Kx=0;height=0;Pv=0;pathLength=0;Cx=new Int32Array(10);Sx=new Int32Array(10);Wv=new n.Ps(10,!1);Uv=0;_g=-1;Tg=-1;Rg=-1;Dg=-1;move(t,i,s){if(-1!==this.Pw&&h.A.ta[this.Pw].priority<=1&&(this.Pw=-1),!t){const t=i-this.Cx[0],e=s-this.Sx[0];if(t>=-8&&t<=8&&e>=-8&&e<=8){this.pathLength<9&&this.pathLength++;for(let t=this.pathLength;t>0;t--)this.Cx[t]=this.Cx[t-1],this.Sx[t]=this.Sx[t-1],this.Wv[t]=this.Wv[t-1];return this.Cx[0]=i,this.Sx[0]=s,void(this.Wv[0]=!1)}}this.pathLength=0,this.Uv=0,this.Cx[0]=i,this.Sx[0]=s,this.x=128*this.Cx[0]+64*this.size,this.z=128*this.Sx[0]+64*this.size}step(t,i){let s=this.Cx[0],e=this.Sx[0];0===i?(s--,e++):1===i?e++:2===i?(s++,e++):3===i?s--:4===i?s++:5===i?(s--,e--):6===i?e--:7===i&&(s++,e--),-1!==this.Pw&&h.A.ta[this.Pw].priority<=1&&(this.Pw=-1),this.pathLength<9&&this.pathLength++;for(let t=this.pathLength;t>0;t--)this.Cx[t]=this.Cx[t-1],this.Sx[t]=this.Sx[t-1],this.Wv[t]=this.Wv[t-1];this.Cx[0]=s,this.Sx[0]=e,this.Wv[0]=t}}},8268:(t,i,s)=>{s.d(i,{A:()=>d});var e=s(9418),h=s(8665),n=s(2031),r=s(8738),o=s(1312),a=s(8317),l=s(1302),c=s(3819),f=s(3867),u=s(9298);class d extends e.A{static Og=1;static yw=2;static pw=4;static ww=8;static Aw=16;static Cw=32;static kg=64;static Wm=128;static gw=256;static Mg=512;static ec=[u.A.IL,u.A.EL,u.A._L,u.A.TL,u.A.OL,u.A.LL,u.A.RL,u.A.DL,u.A.kL,u.A.ML,u.A.UL,u.A.PL,u.A.NL,u.A.FL,u.A.VL,u.A.WL];static sc=[[u.A.YL,u.A.HL,u.A.zL,u.A.XL,u.A.KL,u.A.ZL,u.A.jL,u.A.qL,u.A.$L,u.A.JL,u.A.QL,u.A.tR],[u.A.iR,u.A.sR,u.A.eR,u.A.hR,u.A.nR,u.A.rR,u.A.oR,u.A.aR,u.A.lR,u.A.cR,u.A.fR,u.A.uR,u.A.dR,u.A.yR,u.A.pR,u.A.wR],[u.A.wR-1,u.A.iR+1,u.A.sR,u.A.eR,u.A.hR,u.A.nR,u.A.rR,u.A.oR,u.A.aR,u.A.lR,u.A.cR,u.A.fR,u.A.uR,u.A.dR,u.A.yR,u.A.pR],[u.A.AR,u.A.xR,u.A.gR,u.A.CR,u.A.SR,u.A.mR],[u.A.vR,u.A.BR,u.A.bR,u.A.IR,u.A.ER,u.A._R,u.A.TR,u.A.OR]];static ia=new n.A(200);name=null;visible=!1;LR=0;dg=0;RR=new Uint16Array(12);DR=new Uint16Array(5);Sc=0;kR=0n;y=0;Cv=0;Sv=0;Hv=0;Xv=0;zv=0;gv=null;bv=0;Iv=0;Ev=0;_v=0;Bt=!1;draw(t){if(!this.visible)return null;let i=this.Bw();if(this.height=i.Yw,i.Uw=!0,this.Bt)return i;if(-1!==this.Sw&&-1!==this.mw){const t=r.A.ta[this.Sw],s=h.A.bw(t.Ul(),!0,!t.Iw,!1);s.translate(-this.Ew,0,0),s.nc(),t._w&&t._w.frames&&s.rc(t._w.frames[this.mw]),s.Tw=null,s.Ow=null,128===t.Lw&&128===t.Rw||s.scale(t.Lw,t.Rw,t.Lw),s.oc(t.Dw+64,t.kw+850,-30,-50,-30,!0);const e=[i,s];i=h.A.Mw(e,2)}if(this.gv&&(t>=this.Sv&&(this.gv=null),t>=this.Cv&&t<this.Sv)){const t=this.gv;if(t){t.translate(this.Xv-this.y,this.Hv-this.x,this.zv-this.z),512===this.Pv?(t.eA(),t.eA(),t.eA()):1024===this.Pv?(t.eA(),t.eA()):1536===this.Pv&&t.eA();const s=[i,t];i=h.A.Mw(s,2),512===this.Pv?t.eA():1024===this.Pv?(t.eA(),t.eA()):1536===this.Pv&&(t.eA(),t.eA(),t.eA()),t.translate(this.y-this.Xv,this.x-this.Hv,this.z-this.zv)}}return i.Uw=!0,i}isVisible(){return this.visible}read(t){t.ft=0,this.LR=t.kc,this.dg=t.kc;for(let i=0;i<12;i++){const s=t.kc;this.RR[i]=0===s?0:(s<<8)+t.kc}for(let i=0;i<5;i++){let s=t.kc;(s<0||s>=d.sc[i].length)&&(s=0),this.DR[i]=s}this.hc=t.ct,65535===this.hc&&(this.hc=-1),this.Nv=t.ct,65535===this.Nv&&(this.Nv=-1),this.hv=t.ct,65535===this.hv&&(this.hv=-1),this.rv=t.ct,65535===this.rv&&(this.rv=-1),this.av=t.ct,65535===this.av&&(this.av=-1),this.cv=t.ct,65535===this.cv&&(this.cv=-1),this.Yv=t.ct,65535===this.Yv&&(this.Yv=-1),this.name=c.A.ql(c.A.$l(t.GA)),this.Sc=t.kc,this.visible=!0,this.kR=0n;for(let t=0;t<12;t++)this.kR<<=0x4n,this.RR[t]>=256&&(this.kR+=BigInt(this.RR[t])-256n);this.RR[0]>=256&&(this.kR+=BigInt(this.RR[0])-256n>>4n),this.RR[1]>=256&&(this.kR+=BigInt(this.RR[1])-256n>>8n);for(let t=0;t<5;t++)this.kR<<=0x3n,this.kR+=BigInt(this.DR[t]);this.kR<<=0x1n,this.kR+=BigInt(this.LR)}_S(){if(!this.visible)return null;const t=new f.Ps(12,null);let i=0;for(let s=0;s<12;s++){const e=this.RR[s];if(e>=256&&e<512&&(t[i++]=a.A.ta[e-256]._S()),e>=512){const s=l.A.get(e-512)._S(this.LR);s&&(t[i++]=s)}}const s=h.A.tc(t,i);for(let t=0;t<5;t++)0!==this.DR[t]&&(s.ic(d.sc[t][0],d.sc[t][this.DR[t]]),1===t&&s.ic(d.ec[0],d.ec[this.DR[t]]));return s}Bw(){let t=this.kR,i=-1,s=-1,e=-1,n=-1;if(this.Pw>=0&&0===this.Nw){const h=o.A.ta[this.Pw];if(h.frames&&(i=h.frames[this.Fw]),this.Vw>=0&&this.Vw!==this.hc){const t=o.A.ta[this.Vw].frames;t&&(s=t[this.Gw])}h.oE>=0&&(e=h.oE,t+=BigInt(e-this.RR[5])<<8n),h.aE>=0&&(n=h.aE,t+=BigInt(n-this.RR[3])<<16n)}else if(this.Vw>=0){const t=o.A.ta[this.Vw].frames;t&&(i=t[this.Gw])}let r=d.ia?.get(t);if(!r){const i=new f.Ps(12,null);let s=0;for(let t=0;t<12;t++){let h=this.RR[t];if(n>=0&&3===t&&(h=n),e>=0&&5===t&&(h=e),h>=256&&h<512){const t=a.A.ta[h-256].Ul();t&&(i[s++]=t)}if(h>=512){const t=l.A.get(h-512).rE(this.LR);t&&(i[s++]=t)}}r=h.A.tc(i,s);for(let t=0;t<5;t++)0!==this.DR[t]&&(r.ic(d.sc[t][0],d.sc[t][this.DR[t]]),1===t&&r.ic(d.ec[0],d.ec[this.DR[t]]));r.nc(),r.oc(64,850,-30,-50,-30,!0),d.ia?.put(t,r)}if(this.Bt)return r;const c=h.A.OI(r,!0);return-1!==i&&-1!==s?c.LI(i,s,o.A.ta[this.Pw].Ww):-1!==i&&c.rc(i),c.RI(),c.Tw=null,c.Ow=null,c}}},3795:(t,i,s)=>{s.d(i,{A:()=>n});var e=s(1982),h=s(3867);class n extends e.A{level;x;z;lL;VO;oL;MO=null;PO=null;WO=null;YO=null;NO=null;GO=null;DO=null;FO=0;aL=0;kO=0;visible=!1;update=!1;hL=!1;nL=0;yL=0;pL=0;dL=0;constructor(t,i,s){super(),this.lL=this.level=t,this.x=i,this.z=s,this.VO=new h.Ps(5,null),this.oL=new Int32Array(5)}}},5518:(t,i,s)=>{s.d(i,{A:()=>e});class e{static E_=0;static UO=1;static MR=2;static UR=3;static PR=4;static NR=5;static ST=6;static mT=7;static vT=8;static FR=9;static VR=10;static GR=11}},4474:(t,i,s)=>{s.d(i,{A:()=>h});var e=s(1982);class h extends e.A{WR;YR;constructor(){super(),this.WR=this,this.YR=this}HR(){this.YR&&this.WR&&(this.YR.WR=this.WR,this.WR.YR=this.YR,this.WR=null,this.YR=null)}}},3819:(t,i,s)=>{s.d(i,{A:()=>e});class e{static zR=['_','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','0','1','2','3','4','5','6','7','8','9'];static eC=t=>{t=t.trim();let i=0n;for(let s=0;s<t.length&&s<12;s++){const e=t.charCodeAt(s);i*=37n,e>=65&&e<=90?i+=BigInt(e+1-65):e>=97&&e<=122?i+=BigInt(e+1-97):e>=48&&e<=57&&(i+=BigInt(e+27-48))}return i};static $l=t=>{if(t<0n||t>=6582952005840035281n)return'invalid_name';if(t%37n===0n)return'invalid_name';let i=0;const s=Array(12);for(;0n!==t;){const e=t;t/=37n,s[11-i++]=this.zR[Number(e-37n*t)]}return s.slice(12-i).join('')};static eS=t=>{const i=[...t.toLowerCase()];let s=!0;for(let t=0;t<i.length;t++){const e=i[t];s&&e>='a'&&e<='z'&&(i[t]=e.toUpperCase(),s=!1),'.'!==e&&'!'!==e||(s=!0)}return i.join('')};static VA=t=>{let i='';for(let s=0;s<t.length;s++)i+='*';return i};static wc=t=>(t>>24&255)+'.'+(t>>16&255)+'.'+(t>>8&255)+'.'+(255&t);static ql=t=>{if(0===t.length)return t;const i=[...t];for(let t=0;t<i.length;t++)'_'===i[t]&&(i[t]=' ',t+1<i.length&&i[t+1]>='a'&&i[t+1]<='z'&&(i[t+1]=String.fromCharCode(i[t+1].charCodeAt(0)+'A'.charCodeAt(0)-97)));return i[0]>='a'&&i[0]<='z'&&(i[0]=String.fromCharCode(i[0].charCodeAt(0)+'A'.charCodeAt(0)-97)),i.join('')};static Pb=t=>{const i=t.toUpperCase();let s=0n;for(let t=0;t<i.length;t++)s=61n*s+BigInt(i.charCodeAt(t))-32n,s=s+(s>>56n)&0xffffffffffffffn;return s}}},6666:(t,i,s)=>{s.d(i,{A:()=>h});var e=s(1982);class h{XR;cursor=null;constructor(){const t=new e.A;t.next=t,t.Bm=t,this.XR=t}Sf(t){t.Bm&&t.ES(),t.Bm=this.XR.Bm,t.next=this.XR,t.Bm&&(t.Bm.next=t),t.next.Bm=t}cS(t){t.Bm&&t.ES(),t.Bm=this.XR,t.next=this.XR.next,t.Bm.next=t,t.next&&(t.next.Bm=t)}Bf(){const t=this.XR.next;return t===this.XR?null:(t?.ES(),t)}head(){const t=this.XR.next;return t===this.XR?(this.cursor=null,null):(this.cursor=t?.next||null,t)}vm(){const t=this.XR.Bm;return t===this.XR?(this.cursor=null,null):(this.cursor=t?.Bm||null,t)}next(){const t=this.cursor;return t===this.XR?(this.cursor=null,null):(this.cursor=t?.next||null,t)}Bm(){const t=this.cursor;return t===this.XR?(this.cursor=null,null):(this.cursor=t?.Bm||null,t)}clear(){for(;;){const t=this.XR.next;if(t===this.XR)return;t?.ES()}}}},1982:(t,i,s)=>{s.d(i,{A:()=>e});class e{key;next;Bm;constructor(){this.key=0n,this.next=this,this.Bm=this}ES(){this.Bm&&this.next&&(this.Bm.next=this.next,this.next.Bm=this.Bm,this.next=null,this.Bm=null)}}},2031:(t,i,s)=>{s.d(i,{A:()=>o});var e=s(4474);class h{head;constructor(){this.head=new e.A}push(t){t.YR&&t.HR(),t.YR=this.head.YR,t.WR=this.head,t.YR&&(t.YR.WR=t),t.WR.YR=t}pop(){const t=this.head.WR;return t===this.head?null:(t?.HR(),t)}}var n=s(1982);class r{KR;ZR;constructor(t){this.ZR=[],this.KR=t;for(let i=0;i<t;i++)this.ZR[i]=new n.A}get(t){const i=this.ZR[Number(t&BigInt(this.KR-1))];if(!i.next)return null;for(let s=i.next;s!==i;s=s.next)if(s&&s.key===t)return s;return null}put(t,i){i.Bm&&i.ES();const s=this.ZR[Number(t&BigInt(this.KR-1))];i.Bm=s.Bm,i.next=s,i.Bm&&(i.Bm.next=i),i.next.Bm=i,i.key=t}}class o{jR;qR;history;available;constructor(t){this.jR=t,this.available=t,this.qR=new r(1024),this.history=new h}get(t){const i=this.qR.get(t);return i&&this.history.push(i),i}put(t,i){if(0===this.available){const t=this.history.pop();t?.ES(),t?.HR()}else this.available--;this.qR.put(t,i),this.history.push(i)}clear(){const t=this.history.pop();t?(t.ES(),t.HR()):this.available=this.jR}}},8534:(t,i,s)=>{s.d(i,{A:()=>n});var e=s(1069),h=s(3867);class n{static ta=[];static Dy=t=>{const i=new e.A(t.read('base_head.dat')),s=new e.A(t.read('base_type.dat')),r=new e.A(t.read('base_label.dat')),o=i.ct;i.ft+=2;for(let t=0;t<o;t++){const t=i.ct,e=i.kc,o=new Uint8Array(e),a=new h.Ps(e,null);for(let t=0;t<e;t++){o[t]=s.kc;const i=r.kc,e=new Uint8Array(i);for(let t=0;t<i;t++)e[t]=r.kc;a[t]=e}this.ta[t]=new n,this.ta[t].length=e,this.ta[t].types=o,this.ta[t].labels=a}};length=0;types=null;labels=null}},6730:(t,i,s)=>{s.d(i,{A:()=>n});var e=s(8534),h=s(1069);class n{static ta=[];static Dy=t=>{const i=new h.A(t.read('frame_head.dat')),s=new h.A(t.read('frame_tran1.dat')),r=new h.A(t.read('frame_tran2.dat')),o=new h.A(t.read('frame_del.dat')),a=i.ct;i.ft+=2;const l=new Int32Array(500),c=new Int32Array(500),f=new Int32Array(500),u=new Int32Array(500);for(let t=0;t<a;t++){const t=i.ct,h=this.ta[t]=new n;h.delay=o.kc;const a=i.ct,d=e.A.ta[a];h.$R=d;const y=i.kc;let p=-1,w=0;for(let t=0;t<y;t++){if(!d.types)throw new Error('SeqBase not loaded!!!');const i=s.kc;if(i>0){if(0!==d.types[t])for(let i=t-1;i>p;i--)if(0===d.types[i]){l[w]=i,c[w]=0,f[w]=0,u[w]=0,w++;break}l[w]=t;let s=0;3===d.types[l[w]]&&(s=128),c[w]=1&i?r.$p:s,f[w]=2&i?r.$p:s,u[w]=4&i?r.$p:s,p=t,w++}}h.length=w,h.JR=new Int32Array(w),h.x=new Int32Array(w),h.y=new Int32Array(w),h.z=new Int32Array(w);for(let t=0;t<w;t++)h.JR[t]=l[t],h.x[t]=c[t],h.y[t]=f[t],h.z[t]=u[t]}};delay=0;$R=null;length=0;JR=null;x=null;y=null;z=null}},7854:(t,i,s)=>{s.d(i,{mB:()=>n,nS:()=>e,ma:()=>r,QR:()=>l,SB:()=>h,tD:()=>a,iD:()=>o});const e=document.getElementById('canvas-container'),h=document.getElementById('canvas-overlay'),n=document.getElementById('canvas'),r=n.getContext('2d',{willReadFrequently:!0}),o=document.createElement('canvas'),a=document.createElement('img'),l=o.getContext('2d',{willReadFrequently:!0})},9298:(t,i,s)=>{s.d(i,{A:()=>e});class e{static RED=16711680;static GREEN=65280;static BLUE=255;static yl=16776960;static jc=65535;static qc=16711935;static Za=16777215;static dl=0;static $c=16748608;static Jc=8388608;static Qc=128;static tf=16756736;static if=16740352;static sf=16723968;static ef=12648192;static hf=8453888;static nf=4259584;static IA=9179409;static EC=6116423;static Ta=2301979;static Oa=5063219;static Ra=7759444;static ka=3353893;static $g=8388736;static Jg=13350793;static Pg=Int32Array.of(e.yl,e.RED,e.GREEN,e.jc,e.qc,e.Za);static YL=6798;static HL=107;static zL=10283;static XL=16;static KL=4797;static ZL=7744;static jL=5799;static qL=4634;static $L=33697;static JL=22433;static QL=2983;static tR=54193;static iR=8741;static sR=12;static eR=64030;static hR=43162;static nR=7735;static rR=8404;static oR=1701;static aR=38430;static lR=24094;static cR=10153;static fR=56621;static uR=4783;static dR=1341;static yR=16578;static pR=35003;static wR=25239;static IL=9104;static EL=10275;static _L=7595;static TL=3610;static OL=7975;static LL=8526;static RL=918;static DL=38802;static kL=24466;static ML=10145;static UL=58654;static PL=5027;static NL=1457;static FL=16565;static VL=34991;static WL=25486;static AR=4626;static xR=11146;static gR=6439;static CR=12;static SR=4758;static mR=10270;static OR=4574;static vR=4550;static BR=4537;static bR=5681;static IR=5673;static ER=5790;static _R=6806;static TR=8076}},8950:(t,i,s)=>{s.d(i,{A:()=>h});var e=s(4474);class h extends e.A{static Kc=new Int32Array;static zc=0;static FI=0;static top=0;static bottom=0;static left=0;static right=0;static CL=0;static sD=0;static eD=0;static bind=(t,i,s)=>{this.Kc=t,this.zc=i,this.FI=s,this.Ha(0,0,i,s)};static Ng=()=>{this.left=0,this.top=0,this.right=this.zc,this.bottom=this.FI,this.CL=this.right-1,this.sD=this.right/2|0};static Ha=(t,i,s,e)=>{t<0&&(t=0),i<0&&(i=0),s>this.zc&&(s=this.zc),e>this.FI&&(e=this.FI),this.top=i,this.bottom=e,this.left=t,this.right=s,this.CL=this.right-1,this.sD=this.right/2|0,this.eD=this.bottom/2|0};static clear=(t=0)=>{const i=this.zc*this.FI;for(let s=0;s<i;s++)this.Kc[s]=t};static Ka=(t,i,s,e,h)=>{this.Da(t,i,h,s),this.Da(t,i+e-1,h,s),this.La(t,i,h,e),this.La(t+s-1,i,h,e)};static Da=(t,i,s,e)=>{if(i<this.top||i>=this.bottom)return;t<this.left&&(e-=this.left-t,t=this.left),t+e>this.right&&(e=this.right-t);const h=t+i*this.zc;for(let t=0;t<e;t++)this.Kc[h+t]=s};static La=(t,i,s,e)=>{if(t<this.left||t>=this.right)return;i<this.top&&(e-=this.top-i,i=this.top),i+e>this.bottom&&(e=this.bottom-i);const h=t+i*this.zc;for(let t=0;t<e;t++)this.Kc[h+t*this.zc]=s};static Xg=(t,i,s,e,h)=>{const n=Math.abs(s-t),r=Math.abs(e-i),o=t<s?1:-1,a=i<e?1:-1;let l=n-r;for(;t>=this.left&&t<this.right&&i>=this.top&&i<this.bottom&&(this.Kc[t+i*this.zc]=h),t!==s||i!==e;){const s=2*l;s>-r&&(l-=r,t+=o),s<n&&(l+=n,i+=a)}};static fillRect=(t,i,s,e,h)=>{t<this.left&&(s-=this.left-t,t=this.left),i<this.top&&(e-=this.top-i,i=this.top),t+s>this.right&&(s=this.right-t),i+e>this.bottom&&(e=this.bottom-i);const n=this.zc-s;let r=t+i*this.zc;for(let t=-e;t<0;t++){for(let t=-s;t<0;t++)this.Kc[r++]=h;r+=n}};static hD(t,i,s,e,h,n){t<this.left&&(s-=this.left-t,t=this.left),i<this.top&&(e-=this.top-i,i=this.top),t+s>this.right&&(s=this.right-t),i+e>this.bottom&&(e=this.bottom-i);const r=256-n,o=(h>>16&255)*n,a=(h>>8&255)*n,l=(255&h)*n,c=this.zc-s;let f=t+i*this.zc;for(let t=0;t<e;t++){for(let t=-s;t<0;t++){const t=(o+(this.Kc[f]>>16&255)*r>>8<<16)+(a+(this.Kc[f]>>8&255)*r>>8<<8)+(l+(255&this.Kc[f])*r>>8);this.Kc[f++]=t}f+=c}}static nD(t,i,s,e,h){const n=256-h,r=(e>>16&255)*h,o=(e>>8&255)*h,a=(255&e)*h;let l=i-s;l<0&&(l=0);let c=i+s;c>=this.FI&&(c=this.FI-1);for(let e=l;e<=c;e++){const h=e-i,l=0|Math.sqrt(s*s-h*h);let c=t-l;c<0&&(c=0);let f=t+l;f>=this.zc&&(f=this.zc-1);let u=c+e*this.zc;for(let t=c;t<=f;t++){const t=(r+(this.Kc[u]>>16&255)*n>>8<<16)+(o+(this.Kc[u]>>8&255)*n>>8<<8)+(a+(255&this.Kc[u])*n>>8);this.Kc[u++]=t}}}static rD=(t,i,s)=>{t<this.left||t>=this.right||i<this.top||i>=this.bottom||(this.Kc[t+i*this.zc]=s)}}},4583:(t,i,s)=>{s.d(i,{A:()=>o});var e=s(8950),h=s(1673),n=s(3867),r=s(643);class o extends e.A{static Bt=!1;static oD=new Int32Array(512);static aD=new Int32Array(2048);static sin=new Int32Array(2048);static cos=new Int32Array(2048);static palette=new Int32Array(65536);static Zv=new n.Ps(50,null);static lD=0;static wA=new Int32Array;static Dl=0;static kl=0;static VI=!0;static gL=!1;static alpha=0;static cD=null;static fD=new n.Ps(50,null);static uD=0;static Kx=0;static Kv=new Int32Array(50);static dD=new n.Ps(50,null);static yD=!1;static pD=new n.Ps(50,!1);static wD=new Int32Array(50);static{for(let t=1;t<512;t++)this.oD[t]=32768/t|0;for(let t=1;t<2048;t++)this.aD[t]=65536/t|0;for(let t=0;t<2048;t++)this.sin[t]=65536*Math.sin(.0030679615757712823*t)|0,this.cos[t]=65536*Math.cos(.0030679615757712823*t)|0}static $o=()=>{this.oD=null,this.oD=null,this.sin=null,this.cos=null,this.wA=null,this.Zv=null,this.pD=null,this.wD=null,this.cD=null,this.fD=null,this.Kv=null,this.palette=null,this.dD=null,console.log('Draw3D unloaded!')};static vB=()=>{this.wA=new Int32Array(e.A.FI);for(let t=0;t<e.A.FI;t++)this.wA[t]=e.A.zc*t;this.Dl=e.A.zc/2|0,this.kl=e.A.FI/2|0};static pA=(t,i)=>{this.wA=new Int32Array(i);for(let s=0;s<i;s++)this.wA[s]=t*s;this.Dl=t/2|0,this.kl=i/2|0};static WS=()=>{this.cD=null,this.fD.fill(null)};static uA=t=>{this.lD=0;for(let i=0;i<50;i++)try{this.Zv[i]=h.A.Dc(t,i.toString()),this.Bt&&128===this.Zv[i]?.cl?this.Zv[i]?.AD():this.Zv[i]?.zI(),this.lD++}catch(t){}};static T_=t=>{if(0!==this.wD[t])return this.wD[t];const i=this.dD[t];if(!i)return 0;let s=0,e=0,h=0;const n=i.length;for(let t=0;t<n;t++)s+=i[t]>>16&255,e+=i[t]>>8&255,h+=255&i[t];let r=(s/n<<16)+(e/n<<8)+(h/n|0);return r=this.xD(r,1.4),0===r&&(r=1),this.wD[t]=r,r};static dA=t=>{const i=t+.03*Math.random()-.015;let s=0;for(let t=0;t<512;t++){const e=(t/8|0)/64+.0078125,h=(7&t)/8+.0625;for(let t=0;t<128;t++){const n=t/128;let r=n,o=n,a=n;if(0!==h){let t;t=n<.5?n*(h+1):n+h-n*h;const i=2*n-t;let s=e+.3333333333333333;s>1&&s--;let l=e-.3333333333333333;l<0&&l++,r=6*s<1?i+6*(t-i)*s:2*s<1?t:3*s<2?i+(t-i)*(.6666666666666666-s)*6:i,o=6*e<1?i+6*(t-i)*e:2*e<1?t:3*e<2?i+(t-i)*(.6666666666666666-e)*6:i,a=6*l<1?i+6*(t-i)*l:2*l<1?t:3*l<2?i+(t-i)*(.6666666666666666-l)*6:i}const l=((256*r|0)<<16)+((256*o|0)<<8)+(256*a|0);this.palette[s++]=this.xD(l,i)}}for(let t=0;t<50;t++){const s=this.Zv[t];if(!s)continue;const e=s.palette;this.dD[t]=new Int32Array(e.length);for(let s=0;s<e.length;s++){const h=this.dD[t];h&&(h[s]=this.xD(e[s],i))}}for(let t=0;t<50;t++)this.jv(t);r.A.dA(i)};static xD=(t,i)=>{const s=(t>>16)/256,e=(t>>8&255)/256,h=(255&t)/256;return((256*Math.pow(s,i)|0)<<16)+((256*Math.pow(e,i)|0)<<8)+(256*Math.pow(h,i)|0)};static yA=t=>{this.cD||(this.uD=t,this.Bt?this.cD=new n.wr(t,16384):this.cD=new n.wr(t,65536),this.fD.fill(null))};static mL=(t,i,s,h,n,a,l,c,f)=>{if(r.A.mL(t,i,s,h,n,a,l,c,f))return;let u=0,d=0;n!==h&&(u=(i-t<<16)/(n-h)|0,d=(c-l<<15)/(n-h)|0);let y=0,p=0;a!==n&&(y=(s-i<<16)/(a-n)|0,p=(f-c<<15)/(a-n)|0);let w=0,A=0;if(a!==h&&(w=(t-s<<16)/(h-a)|0,A=(l-f<<15)/(h-a)|0),h<=n&&h<=a){if(h<e.A.bottom)if(n>e.A.bottom&&(n=e.A.bottom),a>e.A.bottom&&(a=e.A.bottom),n<a)if(s=t<<=16,f=l<<=15,h<0&&(s-=w*h,t-=u*h,f-=A*h,l-=d*h,h=0),i<<=16,c<<=15,n<0&&(i-=y*n,c-=p*n,n=0),h!==n&&w<u||h===n&&w>y)for(a-=n,n-=h,h=o.wA[h];;){if(--n<0)for(;;){if(--a<0)return;this.gD(s>>16,i>>16,f>>7,c>>7,e.A.Kc,h,0),s+=w,i+=y,f+=A,c+=p,h+=e.A.zc}this.gD(s>>16,t>>16,f>>7,l>>7,e.A.Kc,h,0),s+=w,t+=u,f+=A,l+=d,h+=e.A.zc}else for(a-=n,n-=h,h=o.wA[h];;){if(--n<0)for(;;){if(--a<0)return;this.gD(i>>16,s>>16,c>>7,f>>7,e.A.Kc,h,0),s+=w,i+=y,f+=A,c+=p,h+=e.A.zc}this.gD(t>>16,s>>16,l>>7,f>>7,e.A.Kc,h,0),s+=w,t+=u,f+=A,l+=d,h+=e.A.zc}else if(i=t<<=16,c=l<<=15,h<0&&(i-=w*h,t-=u*h,c-=A*h,l-=d*h,h=0),s<<=16,f<<=15,a<0&&(s-=y*a,f-=p*a,a=0),h!==a&&w<u||h===a&&y>u)for(n-=a,a-=h,h=o.wA[h];;){if(--a<0)for(;;){if(--n<0)return;this.gD(s>>16,t>>16,f>>7,l>>7,e.A.Kc,h,0),s+=y,t+=u,f+=p,l+=d,h+=e.A.zc}this.gD(i>>16,t>>16,c>>7,l>>7,e.A.Kc,h,0),i+=w,t+=u,c+=A,l+=d,h+=e.A.zc}else for(n-=a,a-=h,h=o.wA[h];;){if(--a<0)for(;;){if(--n<0)return;this.gD(t>>16,s>>16,l>>7,f>>7,e.A.Kc,h,0),s+=y,t+=u,f+=p,l+=d,h+=e.A.zc}this.gD(t>>16,i>>16,l>>7,c>>7,e.A.Kc,h,0),i+=w,t+=u,c+=A,l+=d,h+=e.A.zc}}else if(n<=a){if(n<e.A.bottom)if(a>e.A.bottom&&(a=e.A.bottom),h>e.A.bottom&&(h=e.A.bottom),a<h)if(t=i<<=16,l=c<<=15,n<0&&(t-=u*n,i-=y*n,l-=d*n,c-=p*n,n=0),s<<=16,f<<=15,a<0&&(s-=w*a,f-=A*a,a=0),n!==a&&u<y||n===a&&u>w)for(h-=a,a-=n,n=o.wA[n];;){if(--a<0)for(;;){if(--h<0)return;this.gD(t>>16,s>>16,l>>7,f>>7,e.A.Kc,n,0),t+=u,s+=w,l+=d,f+=A,n+=e.A.zc}this.gD(t>>16,i>>16,l>>7,c>>7,e.A.Kc,n,0),t+=u,i+=y,l+=d,c+=p,n+=e.A.zc}else for(h-=a,a-=n,n=o.wA[n];;){if(--a<0)for(;;){if(--h<0)return;this.gD(s>>16,t>>16,f>>7,l>>7,e.A.Kc,n,0),t+=u,s+=w,l+=d,f+=A,n+=e.A.zc}this.gD(i>>16,t>>16,c>>7,l>>7,e.A.Kc,n,0),t+=u,i+=y,l+=d,c+=p,n+=e.A.zc}else if(s=i<<=16,f=c<<=15,n<0&&(s-=u*n,i-=y*n,f-=d*n,c-=p*n,n=0),t<<=16,l<<=15,h<0&&(t-=w*h,l-=A*h,h=0),a-=h,h-=n,n=o.wA[n],u<y)for(;;){if(--h<0)for(;;){if(--a<0)return;this.gD(t>>16,i>>16,l>>7,c>>7,e.A.Kc,n,0),t+=w,i+=y,l+=A,c+=p,n+=e.A.zc}this.gD(s>>16,i>>16,f>>7,c>>7,e.A.Kc,n,0),s+=u,i+=y,f+=d,c+=p,n+=e.A.zc}else for(;;){if(--h<0)for(;;){if(--a<0)return;this.gD(i>>16,t>>16,c>>7,l>>7,e.A.Kc,n,0),t+=w,i+=y,l+=A,c+=p,n+=e.A.zc}this.gD(i>>16,s>>16,c>>7,f>>7,e.A.Kc,n,0),s+=u,i+=y,f+=d,c+=p,n+=e.A.zc}}else if(a<e.A.bottom)if(h>e.A.bottom&&(h=e.A.bottom),n>e.A.bottom&&(n=e.A.bottom),h<n)if(i=s<<=16,c=f<<=15,a<0&&(i-=y*a,s-=w*a,c-=p*a,f-=A*a,a=0),t<<=16,l<<=15,h<0&&(t-=u*h,l-=d*h,h=0),n-=h,h-=a,a=o.wA[a],y<w)for(;;){if(--h<0)for(;;){if(--n<0)return;this.gD(i>>16,t>>16,c>>7,l>>7,e.A.Kc,a,0),i+=y,t+=u,c+=p,l+=d,a+=e.A.zc}this.gD(i>>16,s>>16,c>>7,f>>7,e.A.Kc,a,0),i+=y,s+=w,c+=p,f+=A,a+=e.A.zc}else for(;;){if(--h<0)for(;;){if(--n<0)return;this.gD(t>>16,i>>16,l>>7,c>>7,e.A.Kc,a,0),i+=y,t+=u,c+=p,l+=d,a+=e.A.zc}this.gD(s>>16,i>>16,f>>7,c>>7,e.A.Kc,a,0),i+=y,s+=w,c+=p,f+=A,a+=e.A.zc}else if(t=s<<=16,l=f<<=15,a<0&&(t-=y*a,s-=w*a,l-=p*a,f-=A*a,a=0),i<<=16,c<<=15,n<0&&(i-=u*n,c-=d*n,n=0),h-=n,n-=a,a=o.wA[a],y<w)for(;;){if(--n<0)for(;;){if(--h<0)return;this.gD(i>>16,s>>16,c>>7,f>>7,e.A.Kc,a,0),i+=u,s+=w,c+=d,f+=A,a+=e.A.zc}this.gD(t>>16,s>>16,l>>7,f>>7,e.A.Kc,a,0),t+=y,s+=w,l+=p,f+=A,a+=e.A.zc}else for(;;){if(--n<0)for(;;){if(--h<0)return;this.gD(s>>16,i>>16,f>>7,c>>7,e.A.Kc,a,0),i+=u,s+=w,c+=d,f+=A,a+=e.A.zc}this.gD(s>>16,t>>16,f>>7,l>>7,e.A.Kc,a,0),t+=y,s+=w,l+=p,f+=A,a+=e.A.zc}};static gD=(t,i,s,h,n,r,a)=>{let l;if(o.VI){let c;if(o.gL){if(c=i-t>3?(h-s)/(i-t)|0:0,i>e.A.CL&&(i=e.A.CL),t<0&&(s-=t*c,t=0),t>=i)return;r+=t,a=i-t>>2,c<<=2}else{if(!(t<i))return;r+=t,c=(a=i-t>>2)>0?(h-s)*o.oD[a]>>15:0}if(0===o.alpha)for(;;){if(--a<0){if((a=i-t&3)>0){l=o.palette[s>>8];do{n[r++]=l,a--}while(a>0);return}break}l=o.palette[s>>8],s+=c,n[r++]=l,n[r++]=l,n[r++]=l,n[r++]=l}else{const e=o.alpha,h=256-o.alpha;for(;;){if(--a<0){if((a=i-t&3)>0){l=o.palette[s>>8],l=((16711935&l)*h>>8&16711935)+((65280&l)*h>>8&65280);do{n[r++]=l+((16711935&n[r])*e>>8&16711935)+((65280&n[r])*e>>8&65280),a--}while(a>0)}break}l=o.palette[s>>8],s+=c,l=((16711935&l)*h>>8&16711935)+((65280&l)*h>>8&65280),n[r++]=l+((16711935&n[r])*e>>8&16711935)+((65280&n[r])*e>>8&65280),n[r++]=l+((16711935&n[r])*e>>8&16711935)+((65280&n[r])*e>>8&65280),n[r++]=l+((16711935&n[r])*e>>8&16711935)+((65280&n[r])*e>>8&65280),n[r++]=l+((16711935&n[r])*e>>8&16711935)+((65280&n[r])*e>>8&65280)}}}else if(t<i){const c=(h-s)/(i-t)|0;if(o.gL&&(i>e.A.CL&&(i=e.A.CL),t<0&&(s-=t*c,t=0),t>=i))return;if(r+=t,a=i-t,0===o.alpha)do{n[r++]=o.palette[s>>8],s+=c,a--}while(a>0);else{const t=o.alpha,i=256-o.alpha;do{l=o.palette[s>>8],s+=c,l=((16711935&l)*i>>8&16711935)+((65280&l)*i>>8&65280),n[r++]=l+((16711935&n[r])*t>>8&16711935)+((65280&n[r])*t>>8&65280),a--}while(a>0)}}};static CD=(t,i,s,h,n,o,a)=>{if(r.A.CD(t,i,s,h,n,o,a))return;let l=0;n!==h&&(l=(i-t<<16)/(n-h)|0);let c=0;o!==n&&(c=(s-i<<16)/(o-n)|0);let f=0;if(o!==h&&(f=(t-s<<16)/(h-o)|0),h<=n&&h<=o){if(h<e.A.bottom)if(n>e.A.bottom&&(n=e.A.bottom),o>e.A.bottom&&(o=e.A.bottom),n<o)if(s=t<<=16,h<0&&(s-=f*h,t-=l*h,h=0),i<<=16,n<0&&(i-=c*n,n=0),h!==n&&f<l||h===n&&f>c)for(o-=n,n-=h,h=this.wA[h];;){if(--n<0)for(;;){if(--o<0)return;this.SD(s>>16,i>>16,e.A.Kc,h,a),s+=f,i+=c,h+=e.A.zc}this.SD(s>>16,t>>16,e.A.Kc,h,a),s+=f,t+=l,h+=e.A.zc}else for(o-=n,n-=h,h=this.wA[h];;){if(--n<0)for(;;){if(--o<0)return;this.SD(i>>16,s>>16,e.A.Kc,h,a),s+=f,i+=c,h+=e.A.zc}this.SD(t>>16,s>>16,e.A.Kc,h,a),s+=f,t+=l,h+=e.A.zc}else if(i=t<<=16,h<0&&(i-=f*h,t-=l*h,h=0),s<<=16,o<0&&(s-=c*o,o=0),h!==o&&f<l||h===o&&c>l)for(n-=o,o-=h,h=this.wA[h];;){if(--o<0)for(;;){if(--n<0)return;this.SD(s>>16,t>>16,e.A.Kc,h,a),s+=c,t+=l,h+=e.A.zc}this.SD(i>>16,t>>16,e.A.Kc,h,a),i+=f,t+=l,h+=e.A.zc}else for(n-=o,o-=h,h=this.wA[h];;){if(--o<0)for(;;){if(--n<0)return;this.SD(t>>16,s>>16,e.A.Kc,h,a),s+=c,t+=l,h+=e.A.zc}this.SD(t>>16,i>>16,e.A.Kc,h,a),i+=f,t+=l,h+=e.A.zc}}else if(n<=o){if(n<e.A.bottom)if(o>e.A.bottom&&(o=e.A.bottom),h>e.A.bottom&&(h=e.A.bottom),o<h)if(t=i<<=16,n<0&&(t-=l*n,i-=c*n,n=0),s<<=16,o<0&&(s-=f*o,o=0),n!==o&&l<c||n===o&&l>f)for(h-=o,o-=n,n=this.wA[n];;){if(--o<0)for(;;){if(--h<0)return;this.SD(t>>16,s>>16,e.A.Kc,n,a),t+=l,s+=f,n+=e.A.zc}this.SD(t>>16,i>>16,e.A.Kc,n,a),t+=l,i+=c,n+=e.A.zc}else for(h-=o,o-=n,n=this.wA[n];;){if(--o<0)for(;;){if(--h<0)return;this.SD(s>>16,t>>16,e.A.Kc,n,a),t+=l,s+=f,n+=e.A.zc}this.SD(i>>16,t>>16,e.A.Kc,n,a),t+=l,i+=c,n+=e.A.zc}else if(s=i<<=16,n<0&&(s-=l*n,i-=c*n,n=0),t<<=16,h<0&&(t-=f*h,h=0),l<c)for(o-=h,h-=n,n=this.wA[n];;){if(--h<0)for(;;){if(--o<0)return;this.SD(t>>16,i>>16,e.A.Kc,n,a),t+=f,i+=c,n+=e.A.zc}this.SD(s>>16,i>>16,e.A.Kc,n,a),s+=l,i+=c,n+=e.A.zc}else for(o-=h,h-=n,n=this.wA[n];;){if(--h<0)for(;;){if(--o<0)return;this.SD(i>>16,t>>16,e.A.Kc,n,a),t+=f,i+=c,n+=e.A.zc}this.SD(i>>16,s>>16,e.A.Kc,n,a),s+=l,i+=c,n+=e.A.zc}}else if(o<e.A.bottom)if(h>e.A.bottom&&(h=e.A.bottom),n>e.A.bottom&&(n=e.A.bottom),h<n)if(i=s<<=16,o<0&&(i-=c*o,s-=f*o,o=0),t<<=16,h<0&&(t-=l*h,h=0),c<f)for(n-=h,h-=o,o=this.wA[o];;){if(--h<0)for(;;){if(--n<0)return;this.SD(i>>16,t>>16,e.A.Kc,o,a),i+=c,t+=l,o+=e.A.zc}this.SD(i>>16,s>>16,e.A.Kc,o,a),i+=c,s+=f,o+=e.A.zc}else for(n-=h,h-=o,o=this.wA[o];;){if(--h<0)for(;;){if(--n<0)return;this.SD(t>>16,i>>16,e.A.Kc,o,a),i+=c,t+=l,o+=e.A.zc}this.SD(s>>16,i>>16,e.A.Kc,o,a),i+=c,s+=f,o+=e.A.zc}else if(t=s<<=16,o<0&&(t-=c*o,s-=f*o,o=0),i<<=16,n<0&&(i-=l*n,n=0),c<f)for(h-=n,n-=o,o=this.wA[o];;){if(--n<0)for(;;){if(--h<0)return;this.SD(i>>16,s>>16,e.A.Kc,o,a),i+=l,s+=f,o+=e.A.zc}this.SD(t>>16,s>>16,e.A.Kc,o,a),t+=c,s+=f,o+=e.A.zc}else for(h-=n,n-=o,o=this.wA[o];;){if(--n<0)for(;;){if(--h<0)return;this.SD(s>>16,i>>16,e.A.Kc,o,a),i+=l,s+=f,o+=e.A.zc}this.SD(s>>16,t>>16,e.A.Kc,o,a),t+=c,s+=f,o+=e.A.zc}};static BL=(t,i,s,h,n,o,a,l,c,f,u,d,y,p,w,A,x,g,C)=>{if(r.A.BL(t,i,s,h,n,o,a,l,c,f,u,d,y,p,w,A,x,g,C))return;const S=this.mD(C);this.yD=!this.pD[C];const m=f-y,v=u-w,B=d-x,b=p-f,I=A-u,E=g-d;let _=b*u-I*f<<14;const T=I*d-E*u<<8,O=E*f-b*d<<5;let L=m*u-v*f<<14;const R=v*d-B*u<<8,D=B*f-m*d<<5;let k=v*b-m*I<<14;const M=B*I-v*E<<8,U=m*E-B*b<<5;let P=0,N=0;n!==h&&(P=(i-t<<16)/(n-h)|0,N=(l-a<<16)/(n-h)|0);let F=0,V=0;o!==n&&(F=(s-i<<16)/(o-n)|0,V=(c-l<<16)/(o-n)|0);let G=0,W=0;if(o!==h&&(G=(t-s<<16)/(h-o)|0,W=(a-c<<16)/(h-o)|0),h<=n&&h<=o){if(h<e.A.bottom)if(n>e.A.bottom&&(n=e.A.bottom),o>e.A.bottom&&(o=e.A.bottom),n<o){s=t<<=16,c=a<<=16,h<0&&(s-=G*h,t-=P*h,c-=W*h,a-=N*h,h=0),i<<=16,l<<=16,n<0&&(i-=F*n,l-=V*n,n=0);const r=h-this.kl;if(_+=O*r,L+=D*r,k+=U*r,_|=0,L|=0,k|=0,h!==n&&G<P||h===n&&G>F)for(o-=n,n-=h,h=this.wA[h];;){if(--n<0)for(;;){if(--o<0)return;this.vD(s>>16,i>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,c>>8,l>>8),s+=G,i+=F,c+=W,l+=V,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(s>>16,t>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,c>>8,a>>8),s+=G,t+=P,c+=W,a+=N,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}else for(o-=n,n-=h,h=this.wA[h];;){if(--n<0)for(;;){if(--o<0)return;this.vD(i>>16,s>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,l>>8,c>>8),s+=G,i+=F,c+=W,l+=V,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(t>>16,s>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,a>>8,c>>8),s+=G,t+=P,c+=W,a+=N,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}}else{i=t<<=16,l=a<<=16,h<0&&(i-=G*h,t-=P*h,l-=W*h,a-=N*h,h=0),s<<=16,c<<=16,o<0&&(s-=F*o,c-=V*o,o=0);const r=h-this.kl;if(_+=O*r,L+=D*r,k+=U*r,_|=0,L|=0,k|=0,(h===o||G>=P)&&(h!==o||F<=P))for(n-=o,o-=h,h=this.wA[h];;){if(--o<0)for(;;){if(--n<0)return;this.vD(t>>16,s>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,a>>8,c>>8),s+=F,t+=P,c+=V,a+=N,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(t>>16,i>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,a>>8,l>>8),i+=G,t+=P,l+=W,a+=N,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}else for(n-=o,o-=h,h=this.wA[h];;){if(--o<0)for(;;){if(--n<0)return;this.vD(s>>16,t>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,c>>8,a>>8),s+=F,t+=P,c+=V,a+=N,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(i>>16,t>>16,e.A.Kc,h,S,0,0,_,L,k,T,R,M,l>>8,a>>8),i+=G,t+=P,l+=W,a+=N,h+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}}}else if(n<=o){if(n<e.A.bottom)if(o>e.A.bottom&&(o=e.A.bottom),h>e.A.bottom&&(h=e.A.bottom),o<h){t=i<<=16,a=l<<=16,n<0&&(t-=P*n,i-=F*n,a-=N*n,l-=V*n,n=0),s<<=16,c<<=16,o<0&&(s-=G*o,c-=W*o,o=0);const r=n-this.kl;if(_+=O*r,L+=D*r,k+=U*r,_|=0,L|=0,k|=0,n!==o&&P<F||n===o&&P>G)for(h-=o,o-=n,n=this.wA[n];;){if(--o<0)for(;;){if(--h<0)return;this.vD(t>>16,s>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,a>>8,c>>8),t+=P,s+=G,a+=N,c+=W,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(t>>16,i>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,a>>8,l>>8),t+=P,i+=F,a+=N,l+=V,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}else for(h-=o,o-=n,n=this.wA[n];;){if(--o<0)for(;;){if(--h<0)return;this.vD(s>>16,t>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,c>>8,a>>8),t+=P,s+=G,a+=N,c+=W,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(i>>16,t>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,l>>8,a>>8),t+=P,i+=F,a+=N,l+=V,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}}else{s=i<<=16,c=l<<=16,n<0&&(s-=P*n,i-=F*n,c-=N*n,l-=V*n,n=0),t<<=16,a<<=16,h<0&&(t-=G*h,a-=W*h,h=0);const r=n-this.kl;if(_+=O*r,L+=D*r,k+=U*r,_|=0,L|=0,k|=0,o-=h,h-=n,n=this.wA[n],P<F)for(;;){if(--h<0)for(;;){if(--o<0)return;this.vD(t>>16,i>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,a>>8,l>>8),t+=G,i+=F,a+=W,l+=V,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(s>>16,i>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,c>>8,l>>8),s+=P,i+=F,c+=N,l+=V,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}else for(;;){if(--h<0)for(;;){if(--o<0)return;this.vD(i>>16,t>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,l>>8,a>>8),t+=G,i+=F,a+=W,l+=V,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(i>>16,s>>16,e.A.Kc,n,S,0,0,_,L,k,T,R,M,l>>8,c>>8),s+=P,i+=F,c+=N,l+=V,n+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}}}else if(o<e.A.bottom)if(h>e.A.bottom&&(h=e.A.bottom),n>e.A.bottom&&(n=e.A.bottom),h<n){i=s<<=16,l=c<<=16,o<0&&(i-=F*o,s-=G*o,l-=V*o,c-=W*o,o=0),t<<=16,a<<=16,h<0&&(t-=P*h,a-=N*h,h=0);const r=o-this.kl;if(_+=O*r,L+=D*r,k+=U*r,_|=0,L|=0,k|=0,n-=h,h-=o,o=this.wA[o],F<G)for(;;){if(--h<0)for(;;){if(--n<0)return;this.vD(i>>16,t>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,l>>8,a>>8),i+=F,t+=P,l+=V,a+=N,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(i>>16,s>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,l>>8,c>>8),i+=F,s+=G,l+=V,c+=W,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}else for(;;){if(--h<0)for(;;){if(--n<0)return;this.vD(t>>16,i>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,a>>8,l>>8),i+=F,t+=P,l+=V,a+=N,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(s>>16,i>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,c>>8,l>>8),i+=F,s+=G,l+=V,c+=W,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}}else{t=s<<=16,a=c<<=16,o<0&&(t-=F*o,s-=G*o,a-=V*o,c-=W*o,o=0),i<<=16,l<<=16,n<0&&(i-=P*n,l-=N*n,n=0);const r=o-this.kl;if(_+=O*r,L+=D*r,k+=U*r,_|=0,L|=0,k|=0,h-=n,n-=o,o=this.wA[o],F<G)for(;;){if(--n<0)for(;;){if(--h<0)return;this.vD(i>>16,s>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,l>>8,c>>8),i+=P,s+=G,l+=N,c+=W,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(t>>16,s>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,a>>8,c>>8),t+=F,s+=G,a+=V,c+=W,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}else for(;;){if(--n<0)for(;;){if(--h<0)return;this.vD(s>>16,i>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,c>>8,l>>8),i+=P,s+=G,l+=N,c+=W,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}this.vD(s>>16,t>>16,e.A.Kc,o,S,0,0,_,L,k,T,R,M,c>>8,a>>8),t+=F,s+=G,a+=V,c+=W,o+=e.A.zc,_+=O,L+=D,k+=U,_|=0,L|=0,k|=0}}};static vD=(t,i,s,h,n,r,o,a,l,c,f,u,d,y,p)=>{if(t>=i)return;let w,A,x,g,C,S,m,v,B;if(this.gL){if(w=(p-y)/(i-t)|0,i>e.A.CL&&(i=e.A.CL),t<0&&(y-=t*w,t=0),t>=i)return;A=i-t>>3,w<<=12}else i-t>7?(A=i-t>>3,w=(p-y)*this.oD[A]>>6):(A=0,w=0);if(y<<=9,h+=t,this.Bt&&n)if(x=0,g=0,S=t-this.Dl,a+=(f>>3)*S,l+=(u>>3)*S,c+=(d>>3)*S,a|=0,l|=0,C=(c|=0)>>12,0!==C&&(o=l/C|0,(r=a/C|0)<0?r=0:r>4032&&(r=4032)),a+=f,l+=u,c+=d,a|=0,l|=0,C=(c|=0)>>12,0!==C&&(x=a/C|0,g=l/C|0,x<7?x=7:x>4032&&(x=4032)),m=x-r>>3,v=g-o>>3,r+=y>>3&786432,B=y>>23,this.yD){for(;A-- >0;)s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v,s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v,s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v,s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v,s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v,s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v,s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v,s[h++]=n[(4032&o)+(r>>6)]>>>B,r=x,o=g,a+=f,l+=u,C=(c+=d)>>12,0!==C&&(x=a/C|0,g=l/C|0,x<7?x=7:x>4032&&(x=4032)),m=x-r>>3,v=g-o>>3,r+=(y+=w)>>3&786432,B=y>>23;for(A=i-t&7;A-- >0;)s[h++]=n[(4032&o)+(r>>6)]>>>B,r+=m,o+=v}else{for(;A-- >0;){let t;0!=(t=n[(4032&o)+(r>>6)]>>>B)&&(s[h]=t),h+=1,0!=(t=n[(4032&(o+=v))+((r+=m)>>6)]>>>B)&&(s[h]=t),h++,0!=(t=n[(4032&(o+=v))+((r+=m)>>6)]>>>B)&&(s[h]=t),h++,0!=(t=n[(4032&(o+=v))+((r+=m)>>6)]>>>B)&&(s[h]=t),h++,0!=(t=n[(4032&(o+=v))+((r+=m)>>6)]>>>B)&&(s[h]=t),h++,0!=(t=n[(4032&(o+=v))+((r+=m)>>6)]>>>B)&&(s[h]=t),h++,0!=(t=n[(4032&(o+=v))+((r+=m)>>6)]>>>B)&&(s[h]=t),h++,0!=(t=n[(4032&(o+=v))+((r+=m)>>6)]>>>B)&&(s[h]=t),h+=1,r=x,o=g,a+=f,l+=u,c+=d,a|=0,l|=0,C=(c|=0)>>12,0!==C&&(x=a/C|0,g=l/C|0,x<7?x=7:x>4032&&(x=4032)),m=x-r>>3,v=g-o>>3,r+=(y+=w)>>3&786432,B=y>>23}for(A=i-t&7;A-- >0;){let t;0!=(t=n[(4032&o)+(r>>6)]>>>B)&&(s[h]=t),h++,r+=m,o+=v}}else if(x=0,g=0,S=t-this.Dl,a+=(f>>3)*S,l+=(u>>3)*S,c+=(d>>3)*S,a|=0,l|=0,C=(c|=0)>>14,0!==C&&(o=l/C|0,(r=a/C|0)<0?r=0:r>16256&&(r=16256)),a+=f,l+=u,c+=d,a|=0,l|=0,C=(c|=0)>>14,0!==C&&(x=a/C|0,g=l/C|0,x<7?x=7:x>16256&&(x=16256)),m=x-r>>3,v=g-o>>3,r+=6291456&y,B=y>>23,this.yD&&n){for(;A-- >0;)s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v,s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v,s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v,s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v,s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v,s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v,s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v,s[h++]=n[(16256&o)+(r>>7)]>>>B,r=x,o=g,a+=f,l+=u,c+=d,a|=0,l|=0,C=(c|=0)>>14,0!==C&&(x=a/C|0,g=l/C|0,x<7?x=7:x>16256&&(x=16256)),m=x-r>>3,v=g-o>>3,r+=6291456&(y+=w),B=y>>23;for(A=i-t&7;A-- >0;)s[h++]=n[(16256&o)+(r>>7)]>>>B,r+=m,o+=v}else{for(;A-- >0&&n;){let t;0!=(t=n[(16256&o)+(r>>7)]>>>B)&&(s[h]=t),h+=1,0!=(t=n[(16256&(o+=v))+((r+=m)>>7)]>>>B)&&(s[h]=t),h++,0!=(t=n[(16256&(o+=v))+((r+=m)>>7)]>>>B)&&(s[h]=t),h++,0!=(t=n[(16256&(o+=v))+((r+=m)>>7)]>>>B)&&(s[h]=t),h++,0!=(t=n[(16256&(o+=v))+((r+=m)>>7)]>>>B)&&(s[h]=t),h++,0!=(t=n[(16256&(o+=v))+((r+=m)>>7)]>>>B)&&(s[h]=t),h++,0!=(t=n[(16256&(o+=v))+((r+=m)>>7)]>>>B)&&(s[h]=t),h++,0!=(t=n[(16256&(o+=v))+((r+=m)>>7)]>>>B)&&(s[h]=t),h++,r=x,o=g,a+=f,l+=u,c+=d,a|=0,l|=0,C=(c|=0)>>14,0!==C&&(x=a/C|0,g=l/C|0,x<7?x=7:x>16256&&(x=16256)),m=x-r>>3,v=g-o>>3,r+=6291456&(y+=w),B=y>>23}for(A=i-t&7;A-- >0&&n;){let t;0!=(t=n[(16256&o)+(r>>7)]>>>B)&&(s[h]=t),h++,r+=m,o+=v}}};static SD=(t,i,s,h,n)=>{if(this.gL&&(i>e.A.CL&&(i=e.A.CL),t<0&&(t=0)),t>=i)return;h+=t;let r=i-t>>2;if(0===this.alpha)for(;;){if(r--,r<0)for(r=i-t&3;;){if(r--,r<0)return;s[h++]=n}s[h++]=n,s[h++]=n,s[h++]=n,s[h++]=n}const o=this.alpha,a=256-this.alpha;for(n=((16711935&n)*a>>8&16711935)+((65280&n)*a>>8&65280);;){if(r--,r<0)for(r=i-t&3;;){if(r--,r<0)return;s[h++]=n+((16711935&s[h])*o>>8&16711935)+((65280&s[h])*o>>8&65280)}s[h++]=n+((16711935&s[h])*o>>8&16711935)+((65280&s[h])*o>>8&65280),s[h++]=n+((16711935&s[h])*o>>8&16711935)+((65280&s[h])*o>>8&65280),s[h++]=n+((16711935&s[h])*o>>8&16711935)+((65280&s[h])*o>>8&65280),s[h++]=n+((16711935&s[h])*o>>8&16711935)+((65280&s[h])*o>>8&65280)}};static jv=t=>{this.fD[t]&&this.cD&&(this.cD[this.uD++]=this.fD[t],this.fD[t]=null),r.A.BD(t)};static mD=t=>{if(this.Kv[t]=this.Kx++,this.fD[t])return this.fD[t];let i;if(this.uD>0&&this.cD)i=this.cD[--this.uD],this.cD[this.uD]=null;else{let t=0,s=-1;for(let i=0;i<this.lD;i++)this.fD[i]&&(this.Kv[i]<t||-1===s)&&(t=this.Kv[i],s=i);i=this.fD[s],this.fD[s]=null}this.fD[t]=i;const s=this.Zv[t],e=this.dD[t];if(!i||!s||!e)return null;if(this.Bt){this.pD[t]=!1;for(let h=0;h<4096;h++){const n=i[h]=16316671&e[s.Kc[h]];0===n&&(this.pD[t]=!0),i[h+4096]=n-(n>>>3)&16316671,i[h+8192]=n-(n>>>2)&16316671,i[h+12288]=n-(n>>>2)-(n>>>3)&16316671}}else{if(64===s.width)for(let t=0;t<128;t++)for(let h=0;h<128;h++)i[h+(t<<7)]=e[s.Kc[(h>>1)+(t>>1<<6)]];else for(let t=0;t<16384;t++)i[t]=e[s.Kc[t]];this.pD[t]=!1;for(let s=0;s<16384;s++){i[s]&=16316671;const e=i[s];0===e&&(this.pD[t]=!0),i[s+16384]=e-(e>>>3)&16316671,i[s+32768]=e-(e>>>2)&16316671,i[s+49152]=e-(e>>>2)-(e>>>3)&16316671}}return i}}},8665:(t,i,s)=>{s.d(i,{A:()=>u});var e=s(1069),h=s(8950),n=s(4583),r=s(6730),o=s(4474),a=s(3867),l=s(5868);class c{vI=0;QO=0;bD=0;ID=-1;ED=-1;_D=-1;TD=-1;OD=-1;LD=-1;RD=-1;DD=-1;kD=-1;MD=0;UD=-1;PD=-1;ND=-1;data=null}class f{x=0;y=0;z=0;w=0}class u extends o.A{static metadata=null;static head=null;static FD=null;static VD=null;static GD=null;static WD=null;static YD=null;static HD=null;static zD=null;static XD=null;static KD=null;static ZD=null;static jD=null;static qD=null;static axis=null;static $D=new a.Ps(4096,!1);static JD=new a.Ps(4096,!1);static QD=new Int32Array(4096);static tk=new Int32Array(4096);static ik=new Int32Array(4096);static sk=new Int32Array(4096);static ek=new Int32Array(4096);static hk=new Int32Array(4096);static nk=new Int32Array(1500);static rk=new a.wr(1500,512);static ak=new Int32Array(12);static lk=new a.wr(12,2e3);static ck=new Int32Array(2e3);static fk=new Int32Array(2e3);static uk=new Int32Array(12);static dk=new Int32Array(10);static yk=new Int32Array(10);static pk=new Int32Array(10);static Yn=0;static wk=0;static Hn=0;static Zx=!1;static ol=0;static al=0;static jx=0;static xm=new Int32Array(1e3);static Ak=!1;static Dy(t){try{u.head=new e.A(t.read('ob_head.dat')),u.FD=new e.A(t.read('ob_face1.dat')),u.VD=new e.A(t.read('ob_face2.dat')),u.GD=new e.A(t.read('ob_face3.dat')),u.WD=new e.A(t.read('ob_face4.dat')),u.YD=new e.A(t.read('ob_face5.dat')),u.HD=new e.A(t.read('ob_point1.dat')),u.zD=new e.A(t.read('ob_point2.dat')),u.XD=new e.A(t.read('ob_point3.dat')),u.KD=new e.A(t.read('ob_point4.dat')),u.ZD=new e.A(t.read('ob_point5.dat')),u.jD=new e.A(t.read('ob_vertex1.dat')),u.qD=new e.A(t.read('ob_vertex2.dat')),u.axis=new e.A(t.read('ob_axis.dat')),u.head.ft=0,u.HD.ft=0,u.zD.ft=0,u.XD.ft=0,u.KD.ft=0,u.jD.ft=0,u.qD.ft=0;const i=u.head.ct;u.metadata=new a.Ps(i+100,null);let s=0,h=0,n=0,r=0,o=0,l=0,f=0;for(let t=0;t<i;t++){const t=u.head.ct,i=new c;i.vI=u.head.ct,i.QO=u.head.ct,i.bD=u.head.kc,i.ID=u.HD.ft,i.ED=u.zD.ft,i._D=u.XD.ft,i.TD=u.KD.ft,i.LD=u.jD.ft,i.RD=u.qD.ft;const e=u.head.kc,a=u.head.kc,d=u.head.kc,y=u.head.kc,p=u.head.kc;for(let t=0;t<i.vI;t++){const t=u.HD.kc;1&t&&u.zD.$p,2&t&&u.XD.$p,4&t&&u.KD.$p}for(let t=0;t<i.QO;t++){1===u.qD.kc&&(u.jD.$p,u.jD.$p),u.jD.$p}i.DD=n,n+=2*i.QO,1===e&&(i.kD=r,r+=i.QO),255===a?(i.MD=o,o+=i.QO):i.MD=-a-1,1===d&&(i.UD=l,l+=i.QO),1===y&&(i.PD=f,f+=i.QO),1===p&&(i.OD=h,h+=i.vI),i.ND=s,s+=i.bD,u.metadata[t]=i}}catch(t){console.log('Error loading model index'),console.error(t)}}static xk(t,i){if(null===u.metadata&&(u.metadata=[]),null===t){const t=new c;return t.vI=0,t.QO=0,t.bD=0,void(u.metadata[i]=t)}const s=new e.A(t);s.ft=s.length-18;const h=new c;h.data=t,h.vI=s.ct,h.QO=s.ct,h.bD=s.kc,u.metadata[i]=h;const n=s.kc,r=s.kc,o=s.kc,a=s.kc,l=s.kc,f=s.ct,d=s.ct,y=s.ct,p=s.ct;let w=0;h.ID=w,w+=h.vI,h.RD=w,w+=h.QO,h.MD=w,255===r?w+=h.QO:h.MD=-r-1,h.PD=w,1===a?w+=h.QO:h.PD=-1,h.kD=w,1===n?w+=h.QO:h.kD=-1,h.OD=w,1===l?w+=h.vI:h.OD=-1,h.UD=w,1===o?w+=h.QO:h.UD=-1,h.LD=w,w+=p,h.DD=w,w+=2*h.QO,h.ND=w,w+=6*h.bD,h.ED=w,w+=f,h._D=w,w+=d,h.TD=w,w+=y}static $o(){u.metadata=null,u.head=null,u.FD=null,u.VD=null,u.GD=null,u.WD=null,u.YD=null,u.HD=null,u.zD=null,u.XD=null,u.KD=null,u.ZD=null,u.jD=null,u.qD=null,u.axis=null,u.$D=null,u.JD=null,u.QD=null,u.tk=null,u.ik=null,u.sk=null,u.ek=null,u.hk=null,u.nk=null,u.rk=null,u.ak=null,u.lk=null,u.ck=null,u.fk=null,u.uk=null}static gk(t,i,s){return 2&~s?((i=i*(127&t)>>7)<2?i=2:i>126&&(i=126),(65408&t)+i):(i<0?i=0:i>127&&(i=127),127-i)}static mI=(t,i,s)=>{const e=t.vI,h=t.QO,n=t.bD;let r,o,l,c,d;if(i){r=new Int32Array(e);for(let i=0;i<e;i++)r[i]=t.II[i]}else r=t.II;let y=null,p=null;if(s){o=new Int32Array(h),l=new Int32Array(h),c=new Int32Array(h);for(let i=0;i<h;i++)t.Ck&&(o[i]=t.Ck[i]),t.Sk&&(l[i]=t.Sk[i]),t.mk&&(c[i]=t.mk[i]);if(d=new Int32Array(h),t.JO)for(let i=0;i<h;i++)d[i]=t.JO[i];else for(let t=0;t<h;t++)d[t]=0;y=new a.Ps(e,null);for(let i=0;i<e;i++){const s=y[i]=new f;if(t.XO){const e=t.XO[i];e&&(s.x=e.x,s.y=e.y,s.z=e.z,s.w=e.w)}}p=t.$O}else o=t.Ck,l=t.Sk,c=t.mk,d=t.JO;return new u({vI:e,BI:t.BI,II:r,bI:t.bI,QO:h,tL:t.tL,iL:t.iL,sL:t.sL,Ck:o,Sk:l,mk:c,JO:d,vk:t.vk,Bk:t.Bk,Nb:t.Nb,priority:t.priority,bD:n,bk:t.bk,Ik:t.Ik,Ek:t.Ek,Y_:t.Y_,H_:t.H_,z_:t.z_,X_:t.X_,k_:t.k_,K_:t.K_,Yw:t.Yw,_k:t._k,Tk:t.Tk,XO:y,$O:p})};static bw=(t,i,s,e)=>{const h=t.vI,n=t.QO,r=t.bD;let o,a,l,c,f;if(e)o=t.BI,a=t.II,l=t.bI;else{o=new Int32Array(h),a=new Int32Array(h),l=new Int32Array(h);for(let i=0;i<h;i++)o[i]=t.BI[i],a[i]=t.II[i],l[i]=t.bI[i]}if(i)c=t.Nb;else{c=new Int32Array(n);for(let i=0;i<n;i++)t.Nb&&(c[i]=t.Nb[i])}if(s)f=t.Bk;else if(f=new Int32Array(n),t.Bk)for(let i=0;i<n;i++)f[i]=t.Bk[i];else for(let t=0;t<n;t++)f[t]=0;return new u({vI:h,BI:o,II:a,bI:l,QO:n,tL:t.tL,iL:t.iL,sL:t.sL,Ck:null,Sk:null,mk:null,JO:t.JO,vk:t.vk,Bk:f,Nb:c,priority:t.priority,bD:r,bk:t.bk,Ik:t.Ik,Ek:t.Ek,Ok:t.Ok,Lk:t.Lk})};static OI=(t,i)=>{const s=t.vI,e=t.QO,h=t.bD,n=new Int32Array(s),r=new Int32Array(s),o=new Int32Array(s);for(let i=0;i<s;i++)n[i]=t.BI[i],r[i]=t.II[i],o[i]=t.bI[i];let a;if(i)a=t.Bk;else if(a=new Int32Array(e),t.Bk)for(let i=0;i<e;i++)a[i]=t.Bk[i];else for(let t=0;t<e;t++)a[t]=0;return new u({vI:s,BI:n,II:r,bI:o,QO:e,tL:t.tL,iL:t.iL,sL:t.sL,Ck:t.Ck,Sk:t.Sk,mk:t.mk,JO:t.JO,vk:t.vk,Bk:a,Nb:t.Nb,priority:t.priority,bD:h,bk:t.bk,Ik:t.Ik,Ek:t.Ek,Ow:t.Ow,Tw:t.Tw})};static Mw=(t,i)=>{let s=!1,e=!1,h=!1,n=!1,r=0,o=0,a=0,l=-1;for(let c=0;c<i;c++){const i=t[c];i&&(r+=i.vI,o+=i.QO,a+=i.bD,s||=null!==i.JO,i.vk?e=!0:(-1===l&&(l=i.priority),l!==i.priority&&(e=!0)),h||=null!==i.Bk,n||=null!==i.Nb)}const c=new Int32Array(r),f=new Int32Array(r),d=new Int32Array(r),y=new Int32Array(o),p=new Int32Array(o),w=new Int32Array(o),A=new Int32Array(o),x=new Int32Array(o),g=new Int32Array(o),C=new Int32Array(a),S=new Int32Array(a),m=new Int32Array(a);let v=null;s&&(v=new Int32Array(o));let B=null;e&&(B=new Int32Array(o));let b=null;h&&(b=new Int32Array(o));let I=null;n&&(I=new Int32Array(o)),r=0,o=0,a=0;for(let l=0;l<i;l++){const i=t[l];if(i){const t=r;for(let t=0;t<i.vI;t++)c[r]=i.BI[t],f[r]=i.II[t],d[r]=i.bI[t],r++;for(let r=0;r<i.QO;r++)y[o]=i.tL[r]+t,p[o]=i.iL[r]+t,w[o]=i.sL[r]+t,i.Ck&&(A[o]=i.Ck[r]),i.Sk&&(x[o]=i.Sk[r]),i.mk&&(g[o]=i.mk[r]),s&&(i.JO?v&&(v[o]=i.JO[r]):v&&(v[o]=0)),e&&(i.vk?B&&(B[o]=i.vk[r]):B&&(B[o]=i.priority)),h&&(i.Bk?b&&(b[o]=i.Bk[r]):b&&(b[o]=0)),n&&i.Nb&&I&&(I[o]=i.Nb[r]),o++;for(let s=0;s<i.bD;s++)C[a]=i.bk[s]+t,S[a]=i.Ik[s]+t,m[a]=i.Ek[s]+t,a++}}const E=new u({vI:r,BI:c,II:f,bI:d,QO:o,tL:y,iL:p,sL:w,Ck:A,Sk:x,mk:g,JO:v,vk:B,Bk:b,Nb:I,priority:l,bD:a,bk:C,Ik:S,Ek:m});return E.RI(),E};static tc=(t,i)=>{let s=!1,e=!1,h=!1,n=!1,r=0,o=0,a=0,l=-1;for(let c=0;c<i;c++){const i=t[c];i&&(r+=i.vI,o+=i.QO,a+=i.bD,s||=null!==i.JO,i.vk?e=!0:(-1===l&&(l=i.priority),l!==i.priority&&(e=!0)),h||=null!==i.Bk,n||=null!==i.Lk)}const c=new Int32Array(r),f=new Int32Array(r),d=new Int32Array(r),y=new Int32Array(r),p=new Int32Array(o),w=new Int32Array(o),A=new Int32Array(o),x=new Int32Array(a),g=new Int32Array(a),C=new Int32Array(a);let S=null;s&&(S=new Int32Array(o));let m=null;e&&(m=new Int32Array(o));let v=null;h&&(v=new Int32Array(o));let B=null;n&&(B=new Int32Array(o));const b=new Int32Array(o);r=0,o=0,a=0;const I=(t,i,s,e,h,n,r)=>{let o=-1;const a=t.BI[i],l=t.II[i],c=t.bI[i];for(let t=0;t<r;t++)if(a===s[t]&&l===e[t]&&c===h[t]){o=t;break}return-1===o&&(s[r]=a,e[r]=l,h[r]=c,n&&t.Ok&&(n[r]=t.Ok[i]),o=r++),{vertex:o,vI:r}};for(let l=0;l<i;l++){const i=t[l];if(i){for(let t=0;t<i.QO;t++){s&&(i.JO?S&&(S[o]=i.JO[t]):S&&(S[o]=0)),e&&(i.vk?m&&(m[o]=i.vk[t]):m&&(m[o]=i.priority)),h&&(i.Bk?v&&(v[o]=i.Bk[t]):v&&(v[o]=0)),n&&i.Lk&&B&&(B[o]=i.Lk[t]),i.Nb&&(b[o]=i.Nb[t]);const a=I(i,i.tL[t],c,f,d,y,r);r=a.vI;const l=I(i,i.iL[t],c,f,d,y,r);r=l.vI;const u=I(i,i.sL[t],c,f,d,y,r);r=u.vI,p[o]=a.vertex,w[o]=l.vertex,A[o]=u.vertex,o++}for(let t=0;t<i.bD;t++){const s=I(i,i.bk[t],c,f,d,y,r);r=s.vI;const e=I(i,i.Ik[t],c,f,d,y,r);r=e.vI;const h=I(i,i.Ek[t],c,f,d,y,r);r=h.vI,x[a]=s.vertex,g[a]=e.vertex,C[a]=h.vertex,a++}}}return new u({vI:r,BI:c,II:f,bI:d,QO:o,tL:p,iL:w,sL:A,Ck:null,Sk:null,mk:null,JO:S,vk:m,Bk:v,Nb:b,priority:l,bD:a,bk:x,Ik:g,Ek:C,Ok:y,Lk:B})};static model=t=>{if(!u.metadata)throw new Error('cant loading model metadata!!!!!');const i=u.metadata[t];if(!i)throw console.log(`Error model:${t} not found!`),new Error('cant loading model metadata!!!!!');if(!(u.head&&u.FD&&u.VD&&u.GD&&u.WD&&u.YD&&u.HD&&u.zD&&u.XD&&u.KD&&u.ZD&&u.jD&&u.qD&&u.axis))throw new Error('cant loading model!!!!!');const s=i.vI,e=i.QO,h=i.bD,n=new Int32Array(s),r=new Int32Array(s),o=new Int32Array(s),a=new Int32Array(e),l=new Int32Array(e),c=new Int32Array(e),f=new Int32Array(h),d=new Int32Array(h),y=new Int32Array(h);let p=null;i.OD>=0&&(p=new Int32Array(s));let w=null;i.kD>=0&&(w=new Int32Array(e));let A=null,x=0;i.MD>=0?A=new Int32Array(e):x=-i.MD-1;let g=null;i.UD>=0&&(g=new Int32Array(e));let C=null;i.PD>=0&&(C=new Int32Array(e));const S=new Int32Array(e);u.HD.ft=i.ID,u.zD.ft=i.ED,u.XD.ft=i._D,u.KD.ft=i.TD,u.ZD.ft=i.OD;let m,v,B,b=0,I=0,E=0;for(let t=0;t<s;t++){const i=u.HD.kc;m=0,1&i&&(m=u.zD.$p),v=0,2&i&&(v=u.XD.$p),B=0,4&i&&(B=u.KD.$p),n[t]=b+m,r[t]=I+v,o[t]=E+B,b=n[t],I=r[t],E=o[t],p&&(p[t]=u.ZD.kc)}u.FD.ft=i.DD,u.VD.ft=i.kD,u.GD.ft=i.MD,u.WD.ft=i.UD,u.YD.ft=i.PD;for(let t=0;t<e;t++)S[t]=u.FD.ct,w&&(w[t]=u.VD.kc),A&&(A[t]=u.GD.kc),g&&(g[t]=u.WD.kc),C&&(C[t]=u.YD.kc);u.jD.ft=i.LD,u.qD.ft=i.RD,m=0,v=0,B=0;let _=0;for(let t=0;t<e;t++){const i=u.qD.kc;if(1===i)m=u.jD.$p+_,_=m,v=u.jD.$p+_,_=v,B=u.jD.$p+_,_=B;else if(2===i)v=B,B=u.jD.$p+_,_=B;else if(3===i)m=B,B=u.jD.$p+_,_=B;else if(4===i){const t=m;m=v,v=t,B=u.jD.$p+_,_=B}a[t]=m,l[t]=v,c[t]=B}u.axis.ft=6*i.ND;for(let t=0;t<h;t++)f[t]=u.axis.ct,d[t]=u.axis.ct,y[t]=u.axis.ct;return new u({vI:s,BI:n,II:r,bI:o,QO:e,tL:a,iL:l,sL:c,Ck:null,Sk:null,mk:null,JO:w,vk:A,Bk:g,Nb:S,priority:x,bD:h,bk:f,Ik:d,Ek:y,Ok:p,Lk:C})};static Rk=(t,i)=>{if(!u.metadata||!u.metadata[i])throw new Error('No model metadata');const s=u.metadata[i];if(s.data=t,!s.data.length)throw new Error('No model data');const h=s.vI,n=s.QO,r=s.bD,o=new Int32Array(h),a=new Int32Array(h),l=new Int32Array(h),c=new Int32Array(n),f=new Int32Array(n),d=new Int32Array(n),y=new Int32Array(r),p=new Int32Array(r),w=new Int32Array(r);let A=null;s.OD>=0&&(A=new Int32Array(h));let x=null;s.kD>=0&&(x=new Int32Array(n));let g=null,C=0;s.MD>=0?g=new Int32Array(n):C=-s.MD-1;let S=null;s.UD>=0&&(S=new Int32Array(n));let m=null;s.PD>=0&&(m=new Int32Array(n));const v=new Int32Array(n),B=new e.A(s.data);B.ft=s.ID;const b=new e.A(s.data);b.ft=s.ED;const I=new e.A(s.data);I.ft=s._D;const E=new e.A(s.data);E.ft=s.TD;const _=new e.A(s.data);_.ft=s.OD;let T,O,L,R=0,D=0,k=0;for(let t=0;t<h;t++){const i=B.kc;T=0,1&i&&(T=b.$p),O=0,2&i&&(O=I.$p),L=0,4&i&&(L=E.$p),o[t]=R+T,a[t]=D+O,l[t]=k+L,R=o[t],D=a[t],k=l[t],A&&(A[t]=_.kc)}const M=new e.A(s.data);M.ft=s.DD;const U=new e.A(s.data);U.ft=s.kD;const P=new e.A(s.data);P.ft=s.MD;const N=new e.A(s.data);N.ft=s.UD;const F=new e.A(s.data);F.ft=s.PD;for(let t=0;t<n;t++)v[t]=M.ct,x&&(x[t]=U.kc),g&&(g[t]=P.kc),S&&(S[t]=N.kc),m&&(m[t]=F.kc);const V=new e.A(s.data);V.ft=s.LD;const G=new e.A(s.data);G.ft=s.RD,T=0,O=0,L=0;let W=0;for(let t=0;t<n;t++){const i=G.kc;if(1===i)T=V.$p+W,W=T,O=V.$p+W,W=O,L=V.$p+W,W=L;else if(2===i)O=L,L=V.$p+W,W=L;else if(3===i)T=L,L=V.$p+W,W=L;else if(4===i){const t=T;T=O,O=t,L=V.$p+W,W=L}c[t]=T,f[t]=O,d[t]=L}const Y=new e.A(s.data);Y.ft=s.ND;for(let t=0;t<r;t++)y[t]=Y.ct,p[t]=Y.ct,w[t]=Y.ct;return new u({vI:h,BI:o,II:a,bI:l,QO:n,tL:c,iL:f,sL:d,Ck:null,Sk:null,mk:null,JO:x,vk:g,Bk:S,Nb:v,priority:C,bD:r,bk:y,Ik:p,Ek:w,Ok:A,Lk:m})};vI;BI;II;bI;QO;tL;iL;sL;Ck;Sk;mk;JO;vk;Bk;Nb;priority;bD;bk;Ik;Ek;Y_;H_;z_;X_;k_;K_;Yw;_k;Tk;Ok;Lk;Ow;Tw;XO;$O;TI=0;Uw=!1;Dk=-1;kk=-1;constructor(t){super(),this.vI=t.vI,this.BI=t.BI,this.II=t.II,this.bI=t.bI,this.QO=t.QO,this.tL=t.tL,this.iL=t.iL,this.sL=t.sL,this.Ck=t.Ck,this.Sk=t.Sk,this.mk=t.mk,this.JO=t.JO,this.vk=t.vk,this.Bk=t.Bk,this.Nb=t.Nb,this.priority=t.priority,this.bD=t.bD,this.bk=t.bk,this.Ik=t.Ik,this.Ek=t.Ek,this.Y_=t.Y_??0,this.H_=t.H_??0,this.z_=t.z_??0,this.X_=t.X_??0,this.k_=t.k_??0,this.K_=t.K_??0,this.Yw=t.Yw??0,this._k=t._k??0,this.Tk=t.Tk??0,this.Ok=t.Ok??null,this.Lk=t.Lk??null,this.Ow=t.Ow??null,this.Tw=t.Tw??null,this.XO=t.XO??null,this.$O=t.$O??null}RI(){this.Yw=0,this.k_=0,this.K_=0;for(let t=0;t<this.vI;t++){const i=this.BI[t],s=this.II[t],e=this.bI[t];-s>this.Yw&&(this.Yw=-s),s>this.K_&&(this.K_=s);const h=i*i+e*e;h>this.k_&&(this.k_=h)}this.k_=Math.sqrt(this.k_)+.99|0,this.Tk=Math.sqrt(this.k_*this.k_+this.Yw*this.Yw)+.99|0,this._k=this.Tk+(Math.sqrt(this.k_*this.k_+this.K_*this.K_)+.99|0)}EI(){this.Yw=0,this.K_=0;for(let t=0;t<this.vI;t++){const i=this.II[t];-i>this.Yw&&(this.Yw=-i),i>this.K_&&(this.K_=i)}this.Tk=Math.sqrt(this.k_*this.k_+this.Yw*this.Yw)+.99|0,this._k=this.Tk+(Math.sqrt(this.k_*this.k_+this.K_*this.K_)+.99|0)}nc(){if(this.Ok){const t=new Int32Array(256);let i=0;for(let s=0;s<this.vI;s++){const e=this.Ok[s];t[e]++,e>i&&(i=e)}this.Ow=new a.Ps(i+1,null);for(let s=0;s<=i;s++)this.Ow[s]=new Int32Array(t[s]),t[s]=0;let s=0;for(;s<this.vI;){const i=this.Ok[s],e=this.Ow[i];e&&(e[t[i]++]=s++)}this.Ok=null}if(this.Lk){const t=new Int32Array(256);let i=0;for(let s=0;s<this.QO;s++){const e=this.Lk[s];t[e]++,e>i&&(i=e)}this.Tw=new a.Ps(i+1,null);for(let s=0;s<=i;s++)this.Tw[s]=new Int32Array(t[s]),t[s]=0;let s=0;for(;s<this.QO;){const i=this.Lk[s],e=this.Tw[i];e&&(e[t[i]++]=s++)}this.Lk=null}}LI(t,i,s){if(-1!==t)if(s&&-1!==i){const e=r.A.ta[t],h=r.A.ta[i],n=e.$R;u.Yn=0,u.wk=0,u.Hn=0;let o=0,a=s[o++];for(let t=0;t<e.length;t++){if(!e.JR)continue;const i=e.JR[t];for(;i>a;)a=s[o++];n&&n.types&&e.x&&e.y&&e.z&&n.labels&&(i!==a||0===n.types[i])&&this.Mk(e.x[t],e.y[t],e.z[t],n.labels[i],n.types[i])}u.Yn=0,u.wk=0,u.Hn=0,o=0,a=s[o++];for(let t=0;t<h.length;t++){if(!h.JR)continue;const i=h.JR[t];for(;i>a;)a=s[o++];n&&n.types&&h.x&&h.y&&h.z&&n.labels&&(i===a||0===n.types[i])&&this.Mk(h.x[t],h.y[t],h.z[t],n.labels[i],n.types[i])}}else this.rc(t)}rc(t){if(!this.Ow||-1===t||!r.A.ta[t])return;const i=r.A.ta[t],s=i.$R;u.Yn=0,u.wk=0,u.Hn=0;for(let t=0;t<i.length;t++){if(!(i.JR&&i.x&&i.y&&i.z&&s&&s.labels&&s.types))continue;const e=i.JR[t];this.Mk(i.x[t],i.y[t],i.z[t],s.labels[e],s.types[e])}}eA(){for(let t=0;t<this.vI;t++){const i=this.BI[t];this.BI[t]=this.bI[t],this.bI[t]=-i}}iA(t){const i=n.A.sin[t],s=n.A.cos[t];for(let t=0;t<this.vI;t++){const e=this.II[t]*s-this.bI[t]*i>>16;this.bI[t]=this.II[t]*i+this.bI[t]*s>>16,this.II[t]=e}}translate(t,i,s){for(let e=0;e<this.vI;e++)this.BI[e]+=i,this.II[e]+=t,this.bI[e]+=s}ic(t,i){if(this.Nb)for(let s=0;s<this.QO;s++)this.Nb[s]===t&&(this.Nb[s]=i)}_I(){for(let t=0;t<this.vI;t++)this.bI[t]=-this.bI[t];for(let t=0;t<this.QO;t++){const i=this.tL[t];this.tL[t]=this.sL[t],this.sL[t]=i}}scale(t,i,s){for(let e=0;e<this.vI;e++)this.BI[e]=this.BI[e]*t/128|0,this.II[e]=this.II[e]*i/128|0,this.bI[e]=this.bI[e]*s/128|0}oc(t,i,s,e,h,n){const r=i*(0|Math.sqrt(s*s+e*e+h*h))>>8;if(this.Ck&&this.Sk&&this.mk||(this.Ck=new Int32Array(this.QO),this.Sk=new Int32Array(this.QO),this.mk=new Int32Array(this.QO)),!this.XO){this.XO=new a.Ps(this.vI,null);for(let t=0;t<this.vI;t++)this.XO[t]=new f}for(let i=0;i<this.QO;i++){const n=this.tL[i],o=this.iL[i],a=this.sL[i],l=this.BI[o]-this.BI[n],c=this.II[o]-this.II[n],f=this.bI[o]-this.bI[n],d=this.BI[a]-this.BI[n],y=this.II[a]-this.II[n],p=this.bI[a]-this.bI[n];let w=c*p-y*f,A=f*d-p*l,x=l*y-d*c;for(;w>8192||A>8192||x>8192||w<-8192||A<-8192||x<-8192;)w>>=1,A>>=1,x>>=1;let g=0|Math.sqrt(w*w+A*A+x*x);if(g<=0&&(g=1),w=256*w/g|0,A=256*A/g|0,x=256*x/g|0,this.JO&&1&this.JO[i]){const n=t+((s*w+e*A+h*x)/(r+(r/2|0))|0);this.Nb&&(this.Ck[i]=u.gk(this.Nb[i],n,this.JO[i]))}else{let t=this.XO[n];t&&(t.x+=w,t.y+=A,t.z+=x,t.w++),t=this.XO[o],t&&(t.x+=w,t.y+=A,t.z+=x,t.w++),t=this.XO[a],t&&(t.x+=w,t.y+=A,t.z+=x,t.w++)}}if(n)this.jO(t,r,s,e,h);else{this.$O=new a.Ps(this.vI,null);for(let t=0;t<this.vI;t++){const i=this.XO[t],s=new f;i&&(s.x=i.x,s.y=i.y,s.z=i.z,s.w=i.w),this.$O[t]=s}}n?this.RI():this.Uk()}jO(t,i,s,e,h){for(let n=0;n<this.QO;n++){const r=this.tL[n],o=this.iL[n],a=this.sL[n];if(!this.JO&&this.Nb&&this.XO&&this.Ck&&this.Sk&&this.mk){const l=this.Nb[n],c=this.XO[r];c&&(this.Ck[n]=u.gk(l,t+((s*c.x+e*c.y+h*c.z)/(i*c.w)|0),0));const f=this.XO[o];f&&(this.Sk[n]=u.gk(l,t+((s*f.x+e*f.y+h*f.z)/(i*f.w)|0),0));const d=this.XO[a];d&&(this.mk[n]=u.gk(l,t+((s*d.x+e*d.y+h*d.z)/(i*d.w)|0),0))}else if(this.JO&&!(1&this.JO[n])&&this.Nb&&this.XO&&this.Ck&&this.Sk&&this.mk){const l=this.Nb[n],c=this.JO[n],f=this.XO[r];f&&(this.Ck[n]=u.gk(l,t+((s*f.x+e*f.y+h*f.z)/(i*f.w)|0),c));const d=this.XO[o];d&&(this.Sk[n]=u.gk(l,t+((s*d.x+e*d.y+h*d.z)/(i*d.w)|0),c));const y=this.XO[a];y&&(this.mk[n]=u.gk(l,t+((s*y.x+e*y.y+h*y.z)/(i*y.w)|0),c))}}if(this.XO=null,this.$O=null,this.Ok=null,this.Lk=null,this.JO)for(let t=0;t<this.QO;t++)if(!(2&~this.JO[t]))return;this.Nb=null}Nl(t,i,s,e,h,r,o){const a=n.A.sin[t],l=n.A.cos[t],c=n.A.sin[i],f=n.A.cos[i],d=n.A.sin[s],y=n.A.cos[s],p=n.A.sin[e],w=n.A.cos[e],A=r*p+o*w>>16;for(let e=0;e<this.vI;e++){let x,g=this.BI[e],C=this.II[e],S=this.bI[e];0!==s&&(x=C*d+g*y>>16,C=C*y-g*d>>16,g=x),0!==t&&(x=C*l-S*a>>16,S=C*a+S*l>>16,C=x),0!==i&&(x=S*c+g*f>>16,S=S*f-g*c>>16,g=x),g+=h,C+=r,S+=o,x=C*w-S*p>>16,S=C*p+S*w>>16,C=x,u.QD&&u.tk&&u.ik&&(u.ik[e]=S-A,u.QD[e]=n.A.Dl+((g<<9)/S|0),u.tk[e]=n.A.kl+((C<<9)/S|0)),this.bD>0&&u.sk&&u.ek&&u.hk&&(u.sk[e]=g,u.ek[e]=C,u.hk[e]=S)}try{this.Pk(!1,!1,0)}catch(t){}}draw(t,i,s,e,r,o,a,c,f){const d=c*r-o*e>>16,y=a*i+d*s>>16,p=this.k_*s>>16,w=y+p;if(w<=50||y>=140*l.A.MT)return;const A=c*e+o*r>>16;let x=A-this.k_<<9;if((x/w|0)>=h.A.sD)return;let g=A+this.k_<<9;if((g/w|0)<=-h.A.sD)return;const C=a*s-d*i>>16,S=this.k_*i>>16;let m=C+S<<9;if((m/w|0)<=-h.A.eD)return;let v=C-(S+(this.Yw*s>>16))<<9;if((v/w|0)>=h.A.eD)return;let B=y-(p+(this.Yw*i>>16))<=50,b=!1;if(f>0&&u.Zx){let t=y-p;t<=50&&(t=50),A>0?(x=x/w|0,g=g/t|0):(g=g/w|0,x=x/t|0),C>0?(v=v/w|0,m=m/t|0):(m=m/w|0,v=v/t|0);const i=u.ol-n.A.Dl,s=u.al-n.A.kl;i>x&&i<g&&s>v&&s<m&&(this.Uw?u.xm[u.jx++]=f:b=!0)}const I=n.A.Dl,E=n.A.kl;let _=0,T=0;0!==t&&(_=n.A.sin[t],T=n.A.cos[t]);for(let h=0;h<this.vI;h++){let n,l=this.BI[h],f=this.II[h],d=this.bI[h];0!==t&&(n=d*_+l*T>>16,d=d*T-l*_>>16,l=n),l+=o,f+=a,d+=c,n=d*e+l*r>>16,d=d*r-l*e>>16,l=n,n=f*s-d*i>>16,d=f*i+d*s>>16,f=n,u.ik&&(u.ik[h]=d-y),d>=50&&u.QD&&u.tk?(u.QD[h]=I+((l<<9)/d|0),u.tk[h]=E+((f<<9)/d|0)):u.QD&&(u.QD[h]=-5e3,B=!0),(B||this.bD>0)&&u.sk&&u.ek&&u.hk&&(u.sk[h]=l,u.ek[h]=f,u.hk[h]=d)}try{this.Pk(B,b,f)}catch(t){}}Pk(t,i,s,e=!1){u.Ak&&(this.Dk=-1,this.kk=-1);for(let t=0;t<this._k;t++)u.nk&&(u.nk[t]=0);for(let e=0;e<this.QO;e++)if((!this.JO||-1!==this.JO[e])&&u.QD&&u.tk&&u.ik&&u.rk&&u.nk){const n=this.tL[e],r=this.iL[e],o=this.sL[e],a=u.QD[n],l=u.QD[r],c=u.QD[o],f=u.tk[n],d=u.tk[r],y=u.tk[o],p=u.ik[n],w=u.ik[r],A=u.ik[o];if(!t||-5e3!==a&&-5e3!==l&&-5e3!==c){i&&this.Nk(u.ol,u.al,f,d,y,a,l,c)&&(u.xm[u.jx++]=s,i=!1);if((a-l)*(y-d)-(f-d)*(c-l)<=0)continue;if(u.JD&&(u.JD[e]=!1),u.$D&&(u.$D[e]=a<0||l<0||c<0||a>h.A.CL||l>h.A.CL||c>h.A.CL),u.rk&&u.nk){const t=((p+w+A)/3|0)+this.Tk;u.rk[t][u.nk[t]++]=e,u.Ak&&this.Nk(u.ol,u.al,f,d,y,a,l,c)&&this.kk<t&&(this.Dk=e,this.kk=t)}}else if(u.JD&&(u.JD[e]=!0),u.rk&&u.nk){const t=((p+w+A)/3|0)+this.Tk;u.rk[t][u.nk[t]++]=e}}if(!this.vk&&u.nk){for(let t=this._k-1;t>=0;t--){const i=u.nk[t];if(!(i<=0)&&u.rk){const s=u.rk[t];for(let t=0;t<i;t++)try{this.Fk(s[t],e)}catch(t){}}}return}for(let t=0;t<12;t++)u.ak&&u.uk&&(u.ak[t]=0,u.uk[t]=0);if(u.nk)for(let t=this._k-1;t>=0;t--){const i=u.nk[t];if(i>0&&u.rk){const s=u.rk[t];for(let e=0;e<i;e++)if(this.vk&&u.ak&&u.lk){const i=s[e],h=this.vk[i],n=u.ak[h]++;u.lk[h][n]=i,h<10&&u.uk?u.uk[h]+=t:10===h&&u.ck?u.ck[n]=t:u.fk&&(u.fk[n]=t)}}}let n=0;u.ak&&u.uk&&(u.ak[1]>0||u.ak[2]>0)&&(n=(u.uk[1]+u.uk[2])/(u.ak[1]+u.ak[2])|0);let r=0;u.ak&&u.uk&&(u.ak[3]>0||u.ak[4]>0)&&(r=(u.uk[3]+u.uk[4])/(u.ak[3]+u.ak[4])|0);let o=0;if(u.ak&&u.uk&&(u.ak[6]>0||u.ak[8]>0)&&(o=(u.uk[6]+u.uk[8])/(u.ak[6]+u.ak[8])|0),u.ak&&u.lk){let t,i=0,s=u.ak[10],h=u.lk[10],a=u.ck;i===s&&(i=0,s=u.ak[11],h=u.lk[11],a=u.fk),t=i<s&&a?a[i]:-1e3;for(let l=0;l<10;l++){for(;0===l&&t>n;)try{this.Fk(h[i++],e),i===s&&h!==u.lk[11]&&(i=0,s=u.ak[11],h=u.lk[11],a=u.fk),t=i<s&&a?a[i]:-1e3}catch(t){}for(;3===l&&t>r;)try{this.Fk(h[i++],e),i===s&&h!==u.lk[11]&&(i=0,s=u.ak[11],h=u.lk[11],a=u.fk),t=i<s&&a?a[i]:-1e3}catch(t){}for(;5===l&&t>o;)try{this.Fk(h[i++],e),i===s&&h!==u.lk[11]&&(i=0,s=u.ak[11],h=u.lk[11],a=u.fk),t=i<s&&a?a[i]:-1e3}catch(t){}const c=u.ak[l],f=u.lk[l];for(let t=0;t<c;t++)try{this.Fk(f[t],e)}catch(t){}}for(;-1e3!==t;)try{this.Fk(h[i++],e),i===s&&h!==u.lk[11]&&(i=0,h=u.lk[11],s=u.ak[11],a=u.fk),t=i<s&&a?a[i]:-1e3}catch(t){}}}Fk(t,i=!1){if(u.JD&&u.JD[t])return void this.Vk(t,i);const s=this.tL[t],e=this.iL[t],h=this.sL[t];let r;if(u.$D&&(n.A.gL=u.$D[t]),this.Bk?n.A.alpha=this.Bk[t]:n.A.alpha=0,r=this.JO?3&this.JO[t]:0,i&&u.QD&&u.tk&&this.Ck&&this.Sk&&this.mk)n.A.Xg(u.QD[s],u.tk[s],u.QD[e],u.tk[e],n.A.palette[this.Ck[t]]),n.A.Xg(u.QD[e],u.tk[e],u.QD[h],u.tk[h],n.A.palette[this.Sk[t]]),n.A.Xg(u.QD[h],u.tk[h],u.QD[s],u.tk[s],n.A.palette[this.mk[t]]);else if(0===r&&this.Ck&&this.Sk&&this.mk&&u.QD&&u.tk)n.A.mL(u.QD[s],u.QD[e],u.QD[h],u.tk[s],u.tk[e],u.tk[h],this.Ck[t],this.Sk[t],this.mk[t]);else if(1===r&&this.Ck&&u.QD&&u.tk)n.A.CD(u.QD[s],u.QD[e],u.QD[h],u.tk[s],u.tk[e],u.tk[h],n.A.palette[this.Ck[t]]);else if(2===r&&this.JO&&this.Nb&&this.Ck&&this.Sk&&this.mk&&u.QD&&u.tk&&u.sk&&u.ek&&u.hk){const i=this.JO[t]>>2,r=this.bk[i],o=this.Ik[i],a=this.Ek[i];n.A.BL(u.QD[s],u.QD[e],u.QD[h],u.tk[s],u.tk[e],u.tk[h],this.Ck[t],this.Sk[t],this.mk[t],u.sk[r],u.ek[r],u.hk[r],u.sk[o],u.sk[a],u.ek[o],u.ek[a],u.hk[o],u.hk[a],this.Nb[t])}else if(3===r&&this.JO&&this.Nb&&this.Ck&&u.QD&&u.tk&&u.sk&&u.ek&&u.hk){const i=this.JO[t]>>2,r=this.bk[i],o=this.Ik[i],a=this.Ek[i];n.A.BL(u.QD[s],u.QD[e],u.QD[h],u.tk[s],u.tk[e],u.tk[h],this.Ck[t],this.Ck[t],this.Ck[t],u.sk[r],u.ek[r],u.hk[r],u.sk[o],u.sk[a],u.ek[o],u.ek[a],u.hk[o],u.hk[a],this.Nb[t])}}Vk(t,i=!1){let s=0;if(u.hk){const i=n.A.Dl,e=n.A.kl,h=this.tL[t],r=this.iL[t],o=this.sL[t],a=u.hk[h],l=u.hk[r],c=u.hk[o];if(a>=50&&u.QD&&u.tk&&this.Ck)u.dk[s]=u.QD[h],u.yk[s]=u.tk[h],u.pk[s++]=this.Ck[t];else if(u.sk&&u.ek&&this.Ck){const f=u.sk[h],d=u.ek[h],y=this.Ck[t];if(c>=50&&this.mk){const h=(50-a)*n.A.aD[c-a];u.dk[s]=i+((f+((u.sk[o]-f)*h>>16)<<9)/50|0),u.yk[s]=e+((d+((u.ek[o]-d)*h>>16)<<9)/50|0),u.pk[s++]=y+((this.mk[t]-y)*h>>16)}if(l>=50&&this.Sk){const h=(50-a)*n.A.aD[l-a];u.dk[s]=i+((f+((u.sk[r]-f)*h>>16)<<9)/50|0),u.yk[s]=e+((d+((u.ek[r]-d)*h>>16)<<9)/50|0),u.pk[s++]=y+((this.Sk[t]-y)*h>>16)}}if(l>=50&&u.QD&&u.tk&&this.Sk)u.dk[s]=u.QD[r],u.yk[s]=u.tk[r],u.pk[s++]=this.Sk[t];else if(u.sk&&u.ek&&this.Sk){const f=u.sk[r],d=u.ek[r],y=this.Sk[t];if(a>=50&&this.Ck){const r=(50-l)*n.A.aD[a-l];u.dk[s]=i+((f+((u.sk[h]-f)*r>>16)<<9)/50|0),u.yk[s]=e+((d+((u.ek[h]-d)*r>>16)<<9)/50|0),u.pk[s++]=y+((this.Ck[t]-y)*r>>16)}if(c>=50&&this.mk){const h=(50-l)*n.A.aD[c-l];u.dk[s]=i+((f+((u.sk[o]-f)*h>>16)<<9)/50|0),u.yk[s]=e+((d+((u.ek[o]-d)*h>>16)<<9)/50|0),u.pk[s++]=y+((this.mk[t]-y)*h>>16)}}if(c>=50&&u.QD&&u.tk&&this.mk)u.dk[s]=u.QD[o],u.yk[s]=u.tk[o],u.pk[s++]=this.mk[t];else if(u.sk&&u.ek&&this.mk){const f=u.sk[o],d=u.ek[o],y=this.mk[t];if(l>=50&&this.Sk){const h=(50-c)*n.A.aD[l-c];u.dk[s]=i+((f+((u.sk[r]-f)*h>>16)<<9)/50|0),u.yk[s]=e+((d+((u.ek[r]-d)*h>>16)<<9)/50|0),u.pk[s++]=y+((this.Sk[t]-y)*h>>16)}if(a>=50&&this.Ck){const r=(50-c)*n.A.aD[a-c];u.dk[s]=i+((f+((u.sk[h]-f)*r>>16)<<9)/50|0),u.yk[s]=e+((d+((u.ek[h]-d)*r>>16)<<9)/50|0),u.pk[s++]=y+((this.Ck[t]-y)*r>>16)}}}const e=u.dk[0],r=u.dk[1],o=u.dk[2],a=u.yk[0],l=u.yk[1],c=u.yk[2];if(!((e-r)*(c-l)-(a-l)*(o-r)<=0))if(n.A.gL=!1,3===s){let s;if((e<0||r<0||o<0||e>h.A.CL||r>h.A.CL||o>h.A.CL)&&(n.A.gL=!0),s=this.JO?3&this.JO[t]:0,i)n.A.Xg(e,r,a,l,u.pk[0]),n.A.Xg(r,o,l,c,u.pk[1]),n.A.Xg(o,e,c,a,u.pk[2]);else if(0===s)n.A.mL(e,r,o,a,l,c,u.pk[0],u.pk[1],u.pk[2]);else if(1===s&&this.Ck)n.A.CD(e,r,o,a,l,c,n.A.palette[this.Ck[t]]);else if(2===s&&this.JO&&this.Nb&&u.sk&&u.ek&&u.hk){const i=this.JO[t]>>2,s=this.bk[i],h=this.Ik[i],f=this.Ek[i];n.A.BL(e,r,o,a,l,c,u.pk[0],u.pk[1],u.pk[2],u.sk[s],u.ek[s],u.hk[s],u.sk[h],u.sk[f],u.ek[h],u.ek[f],u.hk[h],u.hk[f],this.Nb[t])}else if(3===s&&this.JO&&this.Nb&&this.Ck&&u.sk&&u.ek&&u.hk){const i=this.JO[t]>>2,s=this.bk[i],h=this.Ik[i],f=this.Ek[i];n.A.BL(e,r,o,a,l,c,this.Ck[t],this.Ck[t],this.Ck[t],u.sk[s],u.ek[s],u.hk[s],u.sk[h],u.sk[f],u.ek[h],u.ek[f],u.hk[h],u.hk[f],this.Nb[t])}}else if(4===s){let s;if((e<0||r<0||o<0||e>h.A.CL||r>h.A.CL||o>h.A.CL||u.dk[3]<0||u.dk[3]>h.A.CL)&&(n.A.gL=!0),s=this.JO?3&this.JO[t]:0,i)n.A.Xg(e,r,a,l,u.pk[0]),n.A.Xg(r,o,l,c,u.pk[1]),n.A.Xg(o,u.dk[3],c,u.yk[3],u.pk[2]),n.A.Xg(u.dk[3],e,u.yk[3],a,u.pk[3]);else if(0===s)n.A.mL(e,r,o,a,l,c,u.pk[0],u.pk[1],u.pk[2]),n.A.mL(e,o,u.dk[3],a,c,u.yk[3],u.pk[0],u.pk[2],u.pk[3]);else if(1===s){if(this.Ck){const i=n.A.palette[this.Ck[t]];n.A.CD(e,r,o,a,l,c,i),n.A.CD(e,o,u.dk[3],a,c,u.yk[3],i)}}else if(2===s&&this.JO&&this.Nb&&u.sk&&u.ek&&u.hk){const i=this.JO[t]>>2,s=this.bk[i],h=this.Ik[i],f=this.Ek[i];n.A.BL(e,r,o,a,l,c,u.pk[0],u.pk[1],u.pk[2],u.sk[s],u.ek[s],u.hk[s],u.sk[h],u.sk[f],u.ek[h],u.ek[f],u.hk[h],u.hk[f],this.Nb[t]),n.A.BL(e,o,u.dk[3],a,c,u.yk[3],u.pk[0],u.pk[2],u.pk[3],u.sk[s],u.ek[s],u.hk[s],u.sk[h],u.sk[f],u.ek[h],u.ek[f],u.hk[h],u.hk[f],this.Nb[t])}else if(3===s&&this.JO&&this.Nb&&this.Ck&&u.sk&&u.ek&&u.hk){const i=this.JO[t]>>2,s=this.bk[i],h=this.Ik[i],f=this.Ek[i];n.A.BL(e,r,o,a,l,c,this.Ck[t],this.Ck[t],this.Ck[t],u.sk[s],u.ek[s],u.hk[s],u.sk[h],u.sk[f],u.ek[h],u.ek[f],u.hk[h],u.hk[f],this.Nb[t]),n.A.BL(e,o,u.dk[3],a,c,u.yk[3],this.Ck[t],this.Ck[t],this.Ck[t],u.sk[s],u.ek[s],u.hk[s],u.sk[h],u.sk[f],u.ek[h],u.ek[f],u.hk[h],u.hk[f],this.Nb[t])}}}Mk(t,i,s,e,h){if(!e)return;const r=e.length;if(0===h){let h=0;u.Yn=0,u.wk=0,u.Hn=0;for(let t=0;t<r;t++){if(!this.Ow)continue;const i=e[t];if(i<this.Ow.length){const t=this.Ow[i];if(t)for(let i=0;i<t.length;i++){const s=t[i];u.Yn+=this.BI[s],u.wk+=this.II[s],u.Hn+=this.bI[s],h++}}}h>0?(u.Yn=(u.Yn/h|0)+t,u.wk=(u.wk/h|0)+i,u.Hn=(u.Hn/h|0)+s):(u.Yn=t,u.wk=i,u.Hn=s)}else if(1===h)for(let h=0;h<r;h++){const n=e[h];if(!this.Ow||n>=this.Ow.length)continue;const r=this.Ow[n];if(r)for(let e=0;e<r.length;e++){const h=r[e];this.BI[h]+=t,this.II[h]+=i,this.bI[h]+=s}}else if(2===h)for(let h=0;h<r;h++){const r=e[h];if(!this.Ow||r>=this.Ow.length)continue;const o=this.Ow[r];if(o)for(let e=0;e<o.length;e++){const h=o[e];this.BI[h]-=u.Yn,this.II[h]-=u.wk,this.bI[h]-=u.Hn;const r=8*(255&t),a=8*(255&i),l=8*(255&s);let c,f;if(0!==l){c=n.A.sin[l],f=n.A.cos[l];const t=this.II[h]*c+this.BI[h]*f>>16;this.II[h]=this.II[h]*f-this.BI[h]*c>>16,this.BI[h]=t}if(0!==r){c=n.A.sin[r],f=n.A.cos[r];const t=this.II[h]*f-this.bI[h]*c>>16;this.bI[h]=this.II[h]*c+this.bI[h]*f>>16,this.II[h]=t}if(0!==a){c=n.A.sin[a],f=n.A.cos[a];const t=this.bI[h]*c+this.BI[h]*f>>16;this.bI[h]=this.bI[h]*f-this.BI[h]*c>>16,this.BI[h]=t}this.BI[h]+=u.Yn,this.II[h]+=u.wk,this.bI[h]+=u.Hn}}else if(3===h)for(let h=0;h<r;h++){const n=e[h];if(!this.Ow||n>=this.Ow.length)continue;const r=this.Ow[n];if(r)for(let e=0;e<r.length;e++){const h=r[e];this.BI[h]-=u.Yn,this.II[h]-=u.wk,this.bI[h]-=u.Hn,this.BI[h]=this.BI[h]*t/128|0,this.II[h]=this.II[h]*i/128|0,this.bI[h]=this.bI[h]*s/128|0,this.BI[h]+=u.Yn,this.II[h]+=u.wk,this.bI[h]+=u.Hn}}else if(5===h&&this.Tw&&this.Bk)for(let i=0;i<r;i++){const s=e[i];if(s>=this.Tw.length)continue;const h=this.Tw[s];if(h)for(let i=0;i<h.length;i++){const s=h[i];this.Bk[s]+=8*t,this.Bk[s]<0&&(this.Bk[s]=0),this.Bk[s]>255&&(this.Bk[s]=255)}}}Uk(){this.Yw=0,this.k_=0,this.K_=0,this.Y_=999999,this.H_=-999999,this.X_=-99999,this.z_=99999;for(let t=0;t<this.vI;t++){const i=this.BI[t],s=this.II[t],e=this.bI[t];i<this.Y_&&(this.Y_=i),i>this.H_&&(this.H_=i),e<this.z_&&(this.z_=e),e>this.X_&&(this.X_=e),-s>this.Yw&&(this.Yw=-s),s>this.K_&&(this.K_=s);const h=i*i+e*e;h>this.k_&&(this.k_=h)}this.k_=0|Math.sqrt(this.k_),this.Tk=0|Math.sqrt(this.k_*this.k_+this.Yw*this.Yw),this._k=this.Tk+(0|Math.sqrt(this.k_*this.k_+this.K_*this.K_))}Nk(t,i,s,e,h,n,r,o){return!(i<s&&i<e&&i<h)&&(!(i>s&&i>e&&i>h)&&(!(t<n&&t<r&&t<o)&&(t<=n||t<=r||t<=o)))}Gk(t){if(!(u.QD&&u.tk&&this.Ck&&this.Sk&&this.mk))return;const i=this.tL[t],s=this.iL[t],e=this.sL[t];n.A.Xg(u.QD[i],u.tk[i],u.QD[s],u.tk[s],n.A.palette[1e3]),n.A.Xg(u.QD[s],u.tk[s],u.QD[e],u.tk[e],n.A.palette[1e3]),n.A.Xg(u.QD[e],u.tk[e],u.QD[i],u.tk[i],n.A.palette[1e3])}}},1122:(t,i,s)=>{s.d(i,{A:()=>o});var e=s(8950),h=s(1069),n=s(4474),r=s(7854);class o extends n.A{Kc;width;height;RA;DA;cl;nC;constructor(t,i){super(),this.Kc=new Int32Array(t*i),this.width=this.cl=t,this.height=this.nC=i,this.RA=this.DA=0}static OA=async(t,i)=>{const s=t.read(i+'.dat');if(!s)throw new Error(`${i} jpeg not found!`);const e=await(async t=>{255!==t[0]&&(t[0]=255),URL.revokeObjectURL(r.tD.src),r.tD.src=URL.createObjectURL(new Blob([t],{type:'image/jpeg'})),await new Promise((t=>r.tD.onload=()=>t())),r.QR.clearRect(0,0,r.iD.width,r.iD.height);const i=r.tD.naturalWidth,s=r.tD.naturalHeight;return r.iD.width=i,r.iD.height=s,r.QR.drawImage(r.tD,0,0),r.QR.getImageData(0,0,i,s)})(s),h=new o(e.width,e.height),n=new Uint32Array(e.data.buffer),a=h.Kc;for(let t=0;t<a.length;t++){const i=n[t];a[t]=(i>>24&255)<<24|(255&i)<<16|(i>>8&255)<<8|i>>16&255}return h};static Dc=(t,i,s=0)=>{const e=new h.A(t.read(i+'.dat')),n=new h.A(t.read('index.dat'));n.ft=e.ct;const r=n.ct,a=n.ct,l=[],c=n.kc-1;for(let t=0;t<c;t++)l[t+1]=n.lt,0===l[t+1]&&(l[t+1]=1);for(let t=0;t<s;t++)n.ft+=2,e.ft+=n.ct*n.ct,n.ft+=1;if(e.ft>e.length||n.ft>n.length)throw new Error;const f=n.kc,u=n.kc,d=n.ct,y=n.ct,p=new o(d,y);p.RA=f,p.DA=u,p.cl=r,p.nC=a;const w=n.kc;if(0===w){const t=p.width*p.height;for(let i=0;i<t;i++)p.Kc[i]=l[e.kc]}else if(1===w){const t=p.width;for(let i=0;i<t;i++){const s=p.height;for(let h=0;h<s;h++)p.Kc[i+h*t]=l[e.kc]}}return p};bind(){e.A.bind(this.Kc,this.width,this.height)}draw(t,i){t|=0,i|=0;let s=(t+=this.RA)+(i+=this.DA)*e.A.zc,h=0,n=this.height,r=this.width,o=e.A.zc-r,a=0;if(i<e.A.top){const t=e.A.top-i;n-=t,i=e.A.top,h+=t*r,s+=t*e.A.zc}if(i+n>e.A.bottom&&(n-=i+n-e.A.bottom),t<e.A.left){const i=e.A.left-t;r-=i,t=e.A.left,h+=i,s+=i,a+=i,o+=i}if(t+r>e.A.right){const i=t+r-e.A.right;r-=i,a+=i,o+=i}r>0&&n>0&&this.Wk(r,n,this.Kc,h,a,e.A.Kc,s,o)}ll(t,i,s){i|=0,s|=0;let h=(i+=this.RA)+(s+=this.DA)*e.A.zc,n=0,r=this.height,o=this.width,a=e.A.zc-o,l=0;if(s<e.A.top){const t=e.A.top-s;r-=t,s=e.A.top,n+=t*o,h+=t*e.A.zc}if(s+r>e.A.bottom&&(r-=s+r-e.A.bottom),i<e.A.left){const t=e.A.left-i;o-=t,i=e.A.left,n+=t,h+=t,l+=t,a+=t}if(i+o>e.A.right){const t=i+o-e.A.right;o-=t,l+=t,a+=t}o>0&&r>0&&this.Yk(o,r,this.Kc,n,l,e.A.Kc,h,a,t)}fA(t,i){t|=0,i|=0;let s=(t+=this.RA)+(i+=this.DA)*e.A.zc,h=0,n=this.height,r=this.width,o=e.A.zc-r,a=0;if(i<e.A.top){const t=e.A.top-i;n-=t,i=e.A.top,h+=t*r,s+=t*e.A.zc}if(i+n>e.A.bottom&&(n-=i+n-e.A.bottom),t<e.A.left){const i=e.A.left-t;r-=i,t=e.A.left,h+=i,s+=i,a+=i,o+=i}if(t+r>e.A.right){const i=t+r-e.A.right;r-=i,a+=i,o+=i}r>0&&n>0&&this.Hk(r,n,this.Kc,h,a,e.A.Kc,s,o)}lA(){const t=this.Kc,i=this.width,s=this.height;for(let e=0;e<s;e++){const s=i/2|0;for(let h=0;h<s;h++){const s=h+e*i,n=i-h-1+e*i,r=t[s];t[s]=t[n],t[n]=r}}}cA(){const t=this.Kc,i=this.width,s=this.height;for(let e=0;e<(s/2|0);e++)for(let h=0;h<i;h++){const n=h+e*i,r=h+(s-e-1)*i,o=t[n];t[n]=t[r],t[r]=o}}translate(t,i,s){for(let e=0;e<this.Kc.length;e++){const h=this.Kc[e];if(0!==h){let n=h>>16&255;n+=t,n<1?n=1:n>255&&(n=255);let r=h>>8&255;r+=i,r<1?r=1:r>255&&(r=255);let o=255&h;o+=s,o<1?o=1:o>255&&(o=255),this.Kc[e]=(n<<16)+(r<<8)+o}}}zI(t,i,s,h){t|=0,i|=0,s|=0,h|=0;try{const n=this.width;let r=0,o=0;const a=this.cl,l=this.nC,c=(a<<16)/s|0,f=(l<<16)/h|0;t+=(this.RA*s+a-1)/a|0,i+=(this.DA*h+l-1)/l|0,this.RA*s%a!=0&&(r=(a-this.RA*s%a<<16)/s|0),this.DA*h%l!=0&&(o=(l-this.DA*h%l<<16)/h|0),s=s*(this.width-(r>>16))/a|0,h=h*(this.height-(o>>16))/l|0;let u=t+i*e.A.zc,d=e.A.zc-s;if(i<e.A.top){const t=e.A.top-i;h-=t,i=0,u+=t*e.A.zc,o+=f*t}if(i+h>e.A.bottom&&(h-=i+h-e.A.bottom),t<e.A.left){const i=e.A.left-t;s-=i,t=0,u+=i,r+=c*i,d+=i}if(t+s>e.A.right){const i=t+s-e.A.right;s-=i,d+=i}this.scale(s,h,this.Kc,r,o,e.A.Kc,d,u,n,c,f)}catch(t){console.error('error in sprite clipping routine')}}Qg(t,i,s,h,n,r,o,a,l,c){t|=0,i|=0,s|=0,h|=0;try{const f=-s/2|0,u=-h/2|0,d=65536*Math.sin(l/326.11)|0,y=65536*Math.cos(l/326.11)|0,p=d*c>>8,w=y*c>>8;let A=(o<<16)+u*p+f*w,x=u*w-f*p+(a<<16),g=t+i*e.A.zc;for(let t=0;t<h;t++){const i=n[t];let s=g+i,h=A+w*i,o=x-p*i;for(let i=-r[t];i<0;i++)e.A.Kc[s++]=this.Kc[(h>>16)+(o>>16)*this.width],h+=w,o-=p;A+=p,x+=w,g+=e.A.zc}}catch(t){}}hC(t,i,s){t|=0,i|=0;let h=(t+=this.RA)+(i+=this.DA)*e.A.zc,n=0,r=this.height,o=this.width,a=e.A.zc-o,l=0;if(i<e.A.top){const t=e.A.top-i;r-=t,i=e.A.top,n+=t*o,h+=t*e.A.zc}if(i+r>e.A.bottom&&(r-=i+r-e.A.bottom),t<e.A.left){const i=e.A.left-t;o-=i,t=e.A.left,n+=i,h+=i,l+=i,a+=i}if(t+o>e.A.right){const i=t+o-e.A.right;o-=i,l+=i,a+=i}o>0&&r>0&&this.zk(o,r,this.Kc,l,n,e.A.Kc,h,a,s.Kc)}scale(t,i,s,e,h,n,r,o,a,l,c){try{const f=e;for(let u=-i;u<0;u++){const i=(h>>16)*a;for(let h=-t;h<0;h++){const t=s[(e>>16)+i];0===t?o++:n[o++]=t,e+=l}h+=c,e=f,o+=r}}catch(t){console.error('error in plot_scale')}}Hk(t,i,s,e,h,n,r,o){const a=-(t>>2);t=-(3&t);for(let l=-i;l<0;l++){for(let t=a;t<0;t++)n[r++]=s[e++],n[r++]=s[e++],n[r++]=s[e++],n[r++]=s[e++];for(let i=t;i<0;i++)n[r++]=s[e++];r+=o,e+=h}}Yk(t,i,s,e,h,n,r,o,a){const l=256-a;for(let c=-i;c<0;c++){for(let i=-t;i<0;i++){const t=s[e++];if(0===t)r++;else{const i=n[r];n[r++]=((16711935&t)*a+(16711935&i)*l&4278255360)+((65280&t)*a+(65280&i)*l&16711680)>>8}}r+=o,e+=h}}Wk(t,i,s,e,h,n,r,o){const a=-(t>>2);t=-(3&t);for(let l=-i;l<0;l++){for(let t=a;t<0;t++){let t=s[e++];0===t?r++:n[r++]=t,t=s[e++],0===t?r++:n[r++]=t,t=s[e++],0===t?r++:n[r++]=t,t=s[e++],0===t?r++:n[r++]=t}for(let i=t;i<0;i++){const t=s[e++];0===t?r++:n[r++]=t}r+=o,e+=h}}zk(t,i,s,e,h,n,r,o,a){const l=-(t>>2);t=-(3&t);for(let c=-i;c<0;c++){for(let t=l;t<0;t++){let t=s[h++];0!==t&&0===a[r]?n[r++]=t:r++,t=s[h++],0!==t&&0===a[r]?n[r++]=t:r++,t=s[h++],0!==t&&0===a[r]?n[r++]=t:r++,t=s[h++],0!==t&&0===a[r]?n[r++]=t:r++}for(let i=t;i<0;i++){const t=s[h++];0!==t&&0===a[r]?n[r++]=t:r++}r+=o,h+=e}}}},1673:(t,i,s)=>{s.d(i,{A:()=>r});var e=s(8950),h=s(1069),n=s(4474);class r extends n.A{Kc;width;height;RA;DA;cl;nC;palette;constructor(t,i,s){super(),this.Kc=new Int8Array(t*i),this.width=this.cl=t,this.height=this.nC=i,this.RA=this.DA=0,this.palette=s}static Dc=(t,i,s=0)=>{const e=new h.A(t.read(i+'.dat')),n=new h.A(t.read('index.dat'));n.ft=e.ct;const o=n.ct,a=n.ct,l=n.kc,c=new Int32Array(l);for(let t=1;t<l;t++)c[t]=n.lt,0===c[t]&&(c[t]=1);for(let t=0;t<s;t++)n.ft+=2,e.ft+=n.ct*n.ct,n.ft+=1;if(e.ft>e.length||n.ft>n.length)throw new Error;const f=n.kc,u=n.kc,d=n.ct,y=n.ct,p=new r(d,y,c);p.RA=f,p.DA=u,p.cl=o,p.nC=a;const w=p.Kc,A=n.kc;if(0===A){const t=p.width*p.height;for(let i=0;i<t;i++)w[i]=e.Mc}else if(1===A){const t=p.width,i=p.height;for(let s=0;s<t;s++)for(let h=0;h<i;h++)w[s+h*t]=e.Mc}return p};draw(t,i){t|=0,i|=0;let s=(t+=this.RA)+(i+=this.DA)*e.A.zc,h=0,n=this.height,r=this.width,o=e.A.zc-r,a=0;if(i<e.A.top){const t=e.A.top-i;n-=t,i=e.A.top,h+=t*r,s+=t*e.A.zc}if(i+n>e.A.bottom&&(n-=i+n-e.A.bottom),t<e.A.left){const i=e.A.left-t;r-=i,t=e.A.left,h+=i,s+=i,a+=i,o+=i}if(t+r>e.A.right){const i=t+r-e.A.right;r-=i,a+=i,o+=i}r>0&&n>0&&this.Xk(r,n,this.Kc,h,a,e.A.Kc,s,o)}lA(){const t=this.Kc,i=this.width,s=this.height;for(let e=0;e<s;e++){const s=i/2|0;for(let h=0;h<s;h++){const s=h+e*i,n=i-h-1+e*i,r=t[s];t[s]=t[n],t[n]=r}}}cA(){const t=this.Kc,i=this.width,s=this.height;for(let e=0;e<(s/2|0);e++)for(let h=0;h<i;h++){const n=h+e*i,r=h+(s-e-1)*i,o=t[n];t[n]=t[r],t[r]=o}}translate(t,i,s){for(let e=0;e<this.palette.length;e++){let h=this.palette[e]>>16&255;h+=t,h<0?h=0:h>255&&(h=255);let n=this.palette[e]>>8&255;n+=i,n<0?n=0:n>255&&(n=255);let r=255&this.palette[e];r+=s,r<0?r=0:r>255&&(r=255),this.palette[e]=(h<<16)+(n<<8)+r}}AD(){this.cl|=0,this.nC|=0,this.cl/=2,this.nC/=2,this.cl|=0,this.nC|=0;const t=new Int8Array(this.cl*this.nC);let i=0;for(let s=0;s<this.height;s++)for(let e=0;e<this.width;e++)t[(e+this.RA>>1)+(s+this.DA>>1)*this.cl]=this.Kc[i++];this.Kc=t,this.width=this.cl,this.height=this.nC,this.RA=0,this.DA=0}zI(){if(this.width===this.cl&&this.height===this.nC)return;const t=new Int8Array(this.cl*this.nC);let i=0;for(let s=0;s<this.height;s++)for(let e=0;e<this.width;e++)t[e+this.RA+(s+this.DA)*this.cl]=this.Kc[i++];this.Kc=t,this.width=this.cl,this.height=this.nC,this.RA=0,this.DA=0}Xk(t,i,s,e,h,n,r,o){const a=-(t>>2);t=-(3&t);for(let l=-i;l<0;l++){for(let t=a;t<0;t++){let t=s[e++];0===t?r++:n[r++]=this.palette[255&t],t=s[e++],0===t?r++:n[r++]=this.palette[255&t],t=s[e++],0===t?r++:n[r++]=this.palette[255&t],t=s[e++],0===t?r++:n[r++]=this.palette[255&t]}for(let i=t;i<0;i++){const t=s[e++];0===t?r++:n[r++]=this.palette[255&t]}r+=o,e+=h}}clip(t,i,s,h){try{const n=this.width;this.height;let r=0,o=0;const a=this.cl,l=this.nC,c=(a<<16)/s|0,f=(l<<16)/h|0;t=t+(this.RA*s+a-1)/a|0,i=i+(this.DA*h+l-1)/l|0,this.RA*s%a!=0&&(r=(a-this.RA*s%a<<16)/s|0),this.DA*h%l!=0&&(o=(l-this.DA*h%l<<16)/h|0),s=s*(this.width-(r>>16))/a|0,h=h*(this.height-(o>>16))/l|0;let u,d=t+i*e.A.zc,y=e.A.zc-s;i<e.A.top&&(u=e.A.top-i,h-=u,i=0,d+=u*e.A.zc,o+=f*u),i+h>e.A.bottom&&(h-=i+h-e.A.bottom),t<e.A.left&&(u=e.A.left-t,s-=u,t=0,d+=u,r+=c*u,y+=u),t+s>e.A.right&&(u=t+s-e.A.right,s-=u,y+=u),this.Kk(e.A.Kc,this.Kc,this.palette,r,o,d,y,s,h,c,f,n)}catch(t){console.log('error in sprite clipping routine')}}Kk(t,i,s,e,h,n,r,o,a,l,c,f){try{const u=e;for(let d=-a;d<0;d++){const a=(h>>16)*f;for(let h=-o;h<0;h++){const h=i[(e>>16)+a];0==h?n++:t[n++]=s[255&h],e+=l}h+=c,e=u,n+=r}}catch(t){console.log('error in plot_scale')}}}},1183:(t,i,s)=>{s.d(i,{A:()=>r});var e=s(8950),h=s(7854),n=s(643);class r{Zk;width;height;jk;qk;Kc;constructor(t,i,s=h.ma){this.jk=s,this.Zk=this.jk.getImageData(0,0,t,i),this.qk=new Uint32Array(this.Zk.data.buffer),this.Kc=new Int32Array(t*i),this.width=t,this.height=i,this.bind()}clear(){this.Kc.fill(0)}bind(){e.A.bind(this.Kc,this.width,this.height)}draw(t,i){n.A.$k(this,t,i)||(this.#t(),this.jk.putImageData(this.Zk,t,i))}#t(){const t=this.Kc.length,i=this.Kc,s=this.qk;for(let e=0;e<t;e++){const t=i[e];s[e]=t>>16&255|(t>>8&255)<<8|(255&t)<<16|4278190080}}}},1069:(t,i,s)=>{s.d(i,{A:()=>r});var e=s(9234),h=s(6666),n=s(4474);class r extends n.A{static Jk=3988292384;static Qk=new Int32Array(256);static tM=new Uint32Array(33);static iM=new h.A;static sM=new h.A;static eM=new h.A;static hM=0;static nM=0;static rM=0;static{for(let t=0;t<32;t++)r.tM[t]=(1<<t)-1;r.tM[32]=4294967295;for(let t=0;t<256;t++){let i=t;for(let t=0;t<8;t++)1&~i?i>>>=1:i=i>>>1^r.Jk;r.Qk[t]=i}}static da=t=>{let i=4294967295;for(let s=0;s<t.length;s++)i=i>>>8^r.Qk[255&(i^t[s])];return~i};view;data;ft=0;Gm=0;random=null;constructor(t){if(!t)throw new Error('Input src packet array was null!');super(),t instanceof Int8Array?this.data=new Uint8Array(t):this.data=t,this.view=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength)}get length(){return this.view.byteLength}get available(){return this.length-this.ft}static oi=t=>{let i=null;return 0===t&&r.hM>0?(r.hM--,i=r.iM.Bf()):1===t&&r.nM>0?(r.nM--,i=r.sM.Bf()):2===t&&r.rM>0&&(r.rM--,i=r.eM.Bf()),i?(i.ft=0,i):new r(0===t?new Uint8Array(100):1===t?new Uint8Array(5e3):new Uint8Array(3e4))};release(){this.ft=0,100===this.view.byteLength&&r.hM<1e3?(r.iM.Sf(this),r.hM++):5e3===this.view.byteLength&&r.nM<250?(r.sM.Sf(this),r.nM++):3e4===this.view.byteLength&&r.rM<50&&(r.eM.Sf(this),r.rM++)}get kc(){return this.view.getUint8(this.ft++)}get Mc(){return this.view.getInt8(this.ft++)}get ct(){const t=this.view.getUint16(this.ft);return this.ft+=2,t}get kS(){const t=this.view.getInt16(this.ft);return this.ft+=2,t}get lt(){const t=this.view.getUint8(this.ft++)<<16|this.view.getUint16(this.ft);return this.ft+=2,t}get ut(){const t=this.view.getInt32(this.ft);return this.ft+=4,t}get GA(){const t=this.view.getBigInt64(this.ft);return this.ft+=8,t}get $p(){return this.view.getUint8(this.ft)<128?this.kc-64:this.ct-49152}get qp(){return this.view.getUint8(this.ft)<128?this.kc:this.ct-32768}get TS(){const t=this.view,i=t.byteLength;let s,e='';for(;10!==(s=t.getUint8(this.ft++))&&this.ft<i;)e+=String.fromCharCode(s);return e}LS(t,i,s){s.set(this.data.subarray(this.ft,this.ft+t),i),this.ft+=t}$A(t){this.view.setUint8(this.ft++,t+(this.random?.vc??0)&255)}p1(t){this.view.setUint8(this.ft++,t)}p2(t){this.view.setUint16(this.ft,t),this.ft+=2}rw(t){this.view.setUint16(this.ft,t,!0),this.ft+=2}p3(t){this.view.setUint8(this.ft++,t>>16),this.view.setUint16(this.ft,t),this.ft+=2}p4(t){this.view.setInt32(this.ft,t),this.ft+=4}nw(t){this.view.setInt32(this.ft,t,!0),this.ft+=4}JC(t){this.view.setBigInt64(this.ft,t),this.ft+=8}WA(t){const i=this.view,s=t.length;for(let e=0;e<s;e++)i.setUint8(this.ft++,t.charCodeAt(e));i.setUint8(this.ft++,10)}HA(t,i,s){this.data.set(t.subarray(s,s+i),this.ft),this.ft+=i-s}Hx(t){this.view.setUint8(this.ft-t-1,t)}Fm(){this.Gm=this.ft<<3}xf(){this.ft=this.Gm+7>>>3}Vm(t){let i=this.Gm>>>3,s=8-(7&this.Gm),e=0;for(this.Gm+=t;t>s;s=8)e+=(this.view.getUint8(i++)&r.tM[s])<<t-s,t-=s;return e+=t===s?this.view.getUint8(i)&r.tM[s]:this.view.getUint8(i)>>>s-t&r.tM[t],e}YA(t,i){const s=this.ft;this.ft=0;const h=new Uint8Array(s);this.LS(s,0,h);const n=(0,e.oM)(h),r=(0,e.aM)(n,i,t),o=(0,e.lM)(r);this.ft=0,this.p1(o.length),this.HA(o,o.length,0)}}},643:(t,i,s)=>{s.d(i,{A:()=>e});class e{canvas;static Gc;constructor(t){this.canvas=t}static Sa(){e.Gc&&(e.Gc.destroy(),e.Gc.canvas.remove(),e.Gc=void 0)}static resize(t,i){e.Gc?.resize(t,i)}static SA(){e.Gc?.SA()}static BA(){e.Gc?.BA()}static BD(t){e.Gc?.BD(t)}static dA(t){e.Gc?.dA(t)}static $k(t,i,s){return!!e.Gc&&e.Gc.$k(t,i,s)}static qx(){return e.Gc?-1:0}static $x(){e.Gc?.$x()}static Jx(){e.Gc?.Jx()}static CD=(t,i,s,h,n,r,o)=>!!e.Gc&&e.Gc.CD(t,i,s,h,n,r,o);static mL=(t,i,s,h,n,r,o,a,l)=>!!e.Gc&&e.Gc.mL(t,i,s,h,n,r,o,a,l);static BL=(t,i,s,h,n,r,o,a,l,c,f,u,d,y,p,w,A,x,g)=>!!e.Gc&&e.Gc.BL(t,i,s,h,n,r,o,a,l,c,f,u,d,y,p,w,A,x,g);resize(t,i){this.canvas.width=t,this.canvas.height=i}}},2176:(t,i,s)=>{s.d(i,{O:()=>a});var e=s(198),h=s(7854),n=s(4583),r=s(643);const o=262144;class a extends r.A{device;context;cM;fM;uM;dM;yM;pM;wM;AM;xM;gM;CM;SM;mM;vM;BM;bM;IM;EM;_M;TM;OM;LM;RM;DM;kM;MM;UM;PM;NM;FM;VM;GM;WM;YM;HM;zM;XM=!1;KM=!1;ZM=[];jM=0;qM=new Uint32Array(524288);$M=0;JM=new Uint32Array(655360);QM=0;tU=new Uint32Array(1310720);iU=0;sU=new Uint32Array(655360);eU=0;hU=[];nU=new Array(50).fill(!1);rU=[];Ga=0;static oU(){return'gpu'in navigator}static async init(t,i,s){const e=await(navigator.gpu?.requestAdapter()),h=await(e?.requestDevice());if(!h)throw new Error('Could not request WebGPU device');const n=document.createElement('canvas');n.width=i,n.height=s,n.style.display='block',n.style.position='absolute',n.style.width='100%',n.style.height='100%',t.appendChild(n);const r=n.getContext('webgpu');if(!r)throw n.remove(),new Error('Could not create WebGPU context');const o=navigator.gpu.getPreferredCanvasFormat();return r instanceof GPUCanvasContext&&'configure'in r&&r.configure({device:h,format:o,alphaMode:'opaque'}),new a(n,h,r)}constructor(t,i,s){super(t),this.device=i,this.context=s,this.init()}init(){const t=e.A.YT,i=e.A.HT;this.cM=this.device.createSampler(),this.fM=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,sampler:{type:'filtering'}},{binding:1,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:'float'}}]}),this.uM=this.device.createTexture({size:{width:this.canvas.width,height:this.canvas.height},format:'rgba8unorm',usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),this.dM=this.device.createBindGroup({layout:this.fM,entries:[{binding:0,resource:this.cM},{binding:1,resource:this.uM.createView()}]}),this.device.queue.copyExternalImageToTexture({source:h.mB},{texture:this.uM},{width:this.canvas.width,height:this.canvas.height}),this.yM=this.device.createBuffer({size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.device.queue.writeBuffer(this.yM,0,new Float32Array([t,i])),this.pM=this.device.createBuffer({size:t*i*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.wM=this.device.createBuffer({size:t*i*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.AM=this.device.createBuffer({size:13369544,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.aU(),this.hg(),this.xM=this.device.createShaderModule({label:'rasterizer shaders',code:"\nstruct PixelBuffer {\n  data: array<u32>,\n};\n\nconst textureCount = 50;\n\n// Look-up tables\nstruct LUTs {\n  palette: array<u32, 65536>,\n  texturesTranslucent: array<i32, textureCount>,\n  textures: array<array<u32, 65536>, textureCount>,\n};\n\n@group(0) @binding(0) var<storage, read_write> pixelBuffer: PixelBuffer;\n@group(0) @binding(1) var<storage, read_write> depthBuffer: array<atomic<u32>>;\n@group(0) @binding(2) var<storage, read> luts: LUTs;\n@group(1) @binding(0) var<storage, read> triangleData: array<i32>;\n\n@compute @workgroup_size(256, 1)\nfn clear(@builtin(global_invocation_id) global_id: vec3u) {\n  let index = global_id.x;\n  pixelBuffer.data[index] = 0u;\n  atomicStore(&depthBuffer[index], 0u);\n}\n\nconst width = 512;\nconst height = 334;\n\nconst centerX = width / 2;\nconst centerY = height / 2;\n// const centerX = 256;\n// const centerY = 167;\n\nconst boundRight = width;\nconst boundBottom = height;\n// const boundBottom = 334;\nconst boundX = width - 1;\n// const boundX = 512 - 1;\n\nvar<private> jagged = true;\nvar<private> clipX = false;\nvar<private> alpha = 0u;\n\nvar<private> opaqueTexture = true;\n\nvar<private> depth = 0u;\nvar<private> writeDepth = false;\n\n@compute @workgroup_size(1, 1)\nfn renderFlat(@builtin(global_invocation_id) global_id: vec3u) {\n  let offset = global_id.x * 8;\n  depth = u32(triangleData[offset]);\n  rasterTriangle(\n    triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n    triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n    u32(triangleData[offset + 7]),\n  );\n}\n\n@compute @workgroup_size(1, 1)\nfn renderFlatDepth(@builtin(global_invocation_id) global_id: vec3u) {\n  let offset = global_id.x * 8;\n  depth = u32(triangleData[offset]);\n  writeDepth = true;\n  rasterTriangle(\n    triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n    triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n    0,\n  );\n}\n\n@compute @workgroup_size(1, 1)\nfn renderGouraud(@builtin(global_invocation_id) global_id: vec3u) {\n  let offset = global_id.x * 10;\n  depth = u32(triangleData[offset]);\n  rasterGouraudTriangle(\n    triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n    triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n    triangleData[offset + 7], triangleData[offset + 8], triangleData[offset + 9],\n  );\n}\n\n@compute @workgroup_size(1, 1)\nfn renderGouraudDepth(@builtin(global_invocation_id) global_id: vec3u) {\n  let offset = global_id.x * 10;\n  depth = u32(triangleData[offset]);\n  writeDepth = true;\n  rasterTriangle(\n    triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n    triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n    0,\n  );\n}\n\n@compute @workgroup_size(1, 1)\nfn renderTextured(@builtin(global_invocation_id) global_id: vec3u) {\n  let offset = global_id.x * 20;\n  depth = u32(triangleData[offset]);\n  rasterTexturedTriangle(\n    triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n    triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n    triangleData[offset + 7], triangleData[offset + 8], triangleData[offset + 9],\n    triangleData[offset + 10], triangleData[offset + 11], triangleData[offset + 12],\n    triangleData[offset + 13], triangleData[offset + 14], triangleData[offset + 15],\n    triangleData[offset + 16], triangleData[offset + 17], triangleData[offset + 18],\n    triangleData[offset + 19],\n  );\n}\n\n@compute @workgroup_size(1, 1)\nfn renderTexturedDepth(@builtin(global_invocation_id) global_id: vec3u) {\n  let offset = global_id.x * 20;\n  depth = u32(triangleData[offset]);\n  writeDepth = true;\n  opaqueTexture = luts.texturesTranslucent[triangleData[offset + 19]] == 0;\n  if (opaqueTexture) {\n    rasterTriangle(\n      triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n      triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n      0,\n    );\n  } else {\n    rasterTexturedTriangle(\n      triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n      triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n      triangleData[offset + 7], triangleData[offset + 8], triangleData[offset + 9],\n      triangleData[offset + 10], triangleData[offset + 11], triangleData[offset + 12],\n      triangleData[offset + 13], triangleData[offset + 14], triangleData[offset + 15],\n      triangleData[offset + 16], triangleData[offset + 17], triangleData[offset + 18],\n      triangleData[offset + 19],\n    );\n  }\n}\n\n@compute @workgroup_size(1, 1)\nfn renderAlpha(@builtin(global_invocation_id) global_id: vec3u) {\n  let triangleCount = i32(arrayLength(&triangleData)) / 10;\n  for (var i = 0; i < triangleCount; i++) {\n    let offset = i * 10;\n    depth = u32(triangleData[offset] & 0x7fffff);\n    alpha = u32((triangleData[offset] >> 23) & 0xff);\n    var isFlat = (u32(triangleData[offset]) >> 31) == 1;\n    if (isFlat) {\n      rasterTriangle(\n        triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n        triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n        u32(triangleData[offset + 7]),\n      );\n    } else {\n      rasterGouraudTriangle(\n        triangleData[offset + 1], triangleData[offset + 2], triangleData[offset + 3],\n        triangleData[offset + 4], triangleData[offset + 5], triangleData[offset + 6],\n        triangleData[offset + 7], triangleData[offset + 8], triangleData[offset + 9],\n      );\n    }\n  }\n}\n\nfn setPixel(index: i32, value: u32) {\n  if (atomicLoad(&depthBuffer[index]) <= depth) {\n    pixelBuffer.data[index] = value;\n  }\n}\n\nfn rasterTriangle(x0In: i32, x1In: i32, x2In: i32, y0In: i32, y1In: i32, y2In: i32, color: u32) {\n  var x0 = x0In;\n  var x1 = x1In;\n  var x2 = x2In;\n  var y0 = y0In;\n  var y1 = y1In;\n  var y2 = y2In;\n  clipX = x0 < 0 || x1 < 0 || x2 < 0 || x0 > boundX || x1 > boundX || x2 > boundX;\n  var xStepAB = 0;\n  if (y1 != y0) {\n    xStepAB = ((x1 - x0) << 16) / (y1 - y0);\n  }\n  var xStepBC = 0;\n  if (y2 != y1) {\n    xStepBC = ((x2 - x1) << 16) / (y2 - y1);\n  }\n  var xStepAC = 0;\n  if (y2 != y0) {\n    xStepAC = ((x0 - x2) << 16) / (y0 - y2);\n  }\n  if (y0 <= y1 && y0 <= y2) {\n    if (y0 < boundBottom) {\n      if (y1 > boundBottom) {\n        y1 = boundBottom;\n      }\n      if (y2 > boundBottom) {\n        y2 = boundBottom;\n      }\n      if (y1 < y2) {\n        x0 <<= 0x10;\n        x2 = x0;\n        if (y0 < 0) {\n          x2 -= xStepAC * y0;\n          x0 -= xStepAB * y0;\n          y0 = 0;\n        }\n        x1 <<= 0x10;\n        if (y1 < 0) {\n          x1 -= xStepBC * y1;\n          y1 = 0;\n        }\n        if ((y0 != y1 && xStepAC < xStepAB) || (y0 == y1 && xStepAC > xStepBC)) {\n          y2 -= y1;\n          y1 -= y0;\n          y0 = y0 * width;\n          while (true) {\n            y1--;\n            if (y1 < 0) {\n              while (true) {\n                y2--;\n                if (y2 < 0) {\n                  return;\n                }\n                rasterScanline(x2 >> 16, x1 >> 16, y0, color);\n                x2 += xStepAC;\n                x1 += xStepBC;\n                y0 += width;\n              }\n            }\n            rasterScanline(x2 >> 16, x0 >> 16, y0, color);\n            x2 += xStepAC;\n            x0 += xStepAB;\n            y0 += width;\n          }\n        } else {\n          y2 -= y1;\n          y1 -= y0;\n          y0 = y0 * width;\n          while (true) {\n            y1--;\n            if (y1 < 0) {\n              while (true) {\n                y2--;\n                if (y2 < 0) {\n                  return;\n                }\n                rasterScanline(x1 >> 16, x2 >> 16, y0, color);\n                x2 += xStepAC;\n                x1 += xStepBC;\n                y0 += width;\n              }\n            }\n            rasterScanline(x0 >> 16, x2 >> 16, y0, color);\n            x2 += xStepAC;\n            x0 += xStepAB;\n            y0 += width;\n          }\n        }\n      } else {\n        x0 <<= 0x10;\n        x1 = x0;\n        if (y0 < 0) {\n          x1 -= xStepAC * y0;\n          x0 -= xStepAB * y0;\n          y0 = 0;\n        }\n        x2 <<= 0x10;\n        if (y2 < 0) {\n          x2 -= xStepBC * y2;\n          y2 = 0;\n        }\n        if ((y0 != y2 && xStepAC < xStepAB) || (y0 == y2 && xStepBC > xStepAB)) {\n          y1 -= y2;\n          y2 -= y0;\n          y0 = y0 * width;\n          while (true) {\n            y2--;\n            if (y2 < 0) {\n              while (true) {\n                y1--;\n                if (y1 < 0) {\n                  return;\n                }\n                rasterScanline(x2 >> 16, x0 >> 16, y0, color);\n                x2 += xStepBC;\n                x0 += xStepAB;\n                y0 += width;\n              }\n            }\n            rasterScanline(x1 >> 16, x0 >> 16, y0, color);\n            x1 += xStepAC;\n            x0 += xStepAB;\n            y0 += width;\n          }\n        } else {\n          y1 -= y2;\n          y2 -= y0;\n          y0 = y0 * width;\n          while (true) {\n            y2--;\n            if (y2 < 0) {\n              while (true) {\n                y1--;\n                if (y1 < 0) {\n                  return;\n                }\n                rasterScanline(x0 >> 16, x2 >> 16, y0, color);\n                x2 += xStepBC;\n                x0 += xStepAB;\n                y0 += width;\n              }\n            }\n            rasterScanline(x0 >> 16, x1 >> 16, y0, color);\n            x1 += xStepAC;\n            x0 += xStepAB;\n            y0 += width;\n          }\n        }\n      }\n    }\n  } else if (y1 <= y2) {\n    if (y1 < boundBottom) {\n      if (y2 > boundBottom) {\n        y2 = boundBottom;\n      }\n      if (y0 > boundBottom) {\n        y0 = boundBottom;\n      }\n      if (y2 < y0) {\n        x1 <<= 0x10;\n        x0 = x1;\n        if (y1 < 0) {\n          x0 -= xStepAB * y1;\n          x1 -= xStepBC * y1;\n          y1 = 0;\n        }\n        x2 <<= 0x10;\n        if (y2 < 0) {\n          x2 -= xStepAC * y2;\n          y2 = 0;\n        }\n        if ((y1 != y2 && xStepAB < xStepBC) || (y1 == y2 && xStepAB > xStepAC)) {\n          y0 -= y2;\n          y2 -= y1;\n          y1 = y1 * width;\n          while (true) {\n            y2--;\n            if (y2 < 0) {\n              while (true) {\n                y0--;\n                if (y0 < 0) {\n                  return;\n                }\n                rasterScanline(x0 >> 16, x2 >> 16, y1, color);\n                x0 += xStepAB;\n                x2 += xStepAC;\n                y1 += width;\n              }\n            }\n            rasterScanline(x0 >> 16, x1 >> 16, y1, color);\n            x0 += xStepAB;\n            x1 += xStepBC;\n            y1 += width;\n          }\n        } else {\n          y0 -= y2;\n          y2 -= y1;\n          y1 = y1 * width;\n          while (true) {\n            y2--;\n            if (y2 < 0) {\n              while (true) {\n                y0--;\n                if (y0 < 0) {\n                  return;\n                }\n                rasterScanline(x2 >> 16, x0 >> 16, y1, color);\n                x0 += xStepAB;\n                x2 += xStepAC;\n                y1 += width;\n              }\n            }\n            rasterScanline(x1 >> 16, x0 >> 16, y1, color);\n            x0 += xStepAB;\n            x1 += xStepBC;\n            y1 += width;\n          }\n        }\n      } else {\n        x1 <<= 0x10;\n        x2 = x1;\n        if (y1 < 0) {\n          x2 -= xStepAB * y1;\n          x1 -= xStepBC * y1;\n          y1 = 0;\n        }\n        x0 <<= 0x10;\n        if (y0 < 0) {\n          x0 -= xStepAC * y0;\n          y0 = 0;\n        }\n        if (xStepAB < xStepBC) {\n          y2 -= y0;\n          y0 -= y1;\n          y1 = y1 * width;\n          while (true) {\n            y0--;\n            if (y0 < 0) {\n              while (true) {\n                y2--;\n                if (y2 < 0) {\n                  return;\n                }\n                rasterScanline(x0 >> 16, x1 >> 16, y1, color);\n                x0 += xStepAC;\n                x1 += xStepBC;\n                y1 += width;\n              }\n            }\n            rasterScanline(x2 >> 16, x1 >> 16, y1, color);\n            x2 += xStepAB;\n            x1 += xStepBC;\n            y1 += width;\n          }\n        } else {\n          y2 -= y0;\n          y0 -= y1;\n          y1 = y1 * width;\n          while (true) {\n            y0--;\n            if (y0 < 0) {\n              while (true) {\n                y2--;\n                if (y2 < 0) {\n                  return;\n                }\n                rasterScanline(x1 >> 16, x0 >> 16, y1, color);\n                x0 += xStepAC;\n                x1 += xStepBC;\n                y1 += width;\n              }\n            }\n            rasterScanline(x1 >> 16, x2 >> 16, y1, color);\n            x2 += xStepAB;\n            x1 += xStepBC;\n            y1 += width;\n          }\n        }\n      }\n    }\n  } else if (y2 < boundBottom) {\n    if (y0 > boundBottom) {\n      y0 = boundBottom;\n    }\n    if (y1 > boundBottom) {\n      y1 = boundBottom;\n    }\n    if (y0 < y1) {\n      x2 <<= 0x10;\n      x1 = x2;\n      if (y2 < 0) {\n        x1 -= xStepBC * y2;\n        x2 -= xStepAC * y2;\n        y2 = 0;\n      }\n      x0 <<= 0x10;\n      if (y0 < 0) {\n        x0 -= xStepAB * y0;\n        y0 = 0;\n      }\n      if (xStepBC < xStepAC) {\n        y1 -= y0;\n        y0 -= y2;\n        y2 = y2 * width;\n        while (true) {\n          y0--;\n          if (y0 < 0) {\n            while (true) {\n              y1--;\n              if (y1 < 0) {\n                return;\n              }\n              rasterScanline(x1 >> 16, x0 >> 16, y2, color);\n              x1 += xStepBC;\n              x0 += xStepAB;\n              y2 += width;\n            }\n          }\n          rasterScanline(x1 >> 16, x2 >> 16, y2, color);\n          x1 += xStepBC;\n          x2 += xStepAC;\n          y2 += width;\n        }\n      } else {\n        y1 -= y0;\n        y0 -= y2;\n        y2 = y2 * width;\n        while (true) {\n          y0--;\n          if (y0 < 0) {\n            while (true) {\n              y1--;\n              if (y1 < 0) {\n                return;\n              }\n              rasterScanline(x0 >> 16, x1 >> 16, y2, color);\n              x1 += xStepBC;\n              x0 += xStepAB;\n              y2 += width;\n            }\n          }\n          rasterScanline(x2 >> 16, x1 >> 16, y2, color);\n          x1 += xStepBC;\n          x2 += xStepAC;\n          y2 += width;\n        }\n      }\n    } else {\n      x2 <<= 0x10;\n      x0 = x2;\n      if (y2 < 0) {\n        x0 -= xStepBC * y2;\n        x2 -= xStepAC * y2;\n        y2 = 0;\n      }\n      x1 <<= 0x10;\n      if (y1 < 0) {\n        x1 -= xStepAB * y1;\n        y1 = 0;\n      }\n      if (xStepBC < xStepAC) {\n        y0 -= y1;\n        y1 -= y2;\n        y2 = y2 * width;\n        while (true) {\n          y1--;\n          if (y1 < 0) {\n            while (true) {\n              y0--;\n              if (y0 < 0) {\n                return;\n              }\n              rasterScanline(x1 >> 16, x2 >> 16, y2, color);\n              x1 += xStepAB;\n              x2 += xStepAC;\n              y2 += width;\n            }\n          }\n          rasterScanline(x0 >> 16, x2 >> 16, y2, color);\n          x0 += xStepBC;\n          x2 += xStepAC;\n          y2 += width;\n        }\n      } else {\n        y0 -= y1;\n        y1 -= y2;\n        y2 = y2 * width;\n        while (true) {\n          y1--;\n          if (y1 < 0) {\n            while (true) {\n              y0--;\n              if (y0 < 0) {\n                return;\n              }\n              rasterScanline(x2 >> 16, x1 >> 16, y2, color);\n              x1 += xStepAB;\n              x2 += xStepAC;\n              y2 += width;\n            }\n          }\n          rasterScanline(x2 >> 16, x0 >> 16, y2, color);\n          x0 += xStepBC;\n          x2 += xStepAC;\n          y2 += width;\n        }\n      }\n    }\n  }\n}\n\nfn rasterScanline(x0In: i32, x1In: i32, offsetIn: i32, rgbIn: u32) {\n  var x0 = x0In;\n  var x1 = x1In;\n  var offset = offsetIn;\n  var rgb = rgbIn;\n  if (clipX) {\n    if (x1 > boundX) {\n      x1 = boundX;\n    }\n    if (x0 < 0) {\n      x0 = 0;\n    }\n  }  \n  if (x0 >= x1) {\n    return;\n  }  \n  offset += x0;  \n  var length = x1 - x0;\n  if (writeDepth) {\n    for (var x = 0; x < length; x++) {\n      atomicMax(&depthBuffer[offset + x], depth);\n    }\n  } else if (alpha == 0) {\n    for (var x = 0; x < length; x++) {\n      setPixel(offset + x, rgb);\n    }\n  } else {\n    length >>= 2;\n    let alpha = alpha;\n    let invAlpha = 256 - alpha;\n    rgb = ((((rgb & 0xff00ff) * invAlpha) >> 8) & 0xff00ff) + ((((rgb & 0xff00) * invAlpha) >> 8) & 0xff00);\n    var blendRgb: u32;\n    while (true) {\n      length--;\n      if (length < 0) {\n        length = (x1 - x0) & 0x3;\n        if (length > 0) {\n          while (true) {\n            blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n            setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n            offset++;\n            length--;\n            if (length <= 0) {\n              break;\n            }\n          }\n        }\n        break;\n      }\n      blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n      setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n      offset++;\n      blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n      setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n      offset++;\n      blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n      setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n      offset++;\n      blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n      setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n      offset++;\n    }\n  }\n}\n\nfn rasterGouraudTriangle(xAIn: i32, xBIn: i32, xCIn: i32, yAIn: i32, yBIn: i32, yCIn: i32, colorAIn: i32, colorBIn: i32, colorCIn: i32) {\n  var xA = xAIn;\n  var xB = xBIn;\n  var xC = xCIn;\n  var yA = yAIn;\n  var yB = yBIn;\n  var yC = yCIn;\n  var colorA = colorAIn;\n  var colorB = colorBIn;\n  var colorC = colorCIn;\n  clipX = xA < 0 || xB < 0 || xC < 0 || xA > boundX || xB > boundX || xC > boundX;\n  var xStepAB: i32;\n  var colorStepAB: i32;\n  if (yB != yA) {\n    xStepAB = ((xB - xA) << 16) / (yB - yA);\n    colorStepAB = ((colorB - colorA) << 15) / (yB - yA);\n  }\n  var xStepBC: i32;\n  var colorStepBC: i32;\n  if (yC != yB) {\n    xStepBC = ((xC - xB) << 16) / (yC - yB);\n    colorStepBC = ((colorC - colorB) << 15) / (yC - yB);\n  }\n  var xStepAC: i32;\n  var colorStepAC: i32;\n  if (yC != yA) {\n    xStepAC = ((xA - xC) << 16) / (yA - yC);\n    colorStepAC = ((colorA - colorC) << 15) / (yA - yC);\n  }\n\n  if (yA <= yB && yA <= yC) {\n    if (yA < boundBottom) {\n      if (yB > boundBottom) {\n        yB = boundBottom;\n      }\n      if (yC > boundBottom) {\n        yC = boundBottom;\n      }\n      if (yB < yC) {\n        xA <<= 0x10;\n        xC = xA;\n        colorA <<= 0xf;\n        colorC = colorA;\n        if (yA < 0) {\n          xC -= xStepAC * yA;\n          xA -= xStepAB * yA;\n          colorC -= colorStepAC * yA;\n          colorA -= colorStepAB * yA;\n          yA = 0;\n        }\n        xB <<= 0x10;\n        colorB <<= 0xf;\n        if (yB < 0) {\n          xB -= xStepBC * yB;\n          colorB -= colorStepBC * yB;\n          yB = 0;\n        }\n        if ((yA != yB && xStepAC < xStepAB) || (yA == yB && xStepAC > xStepBC)) {\n          yC -= yB;\n          yB -= yA;\n          yA = yA * width;\n          while (true) {\n            yB--;\n            if (yB < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xC >> 16, xB >> 16, colorC >> 7, colorB >> 7, yA);\n                xC += xStepAC;\n                xB += xStepBC;\n                colorC += colorStepAC;\n                colorB += colorStepBC;\n                yA += width;\n              }\n            }\n            rasterGouraudScanline(xC >> 16, xA >> 16, colorC >> 7, colorA >> 7, yA);\n            xC += xStepAC;\n            xA += xStepAB;\n            colorC += colorStepAC;\n            colorA += colorStepAB;\n            yA += width;\n          }\n        } else {\n          yC -= yB;\n          yB -= yA;\n          yA = yA * width;\n          while (true) {\n            yB--;\n            if (yB < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xB >> 16, xC >> 16, colorB >> 7, colorC >> 7, yA);\n                xC += xStepAC;\n                xB += xStepBC;\n                colorC += colorStepAC;\n                colorB += colorStepBC;\n                yA += width;\n              }\n            }\n            rasterGouraudScanline(xA >> 16, xC >> 16, colorA >> 7, colorC >> 7, yA);\n            xC += xStepAC;\n            xA += xStepAB;\n            colorC += colorStepAC;\n            colorA += colorStepAB;\n            yA += width;\n          }\n        }\n      } else {\n        xA <<= 0x10;\n        xB = xA;\n        colorA <<= 0xf;\n        colorB = colorA;\n        if (yA < 0) {\n          xB -= xStepAC * yA;\n          xA -= xStepAB * yA;\n          colorB -= colorStepAC * yA;\n          colorA -= colorStepAB * yA;\n          yA = 0;\n        }\n        xC <<= 0x10;\n        colorC <<= 0xf;\n        if (yC < 0) {\n          xC -= xStepBC * yC;\n          colorC -= colorStepBC * yC;\n          yC = 0;\n        }\n        if ((yA != yC && xStepAC < xStepAB) || (yA == yC && xStepBC > xStepAB)) {\n          yB -= yC;\n          yC -= yA;\n          yA = yA * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yB--;\n                if (yB < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xC >> 16, xA >> 16, colorC >> 7, colorA >> 7, yA);\n                xC += xStepBC;\n                xA += xStepAB;\n                colorC += colorStepBC;\n                colorA += colorStepAB;\n                yA += width;\n              }\n            }\n            rasterGouraudScanline(xB >> 16, xA >> 16, colorB >> 7, colorA >> 7, yA);\n            xB += xStepAC;\n            xA += xStepAB;\n            colorB += colorStepAC;\n            colorA += colorStepAB;\n            yA += width;\n          }\n        } else {\n          yB -= yC;\n          yC -= yA;\n          yA = yA * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yB--;\n                if (yB < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xA >> 16, xC >> 16, colorA >> 7, colorC >> 7, yA);\n                xC += xStepBC;\n                xA += xStepAB;\n                colorC += colorStepBC;\n                colorA += colorStepAB;\n                yA += width;\n              }\n            }\n            rasterGouraudScanline(xA >> 16, xB >> 16, colorA >> 7, colorB >> 7, yA);\n            xB += xStepAC;\n            xA += xStepAB;\n            colorB += colorStepAC;\n            colorA += colorStepAB;\n            yA += width;\n          }\n        }\n      }\n    }\n  } else if (yB <= yC) {\n    if (yB < boundBottom) {\n      if (yC > boundBottom) {\n        yC = boundBottom;\n      }\n      if (yA > boundBottom) {\n        yA = boundBottom;\n      }\n      if (yC < yA) {\n        xB <<= 0x10;\n        xA = xB;\n        colorB <<= 0xf;\n        colorA = colorB;\n        if (yB < 0) {\n          xA -= xStepAB * yB;\n          xB -= xStepBC * yB;\n          colorA -= colorStepAB * yB;\n          colorB -= colorStepBC * yB;\n          yB = 0;\n        }\n        xC <<= 0x10;\n        colorC <<= 0xf;\n        if (yC < 0) {\n          xC -= xStepAC * yC;\n          colorC -= colorStepAC * yC;\n          yC = 0;\n        }\n        if ((yB != yC && xStepAB < xStepBC) || (yB == yC && xStepAB > xStepAC)) {\n          yA -= yC;\n          yC -= yB;\n          yB = yB * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yA--;\n                if (yA < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xA >> 16, xC >> 16, colorA >> 7, colorC >> 7, yB);\n                xA += xStepAB;\n                xC += xStepAC;\n                colorA += colorStepAB;\n                colorC += colorStepAC;\n                yB += width;\n              }\n            }\n            rasterGouraudScanline(xA >> 16, xB >> 16, colorA >> 7, colorB >> 7, yB);\n            xA += xStepAB;\n            xB += xStepBC;\n            colorA += colorStepAB;\n            colorB += colorStepBC;\n            yB += width;\n          }\n        } else {\n          yA -= yC;\n          yC -= yB;\n          yB = yB * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yA--;\n                if (yA < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xC >> 16, xA >> 16, colorC >> 7, colorA >> 7, yB);\n                xA += xStepAB;\n                xC += xStepAC;\n                colorA += colorStepAB;\n                colorC += colorStepAC;\n                yB += width;\n              }\n            }\n            rasterGouraudScanline(xB >> 16, xA >> 16, colorB >> 7, colorA >> 7, yB);\n            xA += xStepAB;\n            xB += xStepBC;\n            colorA += colorStepAB;\n            colorB += colorStepBC;\n            yB += width;\n          }\n        }\n      } else {\n        xB <<= 0x10;\n        xC = xB;\n        colorB <<= 0xf;\n        colorC = colorB;\n        if (yB < 0) {\n          xC -= xStepAB * yB;\n          xB -= xStepBC * yB;\n          colorC -= colorStepAB * yB;\n          colorB -= colorStepBC * yB;\n          yB = 0;\n        }\n        xA <<= 0x10;\n        colorA <<= 0xf;\n        if (yA < 0) {\n          xA -= xStepAC * yA;\n          colorA -= colorStepAC * yA;\n          yA = 0;\n        }\n        yC -= yA;\n        yA -= yB;\n        yB = yB * width;\n        if (xStepAB < xStepBC) {\n          while (true) {\n            yA--;\n            if (yA < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xA >> 16, xB >> 16, colorA >> 7, colorB >> 7, yB);\n                xA += xStepAC;\n                xB += xStepBC;\n                colorA += colorStepAC;\n                colorB += colorStepBC;\n                yB += width;\n              }\n            }\n            rasterGouraudScanline(xC >> 16, xB >> 16, colorC >> 7, colorB >> 7, yB);\n            xC += xStepAB;\n            xB += xStepBC;\n            colorC += colorStepAB;\n            colorB += colorStepBC;\n            yB += width;\n          }\n        } else {\n          while (true) {\n            yA--;\n            if (yA < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterGouraudScanline(xB >> 16, xA >> 16, colorB >> 7, colorA >> 7, yB);\n                xA += xStepAC;\n                xB += xStepBC;\n                colorA += colorStepAC;\n                colorB += colorStepBC;\n                yB += width;\n              }\n            }\n            rasterGouraudScanline(xB >> 16, xC >> 16, colorB >> 7, colorC >> 7, yB);\n            xC += xStepAB;\n            xB += xStepBC;\n            colorC += colorStepAB;\n            colorB += colorStepBC;\n            yB += width;\n          }\n        }\n      }\n    }\n  } else if (yC < boundBottom) {\n    if (yA > boundBottom) {\n      yA = boundBottom;\n    }\n    if (yB > boundBottom) {\n      yB = boundBottom;\n    }\n    if (yA < yB) {\n      xC <<= 0x10;\n      xB = xC;\n      colorC <<= 0xf;\n      colorB = colorC;\n      if (yC < 0) {\n        xB -= xStepBC * yC;\n        xC -= xStepAC * yC;\n        colorB -= colorStepBC * yC;\n        colorC -= colorStepAC * yC;\n        yC = 0;\n      }\n      xA <<= 0x10;\n      colorA <<= 0xf;\n      if (yA < 0) {\n        xA -= xStepAB * yA;\n        colorA -= colorStepAB * yA;\n        yA = 0;\n      }\n      yB -= yA;\n      yA -= yC;\n      yC = yC * width;\n      if (xStepBC < xStepAC) {\n        while (true) {\n          yA--;\n          if (yA < 0) {\n            while (true) {\n              yB--;\n              if (yB < 0) {\n                return;\n              }\n              rasterGouraudScanline(xB >> 16, xA >> 16, colorB >> 7, colorA >> 7, yC);\n              xB += xStepBC;\n              xA += xStepAB;\n              colorB += colorStepBC;\n              colorA += colorStepAB;\n              yC += width;\n            }\n          }\n          rasterGouraudScanline(xB >> 16, xC >> 16, colorB >> 7, colorC >> 7, yC);\n          xB += xStepBC;\n          xC += xStepAC;\n          colorB += colorStepBC;\n          colorC += colorStepAC;\n          yC += width;\n        }\n      } else {\n        while (true) {\n          yA--;\n          if (yA < 0) {\n            while (true) {\n              yB--;\n              if (yB < 0) {\n                return;\n              }\n              rasterGouraudScanline(xA >> 16, xB >> 16, colorA >> 7, colorB >> 7, yC);\n              xB += xStepBC;\n              xA += xStepAB;\n              colorB += colorStepBC;\n              colorA += colorStepAB;\n              yC += width;\n            }\n          }\n          rasterGouraudScanline(xC >> 16, xB >> 16, colorC >> 7, colorB >> 7, yC);\n          xB += xStepBC;\n          xC += xStepAC;\n          colorB += colorStepBC;\n          colorC += colorStepAC;\n          yC += width;\n        }\n      }\n    } else {\n      xC <<= 0x10;\n      xA = xC;\n      colorC <<= 0xf;\n      colorA = colorC;\n      if (yC < 0) {\n        xA -= xStepBC * yC;\n        xC -= xStepAC * yC;\n        colorA -= colorStepBC * yC;\n        colorC -= colorStepAC * yC;\n        yC = 0;\n      }\n      xB <<= 0x10;\n      colorB <<= 0xf;\n      if (yB < 0) {\n        xB -= xStepAB * yB;\n        colorB -= colorStepAB * yB;\n        yB = 0;\n      }\n      yA -= yB;\n      yB -= yC;\n      yC = yC * width;\n      if (xStepBC < xStepAC) {\n        while (true) {\n          yB--;\n          if (yB < 0) {\n            while (true) {\n              yA--;\n              if (yA < 0) {\n                return;\n              }\n              rasterGouraudScanline(xB >> 16, xC >> 16, colorB >> 7, colorC >> 7, yC);\n              xB += xStepAB;\n              xC += xStepAC;\n              colorB += colorStepAB;\n              colorC += colorStepAC;\n              yC += width;\n            }\n          }\n          rasterGouraudScanline(xA >> 16, xC >> 16, colorA >> 7, colorC >> 7, yC);\n          xA += xStepBC;\n          xC += xStepAC;\n          colorA += colorStepBC;\n          colorC += colorStepAC;\n          yC += width;\n        }\n      } else {\n        while (true) {\n          yB--;\n          if (yB < 0) {\n            while (true) {\n              yA--;\n              if (yA < 0) {\n                return;\n              }\n              rasterGouraudScanline(xC >> 16, xB >> 16, colorC >> 7, colorB >> 7, yC);\n              xB += xStepAB;\n              xC += xStepAC;\n              colorB += colorStepAB;\n              colorC += colorStepAC;\n              yC += width;\n            }\n          }\n          rasterGouraudScanline(xC >> 16, xA >> 16, colorC >> 7, colorA >> 7, yC);\n          xA += xStepBC;\n          xC += xStepAC;\n          colorA += colorStepBC;\n          colorC += colorStepAC;\n          yC += width;\n        }\n      }\n    }\n  }\n}\n\nfn rasterGouraudScanline(x0In: i32, x1In: i32, color0In: i32, color1: i32, offsetIn: i32) {\n  var x0 = x0In;\n  var x1 = x1In;\n  var color0 = color0In;\n  var offset = offsetIn;\n\n  var rgb: u32;\n  if (jagged) {\n    var colorStep: i32;\n    var length: i32;\n\n    if (clipX) {\n      if (x1 - x0 > 3) {\n        colorStep = ((color1 - color0) / (x1 - x0));\n      } else {\n        colorStep = 0;\n      }\n      if (x1 > boundX) {\n        x1 = boundX;\n      }\n      if (x0 < 0) {\n        color0 -= x0 * colorStep;\n        x0 = 0;\n      }\n      if (x0 >= x1) {\n        return;\n      }\n      offset += x0;\n      length = (x1 - x0) >> 2;\n      colorStep <<= 0x2;\n    } else if (x0 < x1) {\n      offset += x0;\n      length = (x1 - x0) >> 2;\n      if (length > 0) {\n        colorStep = ((color1 - color0) * reciprocal15(length)) >> 15;\n      } else {\n        colorStep = 0;\n      }\n    } else {\n      return;\n    }\n    \n    if (alpha == 0) {\n      while (true) {\n        length--;\n        if (length < 0) {\n          length = (x1 - x0) & 0x3;\n          if (length > 0) {\n            rgb = luts.palette[color0 >> 8];\n            while (true) {\n              setPixel(offset, rgb);\n              offset++;\n              length--;\n              if (length <= 0) {\n                break;\n              }\n            }\n            return;\n          }\n          break;\n        }\n        rgb = luts.palette[color0 >> 8];\n        color0 += colorStep;\n        setPixel(offset, rgb);\n        offset++;\n        setPixel(offset, rgb);\n        offset++;\n        setPixel(offset, rgb);\n        offset++;\n        setPixel(offset, rgb);\n        offset++;\n      }\n    } else {\n      let alpha = alpha;\n      let invAlpha = 256 - alpha;\n      var blendRgb: u32;\n      while (true) {\n        length--;\n        if (length < 0) {\n          length = (x1 - x0) & 0x3;\n          if (length > 0) {\n            rgb = luts.palette[color0 >> 8];\n            rgb = ((((rgb & 0xff00ff) * invAlpha) >> 8) & 0xff00ff) + ((((rgb & 0xff00) * invAlpha) >> 8) & 0xff00);\n            while (true) {\n              blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n              setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n              offset++;\n              length--;\n              if (length <= 0) {\n                break;\n              }\n            }\n          }\n          break;\n        }\n        rgb = luts.palette[color0 >> 8];\n        color0 += colorStep;\n        rgb = ((((rgb & 0xff00ff) * invAlpha) >> 8) & 0xff00ff) + ((((rgb & 0xff00) * invAlpha) >> 8) & 0xff00);\n        blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n        setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n        offset++;\n        blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n        setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n        offset++;\n        blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n        setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n        offset++;\n        blendRgb = pixelBuffer.data[offset + i32(atomicLoad(&depthBuffer[offset + 1]) < depth)];\n        setPixel(offset, rgb + ((((blendRgb & 0xff00ff) * alpha) >> 8) & 0xff00ff) + ((((blendRgb & 0xff00) * alpha) >> 8) & 0xff00));\n        offset++;\n      }\n    }\n  }\n}\n\nfn rasterTexturedTriangle(\n  xAIn: i32,\n  xBIn: i32,\n  xCIn: i32,\n  yAIn: i32,\n  yBIn: i32,\n  yCIn: i32,\n  shadeAIn: i32,\n  shadeBIn: i32,\n  shadeCIn: i32,\n  originXIn: i32,\n  originYIn: i32,\n  originZIn: i32,\n  txBIn: i32,\n  txCIn: i32,\n  tyBIn: i32,\n  tyCIn: i32,\n  tzBIn: i32,\n  tzCIn: i32,\n  textureId: i32\n) {\n  var xA = xAIn;\n  var xB = xBIn;\n  var xC = xCIn;\n  var yA = yAIn;\n  var yB = yBIn;\n  var yC = yCIn;\n  var shadeA = shadeAIn;\n  var shadeB = shadeBIn;\n  var shadeC = shadeCIn;\n  var originX = originXIn;\n  var originY = originYIn;\n  var originZ = originZIn;\n  var txB = txBIn;\n  var txC = txCIn;\n  var tyB = tyBIn;\n  var tyC = tyCIn;\n  var tzB = tzBIn;\n  var tzC = tzCIn;\n  let texels = &luts.textures[textureId];\n  opaqueTexture = luts.texturesTranslucent[textureId] == 0;\n  clipX = xA < 0 || xB < 0 || xC < 0 || xA > boundX || xB > boundX || xC > boundX;\n\n  let verticalX = originX - txB;\n  let verticalY = originY - tyB;\n  let verticalZ = originZ - tzB;\n\n  let horizontalX = txC - originX;\n  let horizontalY = tyC - originY;\n  let horizontalZ = tzC - originZ;\n\n  var u = (horizontalX * originY - horizontalY * originX) << 14;\n  let uStride = (horizontalY * originZ - horizontalZ * originY) << 8;\n  let uStepVertical = (horizontalZ * originX - horizontalX * originZ) << 5;\n\n  var v = (verticalX * originY - verticalY * originX) << 14;\n  let vStride = (verticalY * originZ - verticalZ * originY) << 8;\n  let vStepVertical = (verticalZ * originX - verticalX * originZ) << 5;\n\n  var w = (verticalY * horizontalX - verticalX * horizontalY) << 14;\n  let wStride = (verticalZ * horizontalY - verticalY * horizontalZ) << 8;\n  let wStepVertical = (verticalX * horizontalZ - verticalZ * horizontalX) << 5;\n\n  var xStepAB = 0;\n  var shadeStepAB = 0;\n  if (yB != yA) {\n    xStepAB = (((xB - xA) << 16) / (yB - yA));\n    shadeStepAB = (((shadeB - shadeA) << 16) / (yB - yA));\n  }\n\n  var xStepBC = 0;\n  var shadeStepBC = 0;\n  if (yC != yB) {\n    xStepBC = (((xC - xB) << 16) / (yC - yB));\n    shadeStepBC = (((shadeC - shadeB) << 16) / (yC - yB));\n  }\n\n  var xStepAC = 0;\n  var shadeStepAC = 0;\n  if (yC != yA) {\n    xStepAC = (((xA - xC) << 16) / (yA - yC));\n    shadeStepAC = (((shadeA - shadeC) << 16) / (yA - yC));\n  }\n\n  if (yA <= yB && yA <= yC) {\n    if (yA < boundBottom) {\n      if (yB > boundBottom) {\n        yB = boundBottom;\n      }\n  \n      if (yC > boundBottom) {\n        yC = boundBottom;\n      }\n  \n      if (yB < yC) {\n        xA <<= 0x10;\n        xC = xA;\n        shadeA <<= 0x10;\n        shadeC = shadeA;\n        if (yA < 0) {\n          xC -= xStepAC * yA;\n          xA -= xStepAB * yA;\n          shadeC -= shadeStepAC * yA;\n          shadeA -= shadeStepAB * yA;\n          yA = 0;\n        }\n        xB <<= 0x10;\n        shadeB <<= 0x10;\n        if (yB < 0) {\n          xB -= xStepBC * yB;\n          shadeB -= shadeStepBC * yB;\n          yB = 0;\n        }\n        let dy = yA - centerY;\n        u += uStepVertical * dy;\n        v += vStepVertical * dy;\n        w += wStepVertical * dy;\n        if ((yA != yB && xStepAC < xStepAB) || (yA == yB && xStepAC > xStepBC)) {\n          yC -= yB;\n          yB -= yA;\n          yA = yA * width;\n          while (true) {\n            yB--;\n            if (yB < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xC >> 16, xB >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeB >> 8);\n                xC += xStepAC;\n                xB += xStepBC;\n                shadeC += shadeStepAC;\n                shadeB += shadeStepBC;\n                yA += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xC >> 16, xA >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeA >> 8);\n            xC += xStepAC;\n            xA += xStepAB;\n            shadeC += shadeStepAC;\n            shadeA += shadeStepAB;\n            yA += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        } else {\n          yC -= yB;\n          yB -= yA;\n          yA = yA * width;\n          while (true) {\n            yB--;\n            if (yB < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xB >> 16, xC >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeC >> 8);\n                xC += xStepAC;\n                xB += xStepBC;\n                shadeC += shadeStepAC;\n                shadeB += shadeStepBC;\n                yA += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xA >> 16, xC >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeC >> 8);\n            xC += xStepAC;\n            xA += xStepAB;\n            shadeC += shadeStepAC;\n            shadeA += shadeStepAB;\n            yA += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        }\n      } else {\n        xA <<= 0x10;\n        xB = xA;\n        shadeA <<= 0x10;\n        shadeB = shadeA;\n        if (yA < 0) {\n          xB -= xStepAC * yA;\n          xA -= xStepAB * yA;\n          shadeB -= shadeStepAC * yA;\n          shadeA -= shadeStepAB * yA;\n          yA = 0;\n        }\n        xC <<= 0x10;\n        shadeC <<= 0x10;\n        if (yC < 0) {\n          xC -= xStepBC * yC;\n          shadeC -= shadeStepBC * yC;\n          yC = 0;\n        }\n        let dy = yA - centerY;\n        u += uStepVertical * dy;\n        v += vStepVertical * dy;\n        w += wStepVertical * dy;\n        if ((yA == yC || xStepAC >= xStepAB) && (yA != yC || xStepBC <= xStepAB)) {\n          yB -= yC;\n          yC -= yA;\n          yA = yA * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yB--;\n                if (yB < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xA >> 16, xC >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeC >> 8);\n                xC += xStepBC;\n                xA += xStepAB;\n                shadeC += shadeStepBC;\n                shadeA += shadeStepAB;\n                yA += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xA >> 16, xB >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeB >> 8);\n            xB += xStepAC;\n            xA += xStepAB;\n            shadeB += shadeStepAC;\n            shadeA += shadeStepAB;\n            yA += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        } else {\n          yB -= yC;\n          yC -= yA;\n          yA = yA * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yB--;\n                if (yB < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xC >> 16, xA >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeA >> 8);\n                xC += xStepBC;\n                xA += xStepAB;\n                shadeC += shadeStepBC;\n                shadeA += shadeStepAB;\n                yA += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xB >> 16, xA >> 16, yA, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeA >> 8);\n            xB += xStepAC;\n            xA += xStepAB;\n            shadeB += shadeStepAC;\n            shadeA += shadeStepAB;\n            yA += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        }\n      }\n    }\n  } else if (yB <= yC) {\n    if (yB < boundBottom) {\n      if (yC > boundBottom) {\n        yC = boundBottom;\n      }\n      if (yA > boundBottom) {\n        yA = boundBottom;\n      }\n      if (yC < yA) {\n        xB <<= 0x10;\n        xA = xB;\n        shadeB <<= 0x10;\n        shadeA = shadeB;\n        if (yB < 0) {\n          xA -= xStepAB * yB;\n          xB -= xStepBC * yB;\n          shadeA -= shadeStepAB * yB;\n          shadeB -= shadeStepBC * yB;\n          yB = 0;\n        }\n        xC <<= 0x10;\n        shadeC <<= 0x10;\n        if (yC < 0) {\n          xC -= xStepAC * yC;\n          shadeC -= shadeStepAC * yC;\n          yC = 0;\n        }\n        let dy = yB - centerY;\n        u += uStepVertical * dy;\n        v += vStepVertical * dy;\n        w += wStepVertical * dy;\n        if ((yB != yC && xStepAB < xStepBC) || (yB == yC && xStepAB > xStepAC)) {\n          yA -= yC;\n          yC -= yB;\n          yB = yB * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yA--;\n                if (yA < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xA >> 16, xC >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeC >> 8);\n                xA += xStepAB;\n                xC += xStepAC;\n                shadeA += shadeStepAB;\n                shadeC += shadeStepAC;\n                yB += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xA >> 16, xB >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeB >> 8);\n            xA += xStepAB;\n            xB += xStepBC;\n            shadeA += shadeStepAB;\n            shadeB += shadeStepBC;\n            yB += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        } else {\n          yA -= yC;\n          yC -= yB;\n          yB = yB * width;\n          while (true) {\n            yC--;\n            if (yC < 0) {\n              while (true) {\n                yA--;\n                if (yA < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xC >> 16, xA >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeA >> 8);\n                xA += xStepAB;\n                xC += xStepAC;\n                shadeA += shadeStepAB;\n                shadeC += shadeStepAC;\n                yB += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xB >> 16, xA >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeA >> 8);\n            xA += xStepAB;\n            xB += xStepBC;\n            shadeA += shadeStepAB;\n            shadeB += shadeStepBC;\n            yB += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        }\n      } else {\n        xB <<= 0x10;\n        xC = xB;\n        shadeB <<= 0x10;\n        shadeC = shadeB;\n        if (yB < 0) {\n          xC -= xStepAB * yB;\n          xB -= xStepBC * yB;\n          shadeC -= shadeStepAB * yB;\n          shadeB -= shadeStepBC * yB;\n          yB = 0;\n        }\n        xA <<= 0x10;\n        shadeA <<= 0x10;\n        if (yA < 0) {\n          xA -= xStepAC * yA;\n          shadeA -= shadeStepAC * yA;\n          yA = 0;\n        }\n        let dy = yB - centerY;\n        u += uStepVertical * dy;\n        v += vStepVertical * dy;\n        w += wStepVertical * dy;\n        yC -= yA;\n        yA -= yB;\n        yB = yB * width;\n        if (xStepAB < xStepBC) {\n          while (true) {\n            yA--;\n            if (yA < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xA >> 16, xB >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeB >> 8);\n                xA += xStepAC;\n                xB += xStepBC;\n                shadeA += shadeStepAC;\n                shadeB += shadeStepBC;\n                yB += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xC >> 16, xB >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeB >> 8);\n            xC += xStepAB;\n            xB += xStepBC;\n            shadeC += shadeStepAB;\n            shadeB += shadeStepBC;\n            yB += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        } else {\n          while (true) {\n            yA--;\n            if (yA < 0) {\n              while (true) {\n                yC--;\n                if (yC < 0) {\n                  return;\n                }\n                rasterTexturedScanline(xB >> 16, xA >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeA >> 8);\n                xA += xStepAC;\n                xB += xStepBC;\n                shadeA += shadeStepAC;\n                shadeB += shadeStepBC;\n                yB += width;\n                u += uStepVertical;\n                v += vStepVertical;\n                w += wStepVertical;\n              }\n            }\n            rasterTexturedScanline(xB >> 16, xC >> 16, yB, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeC >> 8);\n            xC += xStepAB;\n            xB += xStepBC;\n            shadeC += shadeStepAB;\n            shadeB += shadeStepBC;\n            yB += width;\n            u += uStepVertical;\n            v += vStepVertical;\n            w += wStepVertical;\n          }\n        }\n      }\n    }\n  } else if (yC < boundBottom) {\n    if (yA > boundBottom) {\n      yA = boundBottom;\n    }\n    if (yB > boundBottom) {\n      yB = boundBottom;\n    }\n    if (yA < yB) {\n      xC <<= 0x10;\n      xB = xC;\n      shadeC <<= 0x10;\n      shadeB = shadeC;\n      if (yC < 0) {\n        xB -= xStepBC * yC;\n        xC -= xStepAC * yC;\n        shadeB -= shadeStepBC * yC;\n        shadeC -= shadeStepAC * yC;\n        yC = 0;\n      }\n      xA <<= 0x10;\n      shadeA <<= 0x10;\n      if (yA < 0) {\n        xA -= xStepAB * yA;\n        shadeA -= shadeStepAB * yA;\n        yA = 0;\n      }\n      let dy = yC - centerY;\n      u += uStepVertical * dy;\n      v += vStepVertical * dy;\n      w += wStepVertical * dy;\n      yB -= yA;\n      yA -= yC;\n      yC = yC * width;\n      if (xStepBC < xStepAC) {\n        while (true) {\n          yA--;\n          if (yA < 0) {\n            while (true) {\n              yB--;\n              if (yB < 0) {\n                return;\n              }\n              rasterTexturedScanline(xB >> 16, xA >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeA >> 8);\n              xB += xStepBC;\n              xA += xStepAB;\n              shadeB += shadeStepBC;\n              shadeA += shadeStepAB;\n              yC += width;\n              u += uStepVertical;\n              v += vStepVertical;\n              w += wStepVertical;\n            }\n          }\n          rasterTexturedScanline(xB >> 16, xC >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeC >> 8);\n          xB += xStepBC;\n          xC += xStepAC;\n          shadeB += shadeStepBC;\n          shadeC += shadeStepAC;\n          yC += width;\n          u += uStepVertical;\n          v += vStepVertical;\n          w += wStepVertical;\n        }\n      } else {\n        while (true) {\n          yA--;\n          if (yA < 0) {\n            while (true) {\n              yB--;\n              if (yB < 0) {\n                return;\n              }\n              rasterTexturedScanline(xA >> 16, xB >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeB >> 8);\n              xB += xStepBC;\n              xA += xStepAB;\n              shadeB += shadeStepBC;\n              shadeA += shadeStepAB;\n              yC += width;\n              u += uStepVertical;\n              v += vStepVertical;\n              w += wStepVertical;\n            }\n          }\n          rasterTexturedScanline(xC >> 16, xB >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeB >> 8);\n          xB += xStepBC;\n          xC += xStepAC;\n          shadeB += shadeStepBC;\n          shadeC += shadeStepAC;\n          yC += width;\n          u += uStepVertical;\n          v += vStepVertical;\n          w += wStepVertical;\n        }\n      }\n    } else {\n      xC <<= 0x10;\n      xA = xC;\n      shadeC <<= 0x10;\n      shadeA = shadeC;\n      if (yC < 0) {\n        xA -= xStepBC * yC;\n        xC -= xStepAC * yC;\n        shadeA -= shadeStepBC * yC;\n        shadeC -= shadeStepAC * yC;\n        yC = 0;\n      }\n      xB <<= 0x10;\n      shadeB <<= 0x10;\n      if (yB < 0) {\n        xB -= xStepAB * yB;\n        shadeB -= shadeStepAB * yB;\n        yB = 0;\n      }\n      let dy = yC - centerY;\n      u += uStepVertical * dy;\n      v += vStepVertical * dy;\n      w += wStepVertical * dy;\n      yA -= yB;\n      yB -= yC;\n      yC = yC * width;\n      if (xStepBC < xStepAC) {\n        while (true) {\n          yB--;\n          if (yB < 0) {\n            while (true) {\n              yA--;\n              if (yA < 0) {\n                return;\n              }\n              rasterTexturedScanline(xB >> 16, xC >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeB >> 8, shadeC >> 8);\n              xB += xStepAB;\n              xC += xStepAC;\n              shadeB += shadeStepAB;\n              shadeC += shadeStepAC;\n              yC += width;\n              u += uStepVertical;\n              v += vStepVertical;\n              w += wStepVertical;\n            }\n          }\n          rasterTexturedScanline(xA >> 16, xC >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeA >> 8, shadeC >> 8);\n          xA += xStepBC;\n          xC += xStepAC;\n          shadeA += shadeStepBC;\n          shadeC += shadeStepAC;\n          yC += width;\n          u += uStepVertical;\n          v += vStepVertical;\n          w += wStepVertical;\n        }\n      } else {\n        while (true) {\n          yB--;\n          if (yB < 0) {\n            while (true) {\n              yA--;\n              if (yA < 0) {\n                return;\n              }\n              rasterTexturedScanline(xC >> 16, xB >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeB >> 8);\n              xB += xStepAB;\n              xC += xStepAC;\n              shadeB += shadeStepAB;\n              shadeC += shadeStepAC;\n              yC += width;\n              u += uStepVertical;\n              v += vStepVertical;\n              w += wStepVertical;\n            }\n          }\n          rasterTexturedScanline(xC >> 16, xA >> 16, yC, texels, 0, 0, u, v, w, uStride, vStride, wStride, shadeC >> 8, shadeA >> 8);\n          xA += xStepBC;\n          xC += xStepAC;\n          shadeA += shadeStepBC;\n          shadeC += shadeStepAC;\n          yC += width;\n          u += uStepVertical;\n          v += vStepVertical;\n          w += wStepVertical;\n        }\n      }\n    }\n  }\n}\n\nfn rasterTexturedScanline(\n  xAIn: i32, \n  xBIn: i32, \n  offsetIn: i32, \n  texels: ptr<storage, array<u32, 65536>>, \n  curUIn: i32, \n  curVIn: i32, \n  uIn: i32, \n  vIn: i32, \n  wIn: i32, \n  uStride: i32, \n  vStride: i32, \n  wStride: i32, \n  shadeAIn: i32, \n  shadeBIn: i32\n) {\n  var xA = xAIn;\n  var xB = xBIn;\n  var offset = offsetIn;\n  var curU = curUIn;\n  var curV = curVIn;\n  var u = uIn;\n  var v = vIn;\n  var w = wIn;\n  var shadeA = shadeAIn;\n  var shadeB = shadeBIn;\n  if (xA >= xB) {\n      return;\n  } \n  var shadeStrides: i32;\n  var strides: i32;\n  if (clipX) {\n    shadeStrides = ((shadeB - shadeA) / (xB - xA));   \n    if (xB > boundX) {\n      xB = boundX;\n    }   \n    if (xA < 0) {\n      shadeA -= xA * shadeStrides;\n      xA = 0;\n    }   \n    if (xA >= xB) {\n      return;\n    }   \n    strides = (xB - xA) >> 3;\n    shadeStrides <<= 0xc;\n  } else {\n    if (xB - xA > 7) {\n      strides = (xB - xA) >> 3;\n      shadeStrides = ((shadeB - shadeA) * reciprocal15(strides)) >> 6;\n    } else {\n      strides = 0;\n      shadeStrides = 0;\n    }\n  }\n\n  shadeA <<= 0x9;\n  offset += xA;\n\n  var nextU = 0;\n  var nextV = 0;\n  var dx = xA - centerX;\n  u = u + (uStride >> 3) * dx;\n  v = v + (vStride >> 3) * dx;\n  w = w + (wStride >> 3) * dx;\n  var curW = w >> 14;\n  if (curW != 0) {\n    curU = (u / curW);\n    curV = (v / curW);\n    if (curU < 0) {\n      curU = 0;\n    } else if (curU > 16256) {\n      curU = 16256;\n    }\n  }\n  u = u + uStride;\n  v = v + vStride;\n  w = w + wStride;\n  curW = w >> 14;\n  if (curW != 0) {\n    nextU = (u / curW);\n    nextV = (v / curW);\n    if (nextU < 7) {\n      nextU = 7;\n    } else if (nextU > 16256) {\n      nextU = 16256;\n    }\n  }\n  var stepU = (nextU - curU) >> 3;\n  var stepV = (nextV - curV) >> 3;\n  curU += shadeA & 0x600000;\n  var shadeShift = u32(shadeA >> 23);\n  if (writeDepth) {\n    while (strides > 0) {\n      strides--;\n      var rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset = offset + 1;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU = nextU;\n      curV = nextV;\n      u += uStride;\n      v += vStride;\n      w += wStride;\n      curW = w >> 14;\n      if (curW != 0) {\n        nextU = (u / curW);\n        nextV = (v / curW);\n        if (nextU < 7) {\n          nextU = 7;\n        } else if (nextU > 16256) {\n          nextU = 16256;\n        }\n      }\n      stepU = (nextU - curU) >> 3;\n      stepV = (nextV - curV) >> 3;\n      shadeA += shadeStrides;\n      curU += shadeA & 0x600000;\n      shadeShift = u32(shadeA >> 23);\n    }\n    strides = (xB - xA) & 0x7;\n    while (strides > 0) {\n      strides--;\n      var rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        atomicMax(&depthBuffer[offset], depth);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n    }\n  } else if (opaqueTexture) {\n    while (strides > 0) {\n      strides--;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU = nextU;\n      curV = nextV;\n      u += uStride;\n      v += vStride;\n      w += wStride;\n      curW = w >> 14;\n      if (curW != 0) {\n        nextU = (u / curW);\n        nextV = (v / curW);\n        if (nextU < 7) {\n          nextU = 7;\n        } else if (nextU > 16256) {\n          nextU = 16256;\n        }\n      }\n      stepU = (nextU - curU) >> 3;\n      stepV = (nextV - curV) >> 3;\n      shadeA += shadeStrides;\n      curU += shadeA & 0x600000;\n      shadeShift = u32(shadeA >> 23);\n    }\n    strides = (xB - xA) & 0x7;\n    while (strides > 0) {\n      strides--;\n      setPixel(offset, texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift);\n      offset++;\n      curU += stepU;\n      curV += stepV;\n    }\n  } else {\n    while (strides > 0) {\n      strides--;\n      var rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset = offset + 1;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n      rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU = nextU;\n      curV = nextV;\n      u += uStride;\n      v += vStride;\n      w += wStride;\n      curW = w >> 14;\n      if (curW != 0) {\n        nextU = (u / curW);\n        nextV = (v / curW);\n        if (nextU < 7) {\n          nextU = 7;\n        } else if (nextU > 16256) {\n          nextU = 16256;\n        }\n      }\n      stepU = (nextU - curU) >> 3;\n      stepV = (nextV - curV) >> 3;\n      shadeA += shadeStrides;\n      curU += shadeA & 0x600000;\n      shadeShift = u32(shadeA >> 23);\n    }\n    strides = (xB - xA) & 0x7;\n    while (strides > 0) {\n      strides--;\n      var rgb = texels[(curV & 0x3f80) + (curU >> 7)] >> shadeShift;\n      if (rgb != 0) {\n        setPixel(offset, rgb);\n      }\n      offset++;\n      curU += stepU;\n      curV += stepV;\n    }\n  }\n}\n\nfn reciprocal15(value: i32) -> i32 {\n  return 32768 / value;\n}\n\nfn reciprocal16(value: i32) -> i32 {\n  return 65536 / value;\n}\n"}),this.gM=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:'storage'}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:'storage'}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:'read-only-storage'}}]}),this.CM=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:'read-only-storage'}}]}),this.SM=this.device.createBindGroup({layout:this.gM,entries:[{binding:0,resource:{buffer:this.pM}},{binding:1,resource:{buffer:this.wM}},{binding:2,resource:{buffer:this.AM}}]}),this.mM=this.device.createComputePipeline({label:'clear pixels pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM]}),compute:{module:this.xM,entryPoint:'clear'}}),this.vM=this.device.createComputePipeline({label:'render flat depth pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM,this.CM]}),compute:{module:this.xM,entryPoint:'renderFlatDepth'}}),this.BM=this.device.createComputePipeline({label:'render gouraud depth pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM,this.CM]}),compute:{module:this.xM,entryPoint:'renderGouraudDepth'}}),this.bM=this.device.createComputePipeline({label:'render textured depth pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM,this.CM]}),compute:{module:this.xM,entryPoint:'renderTexturedDepth'}}),this.IM=this.device.createComputePipeline({label:'render flat pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM,this.CM]}),compute:{module:this.xM,entryPoint:'renderFlat'}}),this.EM=this.device.createComputePipeline({label:'render gouraud pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM,this.CM]}),compute:{module:this.xM,entryPoint:'renderGouraud'}}),this._M=this.device.createComputePipeline({label:'render textured pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM,this.CM]}),compute:{module:this.xM,entryPoint:'renderTextured'}}),this.TM=this.device.createComputePipeline({label:'render alpha pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.gM,this.CM]}),compute:{module:this.xM,entryPoint:'renderAlpha'}}),this.OM=this.device.createShaderModule({label:'fullscreen vertex shader',code:"\nstruct VertexOutput {\n  @builtin(position) Position: vec4f,\n  @location(0) TexCoord: vec2f,\n};\n\n@vertex\nfn vert_main(@builtin(vertex_index) VertexIndex: u32) -> VertexOutput {\n  var pos = array(\n    vec2f(-1,  3),\n    vec2f( 3, -1),\n    vec2f(-1, -1),\n  );\n\n  var output: VertexOutput;\n  output.Position = vec4f(pos[VertexIndex], 0.0, 1.0);\n  output.TexCoord = pos[VertexIndex] * 0.5 + 0.5;\n  output.TexCoord.y = 1.0 - output.TexCoord.y;\n  return output;\n}\n"}),this.LM=this.device.createShaderModule({label:'pixmap shader',code:"\n@group(0) @binding(0) var textureSampler: sampler;\n@group(0) @binding(1) var texture: texture_2d<f32>;\n\n@fragment\nfn frag_main(@location(0) TexCoord: vec2f) -> @location(0) vec4f {\n  var color = textureSample(texture, textureSampler, TexCoord).bgra;\n  if (all(color == vec4f(1.0))) {\n    discard;\n  }\n  return color;\n}\n"}),this.RM=this.device.createRenderPipeline({label:'pixmap pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.fM]}),vertex:{module:this.OM},fragment:{module:this.LM,targets:[{format:'rgba8unorm'}]}}),this.DM=this.device.createShaderModule({label:'texture shader',code:"\n@group(0) @binding(0) var textureSampler: sampler;\n@group(0) @binding(1) var texture: texture_2d<f32>;\n\n@fragment\nfn frag_main(@location(0) TexCoord: vec2f) -> @location(0) vec4f {\n  var color = textureSample(texture, textureSampler, TexCoord);\n  return color;\n}\n"}),this.kM=this.device.createRenderPipeline({label:'frame texture pipeline',layout:this.device.createPipelineLayout({bindGroupLayouts:[this.fM]}),vertex:{module:this.OM},fragment:{module:this.DM,targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]}}),this.MM=this.device.createShaderModule({label:'pixel buffer shader',code:"\nstruct PixelBuffer {\n  data: array<u32>,\n};\n\nstruct Uniforms {\n  screenWidth: f32,\n  screenHeight: f32,\n};\n\n@group(0) @binding(0) var<uniform> uniforms: Uniforms;\n@group(0) @binding(1) var<storage, read> pixelBuffer: PixelBuffer;\n\n\nfn unpackColor888(rgb: u32) -> vec3f {\n  let r = f32((rgb >> 16) & 0xff) / 255.0;\n  let g = f32((rgb >> 8) & 0xff) / 255.0;\n  let b = f32(rgb & 0xff) / 255.0;\n  return vec3f(r, g, b);\n}\n\n\n@fragment\nfn frag_main(@location(0) TexCoord: vec2f) -> @location(0) vec4f {\n  let coord = floor(vec2f(TexCoord.x * uniforms.screenWidth, TexCoord.y * uniforms.screenHeight));\n  let index = u32(coord.y * uniforms.screenWidth + coord.x);\n\n  let finalColor = vec4f(unpackColor888(pixelBuffer.data[index]), 1.0);\n  return finalColor;\n}\n\n"}),this.UM=this.device.createRenderPipeline({label:'pixel buffer pipeline',layout:'auto',vertex:{module:this.OM},fragment:{module:this.MM,targets:[{format:'rgba8unorm'}]}}),this.PM=this.device.createBindGroup({layout:this.UM.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.yM}},{binding:1,resource:{buffer:this.pM}}]}),'getCurrentTexture'in this.context&&(this.NM={label:'frame render pass',colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:'load',storeOp:'store'}]}),this.FM={label:'main render pass',colorAttachments:[{view:this.uM.createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:'load',storeOp:'store'}]}}resize(t,i){super.resize(t,i)}SA(){this.XM=!0,this.nU.fill(!1),this.HM=this.device.createCommandEncoder({label:'render command encoder'}),this.zM=this.HM.beginRenderPass(this.FM);for(const t of this.ZM)this.$k(t.lU,t.x,t.y);this.ZM.length=0}BA(){if(!this.XM)return;this.XM=!1,this.zM.end();for(const t of this.NM.colorAttachments)'getCurrentTexture'in this.context&&(t.view=this.context.getCurrentTexture().createView());const t=this.HM.beginRenderPass(this.NM);t.setViewport(0,0,this.canvas.width,this.canvas.height,0,1),t.setPipeline(this.kM),t.setBindGroup(0,this.dM),t.draw(3),t.end();const i=this.HM.finish();this.device.queue.submit([i]);for(const t of this.hU)t.destroy();this.hU.length=0}aU(){this.device.queue.writeBuffer(this.AM,0,n.A.palette)}hg(){for(let t=0;t<50;t++)this.BD(t,!1);const t=new Uint32Array(200);for(let i=0;i<50;i++)t[i]=n.A.pD[i]?1:0;this.device.queue.writeBuffer(this.AM,o,t)}BD(t,i=!0){const s=n.A.mD(t);if(!s)return;const e=262144,h=262344+t*e;if(i){let t;t=this.rU.length>0?this.rU.pop():this.device.createBuffer({size:e,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.MAP_WRITE,mappedAtCreation:!0}),new Uint32Array(t.getMappedRange()).set(s),t.unmap();const i=this.device.createCommandEncoder();i.copyBufferToBuffer(t,0,this.AM,h,e),this.device.queue.submit([i.finish()]),t.mapAsync(GPUMapMode.WRITE).then((()=>{this.rU.push(t)}))}else this.device.queue.writeBuffer(this.AM,h,s)}dA(t){this.aU()}$k(t,i,s){if(!this.XM)return this.ZM.push({lU:t,x:i,y:s}),!0;const h=e.A.YT,n=e.A.HT;t.width===h&&t.height===n&&(this.zM.setViewport(i,s,h,n,0,1),this.zM.setPipeline(this.UM),this.zM.setBindGroup(0,this.PM),this.zM.draw(3));const r=this.device.createTexture({size:{width:t.width,height:t.height},format:'rgba8unorm',usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING});this.device.queue.writeTexture({texture:r},t.Kc,{bytesPerRow:4*t.width},{width:t.width,height:t.height});const o=this.device.createBindGroup({layout:this.fM,entries:[{binding:0,resource:this.cM},{binding:1,resource:r.createView()}]});return this.zM.setViewport(i,s,t.width,t.height,0,1),this.zM.setPipeline(this.RM),this.zM.setBindGroup(0,o),this.zM.draw(3),this.hU.push(r),!0}$x(){this.KM=!0,this.jM=0,this.$M=0,this.iU=0,this.QM=0,this.eU=0}Jx(){this.KM=!1,this.cU()}cU(){const t=e.A.YT,i=e.A.HT;let s=this.VM;s&&(s.destroy(),this.VM=void 0);let h=this.GM;h&&(h.destroy(),this.GM=void 0);let n=this.WM;n&&(n.destroy(),this.WM=void 0);let r,o,a,l,c=this.YM;c&&(c.destroy(),this.YM=void 0),this.$M>0&&(s=this.device.createBuffer({size:8*this.$M*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.VM=s,this.device.queue.writeBuffer(s,0,this.qM.subarray(0,8*this.$M)),r=this.device.createBindGroup({layout:this.CM,entries:[{binding:0,resource:{buffer:s}}]})),this.QM>0&&(h=this.device.createBuffer({size:10*this.QM*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.GM=h,this.device.queue.writeBuffer(h,0,this.JM.subarray(0,10*this.QM)),o=this.device.createBindGroup({layout:this.CM,entries:[{binding:0,resource:{buffer:h}}]})),this.iU>0&&(n=this.device.createBuffer({size:20*this.iU*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.WM=n,this.device.queue.writeBuffer(this.WM,0,this.tU.subarray(0,20*this.iU)),a=this.device.createBindGroup({layout:this.CM,entries:[{binding:0,resource:{buffer:n}}]})),this.eU>0&&(c=this.device.createBuffer({size:10*this.eU*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.YM=c,this.device.queue.writeBuffer(c,0,this.sU.subarray(0,10*this.eU)),l=this.device.createBindGroup({layout:this.CM,entries:[{binding:0,resource:{buffer:c}}]}));const f=this.device.createCommandEncoder({label:'render scene command encoder'}),u=f.beginComputePass();u.setPipeline(this.mM),u.setBindGroup(0,this.SM),u.dispatchWorkgroups(Math.ceil(t*i/256)),this.$M>0&&r&&(u.setPipeline(this.vM),u.setBindGroup(0,this.SM),u.setBindGroup(1,r),u.dispatchWorkgroups(this.$M)),this.QM>0&&o&&(u.setPipeline(this.BM),u.setBindGroup(0,this.SM),u.setBindGroup(1,o),u.dispatchWorkgroups(this.QM)),this.iU>0&&a&&(u.setPipeline(this.bM),u.setBindGroup(0,this.SM),u.setBindGroup(1,a),u.dispatchWorkgroups(this.iU)),this.$M>0&&r&&(u.setPipeline(this.IM),u.setBindGroup(0,this.SM),u.setBindGroup(1,r),u.dispatchWorkgroups(this.$M)),this.QM>0&&o&&(u.setPipeline(this.EM),u.setBindGroup(0,this.SM),u.setBindGroup(1,o),u.dispatchWorkgroups(this.QM)),this.iU>0&&a&&(u.setPipeline(this._M),u.setBindGroup(0,this.SM),u.setBindGroup(1,a),u.dispatchWorkgroups(this.iU)),this.eU>0&&l&&(u.setPipeline(this.TM),u.setBindGroup(0,this.SM),u.setBindGroup(1,l),u.dispatchWorkgroups(1)),u.end();const d=f.finish();this.device.queue.submit([d])}CD(t,i,s,e,h,r,o){if(!this.KM)return!1;const a=this.jM++;if(0!==n.A.alpha){let l=10*this.eU;if(l>=this.sU.length){const t=new Uint32Array(2*this.sU.length);t.set(this.sU),this.sU=t}this.sU[l++]=1<<31|n.A.alpha<<23|a,this.sU[l++]=t,this.sU[l++]=i,this.sU[l++]=s,this.sU[l++]=e,this.sU[l++]=h,this.sU[l++]=r,this.sU[l++]=o,this.eU++}else{let n=8*this.$M;if(n>=this.qM.length){const t=new Uint32Array(2*this.qM.length);t.set(this.qM),this.qM=t}this.qM[n++]=a,this.qM[n++]=t,this.qM[n++]=i,this.qM[n++]=s,this.qM[n++]=e,this.qM[n++]=h,this.qM[n++]=r,this.qM[n++]=o,this.$M++}return!0}mL(t,i,s,e,h,r,o,a,l){if(!this.KM)return!1;const c=this.jM++;if(0!==n.A.alpha){let f=10*this.eU;if(f>=this.sU.length){const t=new Uint32Array(2*this.sU.length);t.set(this.sU),this.sU=t}this.sU[f++]=n.A.alpha<<23|c,this.sU[f++]=t,this.sU[f++]=i,this.sU[f++]=s,this.sU[f++]=e,this.sU[f++]=h,this.sU[f++]=r,this.sU[f++]=o,this.sU[f++]=a,this.sU[f++]=l,this.eU++}else{let n=10*this.QM;if(n>=this.JM.length){const t=new Uint32Array(2*this.JM.length);t.set(this.JM),this.JM=t}this.JM[n++]=c,this.JM[n++]=t,this.JM[n++]=i,this.JM[n++]=s,this.JM[n++]=e,this.JM[n++]=h,this.JM[n++]=r,this.JM[n++]=o,this.JM[n++]=a,this.JM[n++]=l,this.QM++}return!0}BL(t,i,s,e,h,r,o,a,l,c,f,u,d,y,p,w,A,x,g){if(!this.KM)return!1;this.nU[g]||(n.A.Kv[g]=n.A.Kx++,this.nU[g]=!0);const C=this.jM++;let S=20*this.iU;if(S>=this.tU.length){const t=new Uint32Array(2*this.tU.length);t.set(this.tU),this.tU=t}return this.tU[S++]=C,this.tU[S++]=t,this.tU[S++]=i,this.tU[S++]=s,this.tU[S++]=e,this.tU[S++]=h,this.tU[S++]=r,this.tU[S++]=o,this.tU[S++]=a,this.tU[S++]=l,this.tU[S++]=c,this.tU[S++]=f,this.tU[S++]=u,this.tU[S++]=d,this.tU[S++]=y,this.tU[S++]=p,this.tU[S++]=w,this.tU[S++]=A,this.tU[S++]=x,this.tU[S++]=g,this.iU++,!0}destroy(){this.device.destroy()}}},3867:(t,i,s)=>{s.d(i,{aA:()=>l,oA:()=>o,Ps:()=>e,NT:()=>h,Kr:()=>n,kT:()=>r,wr:()=>a});class e extends Array{constructor(t,i){super(t);for(let s=0;s<t;s++)this[s]=i}}class h extends Array{constructor(t,i,s){super(t);for(let e=0;e<t;e++){this[e]=new Array(i);for(let t=0;t<i;t++)this[e][t]=s}}}class n extends Array{constructor(t,i,s,e){super(t);for(let h=0;h<t;h++){this[h]=new Array(i);for(let t=0;t<i;t++){this[h][t]=new Array(s);for(let i=0;i<s;i++)this[h][t][i]=e}}}}class r extends Array{constructor(t,i,s,e,h){super(t);for(let n=0;n<t;n++){this[n]=new Array(i);for(let t=0;t<i;t++){this[n][t]=new Array(s);for(let i=0;i<s;i++){this[n][t][i]=new Array(e);for(let s=0;s<e;s++)this[n][t][i][s]=h}}}}}class o extends Array{constructor(t,i,s){super(t);for(let e=0;e<t;e++){this[e]=new Array(i);for(let t=0;t<i;t++)this[e][t]=new Uint8Array(s)}}}class a extends Array{constructor(t,i){super(t);for(let s=0;s<t;s++)this[s]=new Int32Array(i)}}class l extends Array{constructor(t,i,s){super(t);for(let e=0;e<t;e++){this[e]=new Array(i);for(let t=0;t<i;t++)this[e][t]=new Int32Array(s)}}}},9234:(t,i,s)=>{s.d(i,{lM:()=>o,pa:()=>h,oM:()=>r,wa:()=>e,kA:()=>n,aM:()=>a});const e=async t=>new Promise((i=>setTimeout(i,t))),h=async t=>new Int8Array(await(await fetch(t)).arrayBuffer());function n(t,i,s,e,h){for(;h--;)s[e++]=t[i++]}function r(t){let i=0n;for(let s=0;s<t.length;s++)i=i<<8n|BigInt(t[s]);return i}function o(t){const i=[];for(;t>0n;)i.unshift(Number(0xffn&t)),t>>=8n;return 128&i[0]&&i.unshift(0),new Uint8Array(i)}function a(t,i,s){let e=1n;for(;i>0n;)i%2n===1n&&(e=e*t%s),t=t*t%s,i>>=1n;return e}},6791:(t,i,s)=>{s.a(t,(async(t,i)=>{try{var e=s(8793),h=s(7604),n=s(8328),r=s(643),o=s(2176),a=s(7854),l=s(5868);class t{fU;uU;dU;yU;pU;wU;AU;xU;gU;CU;SU;canvas;mU;vU;constructor(t){this.fU=t,this.uU=document.getElementById('true-tile-toggle'),this.dU=document.getElementById('gpu-toggle'),this.yU=document.getElementById('tile-marker-toggle'),this.pU=document.getElementById('resizable-toggle'),this.wU=document.getElementById('debug-toggle'),this.AU=document.getElementById('roofs-toggle'),this.xU=document.getElementById('nodrag-toggle'),this.gU=document.getElementById('ip-toggle'),this.CU=document.getElementById('afk-toggle'),this.SU=document.getElementById('canvas-container'),this.canvas=document.getElementById('canvas'),this.mU=document.getElementById('loot-tracker-toggle'),this.vU=document.getElementById('xp-tracker-toggle');(async()=>{await this.BU(),this.bU(),this.IU(),this.EU()})().then((()=>console.log('Finished loading LostLite.')))}async _U(){console.log('Enabling gpu');try{r.A.Gc=await o.O.init(a.nS,this.fU.width,this.fU.height),r.A.Gc||(this.fU._C(0,'Failed to enable webgpu',''),this.dU.checked=!1,await this.TU())}catch(t){t instanceof Error&&this.fU._C(0,'Error enabling webgpu: '+t.message,''),console.error('Failed creating webgpu renderer',t),this.dU.checked=!1,await this.TU()}console.log('Finished turning on gpu.')}OU(){console.log('turning off gpu...'),r.A.Sa()}async BU(){'true'===localStorage.getItem('gpuEnabled')&&(this.dU.checked=!0,this.dU.closest('.plugin-item')?.classList.add('active'),await this._U()),'true'===localStorage.getItem('resizableEnabled')&&(this.pU.checked=!0,this.SU.classList.add('resizable'),this.LU()),'true'===localStorage.getItem('hideipEnabled')&&(this.gU.checked=!0,this.gU.closest('.plugin-item')?.classList.add('active'),l.A.yc=!0),'true'===localStorage.getItem('afkEnabled')&&(this.CU.checked=!0,this.CU.closest('.plugin-item')?.classList.add('active'),l.A.Ox=!0);const t=document.querySelector('.section-header[data-section="loot"]');'true'===localStorage.getItem('lootTrackerEnabled')?(this.mU.checked=!0,this.mU.closest('.plugin-item')?.classList.add('active'),l.A.RU=!0,t&&(t.style.display='flex')):t&&(t.style.display='none');const i=document.querySelector('.section-header[data-section="xp"]');'true'===localStorage.getItem('xpTrackerEnabled')?(this.vU.checked=!0,this.vU.closest('.plugin-item')?.classList.add('active'),l.A.DU=!0,i&&(i.style.display='flex')):i&&(i.style.display='none')}kU=[];async test(){const t=async()=>(this.fU.xA&&(this.fU.xh='::debug',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'}))),Promise.resolve()),i=async()=>(this.fU.xA&&(this.fU.xh='::entityoverlay',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'}))),Promise.resolve()),s=async()=>(this.fU.xA&&(this.fU.xh='::roofs',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'}))),Promise.resolve()),e=async()=>(this.fU.xA&&(this.fU.xh='::nodrag',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'}))),Promise.resolve()),h=async()=>(this.fU.xA&&(this.fU.xh='::tilemarkers',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'}))),Promise.resolve());this.wU.checked&&this.kU.push(t),this.uU.checked&&this.kU.push(i),this.AU.checked&&this.kU.push(s),this.xU.checked&&this.kU.push(e),this.yU.checked&&this.kU.push(h)}qt(){if(this.wU.checked){this.wU.checked=!1;const t=this.wU.closest('.plugin-item');t?.classList.toggle('active',this.wU.checked),l.A.sg=!l.A.sg}if(this.uU.checked){this.uU.checked=!1;const t=this.uU.closest('.plugin-item');t?.classList.toggle('active',this.uU.checked),l.A.Bg=!l.A.Bg}if(this.AU.checked){this.AU.checked=!1;const t=this.AU.closest('.plugin-item');t?.classList.toggle('active',this.AU.checked),l.A.hS=!l.A.hS}if(this.xU.checked){this.xU.checked=!1;const t=this.xU.closest('.plugin-item');t?.classList.toggle('active',this.xU.checked),l.A.ox=!l.A.ox}if(this.yU.checked){this.yU.checked=!1;const t=this.yU.closest('.plugin-item');t?.classList.toggle('active',this.yU.checked),l.A.Ug=!l.A.Ug}if(this.mU.checked){this.mU.checked=!1;const t=this.mU.closest('.plugin-item');t?.classList.toggle('active',this.mU.checked),l.A.RU=!l.A.RU;const i=document.querySelector('.section-header[data-section="loot"]');if(i&&(i.style.display=this.mU.checked?'flex':'none'),!this.mU.checked){const t=document.querySelector('.section-content[data-section="loot"]'),i=document.querySelector('.section-header[data-section="loot"]');t?.classList.remove('expanded'),i?.classList.remove('active');const s=document.querySelector('.section-content-wrapper'),e=document.querySelector('.list-container'),h=null!==document.querySelector('.section-header.active');s?.classList.toggle('has-active-section',h),e?.classList.toggle('has-active-section',h)}}if(this.vU.checked){this.vU.checked=!1;const t=this.vU.closest('.plugin-item');t?.classList.toggle('active',this.vU.checked),l.A.DU=!l.A.DU;const i=document.querySelector('.section-header[data-section="xp"]');if(i&&(i.style.display=this.vU.checked?'flex':'none'),!this.vU.checked){const t=document.querySelector('.section-content[data-section="xp"]'),i=document.querySelector('.section-header[data-section="xp"]');t?.classList.remove('expanded'),i?.classList.remove('active');const s=document.querySelector('.section-content-wrapper'),e=document.querySelector('.list-container'),h=null!==document.querySelector('.section-header.active');s?.classList.toggle('has-active-section',h),e?.classList.toggle('has-active-section',h)}}}async MU(){if(this.wU.addEventListener('change',(()=>{const t=this.wU.closest('.plugin-item');t?.classList.toggle('active',this.wU.checked),localStorage.setItem('debugEnabled',this.wU.checked.toString()),this.fU.xA&&(this.fU.xh='::debug',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'})))})),this.uU.addEventListener('change',(()=>{const t=this.uU.closest('.plugin-item');t?.classList.toggle('active',this.uU.checked),localStorage.setItem('trueTileEnabled',this.uU.checked.toString()),this.fU.xA&&(this.fU.xh='::entityoverlay',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'})))})),this.AU.addEventListener('change',(()=>{const t=this.AU.closest('.plugin-item');t?.classList.toggle('active',this.AU.checked),localStorage.setItem('roofsEnabled',this.AU.checked.toString()),this.fU.xA&&(this.fU.xh='::roofs',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'})))})),this.xU.addEventListener('change',(()=>{const t=this.xU.closest('.plugin-item');t?.classList.toggle('active',this.xU.checked),localStorage.setItem('nodragEnabled',this.xU.checked.toString()),this.UU('nodrag')})),this.yU.addEventListener('change',(()=>{const t=this.yU.closest('.plugin-item');t?.classList.toggle('active',this.yU.checked),localStorage.setItem('nodragEnabled',this.yU.checked.toString()),this.fU.xA&&(this.fU.xh='::tilemarkers',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'})))})),'true'===localStorage.getItem('debugEnabled')&&(this.wU.checked=!0,this.wU.closest('.plugin-item')?.classList.add('active')),'true'===localStorage.getItem('roofsEnabled')&&(this.AU.checked=!0,this.AU.closest('.plugin-item')?.classList.add('active')),'true'===localStorage.getItem('nodragEnabled')&&(this.xU.checked=!0,this.xU.closest('.plugin-item')?.classList.add('active')),'true'===localStorage.getItem('trueTileEnabled')&&(this.uU.checked=!0,this.uU.closest('.plugin-item')?.classList.add('active')),'true'===localStorage.getItem('tileMarkerEnabled')&&(this.yU.checked=!0,this.yU.closest('.plugin-item')?.classList.add('active')),'true'===localStorage.getItem('lootTrackerEnabled')){this.mU.checked=!0,this.mU.closest('.plugin-item')?.classList.add('active'),l.A.RU=!0;const t=document.querySelector('.section-header[data-section="loot"]');t&&(t.style.display='flex')}if('true'===localStorage.getItem('xpTrackerEnabled')){this.vU.checked=!0,this.vU.closest('.plugin-item')?.classList.add('active'),l.A.DU=!0;const t=document.querySelector('.section-header[data-section="xp"]');t&&(t.style.display='flex')}}UU(t){this.fU.xA&&(this.fU.xh=`::${t}`,this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'})))}async TU(){const t=this.dU.closest('.plugin-item');t?.classList.toggle('active',this.dU.checked),localStorage.setItem('gpuEnabled',this.dU.checked.toString()),this.dU.checked?this.fU.xA?(this.fU.xh='::gpu',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'}))):await this._U():this.fU.xA?(this.fU.xh='::gpu',this.fU.onkeydown(new KeyboardEvent('keydown',{key:'Enter',code:'Enter'}))):this.OU()}bU(){this.dU.addEventListener('change',(async()=>{await this.TU()})),this.gU.addEventListener('change',(async()=>{const t=this.gU.closest('.plugin-item');t?.classList.toggle('active',this.gU.checked),localStorage.setItem('hideipEnabled',this.gU.checked.toString()),l.A.yc=!l.A.yc})),this.CU.addEventListener('change',(async()=>{const t=this.CU.closest('.plugin-item');t?.classList.toggle('active',this.CU.checked),localStorage.setItem('afkEnabled',this.CU.checked.toString()),l.A.Ox=!l.A.Ox})),this.pU.addEventListener('change',(()=>{this.SU.classList.toggle('resizable',this.pU.checked),localStorage.setItem('resizableEnabled',this.pU.checked.toString()),this.LU()})),this.mU.addEventListener('change',(()=>{const t=this.mU.closest('.plugin-item');t?.classList.toggle('active',this.mU.checked),localStorage.setItem('lootTrackerEnabled',this.mU.checked.toString()),l.A.RU=this.mU.checked;const i=document.querySelector('.section-header[data-section="loot"]');if(i&&(i.style.display=this.mU.checked?'flex':'none'),!this.mU.checked){const t=document.querySelector('.section-content[data-section="loot"]'),i=document.querySelector('.section-header[data-section="loot"]');t?.classList.remove('expanded'),i?.classList.remove('active');const s=document.querySelector('.section-content-wrapper'),e=document.querySelector('.list-container'),h=null!==document.querySelector('.section-header.active');s?.classList.toggle('has-active-section',h),e?.classList.toggle('has-active-section',h)}})),this.vU.addEventListener('change',(()=>{const t=this.vU.closest('.plugin-item');t?.classList.toggle('active',this.vU.checked),localStorage.setItem('xpTrackerEnabled',this.vU.checked.toString()),l.A.DU=this.vU.checked;const i=document.querySelector('.section-header[data-section="xp"]');if(i&&(i.style.display=this.vU.checked?'flex':'none'),!this.vU.checked){const t=document.querySelector('.section-content[data-section="xp"]'),i=document.querySelector('.section-header[data-section="xp"]');t?.classList.remove('expanded'),i?.classList.remove('active');const s=document.querySelector('.section-content-wrapper'),e=document.querySelector('.list-container'),h=null!==document.querySelector('.section-header.active');s?.classList.toggle('has-active-section',h),e?.classList.toggle('has-active-section',h)}}))}LU(){if(this.pU.checked){const t=this.SU.clientWidth,i=this.SU.clientHeight;this.canvas.width=t,this.canvas.height=i}else this.canvas.width=789,this.canvas.height=532}IU(){const t=document.querySelector('.fps-counter span'),i=()=>{t.textContent=`${this.fU.Fg} FPS`,requestAnimationFrame(i)};requestAnimationFrame(i)}EU(){const t=document.querySelector('.list-container'),i=document.querySelector('.section-content-wrapper'),s=(t,i)=>{localStorage.setItem(`section_${t}_expanded`,i.toString())},e=()=>{const s=null!==document.querySelector('.section-header.active');i?.classList.toggle('has-active-section',s),t?.classList.toggle('has-active-section',s)};document.querySelectorAll('.section-header').forEach((t=>{t.addEventListener('click',(()=>{const i=t.getAttribute('data-section');if(i){const h=document.querySelector(`.section-content[data-section="${i}"]`),n=document.querySelectorAll('.section-content'),r=document.querySelectorAll('.section-header');n.forEach((t=>{if(t!==h){t.classList.remove('expanded');const i=t.getAttribute('data-section');i&&s(i,!1)}})),r.forEach((i=>{i!==t&&i.classList.remove('active')})),h?.classList.toggle('expanded'),t.classList.toggle('active'),s(i,h?.classList.contains('expanded')||!1),e()}}))}));document.querySelectorAll('.plugin-item').forEach((t=>{t.addEventListener('click',(()=>{const i=t.closest('.section-content')?.getAttribute('data-section');if(i){const t=document.querySelector(`.section-header[data-section="${i}"]`),h=document.querySelector(`.section-content[data-section="${i}"]`),n=document.querySelectorAll('.section-content'),r=document.querySelectorAll('.section-header');n.forEach((t=>{if(t!==h){t.classList.remove('expanded');const i=t.getAttribute('data-section');i&&s(i,!1)}})),r.forEach((i=>{i!==t&&i.classList.remove('active')})),h&&!h.classList.contains('expanded')&&(h.classList.add('expanded'),t?.classList.add('active'),s(i,!0)),e()}}))}));const h=document.querySelectorAll('.section-header');let n=null;if(h.forEach((t=>{const i=t.getAttribute('data-section');if(i){'true'===localStorage.getItem(`section_${i}_expanded`)&&(n=i)}})),n){const t=document.querySelector(`.section-header[data-section="${n}"]`),i=document.querySelector(`.section-content[data-section="${n}"]`);t&&i&&(i.classList.add('expanded'),t.classList.add('active'),e())}else e()}}const c=async()=>{console.log(`Lost Lite Launching w/ user client - release #${e.K.St}`);const i=document.querySelector('.loading-overlay'),s=document.getElementById('loading-progress-bar'),r=document.querySelector('.loading-text');let o=0;const{PU:a,NU:c}=(0,l.i)(),f=(t,i)=>{o=i,s.style.width=`${o}%`,r.textContent=t,console.log(`Loading: ${t} (${o}%)`)};try{f('Setting up configuration...',0),await(0,h.w)(),f('Configuration loaded',33),console.log('Configuration has been setup. Launching game.');const s=new n.Z;f('Game engine initializing...',66);let e=null;s.Xt=async()=>{f('Loading interface...',66),e=new t(s),f('Loading plugins...',75),await c(s),f('LostLite Loaded!',100),i.classList.add('fade-out'),setTimeout((()=>{i.style.display='none'}),300)},s.Kt=async()=>{await(e?.MU()),e?.test()},s.Zt=async()=>{const t=e?.kU?.pop();t&&await t(),a.forEach((t=>t.Zt()))},s.qt=async()=>{e?.qt()},s.jt=(t,i,s)=>{a.forEach((e=>e.jt(t,i,s)))},await s.run(),console.log('Finished.')}catch(t){console.error('Error during initialization:',t),r.textContent='Error loading game. Please refresh the page.',r.style.color='#ff4444'}};await c(),i()}catch(t){i(t)}}),1)},5868:(t,i,s)=>{s.d(i,{A:()=>n,i:()=>r});class e{FU;constructor(t){this.FU=t}Zt(){}jt(t,i,s){}}class h extends e{jt(t,i,s){console.log(`Stat updated: Stat=${t} XP=${i} Level=${s}`)}VU(){return'DebugPlugin'}}class n{static MT=50;static Yx=3;static tC=1;static jA=50;static hS=!1;static Bg=!1;static ox=!1;static Ug=!1;static sg=!1;static yc=!1;static Ox=!1;static RU=!1;static DU=!1}const r=()=>{const t=new Map;return{NU:async i=>(t.set('debug_plugin',new h(i)),Promise.resolve(t)),PU:t}}},4702:(t,i,s)=>{async function e(t,i={}){const s={env:Object.assign(Object.create(globalThis),i.env||{},{abort(t,i,s,e){t=r(t>>>0),i=r(i>>>0),s>>>=0,e>>>=0,(()=>{throw Error(`${t} in ${i}:${s}:${e}`)})()}})},{exports:e}=await WebAssembly.instantiate(t,s),h=e.memory||i.env.memory,n=Object.setPrototypeOf({read:(t,i,s,n)=>(i=function(t,i,s,n,r){if(null==n)return 0;const o=n.length,a=e.__pin(e.__new(o<<s,i))>>>0;if(r)new r(h.buffer,a,o).set(n);else for(let i=0;i<o;i++)t(a+(i<<s>>>0),n[i]);return e.__unpin(a),a}(a,6,0,i,Int8Array)||function(){throw TypeError("value must not be null")}(),function(t,i,s){if(!s)return null;const e=function(t){try{return o.getUint32(t,!0)}catch{return o=new DataView(h.buffer),o.getUint32(t,!0)}}(s-4)>>>i,n=new Array(e);for(let h=0;h<e;++h)n[h]=t(s+(h<<i>>>0));return n}(l,0,e.read(t,i,s,n)>>>0))},e);function r(t){if(!t)return null;const i=t+new Uint32Array(h.buffer)[t-4>>>2]>>>1,s=new Uint16Array(h.buffer);let e=t>>>1,n="";for(;i-e>1024;)n+=String.fromCharCode(...s.subarray(e,e+=1024));return n+String.fromCharCode(...s.subarray(e,i))}let o=new DataView(h.buffer);function a(t,i){try{o.setUint8(t,i,!0)}catch{o=new DataView(h.buffer),o.setUint8(t,i,!0)}}function l(t){try{return o.getInt8(t,!0)}catch{return o=new DataView(h.buffer),o.getInt8(t,!0)}}return n}s.d(i,{A:()=>h});class h{static GU=null;static load=async t=>{this.GU=await e(new WebAssembly.Module(t),{env:void 0})};static read=(t,i,s,e)=>{if(!this.GU)throw new Error('bz2 not found!!');return Int8Array.from(this.GU.read(t,i,s,e))}}},123:(t,i,s)=>{let e;async function h(t,i){n(i);try{const i=await window.audioContext.decodeAudioData(Uint8Array.from(t).buffer);let s=window.audioContext.createBufferSource();s.buffer=i,s.connect(e),s.start()}catch(t){console.log(t)}}function n(t){e||(e=window.audioContext.createGain(),e.connect(window.audioContext.destination)),e.gain.value=t/256}function r(t,i,s){window._tinyMidiPlay&&window._tinyMidiPlay(t,i/256,s)}function o(t){window._tinyMidiVolume&&window._tinyMidiVolume(t/256)}function a(t){window._tinyMidiStop&&window._tinyMidiStop(t)}s.d(i,{qA:()=>h,ga:()=>r,QS:()=>n,Jo:()=>a,JS:()=>o})},8902:(t,i,s)=>{var e;const h=(e="file:///home/runner/work/normozenyte.github.io/normozenyte.github.io/src/js/vendor/tinymidipcm/tinymidipcm.mjs",function(t){var i,h,n=void 0!==(t=t||{})?t:{};n.ready=new Promise((function(t,s){i=t,h=s})),["_tsf_load_memory","_tsf_set_output","_tsf_channel_set_bank_preset","_tsf_set_max_voices","_tsf_channel_set_presetnumber","_tsf_reset","_tsf_close","_tml_load_memory","_midi_render","_malloc","_realloc","_free","_fflush","onRuntimeInitialized"].forEach((t=>{Object.getOwnPropertyDescriptor(n.ready,t)||Object.defineProperty(n.ready,t,{get:()=>K('You are getting '+t+' on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js'),set:()=>K('You are setting '+t+' on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js')})}));var r=Object.assign({},n),o=[],a='object'==typeof window,l='function'==typeof importScripts,c='object'==typeof process&&'object'==typeof process.versions&&'string'==typeof process.versions.node,f=!a&&!c&&!l;if(n.ENVIRONMENT)throw new Error('Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)');var u,d,y,p='';if(c){if('undefined'==typeof process||!process.release||'node'!==process.release.name)throw new Error('not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)');var w,A;p=l?require('path').WU(p)+'/':__dirname+'/';var x=()=>{A||(w=require('fs'),A=require('path'))};u=(t,i)=>(x(),t=A.normalize(t),w.YU(t,i?void 0:'utf8')),y=t=>{var i=u(t,!0);return i.buffer||(i=new Uint8Array(i)),k(i.buffer),i},d=(t,i,s)=>{x(),t=A.normalize(t),w.HU(t,(function(t,e){t?s(t):i(e.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,'/'),o=process.argv.slice(2),process.on('uncaughtException',(function(t){if(!(t instanceof ht))throw t})),process.on('unhandledRejection',(function(t){throw t})),n.inspect=function(){return'[Emscripten Module object]'}}else if(f){if('object'==typeof process&&'function'==typeof require||'object'==typeof window||'function'==typeof importScripts)throw new Error('not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)');'undefined'!=typeof read&&(u=function(t){return read(t)}),y=function(t){let i;return'function'==typeof readbuffer?new Uint8Array(readbuffer(t)):(i=read(t,'binary'),k('object'==typeof i),i)},d=function(t,i,s){setTimeout((()=>i(y(t))),0)},'undefined'!=typeof scriptArgs?o=scriptArgs:void 0!==arguments&&(o=arguments),'undefined'!=typeof print&&('undefined'==typeof console&&(console={}),console.log=print,console.warn=console.error='undefined'!=typeof printErr?printErr:print)}else{if(!a&&!l)throw new Error('environment detection error');if(l?p=self.location.href:'undefined'!=typeof document&&document.currentScript&&(p=document.currentScript.src),e&&(p=e),p=0!==p.indexOf('blob:')?p.substr(0,p.replace(/[?#].*/,"").lastIndexOf('/')+1):'','object'!=typeof window&&'function'!=typeof importScripts)throw new Error('not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)');u=t=>{var i=new XMLHttpRequest;return i.open('GET',t,!1),i.send(null),i.responseText},l&&(y=t=>{var i=new XMLHttpRequest;return i.open('GET',t,!1),i.responseType='arraybuffer',i.send(null),new Uint8Array(i.response)}),d=(t,i,s)=>{var e=new XMLHttpRequest;e.open('GET',t,!0),e.responseType='arraybuffer',e.onload=()=>{200==e.status||0==e.status&&e.response?i(e.response):s()},e.onerror=s,e.send(null)}}n.print||console.log.bind(console);var g,C,S=n.printErr||console.warn.bind(console);function m(t,i){Object.getOwnPropertyDescriptor(n,t)||Object.defineProperty(n,t,{configurable:!0,get:function(){K('Module.'+t+' has been replaced with plain '+i+' (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)')}})}function v(t){return'FS_createPath'===t||'FS_createDataFile'===t||'FS_createPreloadedFile'===t||'FS_unlink'===t||'addRunDependency'===t||'FS_createLazyFile'===t||'FS_createDevice'===t||'removeRunDependency'===t}Object.assign(n,r),r=null,g='fetchSettings',Object.getOwnPropertyDescriptor(n,g)&&K('`Module.'+g+'` was supplied but `'+g+'` not included in INCOMING_MODULE_JS_API'),n.arguments&&(o=n.arguments),m('arguments','arguments_'),n.thisProgram&&n.thisProgram,m('thisProgram','thisProgram'),n.quit&&n.quit,m('quit','quit_'),k(void 0===n.memoryInitializerPrefixURL,'Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead'),k(void 0===n.pthreadMainPrefixURL,'Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead'),k(void 0===n.cdInitializerPrefixURL,'Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead'),k(void 0===n.filePackagePrefixURL,'Module.filePackagePrefixURL option was removed, use Module.locateFile instead'),k(void 0===n.read,'Module.read option was removed (modify read_ in JS)'),k(void 0===n.readAsync,'Module.readAsync option was removed (modify readAsync in JS)'),k(void 0===n.readBinary,'Module.readBinary option was removed (modify readBinary in JS)'),k(void 0===n.setWindowTitle,'Module.setWindowTitle option was removed (modify setWindowTitle in JS)'),k(void 0===n.TOTAL_MEMORY,'Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY'),m('read','read_'),m('readAsync','readAsync'),m('readBinary','readBinary'),m('setWindowTitle','setWindowTitle'),k(!f,"shell environment detected but not enabled at build time.  Add 'shell' to `-sENVIRONMENT` to enable."),n.wasmBinary&&(C=n.wasmBinary),m('wasmBinary','wasmBinary');var B;n.noExitRuntime;m('noExitRuntime','noExitRuntime'),'object'!=typeof WebAssembly&&K('no native wasm support detected');var b,I,E,_,T,O,L,R,D=!1;function k(t,i){t||K('Assertion failed'+(i?': '+i:''))}function M(t){b=t,n.HEAP8=I=new Int8Array(t),n.HEAP16=_=new Int16Array(t),n.HEAP32=T=new Int32Array(t),n.HEAPU8=E=new Uint8Array(t),n.HEAPU16=new Uint16Array(t),n.HEAPU32=O=new Uint32Array(t),n.HEAPF32=L=new Float32Array(t),n.HEAPF64=R=new Float64Array(t)}'undefined'!=typeof TextDecoder&&new TextDecoder('utf8');var U=5242880;n.TOTAL_STACK&&k(U===n.TOTAL_STACK,'the stack size can no longer be determined at runtime');var P=n.INITIAL_MEMORY||16777216;function N(){if(!D){var t=ft(),i=O[t>>2],s=O[t+4>>2];34821223==i&&2310721022==s||K('Stack overflow! Stack cookie has been overwritten at 0x'+t.toString(16)+', expected hex dwords 0x89BACDFE and 0x2135467, but received 0x'+s.toString(16)+' 0x'+i.toString(16)),1668509029!==O[0]&&K('Runtime error: The application has corrupted its heap memory area (address zero)!')}}m('INITIAL_MEMORY','INITIAL_MEMORY'),k(P>=U,'INITIAL_MEMORY should be larger than TOTAL_STACK, was '+P+'! (TOTAL_STACK='+U+')'),k('undefined'!=typeof Int32Array&&'undefined'!=typeof Float64Array&&null!=Int32Array.prototype.subarray&&null!=Int32Array.prototype.set,'JS engine does not provide full typed array support'),k(!n.wasmMemory,'Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally'),k(16777216==P,'Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically'),function(){var t=new Int16Array(1),i=new Int8Array(t.buffer);if(t[0]=25459,115!==i[0]||99!==i[1])throw'Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)'}();var F=[],V=[],G=[],W=!1;k(Math.imul,'This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill'),k(Math.fround,'This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill'),k(Math.clz32,'This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill'),k(Math.trunc,'This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill');var Y=0,H=null,z=null,X={};function K(t){n.onAbort&&n.onAbort(t),S(t='Aborted('+t+')'),D=!0;var i=new WebAssembly.RuntimeError(t);throw h(i),i}var Z={error:function(){K('Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with -sFORCE_FILESYSTEM')},init:function(){Z.error()},zU:function(){Z.error()},XU:function(){Z.error()},KU:function(){Z.error()},open:function(){Z.error()},ZU:function(){Z.error()},jU:function(){Z.error()},qU:function(){Z.error()},$U:function(){Z.error()},JU:function(){Z.error()}};n.FS_createDataFile=Z.zU,n.FS_createPreloadedFile=Z.XU;var j,q,$,J,Q='data:application/octet-stream;base64,';function tt(t){return t.startsWith(Q)}function it(t){return t.startsWith('file://')}function st(t,i){return function(){var s=t,e=i;return i||(e=n.asm),k(W,'native function `'+s+'` called before runtime initialization'),e[t]||k(e[t],'exported native function `'+s+'` not found'),e[t].apply(null,arguments)}}function et(t){try{if(t==j&&C)return new Uint8Array(C);if(y)return y(t);throw"both async and sync fetching of the wasm failed"}catch(t){K(t)}}function ht(t){this.name='ExitStatus',this.message='Program terminated with exit('+t+')',this.status=t}function nt(t){for(;t.length>0;)t.shift()(n)}function rt(t){rt.QU||(rt.QU={}),rt.QU[t]||(rt.QU[t]=1,c&&(t='warning: '+t),S(t))}function ot(t){try{return B.grow(t-b.byteLength+65535>>>16),M(B.buffer),1}catch(i){S('emscripten_realloc_buffer: Attempted to grow heap from '+b.byteLength+' bytes to '+t+' bytes, but got error: '+i)}}n.locateFile?tt(j='tinymidipcm.wasm')||(q=j,j=n.locateFile?n.locateFile(q,p):p+q):j=new URL(s(8227),s.b).toString();var at,lt={"emscripten_memcpy_big":function(t,i,s){E.copyWithin(t,i,i+s)},"emscripten_resize_heap":function(t){var i=E.length;k((t>>>=0)>i);var s,e,h=2147483648;if(t>h)return S('Cannot enlarge memory, asked to go up to '+t+' bytes, but the limit is '+h+' bytes!'),!1;for(var n=1;n<=4;n*=2){var r=i*(1+.2/n);r=Math.min(r,t+100663296);var o=Math.min(h,(s=Math.max(t,r))+((e=65536)-s%e)%e);if(ot(o))return!0}return S('Failed to grow the heap from '+i+' bytes to '+o+' bytes, not enough memory!'),!1}},ct=(function(){var t,i={'env':lt,'wasi_snapshot_preview1':lt};function s(t,i){var s,e=t.exports;n.asm=e,k(B=n.asm.memory,"memory not found in wasm exports"),M(B.buffer),k(n.asm.__indirect_function_table,"table not found in wasm exports"),s=n.asm.__wasm_call_ctors,V.unshift(s),function(t){if(Y--,n.monitorRunDependencies&&n.monitorRunDependencies(Y),t?(k(X[t]),delete X[t]):S('warning: run dependency removed without ID'),0==Y&&(null!==H&&(clearInterval(H),H=null),z)){var i=z;z=null,i()}}('wasm-instantiate')}t='wasm-instantiate',Y++,n.monitorRunDependencies&&n.monitorRunDependencies(Y),t?(k(!X[t]),X[t]=1,null===H&&'undefined'!=typeof setInterval&&(H=setInterval((function(){if(D)return clearInterval(H),void(H=null);var t=!1;for(var i in X)t||(t=!0,S('still waiting on run dependencies:')),S('dependency: '+i);t&&S('(end of list)')}),1e4))):S('warning: run dependency added without ID');var e=n;function r(t){k(n===e,'the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?'),e=null,s(t.instance)}function o(t){return function(){if(!C&&(a||l)){if('function'==typeof fetch&&!it(j))return fetch(j,{credentials:'same-origin'}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+j+"'";return t.arrayBuffer()})).catch((function(){return et(j)}));if(d)return new Promise((function(t,i){d(j,(function(i){t(new Uint8Array(i))}),i)}))}return Promise.resolve().then((function(){return et(j)}))}().then((function(t){return WebAssembly.instantiate(t,i)})).then((function(t){return t})).then(t,(function(t){S('failed to asynchronously prepare wasm: '+t),it(j)&&S('warning: Loading from a file URI ('+j+') is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing'),K(t)}))}if(n.instantiateWasm)try{return n.instantiateWasm(i,s)}catch(t){S('Module.instantiateWasm callback failed with error: '+t),h(t)}(C||'function'!=typeof WebAssembly.instantiateStreaming||tt(j)||it(j)||c||'function'!=typeof fetch?o(r):fetch(j,{credentials:'same-origin'}).then((function(t){return WebAssembly.instantiateStreaming(t,i).then(r,(function(t){return S('wasm streaming compile failed: '+t),S('falling back to ArrayBuffer instantiation'),o(r)}))}))).catch(h)}(),n.___wasm_call_ctors=st("__wasm_call_ctors"),n._malloc=st("malloc"),n._free=st("free"),n._tsf_load_memory=st("tsf_load_memory"),n._tsf_close=st("tsf_close"),n._tsf_reset=st("tsf_reset"),n._tsf_set_output=st("tsf_set_output"),n._tsf_set_max_voices=st("tsf_set_max_voices"),n._realloc=st("realloc"),n._tsf_channel_set_presetnumber=st("tsf_channel_set_presetnumber"),n._tsf_channel_set_bank_preset=st("tsf_channel_set_bank_preset"),n._tml_load_memory=st("tml_load_memory"),n._midi_render=st("midi_render"),n.___errno_location=st("__errno_location"),n._fflush=st("fflush"),n._emscripten_stack_init=function(){return(ct=n._emscripten_stack_init=n.asm.emscripten_stack_init).apply(null,arguments)}),ft=(n._emscripten_stack_get_free=function(){return(n._emscripten_stack_get_free=n.asm.emscripten_stack_get_free).apply(null,arguments)},n._emscripten_stack_get_base=function(){return(n._emscripten_stack_get_base=n.asm.emscripten_stack_get_base).apply(null,arguments)},n._emscripten_stack_get_end=function(){return(ft=n._emscripten_stack_get_end=n.asm.emscripten_stack_get_end).apply(null,arguments)});function ut(){var t;ct(),k(!(3&(t=ft()))),O[t>>2]=34821223,O[t+4>>2]=2310721022,O[0]=1668509029}function dt(t){function s(){at||(at=!0,n.calledRun=!0,D||(k(!W),W=!0,N(),nt(V),i(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),k(!n._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),function(){if(N(),n.postRun)for('function'==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)t=n.postRun.shift(),G.unshift(t);var t;nt(G)}()))}t=t||o,Y>0||(ut(),function(){if(n.preRun)for('function'==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)t=n.preRun.shift(),F.unshift(t);var t;nt(F)}(),Y>0||(n.setStatus?(n.setStatus('Running...'),setTimeout((function(){setTimeout((function(){n.setStatus('')}),1),s()}),1)):s(),N()))}if(n.stackSave=st("stackSave"),n.stackRestore=st("stackRestore"),n.stackAlloc=st("stackAlloc"),n.setValue=function(t,i,s="i8"){switch(s.endsWith('*')&&(s='*'),s){case'i1':case'i8':I[0|t]=i;break;case'i16':_[t>>1]=i;break;case'i32':T[t>>2]=i;break;case'i64':J=[i>>>0,($=i,+Math.abs($)>=1?$>0?(0|Math.min(+Math.floor($/4294967296),4294967295))>>>0:~~+Math.ceil(($-+(~~$>>>0))/4294967296)>>>0:0)],T[t>>2]=J[0],T[t+4>>2]=J[1];break;case'float':L[t>>2]=i;break;case'double':R[t>>3]=i;break;case'*':O[t>>2]=i;break;default:K('invalid type for setValue: '+s)}},n.getValue=function(t,i="i8"){switch(i.endsWith('*')&&(i='*'),i){case'i1':case'i8':return I[0|t];case'i16':return _[t>>1];case'i32':case'i64':return T[t>>2];case'float':return L[t>>2];case'double':return R[t>>3];case'*':return O[t>>2];default:K('invalid type for getValue: '+i)}return null},['run','UTF8ArrayToString','UTF8ToString','stringToUTF8Array','stringToUTF8','lengthBytesUTF8','addOnPreRun','addOnInit','addOnPreMain','addOnExit','addOnPostRun','addRunDependency','removeRunDependency','FS_createFolder','FS_createPath','FS_createDataFile','FS_createPreloadedFile','FS_createLazyFile','FS_createLink','FS_createDevice','FS_unlink','getLEB','getFunctionTables','alignFunctionTables','registerFunctions','prettyPrint','getCompilerSetting','print','printErr','callMain','abort','keepRuntimeAlive','wasmMemory','stackAlloc','stackSave','stackRestore','getTempRet0','setTempRet0','writeStackCookie','checkStackCookie','ptrToString','zeroMemory','stringToNewUTF8','exitJS','getHeapMax','emscripten_realloc_buffer','ENV','ERRNO_CODES','ERRNO_MESSAGES','setErrNo','inetPton4','inetNtop4','inetPton6','inetNtop6','readSockaddr','writeSockaddr','DNS','getHostByName','Protocols','Sockets','getRandomDevice','warnOnce','traverseStack','UNWIND_CACHE','convertPCtoSourceLocation','readAsmConstArgsArray','readAsmConstArgs','mainThreadEM_ASM','jstoi_q','jstoi_s','getExecutableName','listenOnce','autoResumeAudioContext','dynCallLegacy','getDynCaller','dynCall','handleException','runtimeKeepalivePush','runtimeKeepalivePop','callUserCallback','maybeExit','safeSetTimeout','asmjsMangle','asyncLoad','alignMemory','mmapAlloc','writeI53ToI64','writeI53ToI64Clamped','writeI53ToI64Signaling','writeI53ToU64Clamped','writeI53ToU64Signaling','readI53FromI64','readI53FromU64','convertI32PairToI53','convertI32PairToI53Checked','convertU32PairToI53','getCFunc','ccall','cwrap','uleb128Encode','sigToWasmTypes','generateFuncType','convertJsFunctionToWasm','freeTableIndexes','functionsInTableMap','getEmptyTableSlot','updateTableMap','addFunction','removeFunction','reallyNegative','unSign','strLen','reSign','formatString','PATH','PATH_FS','intArrayFromString','intArrayToString','AsciiToString','stringToAscii','UTF16Decoder','UTF16ToString','stringToUTF16','lengthBytesUTF16','UTF32ToString','stringToUTF32','lengthBytesUTF32','allocateUTF8','allocateUTF8OnStack','writeStringToMemory','writeArrayToMemory','writeAsciiToMemory','SYSCALLS','getSocketFromFD','getSocketAddress','JSEvents','registerKeyEventCallback','specialHTMLTargets','maybeCStringToJsString','findEventTarget','findCanvasEventTarget','getBoundingClientRect','fillMouseEventData','registerMouseEventCallback','registerWheelEventCallback','registerUiEventCallback','registerFocusEventCallback','fillDeviceOrientationEventData','registerDeviceOrientationEventCallback','fillDeviceMotionEventData','registerDeviceMotionEventCallback','screenOrientation','fillOrientationChangeEventData','registerOrientationChangeEventCallback','fillFullscreenChangeEventData','registerFullscreenChangeEventCallback','JSEvents_requestFullscreen','JSEvents_resizeCanvasForFullscreen','registerRestoreOldStyle','hideEverythingExceptGivenElement','restoreHiddenElements','setLetterbox','currentFullscreenStrategy','restoreOldWindowedStyle','softFullscreenResizeWebGLRenderTarget','doRequestFullscreen','fillPointerlockChangeEventData','registerPointerlockChangeEventCallback','registerPointerlockErrorEventCallback','requestPointerLock','fillVisibilityChangeEventData','registerVisibilityChangeEventCallback','registerTouchEventCallback','fillGamepadEventData','registerGamepadEventCallback','registerBeforeUnloadEventCallback','fillBatteryEventData','battery','registerBatteryEventCallback','setCanvasElementSize','getCanvasElementSize','demangle','demangleAll','jsStackTrace','stackTrace','ExitStatus','getEnvStrings','checkWasiClock','flush_NO_FILESYSTEM','dlopenMissingError','createDyncallWrapper','setImmediateWrapped','clearImmediateWrapped','polyfillSetImmediate','uncaughtExceptionCount','exceptionLast','exceptionCaught','ExceptionInfo','exception_addRef','exception_decRef','Browser','setMainLoop','wget','FS','MEMFS','TTY','PIPEFS','SOCKFS','_setNetworkCallback','tempFixedLengthArray','miniTempWebGLFloatBuffers','heapObjectForWebGLType','heapAccessShiftForWebGLHeap','GL','emscriptenWebGLGet','computeUnpackAlignedImageSize','emscriptenWebGLGetTexPixelData','emscriptenWebGLGetUniform','webglGetUniformLocation','webglPrepareUniformLocationsBeforeFirstUse','webglGetLeftBracePos','emscriptenWebGLGetVertexAttrib','writeGLArray','AL','SDL_unicode','SDL_ttfContext','SDL_audio','SDL','SDL_gfx','GLUT','EGL','GLFW_Window','GLFW','GLEW','IDBStore','runAndAbortIfError','ALLOC_NORMAL','ALLOC_STACK','allocate'].forEach((function(t){Object.getOwnPropertyDescriptor(n,t)||Object.defineProperty(n,t,{configurable:!0,get:function(){var i="'"+t+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)";v(t)&&(i+='. Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you'),K(i)}})})),['ptrToString','zeroMemory','stringToNewUTF8','exitJS','setErrNo','inetPton4','inetNtop4','inetPton6','inetNtop6','readSockaddr','writeSockaddr','getHostByName','getRandomDevice','traverseStack','convertPCtoSourceLocation','readAsmConstArgs','mainThreadEM_ASM','jstoi_q','jstoi_s','getExecutableName','listenOnce','autoResumeAudioContext','dynCallLegacy','getDynCaller','dynCall','runtimeKeepalivePush','runtimeKeepalivePop','callUserCallback','maybeExit','safeSetTimeout','asmjsMangle','asyncLoad','alignMemory','mmapAlloc','writeI53ToI64','writeI53ToI64Clamped','writeI53ToI64Signaling','writeI53ToU64Clamped','writeI53ToU64Signaling','readI53FromI64','readI53FromU64','convertI32PairToI53','convertI32PairToI53Checked','convertU32PairToI53','getCFunc','ccall','cwrap','uleb128Encode','sigToWasmTypes','generateFuncType','convertJsFunctionToWasm','getEmptyTableSlot','updateTableMap','addFunction','removeFunction','reallyNegative','unSign','strLen','reSign','formatString','intArrayFromString','intArrayToString','AsciiToString','stringToAscii','UTF16ToString','stringToUTF16','lengthBytesUTF16','UTF32ToString','stringToUTF32','lengthBytesUTF32','allocateUTF8','allocateUTF8OnStack','writeStringToMemory','writeAsciiToMemory','getSocketFromFD','getSocketAddress','registerKeyEventCallback','maybeCStringToJsString','findEventTarget','findCanvasEventTarget','getBoundingClientRect','fillMouseEventData','registerMouseEventCallback','registerWheelEventCallback','registerUiEventCallback','registerFocusEventCallback','fillDeviceOrientationEventData','registerDeviceOrientationEventCallback','fillDeviceMotionEventData','registerDeviceMotionEventCallback','screenOrientation','fillOrientationChangeEventData','registerOrientationChangeEventCallback','fillFullscreenChangeEventData','registerFullscreenChangeEventCallback','JSEvents_requestFullscreen','JSEvents_resizeCanvasForFullscreen','registerRestoreOldStyle','hideEverythingExceptGivenElement','restoreHiddenElements','setLetterbox','softFullscreenResizeWebGLRenderTarget','doRequestFullscreen','fillPointerlockChangeEventData','registerPointerlockChangeEventCallback','registerPointerlockErrorEventCallback','requestPointerLock','fillVisibilityChangeEventData','registerVisibilityChangeEventCallback','registerTouchEventCallback','fillGamepadEventData','registerGamepadEventCallback','registerBeforeUnloadEventCallback','fillBatteryEventData','battery','registerBatteryEventCallback','setCanvasElementSize','getCanvasElementSize','getEnvStrings','checkWasiClock','flush_NO_FILESYSTEM','createDyncallWrapper','setImmediateWrapped','clearImmediateWrapped','polyfillSetImmediate','ExceptionInfo','exception_addRef','exception_decRef','setMainLoop','_setNetworkCallback','heapObjectForWebGLType','heapAccessShiftForWebGLHeap','emscriptenWebGLGet','computeUnpackAlignedImageSize','emscriptenWebGLGetTexPixelData','emscriptenWebGLGetUniform','webglGetUniformLocation','webglPrepareUniformLocationsBeforeFirstUse','webglGetLeftBracePos','emscriptenWebGLGetVertexAttrib','writeGLArray','SDL_unicode','SDL_ttfContext','SDL_audio','GLFW_Window','runAndAbortIfError','ALLOC_NORMAL','ALLOC_STACK','allocate'].forEach((function(t){'undefined'==typeof globalThis||Object.getOwnPropertyDescriptor(globalThis,t)||Object.defineProperty(globalThis,t,{configurable:!0,get:function(){var i='`'+t+'` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line';v(t)&&(i+='. Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you'),rt(i)}})})),z=function t(){at||dt(),at||(z=t)},n.preInit)for('function'==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return dt(),t.ready});const n=class{constructor(t={}){this.tP=void 0,this.iP=0,this.sP=0,this.eP=0,this.hP=t.hP||100,this.sampleRate=t.sampleRate||44100,this.nP=t.nP||2,this.gain=t.gain||0,t.bufferSize?this.bufferSize=t.bufferSize:this.rP(1),this.oP=t.oP||(()=>{}),this.aP=t.aP||(()=>{}),this.lP=void 0,this.test=0}async init(){if(!this.tP){if('undefined'!=typeof process){const{WU:t}=await import('path'),{cP:i}=await import('module');globalThis.__dirname=t("file:///home/runner/work/normozenyte.github.io/normozenyte.github.io/src/js/vendor/tinymidipcm/index.js"),globalThis.require=i("file:///home/runner/work/normozenyte.github.io/normozenyte.github.io/src/js/vendor/tinymidipcm/index.js")}this.tP=await h(),this.fP=this.tP._malloc(this.bufferSize),this.uP=this.tP._malloc(8)}}rP(t){this.bufferSize=4*this.sampleRate*this.nP*t}dP(){if(!this.tP)throw new Error(`${this.constructor.name} not initalized. call .init()`)}yP(t){this.dP();const{_malloc:i,_free:s,_tsf_load_memory:e,_tsf_set_output:h,_tsf_channel_set_bank_preset:n,_tsf_set_max_voices:r,_tsf_channel_set_presetnumber:o}=this.tP;s(this.iP),this.iP=i(t.length),this.tP.HEAPU8.set(t,this.iP),this.sP=e(this.iP,t.length),h(this.sP,2===this.nP?0:2,this.sampleRate,this.gain)}pP(){this.dP();const t=new Uint8Array(this.bufferSize);return t.set(this.tP.HEAPU8.subarray(this.fP,this.fP+this.bufferSize)),t}wP(t){const{_malloc:i,_free:s,_tml_load_memory:e}=this.tP;return s(this.eP),this.eP=i(t.length),this.tP.HEAPU8.set(t,this.eP),e(this.eP,t.length)}AP(t){const{_midi_render:i}=this.tP;return i(this.sP,t,this.nP,this.sampleRate,this.fP,this.bufferSize,this.uP)}xP(t){if(this.dP(),!this.sP)throw new Error('no soundfont buffer set. call .setSoundfont');window.clearTimeout(this.lP);const{setValue:i,getValue:s}=this.tP;i(this.uP,0,'double'),this.tP._tsf_reset(this.sP),this.tP._tsf_channel_set_bank_preset(this.sP,9,128,0),t[0]==='R'.charCodeAt(0)&&(t=t.slice(20));let e=this.wP(t);const h=()=>{e=this.AP(e);const t=this.pP();this.oP(t),e?this.lP=setTimeout(h,this.hP):this.aP(s(this.uP,'double'))};this.lP=setTimeout(h,16)}};!function(){window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext&&(window.audioContext=new window.AudioContext);var t=function(i){if(window.audioContext){var s=window.audioContext.createBuffer(1,1,22050),e=window.audioContext.createBufferSource();e.buffer=s,e.connect(window.audioContext.destination),e.start?e.start(0):e.play?e.play(0):e.noteOn&&e.noteOn(0)}document.removeEventListener('touchstart',t),document.removeEventListener('touchend',t),document.removeEventListener('click',t)};document.addEventListener('touchstart',t),document.addEventListener('touchend',t),document.addEventListener('click',t)}(),(async()=>{const t=2,i=44100;let s=new Float32Array,e=window.audioContext.createGain();e.gain.setValueAtTime(.1,window.audioContext.currentTime),e.connect(window.audioContext.destination);let h=window.audioContext.currentTime,r=[];const o=new n({hP:30,oP:t=>{let i=new Float32Array(t.buffer),e=new Float32Array(s.length+i.length);e.set(s,0),e.set(i,s.length),s=e},aP:t=>{},bufferSize:102400});await o.init();const a=await fetch('./SCC1_Florestan.sf2'),l=new Uint8Array(await a.arrayBuffer());function c(){if(!window.audioContext||!s.length)return;let n=window.audioContext.createBufferSource();const o=s.length/t,a=window.audioContext.createBuffer(t,o,i);for(let i=0;i<t;i++){const e=a.getChannelData(i);let h=i;for(let i=0;i<o;i++)e[i]=s[h],h+=t}h<window.audioContext.currentTime&&(h=window.audioContext.currentTime),n.buffer=a,n.connect(e),n.start(h),r.push(n),h+=a.duration,s=new Float32Array}let f;function u(){if(f&&clearInterval(f),s=new Float32Array,r.length){let t=e.gain.value;e.gain.setValueAtTime(0,window.audioContext.currentTime),r.forEach((t=>{t.stop(window.audioContext.currentTime)})),r=[],e.gain.setValueAtTime(t,window.audioContext.currentTime)}}function d(t,i){-1!==t&&window._tinyMidiVolume(t),h=window.audioContext.currentTime,f=setInterval(c,250),o.xP(i)}o.yP(l),window._tinyMidiStop=async t=>{t?function(t){const i=window.audioContext.currentTime;e.gain.cancelScheduledValues(i),e.gain.setTargetAtTime(0,i,.5),setTimeout(t,2e3)}((()=>{u()})):u()},window._tinyMidiVolume=(t=1)=>{e.gain.setValueAtTime(t,window.audioContext.currentTime)},window._tinyMidiPlay=async(t,i,s)=>{t&&(await window._tinyMidiStop(s),s?setTimeout((()=>{d(i,t)}),2e3):d(i,t))}})()},8227:(t,i,s)=>{t.exports=s.p+"9f86b5397894e28b5ae2.wasm"}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var s=n[t]={exports:{}};return h[t](s,s.exports,r),s.exports}r.m=h,t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",i="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",s="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",e=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},r.a=(h,n,r)=>{var o;r&&((o=[]).d=-1);var a,l,c,f=new Set,u=h.exports,d=new Promise(((t,i)=>{c=i,l=t}));d[i]=u,d[t]=t=>(o&&t(o),f.forEach(t),d.catch((t=>{}))),h.exports=d,n((h=>{var n;a=(h=>h.map((h=>{if(null!==h&&"object"==typeof h){if(h[t])return h;if(h.then){var n=[];n.d=0,h.then((t=>{r[i]=t,e(n)}),(t=>{r[s]=t,e(n)}));var r={};return r[t]=t=>t(n),r}}var o={};return o[t]=t=>{},o[i]=h,o})))(h);var r=()=>a.map((t=>{if(t[s])throw t[s];return t[i]})),l=new Promise((i=>{(n=()=>i(r)).r=0;var s=t=>t!==o&&!f.has(t)&&(f.add(t),t&&!t.d&&(n.r++,t.push(n)));a.map((i=>i[t](s)))}));return n.r?l:r()}),(t=>(t?c(d[s]=t):l(u),e(o)))),o&&o.d<0&&(o.d=0)},r.d=(t,i)=>{for(var s in i)r.o(i,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},r.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),r.p="/lostlite/",r.b=document.baseURI||self.location.href;r(6791)})();